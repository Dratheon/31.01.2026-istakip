function Wy(t,s){for(var r=0;r<s.length;r++){const n=s[r];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in t)){const l=Object.getOwnPropertyDescriptor(n,a);l&&Object.defineProperty(t,a,l.get?l:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const i of l.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerPolicy&&(l.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?l.credentials="include":a.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function n(a){if(a.ep)return;a.ep=!0;const l=r(a);fetch(a.href,l)}})();function Ky(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var Hh={exports:{}},Rl={},Yh={exports:{}},$e={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fa=Symbol.for("react.element"),Uy=Symbol.for("react.portal"),qy=Symbol.for("react.fragment"),Hy=Symbol.for("react.strict_mode"),Yy=Symbol.for("react.profiler"),Vy=Symbol.for("react.provider"),Gy=Symbol.for("react.context"),Qy=Symbol.for("react.forward_ref"),Jy=Symbol.for("react.suspense"),Xy=Symbol.for("react.memo"),Zy=Symbol.for("react.lazy"),Zm=Symbol.iterator;function ex(t){return t===null||typeof t!="object"?null:(t=Zm&&t[Zm]||t["@@iterator"],typeof t=="function"?t:null)}var Vh={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Gh=Object.assign,Qh={};function hn(t,s,r){this.props=t,this.context=s,this.refs=Qh,this.updater=r||Vh}hn.prototype.isReactComponent={};hn.prototype.setState=function(t,s){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,s,"setState")};hn.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Jh(){}Jh.prototype=hn.prototype;function Ko(t,s,r){this.props=t,this.context=s,this.refs=Qh,this.updater=r||Vh}var Uo=Ko.prototype=new Jh;Uo.constructor=Ko;Gh(Uo,hn.prototype);Uo.isPureReactComponent=!0;var ep=Array.isArray,Xh=Object.prototype.hasOwnProperty,qo={current:null},Zh={key:!0,ref:!0,__self:!0,__source:!0};function ef(t,s,r){var n,a={},l=null,i=null;if(s!=null)for(n in s.ref!==void 0&&(i=s.ref),s.key!==void 0&&(l=""+s.key),s)Xh.call(s,n)&&!Zh.hasOwnProperty(n)&&(a[n]=s[n]);var d=arguments.length-2;if(d===1)a.children=r;else if(1<d){for(var u=Array(d),f=0;f<d;f++)u[f]=arguments[f+2];a.children=u}if(t&&t.defaultProps)for(n in d=t.defaultProps,d)a[n]===void 0&&(a[n]=d[n]);return{$$typeof:fa,type:t,key:l,ref:i,props:a,_owner:qo.current}}function tx(t,s){return{$$typeof:fa,type:t.type,key:s,ref:t.ref,props:t.props,_owner:t._owner}}function Ho(t){return typeof t=="object"&&t!==null&&t.$$typeof===fa}function sx(t){var s={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(r){return s[r]})}var tp=/\/+/g;function ni(t,s){return typeof t=="object"&&t!==null&&t.key!=null?sx(""+t.key):s.toString(36)}function Ga(t,s,r,n,a){var l=typeof t;(l==="undefined"||l==="boolean")&&(t=null);var i=!1;if(t===null)i=!0;else switch(l){case"string":case"number":i=!0;break;case"object":switch(t.$$typeof){case fa:case Uy:i=!0}}if(i)return i=t,a=a(i),t=n===""?"."+ni(i,0):n,ep(a)?(r="",t!=null&&(r=t.replace(tp,"$&/")+"/"),Ga(a,s,r,"",function(f){return f})):a!=null&&(Ho(a)&&(a=tx(a,r+(!a.key||i&&i.key===a.key?"":(""+a.key).replace(tp,"$&/")+"/")+t)),s.push(a)),1;if(i=0,n=n===""?".":n+":",ep(t))for(var d=0;d<t.length;d++){l=t[d];var u=n+ni(l,d);i+=Ga(l,s,r,u,a)}else if(u=ex(t),typeof u=="function")for(t=u.call(t),d=0;!(l=t.next()).done;)l=l.value,u=n+ni(l,d++),i+=Ga(l,s,r,u,a);else if(l==="object")throw s=String(t),Error("Objects are not valid as a React child (found: "+(s==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":s)+"). If you meant to render a collection of children, use an array instead.");return i}function Na(t,s,r){if(t==null)return t;var n=[],a=0;return Ga(t,n,"","",function(l){return s.call(r,l,a++)}),n}function rx(t){if(t._status===-1){var s=t._result;s=s(),s.then(function(r){(t._status===0||t._status===-1)&&(t._status=1,t._result=r)},function(r){(t._status===0||t._status===-1)&&(t._status=2,t._result=r)}),t._status===-1&&(t._status=0,t._result=s)}if(t._status===1)return t._result.default;throw t._result}var Bt={current:null},Qa={transition:null},nx={ReactCurrentDispatcher:Bt,ReactCurrentBatchConfig:Qa,ReactCurrentOwner:qo};function tf(){throw Error("act(...) is not supported in production builds of React.")}$e.Children={map:Na,forEach:function(t,s,r){Na(t,function(){s.apply(this,arguments)},r)},count:function(t){var s=0;return Na(t,function(){s++}),s},toArray:function(t){return Na(t,function(s){return s})||[]},only:function(t){if(!Ho(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};$e.Component=hn;$e.Fragment=qy;$e.Profiler=Yy;$e.PureComponent=Ko;$e.StrictMode=Hy;$e.Suspense=Jy;$e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=nx;$e.act=tf;$e.cloneElement=function(t,s,r){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var n=Gh({},t.props),a=t.key,l=t.ref,i=t._owner;if(s!=null){if(s.ref!==void 0&&(l=s.ref,i=qo.current),s.key!==void 0&&(a=""+s.key),t.type&&t.type.defaultProps)var d=t.type.defaultProps;for(u in s)Xh.call(s,u)&&!Zh.hasOwnProperty(u)&&(n[u]=s[u]===void 0&&d!==void 0?d[u]:s[u])}var u=arguments.length-2;if(u===1)n.children=r;else if(1<u){d=Array(u);for(var f=0;f<u;f++)d[f]=arguments[f+2];n.children=d}return{$$typeof:fa,type:t.type,key:a,ref:l,props:n,_owner:i}};$e.createContext=function(t){return t={$$typeof:Gy,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Vy,_context:t},t.Consumer=t};$e.createElement=ef;$e.createFactory=function(t){var s=ef.bind(null,t);return s.type=t,s};$e.createRef=function(){return{current:null}};$e.forwardRef=function(t){return{$$typeof:Qy,render:t}};$e.isValidElement=Ho;$e.lazy=function(t){return{$$typeof:Zy,_payload:{_status:-1,_result:t},_init:rx}};$e.memo=function(t,s){return{$$typeof:Xy,type:t,compare:s===void 0?null:s}};$e.startTransition=function(t){var s=Qa.transition;Qa.transition={};try{t()}finally{Qa.transition=s}};$e.unstable_act=tf;$e.useCallback=function(t,s){return Bt.current.useCallback(t,s)};$e.useContext=function(t){return Bt.current.useContext(t)};$e.useDebugValue=function(){};$e.useDeferredValue=function(t){return Bt.current.useDeferredValue(t)};$e.useEffect=function(t,s){return Bt.current.useEffect(t,s)};$e.useId=function(){return Bt.current.useId()};$e.useImperativeHandle=function(t,s,r){return Bt.current.useImperativeHandle(t,s,r)};$e.useInsertionEffect=function(t,s){return Bt.current.useInsertionEffect(t,s)};$e.useLayoutEffect=function(t,s){return Bt.current.useLayoutEffect(t,s)};$e.useMemo=function(t,s){return Bt.current.useMemo(t,s)};$e.useReducer=function(t,s,r){return Bt.current.useReducer(t,s,r)};$e.useRef=function(t){return Bt.current.useRef(t)};$e.useState=function(t){return Bt.current.useState(t)};$e.useSyncExternalStore=function(t,s,r){return Bt.current.useSyncExternalStore(t,s,r)};$e.useTransition=function(){return Bt.current.useTransition()};$e.version="18.3.1";Yh.exports=$e;var c=Yh.exports;const sf=Ky(c),ax=Wy({__proto__:null,default:sf},[c]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var lx=c,ix=Symbol.for("react.element"),ox=Symbol.for("react.fragment"),cx=Object.prototype.hasOwnProperty,dx=lx.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ux={key:!0,ref:!0,__self:!0,__source:!0};function rf(t,s,r){var n,a={},l=null,i=null;r!==void 0&&(l=""+r),s.key!==void 0&&(l=""+s.key),s.ref!==void 0&&(i=s.ref);for(n in s)cx.call(s,n)&&!ux.hasOwnProperty(n)&&(a[n]=s[n]);if(t&&t.defaultProps)for(n in s=t.defaultProps,s)a[n]===void 0&&(a[n]=s[n]);return{$$typeof:ix,type:t,key:l,ref:i,props:a,_owner:dx.current}}Rl.Fragment=ox;Rl.jsx=rf;Rl.jsxs=rf;Hh.exports=Rl;var e=Hh.exports,$i={},nf={exports:{}},Vt={},af={exports:{}},lf={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function s(V,D){var S=V.length;V.push(D);e:for(;0<S;){var g=S-1>>>1,x=V[g];if(0<a(x,D))V[g]=D,V[S]=x,S=g;else break e}}function r(V){return V.length===0?null:V[0]}function n(V){if(V.length===0)return null;var D=V[0],S=V.pop();if(S!==D){V[0]=S;e:for(var g=0,x=V.length,M=x>>>1;g<M;){var w=2*(g+1)-1,j=V[w],B=w+1,K=V[B];if(0>a(j,S))B<x&&0>a(K,j)?(V[g]=K,V[B]=S,g=B):(V[g]=j,V[w]=S,g=w);else if(B<x&&0>a(K,S))V[g]=K,V[B]=S,g=B;else break e}}return D}function a(V,D){var S=V.sortIndex-D.sortIndex;return S!==0?S:V.id-D.id}if(typeof performance=="object"&&typeof performance.now=="function"){var l=performance;t.unstable_now=function(){return l.now()}}else{var i=Date,d=i.now();t.unstable_now=function(){return i.now()-d}}var u=[],f=[],N=1,C=null,b=3,L=!1,k=!1,E=!1,y=typeof setTimeout=="function"?setTimeout:null,p=typeof clearTimeout=="function"?clearTimeout:null,m=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function v(V){for(var D=r(f);D!==null;){if(D.callback===null)n(f);else if(D.startTime<=V)n(f),D.sortIndex=D.expirationTime,s(u,D);else break;D=r(f)}}function z(V){if(E=!1,v(V),!k)if(r(u)!==null)k=!0,U(W);else{var D=r(f);D!==null&&pe(z,D.startTime-V)}}function W(V,D){k=!1,E&&(E=!1,p(X),X=-1),L=!0;var S=b;try{for(v(D),C=r(u);C!==null&&(!(C.expirationTime>D)||V&&!ue());){var g=C.callback;if(typeof g=="function"){C.callback=null,b=C.priorityLevel;var x=g(C.expirationTime<=D);D=t.unstable_now(),typeof x=="function"?C.callback=x:C===r(u)&&n(u),v(D)}else n(u);C=r(u)}if(C!==null)var M=!0;else{var w=r(f);w!==null&&pe(z,w.startTime-D),M=!1}return M}finally{C=null,b=S,L=!1}}var F=!1,q=null,X=-1,Q=5,A=-1;function ue(){return!(t.unstable_now()-A<Q)}function Z(){if(q!==null){var V=t.unstable_now();A=V;var D=!0;try{D=q(!0,V)}finally{D?ae():(F=!1,q=null)}}else F=!1}var ae;if(typeof m=="function")ae=function(){m(Z)};else if(typeof MessageChannel<"u"){var $=new MessageChannel,ne=$.port2;$.port1.onmessage=Z,ae=function(){ne.postMessage(null)}}else ae=function(){y(Z,0)};function U(V){q=V,F||(F=!0,ae())}function pe(V,D){X=y(function(){V(t.unstable_now())},D)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(V){V.callback=null},t.unstable_continueExecution=function(){k||L||(k=!0,U(W))},t.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Q=0<V?Math.floor(1e3/V):5},t.unstable_getCurrentPriorityLevel=function(){return b},t.unstable_getFirstCallbackNode=function(){return r(u)},t.unstable_next=function(V){switch(b){case 1:case 2:case 3:var D=3;break;default:D=b}var S=b;b=D;try{return V()}finally{b=S}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(V,D){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var S=b;b=V;try{return D()}finally{b=S}},t.unstable_scheduleCallback=function(V,D,S){var g=t.unstable_now();switch(typeof S=="object"&&S!==null?(S=S.delay,S=typeof S=="number"&&0<S?g+S:g):S=g,V){case 1:var x=-1;break;case 2:x=250;break;case 5:x=1073741823;break;case 4:x=1e4;break;default:x=5e3}return x=S+x,V={id:N++,callback:D,priorityLevel:V,startTime:S,expirationTime:x,sortIndex:-1},S>g?(V.sortIndex=S,s(f,V),r(u)===null&&V===r(f)&&(E?(p(X),X=-1):E=!0,pe(z,S-g))):(V.sortIndex=x,s(u,V),k||L||(k=!0,U(W))),V},t.unstable_shouldYield=ue,t.unstable_wrapCallback=function(V){var D=b;return function(){var S=b;b=D;try{return V.apply(this,arguments)}finally{b=S}}}})(lf);af.exports=lf;var mx=af.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var px=c,Yt=mx;function ye(t){for(var s="https://reactjs.org/docs/error-decoder.html?invariant="+t,r=1;r<arguments.length;r++)s+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+t+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var of=new Set,Qn={};function Tr(t,s){ln(t,s),ln(t+"Capture",s)}function ln(t,s){for(Qn[t]=s,t=0;t<s.length;t++)of.add(s[t])}var zs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Wi=Object.prototype.hasOwnProperty,hx=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,sp={},rp={};function fx(t){return Wi.call(rp,t)?!0:Wi.call(sp,t)?!1:hx.test(t)?rp[t]=!0:(sp[t]=!0,!1)}function gx(t,s,r,n){if(r!==null&&r.type===0)return!1;switch(typeof s){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function yx(t,s,r,n){if(s===null||typeof s>"u"||gx(t,s,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!s;case 4:return s===!1;case 5:return isNaN(s);case 6:return isNaN(s)||1>s}return!1}function Lt(t,s,r,n,a,l,i){this.acceptsBooleans=s===2||s===3||s===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=t,this.type=s,this.sanitizeURL=l,this.removeEmptyString=i}var kt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){kt[t]=new Lt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var s=t[0];kt[s]=new Lt(s,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){kt[t]=new Lt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){kt[t]=new Lt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){kt[t]=new Lt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){kt[t]=new Lt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){kt[t]=new Lt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){kt[t]=new Lt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){kt[t]=new Lt(t,5,!1,t.toLowerCase(),null,!1,!1)});var Yo=/[\-:]([a-z])/g;function Vo(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var s=t.replace(Yo,Vo);kt[s]=new Lt(s,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var s=t.replace(Yo,Vo);kt[s]=new Lt(s,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var s=t.replace(Yo,Vo);kt[s]=new Lt(s,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){kt[t]=new Lt(t,1,!1,t.toLowerCase(),null,!1,!1)});kt.xlinkHref=new Lt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){kt[t]=new Lt(t,1,!1,t.toLowerCase(),null,!0,!0)});function Go(t,s,r,n){var a=kt.hasOwnProperty(s)?kt[s]:null;(a!==null?a.type!==0:n||!(2<s.length)||s[0]!=="o"&&s[0]!=="O"||s[1]!=="n"&&s[1]!=="N")&&(yx(s,r,a,n)&&(r=null),n||a===null?fx(s)&&(r===null?t.removeAttribute(s):t.setAttribute(s,""+r)):a.mustUseProperty?t[a.propertyName]=r===null?a.type===3?!1:"":r:(s=a.attributeName,n=a.attributeNamespace,r===null?t.removeAttribute(s):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?t.setAttributeNS(n,s,r):t.setAttribute(s,r))))}var Rs=px.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Sa=Symbol.for("react.element"),Wr=Symbol.for("react.portal"),Kr=Symbol.for("react.fragment"),Qo=Symbol.for("react.strict_mode"),Ki=Symbol.for("react.profiler"),cf=Symbol.for("react.provider"),df=Symbol.for("react.context"),Jo=Symbol.for("react.forward_ref"),Ui=Symbol.for("react.suspense"),qi=Symbol.for("react.suspense_list"),Xo=Symbol.for("react.memo"),_s=Symbol.for("react.lazy"),uf=Symbol.for("react.offscreen"),np=Symbol.iterator;function Sn(t){return t===null||typeof t!="object"?null:(t=np&&t[np]||t["@@iterator"],typeof t=="function"?t:null)}var ot=Object.assign,ai;function Ln(t){if(ai===void 0)try{throw Error()}catch(r){var s=r.stack.trim().match(/\n( *(at )?)/);ai=s&&s[1]||""}return`
`+ai+t}var li=!1;function ii(t,s){if(!t||li)return"";li=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(s)if(s=function(){throw Error()},Object.defineProperty(s.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(s,[])}catch(f){var n=f}Reflect.construct(t,[],s)}else{try{s.call()}catch(f){n=f}t.call(s.prototype)}else{try{throw Error()}catch(f){n=f}t()}}catch(f){if(f&&n&&typeof f.stack=="string"){for(var a=f.stack.split(`
`),l=n.stack.split(`
`),i=a.length-1,d=l.length-1;1<=i&&0<=d&&a[i]!==l[d];)d--;for(;1<=i&&0<=d;i--,d--)if(a[i]!==l[d]){if(i!==1||d!==1)do if(i--,d--,0>d||a[i]!==l[d]){var u=`
`+a[i].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=i&&0<=d);break}}}finally{li=!1,Error.prepareStackTrace=r}return(t=t?t.displayName||t.name:"")?Ln(t):""}function xx(t){switch(t.tag){case 5:return Ln(t.type);case 16:return Ln("Lazy");case 13:return Ln("Suspense");case 19:return Ln("SuspenseList");case 0:case 2:case 15:return t=ii(t.type,!1),t;case 11:return t=ii(t.type.render,!1),t;case 1:return t=ii(t.type,!0),t;default:return""}}function Hi(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Kr:return"Fragment";case Wr:return"Portal";case Ki:return"Profiler";case Qo:return"StrictMode";case Ui:return"Suspense";case qi:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case df:return(t.displayName||"Context")+".Consumer";case cf:return(t._context.displayName||"Context")+".Provider";case Jo:var s=t.render;return t=t.displayName,t||(t=s.displayName||s.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Xo:return s=t.displayName||null,s!==null?s:Hi(t.type)||"Memo";case _s:s=t._payload,t=t._init;try{return Hi(t(s))}catch{}}return null}function vx(t){var s=t.type;switch(t.tag){case 24:return"Cache";case 9:return(s.displayName||"Context")+".Consumer";case 10:return(s._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=s.render,t=t.displayName||t.name||"",s.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return s;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Hi(s);case 8:return s===Qo?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof s=="function")return s.displayName||s.name||null;if(typeof s=="string")return s}return null}function sr(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function mf(t){var s=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function jx(t){var s=mf(t)?"checked":"value",r=Object.getOwnPropertyDescriptor(t.constructor.prototype,s),n=""+t[s];if(!t.hasOwnProperty(s)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,l=r.set;return Object.defineProperty(t,s,{configurable:!0,get:function(){return a.call(this)},set:function(i){n=""+i,l.call(this,i)}}),Object.defineProperty(t,s,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(i){n=""+i},stopTracking:function(){t._valueTracker=null,delete t[s]}}}}function ka(t){t._valueTracker||(t._valueTracker=jx(t))}function pf(t){if(!t)return!1;var s=t._valueTracker;if(!s)return!0;var r=s.getValue(),n="";return t&&(n=mf(t)?t.checked?"true":"false":t.value),t=n,t!==r?(s.setValue(t),!0):!1}function il(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Yi(t,s){var r=s.checked;return ot({},s,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??t._wrapperState.initialChecked})}function ap(t,s){var r=s.defaultValue==null?"":s.defaultValue,n=s.checked!=null?s.checked:s.defaultChecked;r=sr(s.value!=null?s.value:r),t._wrapperState={initialChecked:n,initialValue:r,controlled:s.type==="checkbox"||s.type==="radio"?s.checked!=null:s.value!=null}}function hf(t,s){s=s.checked,s!=null&&Go(t,"checked",s,!1)}function Vi(t,s){hf(t,s);var r=sr(s.value),n=s.type;if(r!=null)n==="number"?(r===0&&t.value===""||t.value!=r)&&(t.value=""+r):t.value!==""+r&&(t.value=""+r);else if(n==="submit"||n==="reset"){t.removeAttribute("value");return}s.hasOwnProperty("value")?Gi(t,s.type,r):s.hasOwnProperty("defaultValue")&&Gi(t,s.type,sr(s.defaultValue)),s.checked==null&&s.defaultChecked!=null&&(t.defaultChecked=!!s.defaultChecked)}function lp(t,s,r){if(s.hasOwnProperty("value")||s.hasOwnProperty("defaultValue")){var n=s.type;if(!(n!=="submit"&&n!=="reset"||s.value!==void 0&&s.value!==null))return;s=""+t._wrapperState.initialValue,r||s===t.value||(t.value=s),t.defaultValue=s}r=t.name,r!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,r!==""&&(t.name=r)}function Gi(t,s,r){(s!=="number"||il(t.ownerDocument)!==t)&&(r==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+r&&(t.defaultValue=""+r))}var Pn=Array.isArray;function en(t,s,r,n){if(t=t.options,s){s={};for(var a=0;a<r.length;a++)s["$"+r[a]]=!0;for(r=0;r<t.length;r++)a=s.hasOwnProperty("$"+t[r].value),t[r].selected!==a&&(t[r].selected=a),a&&n&&(t[r].defaultSelected=!0)}else{for(r=""+sr(r),s=null,a=0;a<t.length;a++){if(t[a].value===r){t[a].selected=!0,n&&(t[a].defaultSelected=!0);return}s!==null||t[a].disabled||(s=t[a])}s!==null&&(s.selected=!0)}}function Qi(t,s){if(s.dangerouslySetInnerHTML!=null)throw Error(ye(91));return ot({},s,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function ip(t,s){var r=s.value;if(r==null){if(r=s.children,s=s.defaultValue,r!=null){if(s!=null)throw Error(ye(92));if(Pn(r)){if(1<r.length)throw Error(ye(93));r=r[0]}s=r}s==null&&(s=""),r=s}t._wrapperState={initialValue:sr(r)}}function ff(t,s){var r=sr(s.value),n=sr(s.defaultValue);r!=null&&(r=""+r,r!==t.value&&(t.value=r),s.defaultValue==null&&t.defaultValue!==r&&(t.defaultValue=r)),n!=null&&(t.defaultValue=""+n)}function op(t){var s=t.textContent;s===t._wrapperState.initialValue&&s!==""&&s!==null&&(t.value=s)}function gf(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Ji(t,s){return t==null||t==="http://www.w3.org/1999/xhtml"?gf(s):t==="http://www.w3.org/2000/svg"&&s==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Ca,yf=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(s,r,n,a){MSApp.execUnsafeLocalFunction(function(){return t(s,r,n,a)})}:t}(function(t,s){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=s;else{for(Ca=Ca||document.createElement("div"),Ca.innerHTML="<svg>"+s.valueOf().toString()+"</svg>",s=Ca.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;s.firstChild;)t.appendChild(s.firstChild)}});function Jn(t,s){if(s){var r=t.firstChild;if(r&&r===t.lastChild&&r.nodeType===3){r.nodeValue=s;return}}t.textContent=s}var $n={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},bx=["Webkit","ms","Moz","O"];Object.keys($n).forEach(function(t){bx.forEach(function(s){s=s+t.charAt(0).toUpperCase()+t.substring(1),$n[s]=$n[t]})});function xf(t,s,r){return s==null||typeof s=="boolean"||s===""?"":r||typeof s!="number"||s===0||$n.hasOwnProperty(t)&&$n[t]?(""+s).trim():s+"px"}function vf(t,s){t=t.style;for(var r in s)if(s.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=xf(r,s[r],n);r==="float"&&(r="cssFloat"),n?t.setProperty(r,a):t[r]=a}}var Nx=ot({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Xi(t,s){if(s){if(Nx[t]&&(s.children!=null||s.dangerouslySetInnerHTML!=null))throw Error(ye(137,t));if(s.dangerouslySetInnerHTML!=null){if(s.children!=null)throw Error(ye(60));if(typeof s.dangerouslySetInnerHTML!="object"||!("__html"in s.dangerouslySetInnerHTML))throw Error(ye(61))}if(s.style!=null&&typeof s.style!="object")throw Error(ye(62))}}function Zi(t,s){if(t.indexOf("-")===-1)return typeof s.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var eo=null;function Zo(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var to=null,tn=null,sn=null;function cp(t){if(t=xa(t)){if(typeof to!="function")throw Error(ye(280));var s=t.stateNode;s&&(s=Ol(s),to(t.stateNode,t.type,s))}}function jf(t){tn?sn?sn.push(t):sn=[t]:tn=t}function bf(){if(tn){var t=tn,s=sn;if(sn=tn=null,cp(t),s)for(t=0;t<s.length;t++)cp(s[t])}}function Nf(t,s){return t(s)}function Sf(){}var oi=!1;function kf(t,s,r){if(oi)return t(s,r);oi=!0;try{return Nf(t,s,r)}finally{oi=!1,(tn!==null||sn!==null)&&(Sf(),bf())}}function Xn(t,s){var r=t.stateNode;if(r===null)return null;var n=Ol(r);if(n===null)return null;r=n[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(t=t.type,n=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!n;break e;default:t=!1}if(t)return null;if(r&&typeof r!="function")throw Error(ye(231,s,typeof r));return r}var so=!1;if(zs)try{var kn={};Object.defineProperty(kn,"passive",{get:function(){so=!0}}),window.addEventListener("test",kn,kn),window.removeEventListener("test",kn,kn)}catch{so=!1}function Sx(t,s,r,n,a,l,i,d,u){var f=Array.prototype.slice.call(arguments,3);try{s.apply(r,f)}catch(N){this.onError(N)}}var Wn=!1,ol=null,cl=!1,ro=null,kx={onError:function(t){Wn=!0,ol=t}};function Cx(t,s,r,n,a,l,i,d,u){Wn=!1,ol=null,Sx.apply(kx,arguments)}function wx(t,s,r,n,a,l,i,d,u){if(Cx.apply(this,arguments),Wn){if(Wn){var f=ol;Wn=!1,ol=null}else throw Error(ye(198));cl||(cl=!0,ro=f)}}function Dr(t){var s=t,r=t;if(t.alternate)for(;s.return;)s=s.return;else{t=s;do s=t,s.flags&4098&&(r=s.return),t=s.return;while(t)}return s.tag===3?r:null}function Cf(t){if(t.tag===13){var s=t.memoizedState;if(s===null&&(t=t.alternate,t!==null&&(s=t.memoizedState)),s!==null)return s.dehydrated}return null}function dp(t){if(Dr(t)!==t)throw Error(ye(188))}function Tx(t){var s=t.alternate;if(!s){if(s=Dr(t),s===null)throw Error(ye(188));return s!==t?null:t}for(var r=t,n=s;;){var a=r.return;if(a===null)break;var l=a.alternate;if(l===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===l.child){for(l=a.child;l;){if(l===r)return dp(a),t;if(l===n)return dp(a),s;l=l.sibling}throw Error(ye(188))}if(r.return!==n.return)r=a,n=l;else{for(var i=!1,d=a.child;d;){if(d===r){i=!0,r=a,n=l;break}if(d===n){i=!0,n=a,r=l;break}d=d.sibling}if(!i){for(d=l.child;d;){if(d===r){i=!0,r=l,n=a;break}if(d===n){i=!0,n=l,r=a;break}d=d.sibling}if(!i)throw Error(ye(189))}}if(r.alternate!==n)throw Error(ye(190))}if(r.tag!==3)throw Error(ye(188));return r.stateNode.current===r?t:s}function wf(t){return t=Tx(t),t!==null?Tf(t):null}function Tf(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var s=Tf(t);if(s!==null)return s;t=t.sibling}return null}var Df=Yt.unstable_scheduleCallback,up=Yt.unstable_cancelCallback,Dx=Yt.unstable_shouldYield,zx=Yt.unstable_requestPaint,mt=Yt.unstable_now,Ix=Yt.unstable_getCurrentPriorityLevel,ec=Yt.unstable_ImmediatePriority,zf=Yt.unstable_UserBlockingPriority,dl=Yt.unstable_NormalPriority,Ex=Yt.unstable_LowPriority,If=Yt.unstable_IdlePriority,Bl=null,vs=null;function Ax(t){if(vs&&typeof vs.onCommitFiberRoot=="function")try{vs.onCommitFiberRoot(Bl,t,void 0,(t.current.flags&128)===128)}catch{}}var cs=Math.clz32?Math.clz32:Lx,Rx=Math.log,Bx=Math.LN2;function Lx(t){return t>>>=0,t===0?32:31-(Rx(t)/Bx|0)|0}var wa=64,Ta=4194304;function Mn(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function ul(t,s){var r=t.pendingLanes;if(r===0)return 0;var n=0,a=t.suspendedLanes,l=t.pingedLanes,i=r&268435455;if(i!==0){var d=i&~a;d!==0?n=Mn(d):(l&=i,l!==0&&(n=Mn(l)))}else i=r&~a,i!==0?n=Mn(i):l!==0&&(n=Mn(l));if(n===0)return 0;if(s!==0&&s!==n&&!(s&a)&&(a=n&-n,l=s&-s,a>=l||a===16&&(l&4194240)!==0))return s;if(n&4&&(n|=r&16),s=t.entangledLanes,s!==0)for(t=t.entanglements,s&=n;0<s;)r=31-cs(s),a=1<<r,n|=t[r],s&=~a;return n}function Px(t,s){switch(t){case 1:case 2:case 4:return s+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Mx(t,s){for(var r=t.suspendedLanes,n=t.pingedLanes,a=t.expirationTimes,l=t.pendingLanes;0<l;){var i=31-cs(l),d=1<<i,u=a[i];u===-1?(!(d&r)||d&n)&&(a[i]=Px(d,s)):u<=s&&(t.expiredLanes|=d),l&=~d}}function no(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Ef(){var t=wa;return wa<<=1,!(wa&4194240)&&(wa=64),t}function ci(t){for(var s=[],r=0;31>r;r++)s.push(t);return s}function ga(t,s,r){t.pendingLanes|=s,s!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,s=31-cs(s),t[s]=r}function Ox(t,s){var r=t.pendingLanes&~s;t.pendingLanes=s,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=s,t.mutableReadLanes&=s,t.entangledLanes&=s,s=t.entanglements;var n=t.eventTimes;for(t=t.expirationTimes;0<r;){var a=31-cs(r),l=1<<a;s[a]=0,n[a]=-1,t[a]=-1,r&=~l}}function tc(t,s){var r=t.entangledLanes|=s;for(t=t.entanglements;r;){var n=31-cs(r),a=1<<n;a&s|t[n]&s&&(t[n]|=s),r&=~a}}var Ye=0;function Af(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Rf,sc,Bf,Lf,Pf,ao=!1,Da=[],Ys=null,Vs=null,Gs=null,Zn=new Map,ea=new Map,$s=[],_x="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function mp(t,s){switch(t){case"focusin":case"focusout":Ys=null;break;case"dragenter":case"dragleave":Vs=null;break;case"mouseover":case"mouseout":Gs=null;break;case"pointerover":case"pointerout":Zn.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":ea.delete(s.pointerId)}}function Cn(t,s,r,n,a,l){return t===null||t.nativeEvent!==l?(t={blockedOn:s,domEventName:r,eventSystemFlags:n,nativeEvent:l,targetContainers:[a]},s!==null&&(s=xa(s),s!==null&&sc(s)),t):(t.eventSystemFlags|=n,s=t.targetContainers,a!==null&&s.indexOf(a)===-1&&s.push(a),t)}function Fx(t,s,r,n,a){switch(s){case"focusin":return Ys=Cn(Ys,t,s,r,n,a),!0;case"dragenter":return Vs=Cn(Vs,t,s,r,n,a),!0;case"mouseover":return Gs=Cn(Gs,t,s,r,n,a),!0;case"pointerover":var l=a.pointerId;return Zn.set(l,Cn(Zn.get(l)||null,t,s,r,n,a)),!0;case"gotpointercapture":return l=a.pointerId,ea.set(l,Cn(ea.get(l)||null,t,s,r,n,a)),!0}return!1}function Mf(t){var s=gr(t.target);if(s!==null){var r=Dr(s);if(r!==null){if(s=r.tag,s===13){if(s=Cf(r),s!==null){t.blockedOn=s,Pf(t.priority,function(){Bf(r)});return}}else if(s===3&&r.stateNode.current.memoizedState.isDehydrated){t.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Ja(t){if(t.blockedOn!==null)return!1;for(var s=t.targetContainers;0<s.length;){var r=lo(t.domEventName,t.eventSystemFlags,s[0],t.nativeEvent);if(r===null){r=t.nativeEvent;var n=new r.constructor(r.type,r);eo=n,r.target.dispatchEvent(n),eo=null}else return s=xa(r),s!==null&&sc(s),t.blockedOn=r,!1;s.shift()}return!0}function pp(t,s,r){Ja(t)&&r.delete(s)}function $x(){ao=!1,Ys!==null&&Ja(Ys)&&(Ys=null),Vs!==null&&Ja(Vs)&&(Vs=null),Gs!==null&&Ja(Gs)&&(Gs=null),Zn.forEach(pp),ea.forEach(pp)}function wn(t,s){t.blockedOn===s&&(t.blockedOn=null,ao||(ao=!0,Yt.unstable_scheduleCallback(Yt.unstable_NormalPriority,$x)))}function ta(t){function s(a){return wn(a,t)}if(0<Da.length){wn(Da[0],t);for(var r=1;r<Da.length;r++){var n=Da[r];n.blockedOn===t&&(n.blockedOn=null)}}for(Ys!==null&&wn(Ys,t),Vs!==null&&wn(Vs,t),Gs!==null&&wn(Gs,t),Zn.forEach(s),ea.forEach(s),r=0;r<$s.length;r++)n=$s[r],n.blockedOn===t&&(n.blockedOn=null);for(;0<$s.length&&(r=$s[0],r.blockedOn===null);)Mf(r),r.blockedOn===null&&$s.shift()}var rn=Rs.ReactCurrentBatchConfig,ml=!0;function Wx(t,s,r,n){var a=Ye,l=rn.transition;rn.transition=null;try{Ye=1,rc(t,s,r,n)}finally{Ye=a,rn.transition=l}}function Kx(t,s,r,n){var a=Ye,l=rn.transition;rn.transition=null;try{Ye=4,rc(t,s,r,n)}finally{Ye=a,rn.transition=l}}function rc(t,s,r,n){if(ml){var a=lo(t,s,r,n);if(a===null)vi(t,s,n,pl,r),mp(t,n);else if(Fx(a,t,s,r,n))n.stopPropagation();else if(mp(t,n),s&4&&-1<_x.indexOf(t)){for(;a!==null;){var l=xa(a);if(l!==null&&Rf(l),l=lo(t,s,r,n),l===null&&vi(t,s,n,pl,r),l===a)break;a=l}a!==null&&n.stopPropagation()}else vi(t,s,n,null,r)}}var pl=null;function lo(t,s,r,n){if(pl=null,t=Zo(n),t=gr(t),t!==null)if(s=Dr(t),s===null)t=null;else if(r=s.tag,r===13){if(t=Cf(s),t!==null)return t;t=null}else if(r===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;t=null}else s!==t&&(t=null);return pl=t,null}function Of(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ix()){case ec:return 1;case zf:return 4;case dl:case Ex:return 16;case If:return 536870912;default:return 16}default:return 16}}var Us=null,nc=null,Xa=null;function _f(){if(Xa)return Xa;var t,s=nc,r=s.length,n,a="value"in Us?Us.value:Us.textContent,l=a.length;for(t=0;t<r&&s[t]===a[t];t++);var i=r-t;for(n=1;n<=i&&s[r-n]===a[l-n];n++);return Xa=a.slice(t,1<n?1-n:void 0)}function Za(t){var s=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&s===13&&(t=13)):t=s,t===10&&(t=13),32<=t||t===13?t:0}function za(){return!0}function hp(){return!1}function Gt(t){function s(r,n,a,l,i){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=l,this.target=i,this.currentTarget=null;for(var d in t)t.hasOwnProperty(d)&&(r=t[d],this[d]=r?r(l):l[d]);return this.isDefaultPrevented=(l.defaultPrevented!=null?l.defaultPrevented:l.returnValue===!1)?za:hp,this.isPropagationStopped=hp,this}return ot(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=za)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=za)},persist:function(){},isPersistent:za}),s}var fn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ac=Gt(fn),ya=ot({},fn,{view:0,detail:0}),Ux=Gt(ya),di,ui,Tn,Ll=ot({},ya,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:lc,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Tn&&(Tn&&t.type==="mousemove"?(di=t.screenX-Tn.screenX,ui=t.screenY-Tn.screenY):ui=di=0,Tn=t),di)},movementY:function(t){return"movementY"in t?t.movementY:ui}}),fp=Gt(Ll),qx=ot({},Ll,{dataTransfer:0}),Hx=Gt(qx),Yx=ot({},ya,{relatedTarget:0}),mi=Gt(Yx),Vx=ot({},fn,{animationName:0,elapsedTime:0,pseudoElement:0}),Gx=Gt(Vx),Qx=ot({},fn,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Jx=Gt(Qx),Xx=ot({},fn,{data:0}),gp=Gt(Xx),Zx={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},ev={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},tv={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function sv(t){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(t):(t=tv[t])?!!s[t]:!1}function lc(){return sv}var rv=ot({},ya,{key:function(t){if(t.key){var s=Zx[t.key]||t.key;if(s!=="Unidentified")return s}return t.type==="keypress"?(t=Za(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?ev[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:lc,charCode:function(t){return t.type==="keypress"?Za(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Za(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),nv=Gt(rv),av=ot({},Ll,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),yp=Gt(av),lv=ot({},ya,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:lc}),iv=Gt(lv),ov=ot({},fn,{propertyName:0,elapsedTime:0,pseudoElement:0}),cv=Gt(ov),dv=ot({},Ll,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),uv=Gt(dv),mv=[9,13,27,32],ic=zs&&"CompositionEvent"in window,Kn=null;zs&&"documentMode"in document&&(Kn=document.documentMode);var pv=zs&&"TextEvent"in window&&!Kn,Ff=zs&&(!ic||Kn&&8<Kn&&11>=Kn),xp=" ",vp=!1;function $f(t,s){switch(t){case"keyup":return mv.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Wf(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Ur=!1;function hv(t,s){switch(t){case"compositionend":return Wf(s);case"keypress":return s.which!==32?null:(vp=!0,xp);case"textInput":return t=s.data,t===xp&&vp?null:t;default:return null}}function fv(t,s){if(Ur)return t==="compositionend"||!ic&&$f(t,s)?(t=_f(),Xa=nc=Us=null,Ur=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return Ff&&s.locale!=="ko"?null:s.data;default:return null}}var gv={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function jp(t){var s=t&&t.nodeName&&t.nodeName.toLowerCase();return s==="input"?!!gv[t.type]:s==="textarea"}function Kf(t,s,r,n){jf(n),s=hl(s,"onChange"),0<s.length&&(r=new ac("onChange","change",null,r,n),t.push({event:r,listeners:s}))}var Un=null,sa=null;function yv(t){eg(t,0)}function Pl(t){var s=Yr(t);if(pf(s))return t}function xv(t,s){if(t==="change")return s}var Uf=!1;if(zs){var pi;if(zs){var hi="oninput"in document;if(!hi){var bp=document.createElement("div");bp.setAttribute("oninput","return;"),hi=typeof bp.oninput=="function"}pi=hi}else pi=!1;Uf=pi&&(!document.documentMode||9<document.documentMode)}function Np(){Un&&(Un.detachEvent("onpropertychange",qf),sa=Un=null)}function qf(t){if(t.propertyName==="value"&&Pl(sa)){var s=[];Kf(s,sa,t,Zo(t)),kf(yv,s)}}function vv(t,s,r){t==="focusin"?(Np(),Un=s,sa=r,Un.attachEvent("onpropertychange",qf)):t==="focusout"&&Np()}function jv(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return Pl(sa)}function bv(t,s){if(t==="click")return Pl(s)}function Nv(t,s){if(t==="input"||t==="change")return Pl(s)}function Sv(t,s){return t===s&&(t!==0||1/t===1/s)||t!==t&&s!==s}var us=typeof Object.is=="function"?Object.is:Sv;function ra(t,s){if(us(t,s))return!0;if(typeof t!="object"||t===null||typeof s!="object"||s===null)return!1;var r=Object.keys(t),n=Object.keys(s);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!Wi.call(s,a)||!us(t[a],s[a]))return!1}return!0}function Sp(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function kp(t,s){var r=Sp(t);t=0;for(var n;r;){if(r.nodeType===3){if(n=t+r.textContent.length,t<=s&&n>=s)return{node:r,offset:s-t};t=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=Sp(r)}}function Hf(t,s){return t&&s?t===s?!0:t&&t.nodeType===3?!1:s&&s.nodeType===3?Hf(t,s.parentNode):"contains"in t?t.contains(s):t.compareDocumentPosition?!!(t.compareDocumentPosition(s)&16):!1:!1}function Yf(){for(var t=window,s=il();s instanceof t.HTMLIFrameElement;){try{var r=typeof s.contentWindow.location.href=="string"}catch{r=!1}if(r)t=s.contentWindow;else break;s=il(t.document)}return s}function oc(t){var s=t&&t.nodeName&&t.nodeName.toLowerCase();return s&&(s==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||s==="textarea"||t.contentEditable==="true")}function kv(t){var s=Yf(),r=t.focusedElem,n=t.selectionRange;if(s!==r&&r&&r.ownerDocument&&Hf(r.ownerDocument.documentElement,r)){if(n!==null&&oc(r)){if(s=n.start,t=n.end,t===void 0&&(t=s),"selectionStart"in r)r.selectionStart=s,r.selectionEnd=Math.min(t,r.value.length);else if(t=(s=r.ownerDocument||document)&&s.defaultView||window,t.getSelection){t=t.getSelection();var a=r.textContent.length,l=Math.min(n.start,a);n=n.end===void 0?l:Math.min(n.end,a),!t.extend&&l>n&&(a=n,n=l,l=a),a=kp(r,l);var i=kp(r,n);a&&i&&(t.rangeCount!==1||t.anchorNode!==a.node||t.anchorOffset!==a.offset||t.focusNode!==i.node||t.focusOffset!==i.offset)&&(s=s.createRange(),s.setStart(a.node,a.offset),t.removeAllRanges(),l>n?(t.addRange(s),t.extend(i.node,i.offset)):(s.setEnd(i.node,i.offset),t.addRange(s)))}}for(s=[],t=r;t=t.parentNode;)t.nodeType===1&&s.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<s.length;r++)t=s[r],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var Cv=zs&&"documentMode"in document&&11>=document.documentMode,qr=null,io=null,qn=null,oo=!1;function Cp(t,s,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;oo||qr==null||qr!==il(n)||(n=qr,"selectionStart"in n&&oc(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),qn&&ra(qn,n)||(qn=n,n=hl(io,"onSelect"),0<n.length&&(s=new ac("onSelect","select",null,s,r),t.push({event:s,listeners:n}),s.target=qr)))}function Ia(t,s){var r={};return r[t.toLowerCase()]=s.toLowerCase(),r["Webkit"+t]="webkit"+s,r["Moz"+t]="moz"+s,r}var Hr={animationend:Ia("Animation","AnimationEnd"),animationiteration:Ia("Animation","AnimationIteration"),animationstart:Ia("Animation","AnimationStart"),transitionend:Ia("Transition","TransitionEnd")},fi={},Vf={};zs&&(Vf=document.createElement("div").style,"AnimationEvent"in window||(delete Hr.animationend.animation,delete Hr.animationiteration.animation,delete Hr.animationstart.animation),"TransitionEvent"in window||delete Hr.transitionend.transition);function Ml(t){if(fi[t])return fi[t];if(!Hr[t])return t;var s=Hr[t],r;for(r in s)if(s.hasOwnProperty(r)&&r in Vf)return fi[t]=s[r];return t}var Gf=Ml("animationend"),Qf=Ml("animationiteration"),Jf=Ml("animationstart"),Xf=Ml("transitionend"),Zf=new Map,wp="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function nr(t,s){Zf.set(t,s),Tr(s,[t])}for(var gi=0;gi<wp.length;gi++){var yi=wp[gi],wv=yi.toLowerCase(),Tv=yi[0].toUpperCase()+yi.slice(1);nr(wv,"on"+Tv)}nr(Gf,"onAnimationEnd");nr(Qf,"onAnimationIteration");nr(Jf,"onAnimationStart");nr("dblclick","onDoubleClick");nr("focusin","onFocus");nr("focusout","onBlur");nr(Xf,"onTransitionEnd");ln("onMouseEnter",["mouseout","mouseover"]);ln("onMouseLeave",["mouseout","mouseover"]);ln("onPointerEnter",["pointerout","pointerover"]);ln("onPointerLeave",["pointerout","pointerover"]);Tr("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Tr("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Tr("onBeforeInput",["compositionend","keypress","textInput","paste"]);Tr("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Tr("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Tr("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var On="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Dv=new Set("cancel close invalid load scroll toggle".split(" ").concat(On));function Tp(t,s,r){var n=t.type||"unknown-event";t.currentTarget=r,wx(n,s,void 0,t),t.currentTarget=null}function eg(t,s){s=(s&4)!==0;for(var r=0;r<t.length;r++){var n=t[r],a=n.event;n=n.listeners;e:{var l=void 0;if(s)for(var i=n.length-1;0<=i;i--){var d=n[i],u=d.instance,f=d.currentTarget;if(d=d.listener,u!==l&&a.isPropagationStopped())break e;Tp(a,d,f),l=u}else for(i=0;i<n.length;i++){if(d=n[i],u=d.instance,f=d.currentTarget,d=d.listener,u!==l&&a.isPropagationStopped())break e;Tp(a,d,f),l=u}}}if(cl)throw t=ro,cl=!1,ro=null,t}function Xe(t,s){var r=s[ho];r===void 0&&(r=s[ho]=new Set);var n=t+"__bubble";r.has(n)||(tg(s,t,2,!1),r.add(n))}function xi(t,s,r){var n=0;s&&(n|=4),tg(r,t,n,s)}var Ea="_reactListening"+Math.random().toString(36).slice(2);function na(t){if(!t[Ea]){t[Ea]=!0,of.forEach(function(r){r!=="selectionchange"&&(Dv.has(r)||xi(r,!1,t),xi(r,!0,t))});var s=t.nodeType===9?t:t.ownerDocument;s===null||s[Ea]||(s[Ea]=!0,xi("selectionchange",!1,s))}}function tg(t,s,r,n){switch(Of(s)){case 1:var a=Wx;break;case 4:a=Kx;break;default:a=rc}r=a.bind(null,s,r,t),a=void 0,!so||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(a=!0),n?a!==void 0?t.addEventListener(s,r,{capture:!0,passive:a}):t.addEventListener(s,r,!0):a!==void 0?t.addEventListener(s,r,{passive:a}):t.addEventListener(s,r,!1)}function vi(t,s,r,n,a){var l=n;if(!(s&1)&&!(s&2)&&n!==null)e:for(;;){if(n===null)return;var i=n.tag;if(i===3||i===4){var d=n.stateNode.containerInfo;if(d===a||d.nodeType===8&&d.parentNode===a)break;if(i===4)for(i=n.return;i!==null;){var u=i.tag;if((u===3||u===4)&&(u=i.stateNode.containerInfo,u===a||u.nodeType===8&&u.parentNode===a))return;i=i.return}for(;d!==null;){if(i=gr(d),i===null)return;if(u=i.tag,u===5||u===6){n=l=i;continue e}d=d.parentNode}}n=n.return}kf(function(){var f=l,N=Zo(r),C=[];e:{var b=Zf.get(t);if(b!==void 0){var L=ac,k=t;switch(t){case"keypress":if(Za(r)===0)break e;case"keydown":case"keyup":L=nv;break;case"focusin":k="focus",L=mi;break;case"focusout":k="blur",L=mi;break;case"beforeblur":case"afterblur":L=mi;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":L=fp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":L=Hx;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":L=iv;break;case Gf:case Qf:case Jf:L=Gx;break;case Xf:L=cv;break;case"scroll":L=Ux;break;case"wheel":L=uv;break;case"copy":case"cut":case"paste":L=Jx;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":L=yp}var E=(s&4)!==0,y=!E&&t==="scroll",p=E?b!==null?b+"Capture":null:b;E=[];for(var m=f,v;m!==null;){v=m;var z=v.stateNode;if(v.tag===5&&z!==null&&(v=z,p!==null&&(z=Xn(m,p),z!=null&&E.push(aa(m,z,v)))),y)break;m=m.return}0<E.length&&(b=new L(b,k,null,r,N),C.push({event:b,listeners:E}))}}if(!(s&7)){e:{if(b=t==="mouseover"||t==="pointerover",L=t==="mouseout"||t==="pointerout",b&&r!==eo&&(k=r.relatedTarget||r.fromElement)&&(gr(k)||k[Is]))break e;if((L||b)&&(b=N.window===N?N:(b=N.ownerDocument)?b.defaultView||b.parentWindow:window,L?(k=r.relatedTarget||r.toElement,L=f,k=k?gr(k):null,k!==null&&(y=Dr(k),k!==y||k.tag!==5&&k.tag!==6)&&(k=null)):(L=null,k=f),L!==k)){if(E=fp,z="onMouseLeave",p="onMouseEnter",m="mouse",(t==="pointerout"||t==="pointerover")&&(E=yp,z="onPointerLeave",p="onPointerEnter",m="pointer"),y=L==null?b:Yr(L),v=k==null?b:Yr(k),b=new E(z,m+"leave",L,r,N),b.target=y,b.relatedTarget=v,z=null,gr(N)===f&&(E=new E(p,m+"enter",k,r,N),E.target=v,E.relatedTarget=y,z=E),y=z,L&&k)t:{for(E=L,p=k,m=0,v=E;v;v=Mr(v))m++;for(v=0,z=p;z;z=Mr(z))v++;for(;0<m-v;)E=Mr(E),m--;for(;0<v-m;)p=Mr(p),v--;for(;m--;){if(E===p||p!==null&&E===p.alternate)break t;E=Mr(E),p=Mr(p)}E=null}else E=null;L!==null&&Dp(C,b,L,E,!1),k!==null&&y!==null&&Dp(C,y,k,E,!0)}}e:{if(b=f?Yr(f):window,L=b.nodeName&&b.nodeName.toLowerCase(),L==="select"||L==="input"&&b.type==="file")var W=xv;else if(jp(b))if(Uf)W=Nv;else{W=jv;var F=vv}else(L=b.nodeName)&&L.toLowerCase()==="input"&&(b.type==="checkbox"||b.type==="radio")&&(W=bv);if(W&&(W=W(t,f))){Kf(C,W,r,N);break e}F&&F(t,b,f),t==="focusout"&&(F=b._wrapperState)&&F.controlled&&b.type==="number"&&Gi(b,"number",b.value)}switch(F=f?Yr(f):window,t){case"focusin":(jp(F)||F.contentEditable==="true")&&(qr=F,io=f,qn=null);break;case"focusout":qn=io=qr=null;break;case"mousedown":oo=!0;break;case"contextmenu":case"mouseup":case"dragend":oo=!1,Cp(C,r,N);break;case"selectionchange":if(Cv)break;case"keydown":case"keyup":Cp(C,r,N)}var q;if(ic)e:{switch(t){case"compositionstart":var X="onCompositionStart";break e;case"compositionend":X="onCompositionEnd";break e;case"compositionupdate":X="onCompositionUpdate";break e}X=void 0}else Ur?$f(t,r)&&(X="onCompositionEnd"):t==="keydown"&&r.keyCode===229&&(X="onCompositionStart");X&&(Ff&&r.locale!=="ko"&&(Ur||X!=="onCompositionStart"?X==="onCompositionEnd"&&Ur&&(q=_f()):(Us=N,nc="value"in Us?Us.value:Us.textContent,Ur=!0)),F=hl(f,X),0<F.length&&(X=new gp(X,t,null,r,N),C.push({event:X,listeners:F}),q?X.data=q:(q=Wf(r),q!==null&&(X.data=q)))),(q=pv?hv(t,r):fv(t,r))&&(f=hl(f,"onBeforeInput"),0<f.length&&(N=new gp("onBeforeInput","beforeinput",null,r,N),C.push({event:N,listeners:f}),N.data=q))}eg(C,s)})}function aa(t,s,r){return{instance:t,listener:s,currentTarget:r}}function hl(t,s){for(var r=s+"Capture",n=[];t!==null;){var a=t,l=a.stateNode;a.tag===5&&l!==null&&(a=l,l=Xn(t,r),l!=null&&n.unshift(aa(t,l,a)),l=Xn(t,s),l!=null&&n.push(aa(t,l,a))),t=t.return}return n}function Mr(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Dp(t,s,r,n,a){for(var l=s._reactName,i=[];r!==null&&r!==n;){var d=r,u=d.alternate,f=d.stateNode;if(u!==null&&u===n)break;d.tag===5&&f!==null&&(d=f,a?(u=Xn(r,l),u!=null&&i.unshift(aa(r,u,d))):a||(u=Xn(r,l),u!=null&&i.push(aa(r,u,d)))),r=r.return}i.length!==0&&t.push({event:s,listeners:i})}var zv=/\r\n?/g,Iv=/\u0000|\uFFFD/g;function zp(t){return(typeof t=="string"?t:""+t).replace(zv,`
`).replace(Iv,"")}function Aa(t,s,r){if(s=zp(s),zp(t)!==s&&r)throw Error(ye(425))}function fl(){}var co=null,uo=null;function mo(t,s){return t==="textarea"||t==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var po=typeof setTimeout=="function"?setTimeout:void 0,Ev=typeof clearTimeout=="function"?clearTimeout:void 0,Ip=typeof Promise=="function"?Promise:void 0,Av=typeof queueMicrotask=="function"?queueMicrotask:typeof Ip<"u"?function(t){return Ip.resolve(null).then(t).catch(Rv)}:po;function Rv(t){setTimeout(function(){throw t})}function ji(t,s){var r=s,n=0;do{var a=r.nextSibling;if(t.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){t.removeChild(a),ta(s);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);ta(s)}function Qs(t){for(;t!=null;t=t.nextSibling){var s=t.nodeType;if(s===1||s===3)break;if(s===8){if(s=t.data,s==="$"||s==="$!"||s==="$?")break;if(s==="/$")return null}}return t}function Ep(t){t=t.previousSibling;for(var s=0;t;){if(t.nodeType===8){var r=t.data;if(r==="$"||r==="$!"||r==="$?"){if(s===0)return t;s--}else r==="/$"&&s++}t=t.previousSibling}return null}var gn=Math.random().toString(36).slice(2),xs="__reactFiber$"+gn,la="__reactProps$"+gn,Is="__reactContainer$"+gn,ho="__reactEvents$"+gn,Bv="__reactListeners$"+gn,Lv="__reactHandles$"+gn;function gr(t){var s=t[xs];if(s)return s;for(var r=t.parentNode;r;){if(s=r[Is]||r[xs]){if(r=s.alternate,s.child!==null||r!==null&&r.child!==null)for(t=Ep(t);t!==null;){if(r=t[xs])return r;t=Ep(t)}return s}t=r,r=t.parentNode}return null}function xa(t){return t=t[xs]||t[Is],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Yr(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ye(33))}function Ol(t){return t[la]||null}var fo=[],Vr=-1;function ar(t){return{current:t}}function Ze(t){0>Vr||(t.current=fo[Vr],fo[Vr]=null,Vr--)}function Je(t,s){Vr++,fo[Vr]=t.current,t.current=s}var rr={},It=ar(rr),Ot=ar(!1),Nr=rr;function on(t,s){var r=t.type.contextTypes;if(!r)return rr;var n=t.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===s)return n.__reactInternalMemoizedMaskedChildContext;var a={},l;for(l in r)a[l]=s[l];return n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=a),a}function _t(t){return t=t.childContextTypes,t!=null}function gl(){Ze(Ot),Ze(It)}function Ap(t,s,r){if(It.current!==rr)throw Error(ye(168));Je(It,s),Je(Ot,r)}function sg(t,s,r){var n=t.stateNode;if(s=s.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in s))throw Error(ye(108,vx(t)||"Unknown",a));return ot({},r,n)}function yl(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||rr,Nr=It.current,Je(It,t),Je(Ot,Ot.current),!0}function Rp(t,s,r){var n=t.stateNode;if(!n)throw Error(ye(169));r?(t=sg(t,s,Nr),n.__reactInternalMemoizedMergedChildContext=t,Ze(Ot),Ze(It),Je(It,t)):Ze(Ot),Je(Ot,r)}var ks=null,_l=!1,bi=!1;function rg(t){ks===null?ks=[t]:ks.push(t)}function Pv(t){_l=!0,rg(t)}function lr(){if(!bi&&ks!==null){bi=!0;var t=0,s=Ye;try{var r=ks;for(Ye=1;t<r.length;t++){var n=r[t];do n=n(!0);while(n!==null)}ks=null,_l=!1}catch(a){throw ks!==null&&(ks=ks.slice(t+1)),Df(ec,lr),a}finally{Ye=s,bi=!1}}return null}var Gr=[],Qr=0,xl=null,vl=0,Jt=[],Xt=0,Sr=null,ws=1,Ts="";function pr(t,s){Gr[Qr++]=vl,Gr[Qr++]=xl,xl=t,vl=s}function ng(t,s,r){Jt[Xt++]=ws,Jt[Xt++]=Ts,Jt[Xt++]=Sr,Sr=t;var n=ws;t=Ts;var a=32-cs(n)-1;n&=~(1<<a),r+=1;var l=32-cs(s)+a;if(30<l){var i=a-a%5;l=(n&(1<<i)-1).toString(32),n>>=i,a-=i,ws=1<<32-cs(s)+a|r<<a|n,Ts=l+t}else ws=1<<l|r<<a|n,Ts=t}function cc(t){t.return!==null&&(pr(t,1),ng(t,1,0))}function dc(t){for(;t===xl;)xl=Gr[--Qr],Gr[Qr]=null,vl=Gr[--Qr],Gr[Qr]=null;for(;t===Sr;)Sr=Jt[--Xt],Jt[Xt]=null,Ts=Jt[--Xt],Jt[Xt]=null,ws=Jt[--Xt],Jt[Xt]=null}var Ht=null,qt=null,nt=!1,os=null;function ag(t,s){var r=Zt(5,null,null,0);r.elementType="DELETED",r.stateNode=s,r.return=t,s=t.deletions,s===null?(t.deletions=[r],t.flags|=16):s.push(r)}function Bp(t,s){switch(t.tag){case 5:var r=t.type;return s=s.nodeType!==1||r.toLowerCase()!==s.nodeName.toLowerCase()?null:s,s!==null?(t.stateNode=s,Ht=t,qt=Qs(s.firstChild),!0):!1;case 6:return s=t.pendingProps===""||s.nodeType!==3?null:s,s!==null?(t.stateNode=s,Ht=t,qt=null,!0):!1;case 13:return s=s.nodeType!==8?null:s,s!==null?(r=Sr!==null?{id:ws,overflow:Ts}:null,t.memoizedState={dehydrated:s,treeContext:r,retryLane:1073741824},r=Zt(18,null,null,0),r.stateNode=s,r.return=t,t.child=r,Ht=t,qt=null,!0):!1;default:return!1}}function go(t){return(t.mode&1)!==0&&(t.flags&128)===0}function yo(t){if(nt){var s=qt;if(s){var r=s;if(!Bp(t,s)){if(go(t))throw Error(ye(418));s=Qs(r.nextSibling);var n=Ht;s&&Bp(t,s)?ag(n,r):(t.flags=t.flags&-4097|2,nt=!1,Ht=t)}}else{if(go(t))throw Error(ye(418));t.flags=t.flags&-4097|2,nt=!1,Ht=t}}}function Lp(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Ht=t}function Ra(t){if(t!==Ht)return!1;if(!nt)return Lp(t),nt=!0,!1;var s;if((s=t.tag!==3)&&!(s=t.tag!==5)&&(s=t.type,s=s!=="head"&&s!=="body"&&!mo(t.type,t.memoizedProps)),s&&(s=qt)){if(go(t))throw lg(),Error(ye(418));for(;s;)ag(t,s),s=Qs(s.nextSibling)}if(Lp(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ye(317));e:{for(t=t.nextSibling,s=0;t;){if(t.nodeType===8){var r=t.data;if(r==="/$"){if(s===0){qt=Qs(t.nextSibling);break e}s--}else r!=="$"&&r!=="$!"&&r!=="$?"||s++}t=t.nextSibling}qt=null}}else qt=Ht?Qs(t.stateNode.nextSibling):null;return!0}function lg(){for(var t=qt;t;)t=Qs(t.nextSibling)}function cn(){qt=Ht=null,nt=!1}function uc(t){os===null?os=[t]:os.push(t)}var Mv=Rs.ReactCurrentBatchConfig;function Dn(t,s,r){if(t=r.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(ye(309));var n=r.stateNode}if(!n)throw Error(ye(147,t));var a=n,l=""+t;return s!==null&&s.ref!==null&&typeof s.ref=="function"&&s.ref._stringRef===l?s.ref:(s=function(i){var d=a.refs;i===null?delete d[l]:d[l]=i},s._stringRef=l,s)}if(typeof t!="string")throw Error(ye(284));if(!r._owner)throw Error(ye(290,t))}return t}function Ba(t,s){throw t=Object.prototype.toString.call(s),Error(ye(31,t==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":t))}function Pp(t){var s=t._init;return s(t._payload)}function ig(t){function s(p,m){if(t){var v=p.deletions;v===null?(p.deletions=[m],p.flags|=16):v.push(m)}}function r(p,m){if(!t)return null;for(;m!==null;)s(p,m),m=m.sibling;return null}function n(p,m){for(p=new Map;m!==null;)m.key!==null?p.set(m.key,m):p.set(m.index,m),m=m.sibling;return p}function a(p,m){return p=er(p,m),p.index=0,p.sibling=null,p}function l(p,m,v){return p.index=v,t?(v=p.alternate,v!==null?(v=v.index,v<m?(p.flags|=2,m):v):(p.flags|=2,m)):(p.flags|=1048576,m)}function i(p){return t&&p.alternate===null&&(p.flags|=2),p}function d(p,m,v,z){return m===null||m.tag!==6?(m=Di(v,p.mode,z),m.return=p,m):(m=a(m,v),m.return=p,m)}function u(p,m,v,z){var W=v.type;return W===Kr?N(p,m,v.props.children,z,v.key):m!==null&&(m.elementType===W||typeof W=="object"&&W!==null&&W.$$typeof===_s&&Pp(W)===m.type)?(z=a(m,v.props),z.ref=Dn(p,m,v),z.return=p,z):(z=ll(v.type,v.key,v.props,null,p.mode,z),z.ref=Dn(p,m,v),z.return=p,z)}function f(p,m,v,z){return m===null||m.tag!==4||m.stateNode.containerInfo!==v.containerInfo||m.stateNode.implementation!==v.implementation?(m=zi(v,p.mode,z),m.return=p,m):(m=a(m,v.children||[]),m.return=p,m)}function N(p,m,v,z,W){return m===null||m.tag!==7?(m=jr(v,p.mode,z,W),m.return=p,m):(m=a(m,v),m.return=p,m)}function C(p,m,v){if(typeof m=="string"&&m!==""||typeof m=="number")return m=Di(""+m,p.mode,v),m.return=p,m;if(typeof m=="object"&&m!==null){switch(m.$$typeof){case Sa:return v=ll(m.type,m.key,m.props,null,p.mode,v),v.ref=Dn(p,null,m),v.return=p,v;case Wr:return m=zi(m,p.mode,v),m.return=p,m;case _s:var z=m._init;return C(p,z(m._payload),v)}if(Pn(m)||Sn(m))return m=jr(m,p.mode,v,null),m.return=p,m;Ba(p,m)}return null}function b(p,m,v,z){var W=m!==null?m.key:null;if(typeof v=="string"&&v!==""||typeof v=="number")return W!==null?null:d(p,m,""+v,z);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case Sa:return v.key===W?u(p,m,v,z):null;case Wr:return v.key===W?f(p,m,v,z):null;case _s:return W=v._init,b(p,m,W(v._payload),z)}if(Pn(v)||Sn(v))return W!==null?null:N(p,m,v,z,null);Ba(p,v)}return null}function L(p,m,v,z,W){if(typeof z=="string"&&z!==""||typeof z=="number")return p=p.get(v)||null,d(m,p,""+z,W);if(typeof z=="object"&&z!==null){switch(z.$$typeof){case Sa:return p=p.get(z.key===null?v:z.key)||null,u(m,p,z,W);case Wr:return p=p.get(z.key===null?v:z.key)||null,f(m,p,z,W);case _s:var F=z._init;return L(p,m,v,F(z._payload),W)}if(Pn(z)||Sn(z))return p=p.get(v)||null,N(m,p,z,W,null);Ba(m,z)}return null}function k(p,m,v,z){for(var W=null,F=null,q=m,X=m=0,Q=null;q!==null&&X<v.length;X++){q.index>X?(Q=q,q=null):Q=q.sibling;var A=b(p,q,v[X],z);if(A===null){q===null&&(q=Q);break}t&&q&&A.alternate===null&&s(p,q),m=l(A,m,X),F===null?W=A:F.sibling=A,F=A,q=Q}if(X===v.length)return r(p,q),nt&&pr(p,X),W;if(q===null){for(;X<v.length;X++)q=C(p,v[X],z),q!==null&&(m=l(q,m,X),F===null?W=q:F.sibling=q,F=q);return nt&&pr(p,X),W}for(q=n(p,q);X<v.length;X++)Q=L(q,p,X,v[X],z),Q!==null&&(t&&Q.alternate!==null&&q.delete(Q.key===null?X:Q.key),m=l(Q,m,X),F===null?W=Q:F.sibling=Q,F=Q);return t&&q.forEach(function(ue){return s(p,ue)}),nt&&pr(p,X),W}function E(p,m,v,z){var W=Sn(v);if(typeof W!="function")throw Error(ye(150));if(v=W.call(v),v==null)throw Error(ye(151));for(var F=W=null,q=m,X=m=0,Q=null,A=v.next();q!==null&&!A.done;X++,A=v.next()){q.index>X?(Q=q,q=null):Q=q.sibling;var ue=b(p,q,A.value,z);if(ue===null){q===null&&(q=Q);break}t&&q&&ue.alternate===null&&s(p,q),m=l(ue,m,X),F===null?W=ue:F.sibling=ue,F=ue,q=Q}if(A.done)return r(p,q),nt&&pr(p,X),W;if(q===null){for(;!A.done;X++,A=v.next())A=C(p,A.value,z),A!==null&&(m=l(A,m,X),F===null?W=A:F.sibling=A,F=A);return nt&&pr(p,X),W}for(q=n(p,q);!A.done;X++,A=v.next())A=L(q,p,X,A.value,z),A!==null&&(t&&A.alternate!==null&&q.delete(A.key===null?X:A.key),m=l(A,m,X),F===null?W=A:F.sibling=A,F=A);return t&&q.forEach(function(Z){return s(p,Z)}),nt&&pr(p,X),W}function y(p,m,v,z){if(typeof v=="object"&&v!==null&&v.type===Kr&&v.key===null&&(v=v.props.children),typeof v=="object"&&v!==null){switch(v.$$typeof){case Sa:e:{for(var W=v.key,F=m;F!==null;){if(F.key===W){if(W=v.type,W===Kr){if(F.tag===7){r(p,F.sibling),m=a(F,v.props.children),m.return=p,p=m;break e}}else if(F.elementType===W||typeof W=="object"&&W!==null&&W.$$typeof===_s&&Pp(W)===F.type){r(p,F.sibling),m=a(F,v.props),m.ref=Dn(p,F,v),m.return=p,p=m;break e}r(p,F);break}else s(p,F);F=F.sibling}v.type===Kr?(m=jr(v.props.children,p.mode,z,v.key),m.return=p,p=m):(z=ll(v.type,v.key,v.props,null,p.mode,z),z.ref=Dn(p,m,v),z.return=p,p=z)}return i(p);case Wr:e:{for(F=v.key;m!==null;){if(m.key===F)if(m.tag===4&&m.stateNode.containerInfo===v.containerInfo&&m.stateNode.implementation===v.implementation){r(p,m.sibling),m=a(m,v.children||[]),m.return=p,p=m;break e}else{r(p,m);break}else s(p,m);m=m.sibling}m=zi(v,p.mode,z),m.return=p,p=m}return i(p);case _s:return F=v._init,y(p,m,F(v._payload),z)}if(Pn(v))return k(p,m,v,z);if(Sn(v))return E(p,m,v,z);Ba(p,v)}return typeof v=="string"&&v!==""||typeof v=="number"?(v=""+v,m!==null&&m.tag===6?(r(p,m.sibling),m=a(m,v),m.return=p,p=m):(r(p,m),m=Di(v,p.mode,z),m.return=p,p=m),i(p)):r(p,m)}return y}var dn=ig(!0),og=ig(!1),jl=ar(null),bl=null,Jr=null,mc=null;function pc(){mc=Jr=bl=null}function hc(t){var s=jl.current;Ze(jl),t._currentValue=s}function xo(t,s,r){for(;t!==null;){var n=t.alternate;if((t.childLanes&s)!==s?(t.childLanes|=s,n!==null&&(n.childLanes|=s)):n!==null&&(n.childLanes&s)!==s&&(n.childLanes|=s),t===r)break;t=t.return}}function nn(t,s){bl=t,mc=Jr=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&s&&(Mt=!0),t.firstContext=null)}function ss(t){var s=t._currentValue;if(mc!==t)if(t={context:t,memoizedValue:s,next:null},Jr===null){if(bl===null)throw Error(ye(308));Jr=t,bl.dependencies={lanes:0,firstContext:t}}else Jr=Jr.next=t;return s}var yr=null;function fc(t){yr===null?yr=[t]:yr.push(t)}function cg(t,s,r,n){var a=s.interleaved;return a===null?(r.next=r,fc(s)):(r.next=a.next,a.next=r),s.interleaved=r,Es(t,n)}function Es(t,s){t.lanes|=s;var r=t.alternate;for(r!==null&&(r.lanes|=s),r=t,t=t.return;t!==null;)t.childLanes|=s,r=t.alternate,r!==null&&(r.childLanes|=s),r=t,t=t.return;return r.tag===3?r.stateNode:null}var Fs=!1;function gc(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function dg(t,s){t=t.updateQueue,s.updateQueue===t&&(s.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Ds(t,s){return{eventTime:t,lane:s,tag:0,payload:null,callback:null,next:null}}function Js(t,s,r){var n=t.updateQueue;if(n===null)return null;if(n=n.shared,Ue&2){var a=n.pending;return a===null?s.next=s:(s.next=a.next,a.next=s),n.pending=s,Es(t,r)}return a=n.interleaved,a===null?(s.next=s,fc(n)):(s.next=a.next,a.next=s),n.interleaved=s,Es(t,r)}function el(t,s,r){if(s=s.updateQueue,s!==null&&(s=s.shared,(r&4194240)!==0)){var n=s.lanes;n&=t.pendingLanes,r|=n,s.lanes=r,tc(t,r)}}function Mp(t,s){var r=t.updateQueue,n=t.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,l=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};l===null?a=l=i:l=l.next=i,r=r.next}while(r!==null);l===null?a=l=s:l=l.next=s}else a=l=s;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:l,shared:n.shared,effects:n.effects},t.updateQueue=r;return}t=r.lastBaseUpdate,t===null?r.firstBaseUpdate=s:t.next=s,r.lastBaseUpdate=s}function Nl(t,s,r,n){var a=t.updateQueue;Fs=!1;var l=a.firstBaseUpdate,i=a.lastBaseUpdate,d=a.shared.pending;if(d!==null){a.shared.pending=null;var u=d,f=u.next;u.next=null,i===null?l=f:i.next=f,i=u;var N=t.alternate;N!==null&&(N=N.updateQueue,d=N.lastBaseUpdate,d!==i&&(d===null?N.firstBaseUpdate=f:d.next=f,N.lastBaseUpdate=u))}if(l!==null){var C=a.baseState;i=0,N=f=u=null,d=l;do{var b=d.lane,L=d.eventTime;if((n&b)===b){N!==null&&(N=N.next={eventTime:L,lane:0,tag:d.tag,payload:d.payload,callback:d.callback,next:null});e:{var k=t,E=d;switch(b=s,L=r,E.tag){case 1:if(k=E.payload,typeof k=="function"){C=k.call(L,C,b);break e}C=k;break e;case 3:k.flags=k.flags&-65537|128;case 0:if(k=E.payload,b=typeof k=="function"?k.call(L,C,b):k,b==null)break e;C=ot({},C,b);break e;case 2:Fs=!0}}d.callback!==null&&d.lane!==0&&(t.flags|=64,b=a.effects,b===null?a.effects=[d]:b.push(d))}else L={eventTime:L,lane:b,tag:d.tag,payload:d.payload,callback:d.callback,next:null},N===null?(f=N=L,u=C):N=N.next=L,i|=b;if(d=d.next,d===null){if(d=a.shared.pending,d===null)break;b=d,d=b.next,b.next=null,a.lastBaseUpdate=b,a.shared.pending=null}}while(!0);if(N===null&&(u=C),a.baseState=u,a.firstBaseUpdate=f,a.lastBaseUpdate=N,s=a.shared.interleaved,s!==null){a=s;do i|=a.lane,a=a.next;while(a!==s)}else l===null&&(a.shared.lanes=0);Cr|=i,t.lanes=i,t.memoizedState=C}}function Op(t,s,r){if(t=s.effects,s.effects=null,t!==null)for(s=0;s<t.length;s++){var n=t[s],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(ye(191,a));a.call(n)}}}var va={},js=ar(va),ia=ar(va),oa=ar(va);function xr(t){if(t===va)throw Error(ye(174));return t}function yc(t,s){switch(Je(oa,s),Je(ia,t),Je(js,va),t=s.nodeType,t){case 9:case 11:s=(s=s.documentElement)?s.namespaceURI:Ji(null,"");break;default:t=t===8?s.parentNode:s,s=t.namespaceURI||null,t=t.tagName,s=Ji(s,t)}Ze(js),Je(js,s)}function un(){Ze(js),Ze(ia),Ze(oa)}function ug(t){xr(oa.current);var s=xr(js.current),r=Ji(s,t.type);s!==r&&(Je(ia,t),Je(js,r))}function xc(t){ia.current===t&&(Ze(js),Ze(ia))}var lt=ar(0);function Sl(t){for(var s=t;s!==null;){if(s.tag===13){var r=s.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if(s.flags&128)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===t)break;for(;s.sibling===null;){if(s.return===null||s.return===t)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}var Ni=[];function vc(){for(var t=0;t<Ni.length;t++)Ni[t]._workInProgressVersionPrimary=null;Ni.length=0}var tl=Rs.ReactCurrentDispatcher,Si=Rs.ReactCurrentBatchConfig,kr=0,it=null,gt=null,vt=null,kl=!1,Hn=!1,ca=0,Ov=0;function wt(){throw Error(ye(321))}function jc(t,s){if(s===null)return!1;for(var r=0;r<s.length&&r<t.length;r++)if(!us(t[r],s[r]))return!1;return!0}function bc(t,s,r,n,a,l){if(kr=l,it=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,tl.current=t===null||t.memoizedState===null?Wv:Kv,t=r(n,a),Hn){l=0;do{if(Hn=!1,ca=0,25<=l)throw Error(ye(301));l+=1,vt=gt=null,s.updateQueue=null,tl.current=Uv,t=r(n,a)}while(Hn)}if(tl.current=Cl,s=gt!==null&&gt.next!==null,kr=0,vt=gt=it=null,kl=!1,s)throw Error(ye(300));return t}function Nc(){var t=ca!==0;return ca=0,t}function fs(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return vt===null?it.memoizedState=vt=t:vt=vt.next=t,vt}function rs(){if(gt===null){var t=it.alternate;t=t!==null?t.memoizedState:null}else t=gt.next;var s=vt===null?it.memoizedState:vt.next;if(s!==null)vt=s,gt=t;else{if(t===null)throw Error(ye(310));gt=t,t={memoizedState:gt.memoizedState,baseState:gt.baseState,baseQueue:gt.baseQueue,queue:gt.queue,next:null},vt===null?it.memoizedState=vt=t:vt=vt.next=t}return vt}function da(t,s){return typeof s=="function"?s(t):s}function ki(t){var s=rs(),r=s.queue;if(r===null)throw Error(ye(311));r.lastRenderedReducer=t;var n=gt,a=n.baseQueue,l=r.pending;if(l!==null){if(a!==null){var i=a.next;a.next=l.next,l.next=i}n.baseQueue=a=l,r.pending=null}if(a!==null){l=a.next,n=n.baseState;var d=i=null,u=null,f=l;do{var N=f.lane;if((kr&N)===N)u!==null&&(u=u.next={lane:0,action:f.action,hasEagerState:f.hasEagerState,eagerState:f.eagerState,next:null}),n=f.hasEagerState?f.eagerState:t(n,f.action);else{var C={lane:N,action:f.action,hasEagerState:f.hasEagerState,eagerState:f.eagerState,next:null};u===null?(d=u=C,i=n):u=u.next=C,it.lanes|=N,Cr|=N}f=f.next}while(f!==null&&f!==l);u===null?i=n:u.next=d,us(n,s.memoizedState)||(Mt=!0),s.memoizedState=n,s.baseState=i,s.baseQueue=u,r.lastRenderedState=n}if(t=r.interleaved,t!==null){a=t;do l=a.lane,it.lanes|=l,Cr|=l,a=a.next;while(a!==t)}else a===null&&(r.lanes=0);return[s.memoizedState,r.dispatch]}function Ci(t){var s=rs(),r=s.queue;if(r===null)throw Error(ye(311));r.lastRenderedReducer=t;var n=r.dispatch,a=r.pending,l=s.memoizedState;if(a!==null){r.pending=null;var i=a=a.next;do l=t(l,i.action),i=i.next;while(i!==a);us(l,s.memoizedState)||(Mt=!0),s.memoizedState=l,s.baseQueue===null&&(s.baseState=l),r.lastRenderedState=l}return[l,n]}function mg(){}function pg(t,s){var r=it,n=rs(),a=s(),l=!us(n.memoizedState,a);if(l&&(n.memoizedState=a,Mt=!0),n=n.queue,Sc(gg.bind(null,r,n,t),[t]),n.getSnapshot!==s||l||vt!==null&&vt.memoizedState.tag&1){if(r.flags|=2048,ua(9,fg.bind(null,r,n,a,s),void 0,null),jt===null)throw Error(ye(349));kr&30||hg(r,s,a)}return a}function hg(t,s,r){t.flags|=16384,t={getSnapshot:s,value:r},s=it.updateQueue,s===null?(s={lastEffect:null,stores:null},it.updateQueue=s,s.stores=[t]):(r=s.stores,r===null?s.stores=[t]:r.push(t))}function fg(t,s,r,n){s.value=r,s.getSnapshot=n,yg(s)&&xg(t)}function gg(t,s,r){return r(function(){yg(s)&&xg(t)})}function yg(t){var s=t.getSnapshot;t=t.value;try{var r=s();return!us(t,r)}catch{return!0}}function xg(t){var s=Es(t,1);s!==null&&ds(s,t,1,-1)}function _p(t){var s=fs();return typeof t=="function"&&(t=t()),s.memoizedState=s.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:da,lastRenderedState:t},s.queue=t,t=t.dispatch=$v.bind(null,it,t),[s.memoizedState,t]}function ua(t,s,r,n){return t={tag:t,create:s,destroy:r,deps:n,next:null},s=it.updateQueue,s===null?(s={lastEffect:null,stores:null},it.updateQueue=s,s.lastEffect=t.next=t):(r=s.lastEffect,r===null?s.lastEffect=t.next=t:(n=r.next,r.next=t,t.next=n,s.lastEffect=t)),t}function vg(){return rs().memoizedState}function sl(t,s,r,n){var a=fs();it.flags|=t,a.memoizedState=ua(1|s,r,void 0,n===void 0?null:n)}function Fl(t,s,r,n){var a=rs();n=n===void 0?null:n;var l=void 0;if(gt!==null){var i=gt.memoizedState;if(l=i.destroy,n!==null&&jc(n,i.deps)){a.memoizedState=ua(s,r,l,n);return}}it.flags|=t,a.memoizedState=ua(1|s,r,l,n)}function Fp(t,s){return sl(8390656,8,t,s)}function Sc(t,s){return Fl(2048,8,t,s)}function jg(t,s){return Fl(4,2,t,s)}function bg(t,s){return Fl(4,4,t,s)}function Ng(t,s){if(typeof s=="function")return t=t(),s(t),function(){s(null)};if(s!=null)return t=t(),s.current=t,function(){s.current=null}}function Sg(t,s,r){return r=r!=null?r.concat([t]):null,Fl(4,4,Ng.bind(null,s,t),r)}function kc(){}function kg(t,s){var r=rs();s=s===void 0?null:s;var n=r.memoizedState;return n!==null&&s!==null&&jc(s,n[1])?n[0]:(r.memoizedState=[t,s],t)}function Cg(t,s){var r=rs();s=s===void 0?null:s;var n=r.memoizedState;return n!==null&&s!==null&&jc(s,n[1])?n[0]:(t=t(),r.memoizedState=[t,s],t)}function wg(t,s,r){return kr&21?(us(r,s)||(r=Ef(),it.lanes|=r,Cr|=r,t.baseState=!0),s):(t.baseState&&(t.baseState=!1,Mt=!0),t.memoizedState=r)}function _v(t,s){var r=Ye;Ye=r!==0&&4>r?r:4,t(!0);var n=Si.transition;Si.transition={};try{t(!1),s()}finally{Ye=r,Si.transition=n}}function Tg(){return rs().memoizedState}function Fv(t,s,r){var n=Zs(t);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},Dg(t))zg(s,r);else if(r=cg(t,s,r,n),r!==null){var a=Rt();ds(r,t,n,a),Ig(r,s,n)}}function $v(t,s,r){var n=Zs(t),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(Dg(t))zg(s,a);else{var l=t.alternate;if(t.lanes===0&&(l===null||l.lanes===0)&&(l=s.lastRenderedReducer,l!==null))try{var i=s.lastRenderedState,d=l(i,r);if(a.hasEagerState=!0,a.eagerState=d,us(d,i)){var u=s.interleaved;u===null?(a.next=a,fc(s)):(a.next=u.next,u.next=a),s.interleaved=a;return}}catch{}finally{}r=cg(t,s,a,n),r!==null&&(a=Rt(),ds(r,t,n,a),Ig(r,s,n))}}function Dg(t){var s=t.alternate;return t===it||s!==null&&s===it}function zg(t,s){Hn=kl=!0;var r=t.pending;r===null?s.next=s:(s.next=r.next,r.next=s),t.pending=s}function Ig(t,s,r){if(r&4194240){var n=s.lanes;n&=t.pendingLanes,r|=n,s.lanes=r,tc(t,r)}}var Cl={readContext:ss,useCallback:wt,useContext:wt,useEffect:wt,useImperativeHandle:wt,useInsertionEffect:wt,useLayoutEffect:wt,useMemo:wt,useReducer:wt,useRef:wt,useState:wt,useDebugValue:wt,useDeferredValue:wt,useTransition:wt,useMutableSource:wt,useSyncExternalStore:wt,useId:wt,unstable_isNewReconciler:!1},Wv={readContext:ss,useCallback:function(t,s){return fs().memoizedState=[t,s===void 0?null:s],t},useContext:ss,useEffect:Fp,useImperativeHandle:function(t,s,r){return r=r!=null?r.concat([t]):null,sl(4194308,4,Ng.bind(null,s,t),r)},useLayoutEffect:function(t,s){return sl(4194308,4,t,s)},useInsertionEffect:function(t,s){return sl(4,2,t,s)},useMemo:function(t,s){var r=fs();return s=s===void 0?null:s,t=t(),r.memoizedState=[t,s],t},useReducer:function(t,s,r){var n=fs();return s=r!==void 0?r(s):s,n.memoizedState=n.baseState=s,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:s},n.queue=t,t=t.dispatch=Fv.bind(null,it,t),[n.memoizedState,t]},useRef:function(t){var s=fs();return t={current:t},s.memoizedState=t},useState:_p,useDebugValue:kc,useDeferredValue:function(t){return fs().memoizedState=t},useTransition:function(){var t=_p(!1),s=t[0];return t=_v.bind(null,t[1]),fs().memoizedState=t,[s,t]},useMutableSource:function(){},useSyncExternalStore:function(t,s,r){var n=it,a=fs();if(nt){if(r===void 0)throw Error(ye(407));r=r()}else{if(r=s(),jt===null)throw Error(ye(349));kr&30||hg(n,s,r)}a.memoizedState=r;var l={value:r,getSnapshot:s};return a.queue=l,Fp(gg.bind(null,n,l,t),[t]),n.flags|=2048,ua(9,fg.bind(null,n,l,r,s),void 0,null),r},useId:function(){var t=fs(),s=jt.identifierPrefix;if(nt){var r=Ts,n=ws;r=(n&~(1<<32-cs(n)-1)).toString(32)+r,s=":"+s+"R"+r,r=ca++,0<r&&(s+="H"+r.toString(32)),s+=":"}else r=Ov++,s=":"+s+"r"+r.toString(32)+":";return t.memoizedState=s},unstable_isNewReconciler:!1},Kv={readContext:ss,useCallback:kg,useContext:ss,useEffect:Sc,useImperativeHandle:Sg,useInsertionEffect:jg,useLayoutEffect:bg,useMemo:Cg,useReducer:ki,useRef:vg,useState:function(){return ki(da)},useDebugValue:kc,useDeferredValue:function(t){var s=rs();return wg(s,gt.memoizedState,t)},useTransition:function(){var t=ki(da)[0],s=rs().memoizedState;return[t,s]},useMutableSource:mg,useSyncExternalStore:pg,useId:Tg,unstable_isNewReconciler:!1},Uv={readContext:ss,useCallback:kg,useContext:ss,useEffect:Sc,useImperativeHandle:Sg,useInsertionEffect:jg,useLayoutEffect:bg,useMemo:Cg,useReducer:Ci,useRef:vg,useState:function(){return Ci(da)},useDebugValue:kc,useDeferredValue:function(t){var s=rs();return gt===null?s.memoizedState=t:wg(s,gt.memoizedState,t)},useTransition:function(){var t=Ci(da)[0],s=rs().memoizedState;return[t,s]},useMutableSource:mg,useSyncExternalStore:pg,useId:Tg,unstable_isNewReconciler:!1};function ls(t,s){if(t&&t.defaultProps){s=ot({},s),t=t.defaultProps;for(var r in t)s[r]===void 0&&(s[r]=t[r]);return s}return s}function vo(t,s,r,n){s=t.memoizedState,r=r(n,s),r=r==null?s:ot({},s,r),t.memoizedState=r,t.lanes===0&&(t.updateQueue.baseState=r)}var $l={isMounted:function(t){return(t=t._reactInternals)?Dr(t)===t:!1},enqueueSetState:function(t,s,r){t=t._reactInternals;var n=Rt(),a=Zs(t),l=Ds(n,a);l.payload=s,r!=null&&(l.callback=r),s=Js(t,l,a),s!==null&&(ds(s,t,a,n),el(s,t,a))},enqueueReplaceState:function(t,s,r){t=t._reactInternals;var n=Rt(),a=Zs(t),l=Ds(n,a);l.tag=1,l.payload=s,r!=null&&(l.callback=r),s=Js(t,l,a),s!==null&&(ds(s,t,a,n),el(s,t,a))},enqueueForceUpdate:function(t,s){t=t._reactInternals;var r=Rt(),n=Zs(t),a=Ds(r,n);a.tag=2,s!=null&&(a.callback=s),s=Js(t,a,n),s!==null&&(ds(s,t,n,r),el(s,t,n))}};function $p(t,s,r,n,a,l,i){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(n,l,i):s.prototype&&s.prototype.isPureReactComponent?!ra(r,n)||!ra(a,l):!0}function Eg(t,s,r){var n=!1,a=rr,l=s.contextType;return typeof l=="object"&&l!==null?l=ss(l):(a=_t(s)?Nr:It.current,n=s.contextTypes,l=(n=n!=null)?on(t,a):rr),s=new s(r,l),t.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,s.updater=$l,t.stateNode=s,s._reactInternals=t,n&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=a,t.__reactInternalMemoizedMaskedChildContext=l),s}function Wp(t,s,r,n){t=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(r,n),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(r,n),s.state!==t&&$l.enqueueReplaceState(s,s.state,null)}function jo(t,s,r,n){var a=t.stateNode;a.props=r,a.state=t.memoizedState,a.refs={},gc(t);var l=s.contextType;typeof l=="object"&&l!==null?a.context=ss(l):(l=_t(s)?Nr:It.current,a.context=on(t,l)),a.state=t.memoizedState,l=s.getDerivedStateFromProps,typeof l=="function"&&(vo(t,s,l,r),a.state=t.memoizedState),typeof s.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(s=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),s!==a.state&&$l.enqueueReplaceState(a,a.state,null),Nl(t,r,a,n),a.state=t.memoizedState),typeof a.componentDidMount=="function"&&(t.flags|=4194308)}function mn(t,s){try{var r="",n=s;do r+=xx(n),n=n.return;while(n);var a=r}catch(l){a=`
Error generating stack: `+l.message+`
`+l.stack}return{value:t,source:s,stack:a,digest:null}}function wi(t,s,r){return{value:t,source:null,stack:r??null,digest:s??null}}function bo(t,s){try{console.error(s.value)}catch(r){setTimeout(function(){throw r})}}var qv=typeof WeakMap=="function"?WeakMap:Map;function Ag(t,s,r){r=Ds(-1,r),r.tag=3,r.payload={element:null};var n=s.value;return r.callback=function(){Tl||(Tl=!0,Eo=n),bo(t,s)},r}function Rg(t,s,r){r=Ds(-1,r),r.tag=3;var n=t.type.getDerivedStateFromError;if(typeof n=="function"){var a=s.value;r.payload=function(){return n(a)},r.callback=function(){bo(t,s)}}var l=t.stateNode;return l!==null&&typeof l.componentDidCatch=="function"&&(r.callback=function(){bo(t,s),typeof n!="function"&&(Xs===null?Xs=new Set([this]):Xs.add(this));var i=s.stack;this.componentDidCatch(s.value,{componentStack:i!==null?i:""})}),r}function Kp(t,s,r){var n=t.pingCache;if(n===null){n=t.pingCache=new qv;var a=new Set;n.set(s,a)}else a=n.get(s),a===void 0&&(a=new Set,n.set(s,a));a.has(r)||(a.add(r),t=aj.bind(null,t,s,r),s.then(t,t))}function Up(t){do{var s;if((s=t.tag===13)&&(s=t.memoizedState,s=s!==null?s.dehydrated!==null:!0),s)return t;t=t.return}while(t!==null);return null}function qp(t,s,r,n,a){return t.mode&1?(t.flags|=65536,t.lanes=a,t):(t===s?t.flags|=65536:(t.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(s=Ds(-1,1),s.tag=2,Js(r,s,1))),r.lanes|=1),t)}var Hv=Rs.ReactCurrentOwner,Mt=!1;function At(t,s,r,n){s.child=t===null?og(s,null,r,n):dn(s,t.child,r,n)}function Hp(t,s,r,n,a){r=r.render;var l=s.ref;return nn(s,a),n=bc(t,s,r,n,l,a),r=Nc(),t!==null&&!Mt?(s.updateQueue=t.updateQueue,s.flags&=-2053,t.lanes&=~a,As(t,s,a)):(nt&&r&&cc(s),s.flags|=1,At(t,s,n,a),s.child)}function Yp(t,s,r,n,a){if(t===null){var l=r.type;return typeof l=="function"&&!Ac(l)&&l.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(s.tag=15,s.type=l,Bg(t,s,l,n,a)):(t=ll(r.type,null,n,s,s.mode,a),t.ref=s.ref,t.return=s,s.child=t)}if(l=t.child,!(t.lanes&a)){var i=l.memoizedProps;if(r=r.compare,r=r!==null?r:ra,r(i,n)&&t.ref===s.ref)return As(t,s,a)}return s.flags|=1,t=er(l,n),t.ref=s.ref,t.return=s,s.child=t}function Bg(t,s,r,n,a){if(t!==null){var l=t.memoizedProps;if(ra(l,n)&&t.ref===s.ref)if(Mt=!1,s.pendingProps=n=l,(t.lanes&a)!==0)t.flags&131072&&(Mt=!0);else return s.lanes=t.lanes,As(t,s,a)}return No(t,s,r,n,a)}function Lg(t,s,r){var n=s.pendingProps,a=n.children,l=t!==null?t.memoizedState:null;if(n.mode==="hidden")if(!(s.mode&1))s.memoizedState={baseLanes:0,cachePool:null,transitions:null},Je(Zr,Ut),Ut|=r;else{if(!(r&1073741824))return t=l!==null?l.baseLanes|r:r,s.lanes=s.childLanes=1073741824,s.memoizedState={baseLanes:t,cachePool:null,transitions:null},s.updateQueue=null,Je(Zr,Ut),Ut|=t,null;s.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=l!==null?l.baseLanes:r,Je(Zr,Ut),Ut|=n}else l!==null?(n=l.baseLanes|r,s.memoizedState=null):n=r,Je(Zr,Ut),Ut|=n;return At(t,s,a,r),s.child}function Pg(t,s){var r=s.ref;(t===null&&r!==null||t!==null&&t.ref!==r)&&(s.flags|=512,s.flags|=2097152)}function No(t,s,r,n,a){var l=_t(r)?Nr:It.current;return l=on(s,l),nn(s,a),r=bc(t,s,r,n,l,a),n=Nc(),t!==null&&!Mt?(s.updateQueue=t.updateQueue,s.flags&=-2053,t.lanes&=~a,As(t,s,a)):(nt&&n&&cc(s),s.flags|=1,At(t,s,r,a),s.child)}function Vp(t,s,r,n,a){if(_t(r)){var l=!0;yl(s)}else l=!1;if(nn(s,a),s.stateNode===null)rl(t,s),Eg(s,r,n),jo(s,r,n,a),n=!0;else if(t===null){var i=s.stateNode,d=s.memoizedProps;i.props=d;var u=i.context,f=r.contextType;typeof f=="object"&&f!==null?f=ss(f):(f=_t(r)?Nr:It.current,f=on(s,f));var N=r.getDerivedStateFromProps,C=typeof N=="function"||typeof i.getSnapshotBeforeUpdate=="function";C||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(d!==n||u!==f)&&Wp(s,i,n,f),Fs=!1;var b=s.memoizedState;i.state=b,Nl(s,n,i,a),u=s.memoizedState,d!==n||b!==u||Ot.current||Fs?(typeof N=="function"&&(vo(s,r,N,n),u=s.memoizedState),(d=Fs||$p(s,r,d,n,b,u,f))?(C||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(s.flags|=4194308)):(typeof i.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=n,s.memoizedState=u),i.props=n,i.state=u,i.context=f,n=d):(typeof i.componentDidMount=="function"&&(s.flags|=4194308),n=!1)}else{i=s.stateNode,dg(t,s),d=s.memoizedProps,f=s.type===s.elementType?d:ls(s.type,d),i.props=f,C=s.pendingProps,b=i.context,u=r.contextType,typeof u=="object"&&u!==null?u=ss(u):(u=_t(r)?Nr:It.current,u=on(s,u));var L=r.getDerivedStateFromProps;(N=typeof L=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(d!==C||b!==u)&&Wp(s,i,n,u),Fs=!1,b=s.memoizedState,i.state=b,Nl(s,n,i,a);var k=s.memoizedState;d!==C||b!==k||Ot.current||Fs?(typeof L=="function"&&(vo(s,r,L,n),k=s.memoizedState),(f=Fs||$p(s,r,f,n,b,k,u)||!1)?(N||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(n,k,u),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(n,k,u)),typeof i.componentDidUpdate=="function"&&(s.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof i.componentDidUpdate!="function"||d===t.memoizedProps&&b===t.memoizedState||(s.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||d===t.memoizedProps&&b===t.memoizedState||(s.flags|=1024),s.memoizedProps=n,s.memoizedState=k),i.props=n,i.state=k,i.context=u,n=f):(typeof i.componentDidUpdate!="function"||d===t.memoizedProps&&b===t.memoizedState||(s.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||d===t.memoizedProps&&b===t.memoizedState||(s.flags|=1024),n=!1)}return So(t,s,r,n,l,a)}function So(t,s,r,n,a,l){Pg(t,s);var i=(s.flags&128)!==0;if(!n&&!i)return a&&Rp(s,r,!1),As(t,s,l);n=s.stateNode,Hv.current=s;var d=i&&typeof r.getDerivedStateFromError!="function"?null:n.render();return s.flags|=1,t!==null&&i?(s.child=dn(s,t.child,null,l),s.child=dn(s,null,d,l)):At(t,s,d,l),s.memoizedState=n.state,a&&Rp(s,r,!0),s.child}function Mg(t){var s=t.stateNode;s.pendingContext?Ap(t,s.pendingContext,s.pendingContext!==s.context):s.context&&Ap(t,s.context,!1),yc(t,s.containerInfo)}function Gp(t,s,r,n,a){return cn(),uc(a),s.flags|=256,At(t,s,r,n),s.child}var ko={dehydrated:null,treeContext:null,retryLane:0};function Co(t){return{baseLanes:t,cachePool:null,transitions:null}}function Og(t,s,r){var n=s.pendingProps,a=lt.current,l=!1,i=(s.flags&128)!==0,d;if((d=i)||(d=t!==null&&t.memoizedState===null?!1:(a&2)!==0),d?(l=!0,s.flags&=-129):(t===null||t.memoizedState!==null)&&(a|=1),Je(lt,a&1),t===null)return yo(s),t=s.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(s.mode&1?t.data==="$!"?s.lanes=8:s.lanes=1073741824:s.lanes=1,null):(i=n.children,t=n.fallback,l?(n=s.mode,l=s.child,i={mode:"hidden",children:i},!(n&1)&&l!==null?(l.childLanes=0,l.pendingProps=i):l=Ul(i,n,0,null),t=jr(t,n,r,null),l.return=s,t.return=s,l.sibling=t,s.child=l,s.child.memoizedState=Co(r),s.memoizedState=ko,t):Cc(s,i));if(a=t.memoizedState,a!==null&&(d=a.dehydrated,d!==null))return Yv(t,s,i,n,d,a,r);if(l){l=n.fallback,i=s.mode,a=t.child,d=a.sibling;var u={mode:"hidden",children:n.children};return!(i&1)&&s.child!==a?(n=s.child,n.childLanes=0,n.pendingProps=u,s.deletions=null):(n=er(a,u),n.subtreeFlags=a.subtreeFlags&14680064),d!==null?l=er(d,l):(l=jr(l,i,r,null),l.flags|=2),l.return=s,n.return=s,n.sibling=l,s.child=n,n=l,l=s.child,i=t.child.memoizedState,i=i===null?Co(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},l.memoizedState=i,l.childLanes=t.childLanes&~r,s.memoizedState=ko,n}return l=t.child,t=l.sibling,n=er(l,{mode:"visible",children:n.children}),!(s.mode&1)&&(n.lanes=r),n.return=s,n.sibling=null,t!==null&&(r=s.deletions,r===null?(s.deletions=[t],s.flags|=16):r.push(t)),s.child=n,s.memoizedState=null,n}function Cc(t,s){return s=Ul({mode:"visible",children:s},t.mode,0,null),s.return=t,t.child=s}function La(t,s,r,n){return n!==null&&uc(n),dn(s,t.child,null,r),t=Cc(s,s.pendingProps.children),t.flags|=2,s.memoizedState=null,t}function Yv(t,s,r,n,a,l,i){if(r)return s.flags&256?(s.flags&=-257,n=wi(Error(ye(422))),La(t,s,i,n)):s.memoizedState!==null?(s.child=t.child,s.flags|=128,null):(l=n.fallback,a=s.mode,n=Ul({mode:"visible",children:n.children},a,0,null),l=jr(l,a,i,null),l.flags|=2,n.return=s,l.return=s,n.sibling=l,s.child=n,s.mode&1&&dn(s,t.child,null,i),s.child.memoizedState=Co(i),s.memoizedState=ko,l);if(!(s.mode&1))return La(t,s,i,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var d=n.dgst;return n=d,l=Error(ye(419)),n=wi(l,n,void 0),La(t,s,i,n)}if(d=(i&t.childLanes)!==0,Mt||d){if(n=jt,n!==null){switch(i&-i){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|i)?0:a,a!==0&&a!==l.retryLane&&(l.retryLane=a,Es(t,a),ds(n,t,a,-1))}return Ec(),n=wi(Error(ye(421))),La(t,s,i,n)}return a.data==="$?"?(s.flags|=128,s.child=t.child,s=lj.bind(null,t),a._reactRetry=s,null):(t=l.treeContext,qt=Qs(a.nextSibling),Ht=s,nt=!0,os=null,t!==null&&(Jt[Xt++]=ws,Jt[Xt++]=Ts,Jt[Xt++]=Sr,ws=t.id,Ts=t.overflow,Sr=s),s=Cc(s,n.children),s.flags|=4096,s)}function Qp(t,s,r){t.lanes|=s;var n=t.alternate;n!==null&&(n.lanes|=s),xo(t.return,s,r)}function Ti(t,s,r,n,a){var l=t.memoizedState;l===null?t.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(l.isBackwards=s,l.rendering=null,l.renderingStartTime=0,l.last=n,l.tail=r,l.tailMode=a)}function _g(t,s,r){var n=s.pendingProps,a=n.revealOrder,l=n.tail;if(At(t,s,n.children,r),n=lt.current,n&2)n=n&1|2,s.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=s.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&Qp(t,r,s);else if(t.tag===19)Qp(t,r,s);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===s)break e;for(;t.sibling===null;){if(t.return===null||t.return===s)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}n&=1}if(Je(lt,n),!(s.mode&1))s.memoizedState=null;else switch(a){case"forwards":for(r=s.child,a=null;r!==null;)t=r.alternate,t!==null&&Sl(t)===null&&(a=r),r=r.sibling;r=a,r===null?(a=s.child,s.child=null):(a=r.sibling,r.sibling=null),Ti(s,!1,a,r,l);break;case"backwards":for(r=null,a=s.child,s.child=null;a!==null;){if(t=a.alternate,t!==null&&Sl(t)===null){s.child=a;break}t=a.sibling,a.sibling=r,r=a,a=t}Ti(s,!0,r,null,l);break;case"together":Ti(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function rl(t,s){!(s.mode&1)&&t!==null&&(t.alternate=null,s.alternate=null,s.flags|=2)}function As(t,s,r){if(t!==null&&(s.dependencies=t.dependencies),Cr|=s.lanes,!(r&s.childLanes))return null;if(t!==null&&s.child!==t.child)throw Error(ye(153));if(s.child!==null){for(t=s.child,r=er(t,t.pendingProps),s.child=r,r.return=s;t.sibling!==null;)t=t.sibling,r=r.sibling=er(t,t.pendingProps),r.return=s;r.sibling=null}return s.child}function Vv(t,s,r){switch(s.tag){case 3:Mg(s),cn();break;case 5:ug(s);break;case 1:_t(s.type)&&yl(s);break;case 4:yc(s,s.stateNode.containerInfo);break;case 10:var n=s.type._context,a=s.memoizedProps.value;Je(jl,n._currentValue),n._currentValue=a;break;case 13:if(n=s.memoizedState,n!==null)return n.dehydrated!==null?(Je(lt,lt.current&1),s.flags|=128,null):r&s.child.childLanes?Og(t,s,r):(Je(lt,lt.current&1),t=As(t,s,r),t!==null?t.sibling:null);Je(lt,lt.current&1);break;case 19:if(n=(r&s.childLanes)!==0,t.flags&128){if(n)return _g(t,s,r);s.flags|=128}if(a=s.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),Je(lt,lt.current),n)break;return null;case 22:case 23:return s.lanes=0,Lg(t,s,r)}return As(t,s,r)}var Fg,wo,$g,Wg;Fg=function(t,s){for(var r=s.child;r!==null;){if(r.tag===5||r.tag===6)t.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===s)break;for(;r.sibling===null;){if(r.return===null||r.return===s)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};wo=function(){};$g=function(t,s,r,n){var a=t.memoizedProps;if(a!==n){t=s.stateNode,xr(js.current);var l=null;switch(r){case"input":a=Yi(t,a),n=Yi(t,n),l=[];break;case"select":a=ot({},a,{value:void 0}),n=ot({},n,{value:void 0}),l=[];break;case"textarea":a=Qi(t,a),n=Qi(t,n),l=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(t.onclick=fl)}Xi(r,n);var i;r=null;for(f in a)if(!n.hasOwnProperty(f)&&a.hasOwnProperty(f)&&a[f]!=null)if(f==="style"){var d=a[f];for(i in d)d.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else f!=="dangerouslySetInnerHTML"&&f!=="children"&&f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&f!=="autoFocus"&&(Qn.hasOwnProperty(f)?l||(l=[]):(l=l||[]).push(f,null));for(f in n){var u=n[f];if(d=a!=null?a[f]:void 0,n.hasOwnProperty(f)&&u!==d&&(u!=null||d!=null))if(f==="style")if(d){for(i in d)!d.hasOwnProperty(i)||u&&u.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in u)u.hasOwnProperty(i)&&d[i]!==u[i]&&(r||(r={}),r[i]=u[i])}else r||(l||(l=[]),l.push(f,r)),r=u;else f==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,d=d?d.__html:void 0,u!=null&&d!==u&&(l=l||[]).push(f,u)):f==="children"?typeof u!="string"&&typeof u!="number"||(l=l||[]).push(f,""+u):f!=="suppressContentEditableWarning"&&f!=="suppressHydrationWarning"&&(Qn.hasOwnProperty(f)?(u!=null&&f==="onScroll"&&Xe("scroll",t),l||d===u||(l=[])):(l=l||[]).push(f,u))}r&&(l=l||[]).push("style",r);var f=l;(s.updateQueue=f)&&(s.flags|=4)}};Wg=function(t,s,r,n){r!==n&&(s.flags|=4)};function zn(t,s){if(!nt)switch(t.tailMode){case"hidden":s=t.tail;for(var r=null;s!==null;)s.alternate!==null&&(r=s),s=s.sibling;r===null?t.tail=null:r.sibling=null;break;case"collapsed":r=t.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?s||t.tail===null?t.tail=null:t.tail.sibling=null:n.sibling=null}}function Tt(t){var s=t.alternate!==null&&t.alternate.child===t.child,r=0,n=0;if(s)for(var a=t.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=t,a=a.sibling;else for(a=t.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=t,a=a.sibling;return t.subtreeFlags|=n,t.childLanes=r,s}function Gv(t,s,r){var n=s.pendingProps;switch(dc(s),s.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Tt(s),null;case 1:return _t(s.type)&&gl(),Tt(s),null;case 3:return n=s.stateNode,un(),Ze(Ot),Ze(It),vc(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(t===null||t.child===null)&&(Ra(s)?s.flags|=4:t===null||t.memoizedState.isDehydrated&&!(s.flags&256)||(s.flags|=1024,os!==null&&(Bo(os),os=null))),wo(t,s),Tt(s),null;case 5:xc(s);var a=xr(oa.current);if(r=s.type,t!==null&&s.stateNode!=null)$g(t,s,r,n,a),t.ref!==s.ref&&(s.flags|=512,s.flags|=2097152);else{if(!n){if(s.stateNode===null)throw Error(ye(166));return Tt(s),null}if(t=xr(js.current),Ra(s)){n=s.stateNode,r=s.type;var l=s.memoizedProps;switch(n[xs]=s,n[la]=l,t=(s.mode&1)!==0,r){case"dialog":Xe("cancel",n),Xe("close",n);break;case"iframe":case"object":case"embed":Xe("load",n);break;case"video":case"audio":for(a=0;a<On.length;a++)Xe(On[a],n);break;case"source":Xe("error",n);break;case"img":case"image":case"link":Xe("error",n),Xe("load",n);break;case"details":Xe("toggle",n);break;case"input":ap(n,l),Xe("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!l.multiple},Xe("invalid",n);break;case"textarea":ip(n,l),Xe("invalid",n)}Xi(r,l),a=null;for(var i in l)if(l.hasOwnProperty(i)){var d=l[i];i==="children"?typeof d=="string"?n.textContent!==d&&(l.suppressHydrationWarning!==!0&&Aa(n.textContent,d,t),a=["children",d]):typeof d=="number"&&n.textContent!==""+d&&(l.suppressHydrationWarning!==!0&&Aa(n.textContent,d,t),a=["children",""+d]):Qn.hasOwnProperty(i)&&d!=null&&i==="onScroll"&&Xe("scroll",n)}switch(r){case"input":ka(n),lp(n,l,!0);break;case"textarea":ka(n),op(n);break;case"select":case"option":break;default:typeof l.onClick=="function"&&(n.onclick=fl)}n=a,s.updateQueue=n,n!==null&&(s.flags|=4)}else{i=a.nodeType===9?a:a.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=gf(r)),t==="http://www.w3.org/1999/xhtml"?r==="script"?(t=i.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof n.is=="string"?t=i.createElement(r,{is:n.is}):(t=i.createElement(r),r==="select"&&(i=t,n.multiple?i.multiple=!0:n.size&&(i.size=n.size))):t=i.createElementNS(t,r),t[xs]=s,t[la]=n,Fg(t,s,!1,!1),s.stateNode=t;e:{switch(i=Zi(r,n),r){case"dialog":Xe("cancel",t),Xe("close",t),a=n;break;case"iframe":case"object":case"embed":Xe("load",t),a=n;break;case"video":case"audio":for(a=0;a<On.length;a++)Xe(On[a],t);a=n;break;case"source":Xe("error",t),a=n;break;case"img":case"image":case"link":Xe("error",t),Xe("load",t),a=n;break;case"details":Xe("toggle",t),a=n;break;case"input":ap(t,n),a=Yi(t,n),Xe("invalid",t);break;case"option":a=n;break;case"select":t._wrapperState={wasMultiple:!!n.multiple},a=ot({},n,{value:void 0}),Xe("invalid",t);break;case"textarea":ip(t,n),a=Qi(t,n),Xe("invalid",t);break;default:a=n}Xi(r,a),d=a;for(l in d)if(d.hasOwnProperty(l)){var u=d[l];l==="style"?vf(t,u):l==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&yf(t,u)):l==="children"?typeof u=="string"?(r!=="textarea"||u!=="")&&Jn(t,u):typeof u=="number"&&Jn(t,""+u):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(Qn.hasOwnProperty(l)?u!=null&&l==="onScroll"&&Xe("scroll",t):u!=null&&Go(t,l,u,i))}switch(r){case"input":ka(t),lp(t,n,!1);break;case"textarea":ka(t),op(t);break;case"option":n.value!=null&&t.setAttribute("value",""+sr(n.value));break;case"select":t.multiple=!!n.multiple,l=n.value,l!=null?en(t,!!n.multiple,l,!1):n.defaultValue!=null&&en(t,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(t.onclick=fl)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(s.flags|=4)}s.ref!==null&&(s.flags|=512,s.flags|=2097152)}return Tt(s),null;case 6:if(t&&s.stateNode!=null)Wg(t,s,t.memoizedProps,n);else{if(typeof n!="string"&&s.stateNode===null)throw Error(ye(166));if(r=xr(oa.current),xr(js.current),Ra(s)){if(n=s.stateNode,r=s.memoizedProps,n[xs]=s,(l=n.nodeValue!==r)&&(t=Ht,t!==null))switch(t.tag){case 3:Aa(n.nodeValue,r,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Aa(n.nodeValue,r,(t.mode&1)!==0)}l&&(s.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[xs]=s,s.stateNode=n}return Tt(s),null;case 13:if(Ze(lt),n=s.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(nt&&qt!==null&&s.mode&1&&!(s.flags&128))lg(),cn(),s.flags|=98560,l=!1;else if(l=Ra(s),n!==null&&n.dehydrated!==null){if(t===null){if(!l)throw Error(ye(318));if(l=s.memoizedState,l=l!==null?l.dehydrated:null,!l)throw Error(ye(317));l[xs]=s}else cn(),!(s.flags&128)&&(s.memoizedState=null),s.flags|=4;Tt(s),l=!1}else os!==null&&(Bo(os),os=null),l=!0;if(!l)return s.flags&65536?s:null}return s.flags&128?(s.lanes=r,s):(n=n!==null,n!==(t!==null&&t.memoizedState!==null)&&n&&(s.child.flags|=8192,s.mode&1&&(t===null||lt.current&1?yt===0&&(yt=3):Ec())),s.updateQueue!==null&&(s.flags|=4),Tt(s),null);case 4:return un(),wo(t,s),t===null&&na(s.stateNode.containerInfo),Tt(s),null;case 10:return hc(s.type._context),Tt(s),null;case 17:return _t(s.type)&&gl(),Tt(s),null;case 19:if(Ze(lt),l=s.memoizedState,l===null)return Tt(s),null;if(n=(s.flags&128)!==0,i=l.rendering,i===null)if(n)zn(l,!1);else{if(yt!==0||t!==null&&t.flags&128)for(t=s.child;t!==null;){if(i=Sl(t),i!==null){for(s.flags|=128,zn(l,!1),n=i.updateQueue,n!==null&&(s.updateQueue=n,s.flags|=4),s.subtreeFlags=0,n=r,r=s.child;r!==null;)l=r,t=n,l.flags&=14680066,i=l.alternate,i===null?(l.childLanes=0,l.lanes=t,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=i.childLanes,l.lanes=i.lanes,l.child=i.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=i.memoizedProps,l.memoizedState=i.memoizedState,l.updateQueue=i.updateQueue,l.type=i.type,t=i.dependencies,l.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),r=r.sibling;return Je(lt,lt.current&1|2),s.child}t=t.sibling}l.tail!==null&&mt()>pn&&(s.flags|=128,n=!0,zn(l,!1),s.lanes=4194304)}else{if(!n)if(t=Sl(i),t!==null){if(s.flags|=128,n=!0,r=t.updateQueue,r!==null&&(s.updateQueue=r,s.flags|=4),zn(l,!0),l.tail===null&&l.tailMode==="hidden"&&!i.alternate&&!nt)return Tt(s),null}else 2*mt()-l.renderingStartTime>pn&&r!==1073741824&&(s.flags|=128,n=!0,zn(l,!1),s.lanes=4194304);l.isBackwards?(i.sibling=s.child,s.child=i):(r=l.last,r!==null?r.sibling=i:s.child=i,l.last=i)}return l.tail!==null?(s=l.tail,l.rendering=s,l.tail=s.sibling,l.renderingStartTime=mt(),s.sibling=null,r=lt.current,Je(lt,n?r&1|2:r&1),s):(Tt(s),null);case 22:case 23:return Ic(),n=s.memoizedState!==null,t!==null&&t.memoizedState!==null!==n&&(s.flags|=8192),n&&s.mode&1?Ut&1073741824&&(Tt(s),s.subtreeFlags&6&&(s.flags|=8192)):Tt(s),null;case 24:return null;case 25:return null}throw Error(ye(156,s.tag))}function Qv(t,s){switch(dc(s),s.tag){case 1:return _t(s.type)&&gl(),t=s.flags,t&65536?(s.flags=t&-65537|128,s):null;case 3:return un(),Ze(Ot),Ze(It),vc(),t=s.flags,t&65536&&!(t&128)?(s.flags=t&-65537|128,s):null;case 5:return xc(s),null;case 13:if(Ze(lt),t=s.memoizedState,t!==null&&t.dehydrated!==null){if(s.alternate===null)throw Error(ye(340));cn()}return t=s.flags,t&65536?(s.flags=t&-65537|128,s):null;case 19:return Ze(lt),null;case 4:return un(),null;case 10:return hc(s.type._context),null;case 22:case 23:return Ic(),null;case 24:return null;default:return null}}var Pa=!1,zt=!1,Jv=typeof WeakSet=="function"?WeakSet:Set,Te=null;function Xr(t,s){var r=t.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){dt(t,s,n)}else r.current=null}function To(t,s,r){try{r()}catch(n){dt(t,s,n)}}var Jp=!1;function Xv(t,s){if(co=ml,t=Yf(),oc(t)){if("selectionStart"in t)var r={start:t.selectionStart,end:t.selectionEnd};else e:{r=(r=t.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,l=n.focusNode;n=n.focusOffset;try{r.nodeType,l.nodeType}catch{r=null;break e}var i=0,d=-1,u=-1,f=0,N=0,C=t,b=null;t:for(;;){for(var L;C!==r||a!==0&&C.nodeType!==3||(d=i+a),C!==l||n!==0&&C.nodeType!==3||(u=i+n),C.nodeType===3&&(i+=C.nodeValue.length),(L=C.firstChild)!==null;)b=C,C=L;for(;;){if(C===t)break t;if(b===r&&++f===a&&(d=i),b===l&&++N===n&&(u=i),(L=C.nextSibling)!==null)break;C=b,b=C.parentNode}C=L}r=d===-1||u===-1?null:{start:d,end:u}}else r=null}r=r||{start:0,end:0}}else r=null;for(uo={focusedElem:t,selectionRange:r},ml=!1,Te=s;Te!==null;)if(s=Te,t=s.child,(s.subtreeFlags&1028)!==0&&t!==null)t.return=s,Te=t;else for(;Te!==null;){s=Te;try{var k=s.alternate;if(s.flags&1024)switch(s.tag){case 0:case 11:case 15:break;case 1:if(k!==null){var E=k.memoizedProps,y=k.memoizedState,p=s.stateNode,m=p.getSnapshotBeforeUpdate(s.elementType===s.type?E:ls(s.type,E),y);p.__reactInternalSnapshotBeforeUpdate=m}break;case 3:var v=s.stateNode.containerInfo;v.nodeType===1?v.textContent="":v.nodeType===9&&v.documentElement&&v.removeChild(v.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ye(163))}}catch(z){dt(s,s.return,z)}if(t=s.sibling,t!==null){t.return=s.return,Te=t;break}Te=s.return}return k=Jp,Jp=!1,k}function Yn(t,s,r){var n=s.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&t)===t){var l=a.destroy;a.destroy=void 0,l!==void 0&&To(s,r,l)}a=a.next}while(a!==n)}}function Wl(t,s){if(s=s.updateQueue,s=s!==null?s.lastEffect:null,s!==null){var r=s=s.next;do{if((r.tag&t)===t){var n=r.create;r.destroy=n()}r=r.next}while(r!==s)}}function Do(t){var s=t.ref;if(s!==null){var r=t.stateNode;switch(t.tag){case 5:t=r;break;default:t=r}typeof s=="function"?s(t):s.current=t}}function Kg(t){var s=t.alternate;s!==null&&(t.alternate=null,Kg(s)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(s=t.stateNode,s!==null&&(delete s[xs],delete s[la],delete s[ho],delete s[Bv],delete s[Lv])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Ug(t){return t.tag===5||t.tag===3||t.tag===4}function Xp(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Ug(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function zo(t,s,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,s?r.nodeType===8?r.parentNode.insertBefore(t,s):r.insertBefore(t,s):(r.nodeType===8?(s=r.parentNode,s.insertBefore(t,r)):(s=r,s.appendChild(t)),r=r._reactRootContainer,r!=null||s.onclick!==null||(s.onclick=fl));else if(n!==4&&(t=t.child,t!==null))for(zo(t,s,r),t=t.sibling;t!==null;)zo(t,s,r),t=t.sibling}function Io(t,s,r){var n=t.tag;if(n===5||n===6)t=t.stateNode,s?r.insertBefore(t,s):r.appendChild(t);else if(n!==4&&(t=t.child,t!==null))for(Io(t,s,r),t=t.sibling;t!==null;)Io(t,s,r),t=t.sibling}var Nt=null,is=!1;function Ps(t,s,r){for(r=r.child;r!==null;)qg(t,s,r),r=r.sibling}function qg(t,s,r){if(vs&&typeof vs.onCommitFiberUnmount=="function")try{vs.onCommitFiberUnmount(Bl,r)}catch{}switch(r.tag){case 5:zt||Xr(r,s);case 6:var n=Nt,a=is;Nt=null,Ps(t,s,r),Nt=n,is=a,Nt!==null&&(is?(t=Nt,r=r.stateNode,t.nodeType===8?t.parentNode.removeChild(r):t.removeChild(r)):Nt.removeChild(r.stateNode));break;case 18:Nt!==null&&(is?(t=Nt,r=r.stateNode,t.nodeType===8?ji(t.parentNode,r):t.nodeType===1&&ji(t,r),ta(t)):ji(Nt,r.stateNode));break;case 4:n=Nt,a=is,Nt=r.stateNode.containerInfo,is=!0,Ps(t,s,r),Nt=n,is=a;break;case 0:case 11:case 14:case 15:if(!zt&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var l=a,i=l.destroy;l=l.tag,i!==void 0&&(l&2||l&4)&&To(r,s,i),a=a.next}while(a!==n)}Ps(t,s,r);break;case 1:if(!zt&&(Xr(r,s),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(d){dt(r,s,d)}Ps(t,s,r);break;case 21:Ps(t,s,r);break;case 22:r.mode&1?(zt=(n=zt)||r.memoizedState!==null,Ps(t,s,r),zt=n):Ps(t,s,r);break;default:Ps(t,s,r)}}function Zp(t){var s=t.updateQueue;if(s!==null){t.updateQueue=null;var r=t.stateNode;r===null&&(r=t.stateNode=new Jv),s.forEach(function(n){var a=ij.bind(null,t,n);r.has(n)||(r.add(n),n.then(a,a))})}}function as(t,s){var r=s.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var l=t,i=s,d=i;e:for(;d!==null;){switch(d.tag){case 5:Nt=d.stateNode,is=!1;break e;case 3:Nt=d.stateNode.containerInfo,is=!0;break e;case 4:Nt=d.stateNode.containerInfo,is=!0;break e}d=d.return}if(Nt===null)throw Error(ye(160));qg(l,i,a),Nt=null,is=!1;var u=a.alternate;u!==null&&(u.return=null),a.return=null}catch(f){dt(a,s,f)}}if(s.subtreeFlags&12854)for(s=s.child;s!==null;)Hg(s,t),s=s.sibling}function Hg(t,s){var r=t.alternate,n=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(as(s,t),ps(t),n&4){try{Yn(3,t,t.return),Wl(3,t)}catch(E){dt(t,t.return,E)}try{Yn(5,t,t.return)}catch(E){dt(t,t.return,E)}}break;case 1:as(s,t),ps(t),n&512&&r!==null&&Xr(r,r.return);break;case 5:if(as(s,t),ps(t),n&512&&r!==null&&Xr(r,r.return),t.flags&32){var a=t.stateNode;try{Jn(a,"")}catch(E){dt(t,t.return,E)}}if(n&4&&(a=t.stateNode,a!=null)){var l=t.memoizedProps,i=r!==null?r.memoizedProps:l,d=t.type,u=t.updateQueue;if(t.updateQueue=null,u!==null)try{d==="input"&&l.type==="radio"&&l.name!=null&&hf(a,l),Zi(d,i);var f=Zi(d,l);for(i=0;i<u.length;i+=2){var N=u[i],C=u[i+1];N==="style"?vf(a,C):N==="dangerouslySetInnerHTML"?yf(a,C):N==="children"?Jn(a,C):Go(a,N,C,f)}switch(d){case"input":Vi(a,l);break;case"textarea":ff(a,l);break;case"select":var b=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!l.multiple;var L=l.value;L!=null?en(a,!!l.multiple,L,!1):b!==!!l.multiple&&(l.defaultValue!=null?en(a,!!l.multiple,l.defaultValue,!0):en(a,!!l.multiple,l.multiple?[]:"",!1))}a[la]=l}catch(E){dt(t,t.return,E)}}break;case 6:if(as(s,t),ps(t),n&4){if(t.stateNode===null)throw Error(ye(162));a=t.stateNode,l=t.memoizedProps;try{a.nodeValue=l}catch(E){dt(t,t.return,E)}}break;case 3:if(as(s,t),ps(t),n&4&&r!==null&&r.memoizedState.isDehydrated)try{ta(s.containerInfo)}catch(E){dt(t,t.return,E)}break;case 4:as(s,t),ps(t);break;case 13:as(s,t),ps(t),a=t.child,a.flags&8192&&(l=a.memoizedState!==null,a.stateNode.isHidden=l,!l||a.alternate!==null&&a.alternate.memoizedState!==null||(Dc=mt())),n&4&&Zp(t);break;case 22:if(N=r!==null&&r.memoizedState!==null,t.mode&1?(zt=(f=zt)||N,as(s,t),zt=f):as(s,t),ps(t),n&8192){if(f=t.memoizedState!==null,(t.stateNode.isHidden=f)&&!N&&t.mode&1)for(Te=t,N=t.child;N!==null;){for(C=Te=N;Te!==null;){switch(b=Te,L=b.child,b.tag){case 0:case 11:case 14:case 15:Yn(4,b,b.return);break;case 1:Xr(b,b.return);var k=b.stateNode;if(typeof k.componentWillUnmount=="function"){n=b,r=b.return;try{s=n,k.props=s.memoizedProps,k.state=s.memoizedState,k.componentWillUnmount()}catch(E){dt(n,r,E)}}break;case 5:Xr(b,b.return);break;case 22:if(b.memoizedState!==null){th(C);continue}}L!==null?(L.return=b,Te=L):th(C)}N=N.sibling}e:for(N=null,C=t;;){if(C.tag===5){if(N===null){N=C;try{a=C.stateNode,f?(l=a.style,typeof l.setProperty=="function"?l.setProperty("display","none","important"):l.display="none"):(d=C.stateNode,u=C.memoizedProps.style,i=u!=null&&u.hasOwnProperty("display")?u.display:null,d.style.display=xf("display",i))}catch(E){dt(t,t.return,E)}}}else if(C.tag===6){if(N===null)try{C.stateNode.nodeValue=f?"":C.memoizedProps}catch(E){dt(t,t.return,E)}}else if((C.tag!==22&&C.tag!==23||C.memoizedState===null||C===t)&&C.child!==null){C.child.return=C,C=C.child;continue}if(C===t)break e;for(;C.sibling===null;){if(C.return===null||C.return===t)break e;N===C&&(N=null),C=C.return}N===C&&(N=null),C.sibling.return=C.return,C=C.sibling}}break;case 19:as(s,t),ps(t),n&4&&Zp(t);break;case 21:break;default:as(s,t),ps(t)}}function ps(t){var s=t.flags;if(s&2){try{e:{for(var r=t.return;r!==null;){if(Ug(r)){var n=r;break e}r=r.return}throw Error(ye(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(Jn(a,""),n.flags&=-33);var l=Xp(t);Io(t,l,a);break;case 3:case 4:var i=n.stateNode.containerInfo,d=Xp(t);zo(t,d,i);break;default:throw Error(ye(161))}}catch(u){dt(t,t.return,u)}t.flags&=-3}s&4096&&(t.flags&=-4097)}function Zv(t,s,r){Te=t,Yg(t)}function Yg(t,s,r){for(var n=(t.mode&1)!==0;Te!==null;){var a=Te,l=a.child;if(a.tag===22&&n){var i=a.memoizedState!==null||Pa;if(!i){var d=a.alternate,u=d!==null&&d.memoizedState!==null||zt;d=Pa;var f=zt;if(Pa=i,(zt=u)&&!f)for(Te=a;Te!==null;)i=Te,u=i.child,i.tag===22&&i.memoizedState!==null?sh(a):u!==null?(u.return=i,Te=u):sh(a);for(;l!==null;)Te=l,Yg(l),l=l.sibling;Te=a,Pa=d,zt=f}eh(t)}else a.subtreeFlags&8772&&l!==null?(l.return=a,Te=l):eh(t)}}function eh(t){for(;Te!==null;){var s=Te;if(s.flags&8772){var r=s.alternate;try{if(s.flags&8772)switch(s.tag){case 0:case 11:case 15:zt||Wl(5,s);break;case 1:var n=s.stateNode;if(s.flags&4&&!zt)if(r===null)n.componentDidMount();else{var a=s.elementType===s.type?r.memoizedProps:ls(s.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var l=s.updateQueue;l!==null&&Op(s,l,n);break;case 3:var i=s.updateQueue;if(i!==null){if(r=null,s.child!==null)switch(s.child.tag){case 5:r=s.child.stateNode;break;case 1:r=s.child.stateNode}Op(s,i,r)}break;case 5:var d=s.stateNode;if(r===null&&s.flags&4){r=d;var u=s.memoizedProps;switch(s.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&r.focus();break;case"img":u.src&&(r.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(s.memoizedState===null){var f=s.alternate;if(f!==null){var N=f.memoizedState;if(N!==null){var C=N.dehydrated;C!==null&&ta(C)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ye(163))}zt||s.flags&512&&Do(s)}catch(b){dt(s,s.return,b)}}if(s===t){Te=null;break}if(r=s.sibling,r!==null){r.return=s.return,Te=r;break}Te=s.return}}function th(t){for(;Te!==null;){var s=Te;if(s===t){Te=null;break}var r=s.sibling;if(r!==null){r.return=s.return,Te=r;break}Te=s.return}}function sh(t){for(;Te!==null;){var s=Te;try{switch(s.tag){case 0:case 11:case 15:var r=s.return;try{Wl(4,s)}catch(u){dt(s,r,u)}break;case 1:var n=s.stateNode;if(typeof n.componentDidMount=="function"){var a=s.return;try{n.componentDidMount()}catch(u){dt(s,a,u)}}var l=s.return;try{Do(s)}catch(u){dt(s,l,u)}break;case 5:var i=s.return;try{Do(s)}catch(u){dt(s,i,u)}}}catch(u){dt(s,s.return,u)}if(s===t){Te=null;break}var d=s.sibling;if(d!==null){d.return=s.return,Te=d;break}Te=s.return}}var ej=Math.ceil,wl=Rs.ReactCurrentDispatcher,wc=Rs.ReactCurrentOwner,ts=Rs.ReactCurrentBatchConfig,Ue=0,jt=null,ht=null,St=0,Ut=0,Zr=ar(0),yt=0,ma=null,Cr=0,Kl=0,Tc=0,Vn=null,Pt=null,Dc=0,pn=1/0,Ss=null,Tl=!1,Eo=null,Xs=null,Ma=!1,qs=null,Dl=0,Gn=0,Ao=null,nl=-1,al=0;function Rt(){return Ue&6?mt():nl!==-1?nl:nl=mt()}function Zs(t){return t.mode&1?Ue&2&&St!==0?St&-St:Mv.transition!==null?(al===0&&(al=Ef()),al):(t=Ye,t!==0||(t=window.event,t=t===void 0?16:Of(t.type)),t):1}function ds(t,s,r,n){if(50<Gn)throw Gn=0,Ao=null,Error(ye(185));ga(t,r,n),(!(Ue&2)||t!==jt)&&(t===jt&&(!(Ue&2)&&(Kl|=r),yt===4&&Ws(t,St)),Ft(t,n),r===1&&Ue===0&&!(s.mode&1)&&(pn=mt()+500,_l&&lr()))}function Ft(t,s){var r=t.callbackNode;Mx(t,s);var n=ul(t,t===jt?St:0);if(n===0)r!==null&&up(r),t.callbackNode=null,t.callbackPriority=0;else if(s=n&-n,t.callbackPriority!==s){if(r!=null&&up(r),s===1)t.tag===0?Pv(rh.bind(null,t)):rg(rh.bind(null,t)),Av(function(){!(Ue&6)&&lr()}),r=null;else{switch(Af(n)){case 1:r=ec;break;case 4:r=zf;break;case 16:r=dl;break;case 536870912:r=If;break;default:r=dl}r=ty(r,Vg.bind(null,t))}t.callbackPriority=s,t.callbackNode=r}}function Vg(t,s){if(nl=-1,al=0,Ue&6)throw Error(ye(327));var r=t.callbackNode;if(an()&&t.callbackNode!==r)return null;var n=ul(t,t===jt?St:0);if(n===0)return null;if(n&30||n&t.expiredLanes||s)s=zl(t,n);else{s=n;var a=Ue;Ue|=2;var l=Qg();(jt!==t||St!==s)&&(Ss=null,pn=mt()+500,vr(t,s));do try{rj();break}catch(d){Gg(t,d)}while(!0);pc(),wl.current=l,Ue=a,ht!==null?s=0:(jt=null,St=0,s=yt)}if(s!==0){if(s===2&&(a=no(t),a!==0&&(n=a,s=Ro(t,a))),s===1)throw r=ma,vr(t,0),Ws(t,n),Ft(t,mt()),r;if(s===6)Ws(t,n);else{if(a=t.current.alternate,!(n&30)&&!tj(a)&&(s=zl(t,n),s===2&&(l=no(t),l!==0&&(n=l,s=Ro(t,l))),s===1))throw r=ma,vr(t,0),Ws(t,n),Ft(t,mt()),r;switch(t.finishedWork=a,t.finishedLanes=n,s){case 0:case 1:throw Error(ye(345));case 2:hr(t,Pt,Ss);break;case 3:if(Ws(t,n),(n&130023424)===n&&(s=Dc+500-mt(),10<s)){if(ul(t,0)!==0)break;if(a=t.suspendedLanes,(a&n)!==n){Rt(),t.pingedLanes|=t.suspendedLanes&a;break}t.timeoutHandle=po(hr.bind(null,t,Pt,Ss),s);break}hr(t,Pt,Ss);break;case 4:if(Ws(t,n),(n&4194240)===n)break;for(s=t.eventTimes,a=-1;0<n;){var i=31-cs(n);l=1<<i,i=s[i],i>a&&(a=i),n&=~l}if(n=a,n=mt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*ej(n/1960))-n,10<n){t.timeoutHandle=po(hr.bind(null,t,Pt,Ss),n);break}hr(t,Pt,Ss);break;case 5:hr(t,Pt,Ss);break;default:throw Error(ye(329))}}}return Ft(t,mt()),t.callbackNode===r?Vg.bind(null,t):null}function Ro(t,s){var r=Vn;return t.current.memoizedState.isDehydrated&&(vr(t,s).flags|=256),t=zl(t,s),t!==2&&(s=Pt,Pt=r,s!==null&&Bo(s)),t}function Bo(t){Pt===null?Pt=t:Pt.push.apply(Pt,t)}function tj(t){for(var s=t;;){if(s.flags&16384){var r=s.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],l=a.getSnapshot;a=a.value;try{if(!us(l(),a))return!1}catch{return!1}}}if(r=s.child,s.subtreeFlags&16384&&r!==null)r.return=s,s=r;else{if(s===t)break;for(;s.sibling===null;){if(s.return===null||s.return===t)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function Ws(t,s){for(s&=~Tc,s&=~Kl,t.suspendedLanes|=s,t.pingedLanes&=~s,t=t.expirationTimes;0<s;){var r=31-cs(s),n=1<<r;t[r]=-1,s&=~n}}function rh(t){if(Ue&6)throw Error(ye(327));an();var s=ul(t,0);if(!(s&1))return Ft(t,mt()),null;var r=zl(t,s);if(t.tag!==0&&r===2){var n=no(t);n!==0&&(s=n,r=Ro(t,n))}if(r===1)throw r=ma,vr(t,0),Ws(t,s),Ft(t,mt()),r;if(r===6)throw Error(ye(345));return t.finishedWork=t.current.alternate,t.finishedLanes=s,hr(t,Pt,Ss),Ft(t,mt()),null}function zc(t,s){var r=Ue;Ue|=1;try{return t(s)}finally{Ue=r,Ue===0&&(pn=mt()+500,_l&&lr())}}function wr(t){qs!==null&&qs.tag===0&&!(Ue&6)&&an();var s=Ue;Ue|=1;var r=ts.transition,n=Ye;try{if(ts.transition=null,Ye=1,t)return t()}finally{Ye=n,ts.transition=r,Ue=s,!(Ue&6)&&lr()}}function Ic(){Ut=Zr.current,Ze(Zr)}function vr(t,s){t.finishedWork=null,t.finishedLanes=0;var r=t.timeoutHandle;if(r!==-1&&(t.timeoutHandle=-1,Ev(r)),ht!==null)for(r=ht.return;r!==null;){var n=r;switch(dc(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&gl();break;case 3:un(),Ze(Ot),Ze(It),vc();break;case 5:xc(n);break;case 4:un();break;case 13:Ze(lt);break;case 19:Ze(lt);break;case 10:hc(n.type._context);break;case 22:case 23:Ic()}r=r.return}if(jt=t,ht=t=er(t.current,null),St=Ut=s,yt=0,ma=null,Tc=Kl=Cr=0,Pt=Vn=null,yr!==null){for(s=0;s<yr.length;s++)if(r=yr[s],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,l=r.pending;if(l!==null){var i=l.next;l.next=a,n.next=i}r.pending=n}yr=null}return t}function Gg(t,s){do{var r=ht;try{if(pc(),tl.current=Cl,kl){for(var n=it.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}kl=!1}if(kr=0,vt=gt=it=null,Hn=!1,ca=0,wc.current=null,r===null||r.return===null){yt=1,ma=s,ht=null;break}e:{var l=t,i=r.return,d=r,u=s;if(s=St,d.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var f=u,N=d,C=N.tag;if(!(N.mode&1)&&(C===0||C===11||C===15)){var b=N.alternate;b?(N.updateQueue=b.updateQueue,N.memoizedState=b.memoizedState,N.lanes=b.lanes):(N.updateQueue=null,N.memoizedState=null)}var L=Up(i);if(L!==null){L.flags&=-257,qp(L,i,d,l,s),L.mode&1&&Kp(l,f,s),s=L,u=f;var k=s.updateQueue;if(k===null){var E=new Set;E.add(u),s.updateQueue=E}else k.add(u);break e}else{if(!(s&1)){Kp(l,f,s),Ec();break e}u=Error(ye(426))}}else if(nt&&d.mode&1){var y=Up(i);if(y!==null){!(y.flags&65536)&&(y.flags|=256),qp(y,i,d,l,s),uc(mn(u,d));break e}}l=u=mn(u,d),yt!==4&&(yt=2),Vn===null?Vn=[l]:Vn.push(l),l=i;do{switch(l.tag){case 3:l.flags|=65536,s&=-s,l.lanes|=s;var p=Ag(l,u,s);Mp(l,p);break e;case 1:d=u;var m=l.type,v=l.stateNode;if(!(l.flags&128)&&(typeof m.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(Xs===null||!Xs.has(v)))){l.flags|=65536,s&=-s,l.lanes|=s;var z=Rg(l,d,s);Mp(l,z);break e}}l=l.return}while(l!==null)}Xg(r)}catch(W){s=W,ht===r&&r!==null&&(ht=r=r.return);continue}break}while(!0)}function Qg(){var t=wl.current;return wl.current=Cl,t===null?Cl:t}function Ec(){(yt===0||yt===3||yt===2)&&(yt=4),jt===null||!(Cr&268435455)&&!(Kl&268435455)||Ws(jt,St)}function zl(t,s){var r=Ue;Ue|=2;var n=Qg();(jt!==t||St!==s)&&(Ss=null,vr(t,s));do try{sj();break}catch(a){Gg(t,a)}while(!0);if(pc(),Ue=r,wl.current=n,ht!==null)throw Error(ye(261));return jt=null,St=0,yt}function sj(){for(;ht!==null;)Jg(ht)}function rj(){for(;ht!==null&&!Dx();)Jg(ht)}function Jg(t){var s=ey(t.alternate,t,Ut);t.memoizedProps=t.pendingProps,s===null?Xg(t):ht=s,wc.current=null}function Xg(t){var s=t;do{var r=s.alternate;if(t=s.return,s.flags&32768){if(r=Qv(r,s),r!==null){r.flags&=32767,ht=r;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{yt=6,ht=null;return}}else if(r=Gv(r,s,Ut),r!==null){ht=r;return}if(s=s.sibling,s!==null){ht=s;return}ht=s=t}while(s!==null);yt===0&&(yt=5)}function hr(t,s,r){var n=Ye,a=ts.transition;try{ts.transition=null,Ye=1,nj(t,s,r,n)}finally{ts.transition=a,Ye=n}return null}function nj(t,s,r,n){do an();while(qs!==null);if(Ue&6)throw Error(ye(327));r=t.finishedWork;var a=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(ye(177));t.callbackNode=null,t.callbackPriority=0;var l=r.lanes|r.childLanes;if(Ox(t,l),t===jt&&(ht=jt=null,St=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||Ma||(Ma=!0,ty(dl,function(){return an(),null})),l=(r.flags&15990)!==0,r.subtreeFlags&15990||l){l=ts.transition,ts.transition=null;var i=Ye;Ye=1;var d=Ue;Ue|=4,wc.current=null,Xv(t,r),Hg(r,t),kv(uo),ml=!!co,uo=co=null,t.current=r,Zv(r),zx(),Ue=d,Ye=i,ts.transition=l}else t.current=r;if(Ma&&(Ma=!1,qs=t,Dl=a),l=t.pendingLanes,l===0&&(Xs=null),Ax(r.stateNode),Ft(t,mt()),s!==null)for(n=t.onRecoverableError,r=0;r<s.length;r++)a=s[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(Tl)throw Tl=!1,t=Eo,Eo=null,t;return Dl&1&&t.tag!==0&&an(),l=t.pendingLanes,l&1?t===Ao?Gn++:(Gn=0,Ao=t):Gn=0,lr(),null}function an(){if(qs!==null){var t=Af(Dl),s=ts.transition,r=Ye;try{if(ts.transition=null,Ye=16>t?16:t,qs===null)var n=!1;else{if(t=qs,qs=null,Dl=0,Ue&6)throw Error(ye(331));var a=Ue;for(Ue|=4,Te=t.current;Te!==null;){var l=Te,i=l.child;if(Te.flags&16){var d=l.deletions;if(d!==null){for(var u=0;u<d.length;u++){var f=d[u];for(Te=f;Te!==null;){var N=Te;switch(N.tag){case 0:case 11:case 15:Yn(8,N,l)}var C=N.child;if(C!==null)C.return=N,Te=C;else for(;Te!==null;){N=Te;var b=N.sibling,L=N.return;if(Kg(N),N===f){Te=null;break}if(b!==null){b.return=L,Te=b;break}Te=L}}}var k=l.alternate;if(k!==null){var E=k.child;if(E!==null){k.child=null;do{var y=E.sibling;E.sibling=null,E=y}while(E!==null)}}Te=l}}if(l.subtreeFlags&2064&&i!==null)i.return=l,Te=i;else e:for(;Te!==null;){if(l=Te,l.flags&2048)switch(l.tag){case 0:case 11:case 15:Yn(9,l,l.return)}var p=l.sibling;if(p!==null){p.return=l.return,Te=p;break e}Te=l.return}}var m=t.current;for(Te=m;Te!==null;){i=Te;var v=i.child;if(i.subtreeFlags&2064&&v!==null)v.return=i,Te=v;else e:for(i=m;Te!==null;){if(d=Te,d.flags&2048)try{switch(d.tag){case 0:case 11:case 15:Wl(9,d)}}catch(W){dt(d,d.return,W)}if(d===i){Te=null;break e}var z=d.sibling;if(z!==null){z.return=d.return,Te=z;break e}Te=d.return}}if(Ue=a,lr(),vs&&typeof vs.onPostCommitFiberRoot=="function")try{vs.onPostCommitFiberRoot(Bl,t)}catch{}n=!0}return n}finally{Ye=r,ts.transition=s}}return!1}function nh(t,s,r){s=mn(r,s),s=Ag(t,s,1),t=Js(t,s,1),s=Rt(),t!==null&&(ga(t,1,s),Ft(t,s))}function dt(t,s,r){if(t.tag===3)nh(t,t,r);else for(;s!==null;){if(s.tag===3){nh(s,t,r);break}else if(s.tag===1){var n=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Xs===null||!Xs.has(n))){t=mn(r,t),t=Rg(s,t,1),s=Js(s,t,1),t=Rt(),s!==null&&(ga(s,1,t),Ft(s,t));break}}s=s.return}}function aj(t,s,r){var n=t.pingCache;n!==null&&n.delete(s),s=Rt(),t.pingedLanes|=t.suspendedLanes&r,jt===t&&(St&r)===r&&(yt===4||yt===3&&(St&130023424)===St&&500>mt()-Dc?vr(t,0):Tc|=r),Ft(t,s)}function Zg(t,s){s===0&&(t.mode&1?(s=Ta,Ta<<=1,!(Ta&130023424)&&(Ta=4194304)):s=1);var r=Rt();t=Es(t,s),t!==null&&(ga(t,s,r),Ft(t,r))}function lj(t){var s=t.memoizedState,r=0;s!==null&&(r=s.retryLane),Zg(t,r)}function ij(t,s){var r=0;switch(t.tag){case 13:var n=t.stateNode,a=t.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=t.stateNode;break;default:throw Error(ye(314))}n!==null&&n.delete(s),Zg(t,r)}var ey;ey=function(t,s,r){if(t!==null)if(t.memoizedProps!==s.pendingProps||Ot.current)Mt=!0;else{if(!(t.lanes&r)&&!(s.flags&128))return Mt=!1,Vv(t,s,r);Mt=!!(t.flags&131072)}else Mt=!1,nt&&s.flags&1048576&&ng(s,vl,s.index);switch(s.lanes=0,s.tag){case 2:var n=s.type;rl(t,s),t=s.pendingProps;var a=on(s,It.current);nn(s,r),a=bc(null,s,n,t,a,r);var l=Nc();return s.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(s.tag=1,s.memoizedState=null,s.updateQueue=null,_t(n)?(l=!0,yl(s)):l=!1,s.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,gc(s),a.updater=$l,s.stateNode=a,a._reactInternals=s,jo(s,n,t,r),s=So(null,s,n,!0,l,r)):(s.tag=0,nt&&l&&cc(s),At(null,s,a,r),s=s.child),s;case 16:n=s.elementType;e:{switch(rl(t,s),t=s.pendingProps,a=n._init,n=a(n._payload),s.type=n,a=s.tag=cj(n),t=ls(n,t),a){case 0:s=No(null,s,n,t,r);break e;case 1:s=Vp(null,s,n,t,r);break e;case 11:s=Hp(null,s,n,t,r);break e;case 14:s=Yp(null,s,n,ls(n.type,t),r);break e}throw Error(ye(306,n,""))}return s;case 0:return n=s.type,a=s.pendingProps,a=s.elementType===n?a:ls(n,a),No(t,s,n,a,r);case 1:return n=s.type,a=s.pendingProps,a=s.elementType===n?a:ls(n,a),Vp(t,s,n,a,r);case 3:e:{if(Mg(s),t===null)throw Error(ye(387));n=s.pendingProps,l=s.memoizedState,a=l.element,dg(t,s),Nl(s,n,null,r);var i=s.memoizedState;if(n=i.element,l.isDehydrated)if(l={element:n,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},s.updateQueue.baseState=l,s.memoizedState=l,s.flags&256){a=mn(Error(ye(423)),s),s=Gp(t,s,n,r,a);break e}else if(n!==a){a=mn(Error(ye(424)),s),s=Gp(t,s,n,r,a);break e}else for(qt=Qs(s.stateNode.containerInfo.firstChild),Ht=s,nt=!0,os=null,r=og(s,null,n,r),s.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(cn(),n===a){s=As(t,s,r);break e}At(t,s,n,r)}s=s.child}return s;case 5:return ug(s),t===null&&yo(s),n=s.type,a=s.pendingProps,l=t!==null?t.memoizedProps:null,i=a.children,mo(n,a)?i=null:l!==null&&mo(n,l)&&(s.flags|=32),Pg(t,s),At(t,s,i,r),s.child;case 6:return t===null&&yo(s),null;case 13:return Og(t,s,r);case 4:return yc(s,s.stateNode.containerInfo),n=s.pendingProps,t===null?s.child=dn(s,null,n,r):At(t,s,n,r),s.child;case 11:return n=s.type,a=s.pendingProps,a=s.elementType===n?a:ls(n,a),Hp(t,s,n,a,r);case 7:return At(t,s,s.pendingProps,r),s.child;case 8:return At(t,s,s.pendingProps.children,r),s.child;case 12:return At(t,s,s.pendingProps.children,r),s.child;case 10:e:{if(n=s.type._context,a=s.pendingProps,l=s.memoizedProps,i=a.value,Je(jl,n._currentValue),n._currentValue=i,l!==null)if(us(l.value,i)){if(l.children===a.children&&!Ot.current){s=As(t,s,r);break e}}else for(l=s.child,l!==null&&(l.return=s);l!==null;){var d=l.dependencies;if(d!==null){i=l.child;for(var u=d.firstContext;u!==null;){if(u.context===n){if(l.tag===1){u=Ds(-1,r&-r),u.tag=2;var f=l.updateQueue;if(f!==null){f=f.shared;var N=f.pending;N===null?u.next=u:(u.next=N.next,N.next=u),f.pending=u}}l.lanes|=r,u=l.alternate,u!==null&&(u.lanes|=r),xo(l.return,r,s),d.lanes|=r;break}u=u.next}}else if(l.tag===10)i=l.type===s.type?null:l.child;else if(l.tag===18){if(i=l.return,i===null)throw Error(ye(341));i.lanes|=r,d=i.alternate,d!==null&&(d.lanes|=r),xo(i,r,s),i=l.sibling}else i=l.child;if(i!==null)i.return=l;else for(i=l;i!==null;){if(i===s){i=null;break}if(l=i.sibling,l!==null){l.return=i.return,i=l;break}i=i.return}l=i}At(t,s,a.children,r),s=s.child}return s;case 9:return a=s.type,n=s.pendingProps.children,nn(s,r),a=ss(a),n=n(a),s.flags|=1,At(t,s,n,r),s.child;case 14:return n=s.type,a=ls(n,s.pendingProps),a=ls(n.type,a),Yp(t,s,n,a,r);case 15:return Bg(t,s,s.type,s.pendingProps,r);case 17:return n=s.type,a=s.pendingProps,a=s.elementType===n?a:ls(n,a),rl(t,s),s.tag=1,_t(n)?(t=!0,yl(s)):t=!1,nn(s,r),Eg(s,n,a),jo(s,n,a,r),So(null,s,n,!0,t,r);case 19:return _g(t,s,r);case 22:return Lg(t,s,r)}throw Error(ye(156,s.tag))};function ty(t,s){return Df(t,s)}function oj(t,s,r,n){this.tag=t,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Zt(t,s,r,n){return new oj(t,s,r,n)}function Ac(t){return t=t.prototype,!(!t||!t.isReactComponent)}function cj(t){if(typeof t=="function")return Ac(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Jo)return 11;if(t===Xo)return 14}return 2}function er(t,s){var r=t.alternate;return r===null?(r=Zt(t.tag,s,t.key,t.mode),r.elementType=t.elementType,r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=s,r.type=t.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=t.flags&14680064,r.childLanes=t.childLanes,r.lanes=t.lanes,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,s=t.dependencies,r.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function ll(t,s,r,n,a,l){var i=2;if(n=t,typeof t=="function")Ac(t)&&(i=1);else if(typeof t=="string")i=5;else e:switch(t){case Kr:return jr(r.children,a,l,s);case Qo:i=8,a|=8;break;case Ki:return t=Zt(12,r,s,a|2),t.elementType=Ki,t.lanes=l,t;case Ui:return t=Zt(13,r,s,a),t.elementType=Ui,t.lanes=l,t;case qi:return t=Zt(19,r,s,a),t.elementType=qi,t.lanes=l,t;case uf:return Ul(r,a,l,s);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case cf:i=10;break e;case df:i=9;break e;case Jo:i=11;break e;case Xo:i=14;break e;case _s:i=16,n=null;break e}throw Error(ye(130,t==null?t:typeof t,""))}return s=Zt(i,r,s,a),s.elementType=t,s.type=n,s.lanes=l,s}function jr(t,s,r,n){return t=Zt(7,t,n,s),t.lanes=r,t}function Ul(t,s,r,n){return t=Zt(22,t,n,s),t.elementType=uf,t.lanes=r,t.stateNode={isHidden:!1},t}function Di(t,s,r){return t=Zt(6,t,null,s),t.lanes=r,t}function zi(t,s,r){return s=Zt(4,t.children!==null?t.children:[],t.key,s),s.lanes=r,s.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},s}function dj(t,s,r,n,a){this.tag=s,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ci(0),this.expirationTimes=ci(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ci(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Rc(t,s,r,n,a,l,i,d,u){return t=new dj(t,s,r,d,u),s===1?(s=1,l===!0&&(s|=8)):s=0,l=Zt(3,null,null,s),t.current=l,l.stateNode=t,l.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},gc(l),t}function uj(t,s,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Wr,key:n==null?null:""+n,children:t,containerInfo:s,implementation:r}}function sy(t){if(!t)return rr;t=t._reactInternals;e:{if(Dr(t)!==t||t.tag!==1)throw Error(ye(170));var s=t;do{switch(s.tag){case 3:s=s.stateNode.context;break e;case 1:if(_t(s.type)){s=s.stateNode.__reactInternalMemoizedMergedChildContext;break e}}s=s.return}while(s!==null);throw Error(ye(171))}if(t.tag===1){var r=t.type;if(_t(r))return sg(t,r,s)}return s}function ry(t,s,r,n,a,l,i,d,u){return t=Rc(r,n,!0,t,a,l,i,d,u),t.context=sy(null),r=t.current,n=Rt(),a=Zs(r),l=Ds(n,a),l.callback=s??null,Js(r,l,a),t.current.lanes=a,ga(t,a,n),Ft(t,n),t}function ql(t,s,r,n){var a=s.current,l=Rt(),i=Zs(a);return r=sy(r),s.context===null?s.context=r:s.pendingContext=r,s=Ds(l,i),s.payload={element:t},n=n===void 0?null:n,n!==null&&(s.callback=n),t=Js(a,s,i),t!==null&&(ds(t,a,i,l),el(t,a,i)),i}function Il(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function ah(t,s){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var r=t.retryLane;t.retryLane=r!==0&&r<s?r:s}}function Bc(t,s){ah(t,s),(t=t.alternate)&&ah(t,s)}function mj(){return null}var ny=typeof reportError=="function"?reportError:function(t){console.error(t)};function Lc(t){this._internalRoot=t}Hl.prototype.render=Lc.prototype.render=function(t){var s=this._internalRoot;if(s===null)throw Error(ye(409));ql(t,s,null,null)};Hl.prototype.unmount=Lc.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var s=t.containerInfo;wr(function(){ql(null,t,null,null)}),s[Is]=null}};function Hl(t){this._internalRoot=t}Hl.prototype.unstable_scheduleHydration=function(t){if(t){var s=Lf();t={blockedOn:null,target:t,priority:s};for(var r=0;r<$s.length&&s!==0&&s<$s[r].priority;r++);$s.splice(r,0,t),r===0&&Mf(t)}};function Pc(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Yl(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function lh(){}function pj(t,s,r,n,a){if(a){if(typeof n=="function"){var l=n;n=function(){var f=Il(i);l.call(f)}}var i=ry(s,n,t,0,null,!1,!1,"",lh);return t._reactRootContainer=i,t[Is]=i.current,na(t.nodeType===8?t.parentNode:t),wr(),i}for(;a=t.lastChild;)t.removeChild(a);if(typeof n=="function"){var d=n;n=function(){var f=Il(u);d.call(f)}}var u=Rc(t,0,!1,null,null,!1,!1,"",lh);return t._reactRootContainer=u,t[Is]=u.current,na(t.nodeType===8?t.parentNode:t),wr(function(){ql(s,u,r,n)}),u}function Vl(t,s,r,n,a){var l=r._reactRootContainer;if(l){var i=l;if(typeof a=="function"){var d=a;a=function(){var u=Il(i);d.call(u)}}ql(s,i,t,a)}else i=pj(r,s,t,a,n);return Il(i)}Rf=function(t){switch(t.tag){case 3:var s=t.stateNode;if(s.current.memoizedState.isDehydrated){var r=Mn(s.pendingLanes);r!==0&&(tc(s,r|1),Ft(s,mt()),!(Ue&6)&&(pn=mt()+500,lr()))}break;case 13:wr(function(){var n=Es(t,1);if(n!==null){var a=Rt();ds(n,t,1,a)}}),Bc(t,1)}};sc=function(t){if(t.tag===13){var s=Es(t,134217728);if(s!==null){var r=Rt();ds(s,t,134217728,r)}Bc(t,134217728)}};Bf=function(t){if(t.tag===13){var s=Zs(t),r=Es(t,s);if(r!==null){var n=Rt();ds(r,t,s,n)}Bc(t,s)}};Lf=function(){return Ye};Pf=function(t,s){var r=Ye;try{return Ye=t,s()}finally{Ye=r}};to=function(t,s,r){switch(s){case"input":if(Vi(t,r),s=r.name,r.type==="radio"&&s!=null){for(r=t;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+s)+'][type="radio"]'),s=0;s<r.length;s++){var n=r[s];if(n!==t&&n.form===t.form){var a=Ol(n);if(!a)throw Error(ye(90));pf(n),Vi(n,a)}}}break;case"textarea":ff(t,r);break;case"select":s=r.value,s!=null&&en(t,!!r.multiple,s,!1)}};Nf=zc;Sf=wr;var hj={usingClientEntryPoint:!1,Events:[xa,Yr,Ol,jf,bf,zc]},In={findFiberByHostInstance:gr,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},fj={bundleType:In.bundleType,version:In.version,rendererPackageName:In.rendererPackageName,rendererConfig:In.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Rs.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=wf(t),t===null?null:t.stateNode},findFiberByHostInstance:In.findFiberByHostInstance||mj,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Oa=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Oa.isDisabled&&Oa.supportsFiber)try{Bl=Oa.inject(fj),vs=Oa}catch{}}Vt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=hj;Vt.createPortal=function(t,s){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Pc(s))throw Error(ye(200));return uj(t,s,null,r)};Vt.createRoot=function(t,s){if(!Pc(t))throw Error(ye(299));var r=!1,n="",a=ny;return s!=null&&(s.unstable_strictMode===!0&&(r=!0),s.identifierPrefix!==void 0&&(n=s.identifierPrefix),s.onRecoverableError!==void 0&&(a=s.onRecoverableError)),s=Rc(t,1,!1,null,null,r,!1,n,a),t[Is]=s.current,na(t.nodeType===8?t.parentNode:t),new Lc(s)};Vt.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var s=t._reactInternals;if(s===void 0)throw typeof t.render=="function"?Error(ye(188)):(t=Object.keys(t).join(","),Error(ye(268,t)));return t=wf(s),t=t===null?null:t.stateNode,t};Vt.flushSync=function(t){return wr(t)};Vt.hydrate=function(t,s,r){if(!Yl(s))throw Error(ye(200));return Vl(null,t,s,!0,r)};Vt.hydrateRoot=function(t,s,r){if(!Pc(t))throw Error(ye(405));var n=r!=null&&r.hydratedSources||null,a=!1,l="",i=ny;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(l=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),s=ry(s,null,t,1,r??null,a,!1,l,i),t[Is]=s.current,na(t),n)for(t=0;t<n.length;t++)r=n[t],a=r._getVersion,a=a(r._source),s.mutableSourceEagerHydrationData==null?s.mutableSourceEagerHydrationData=[r,a]:s.mutableSourceEagerHydrationData.push(r,a);return new Hl(s)};Vt.render=function(t,s,r){if(!Yl(s))throw Error(ye(200));return Vl(null,t,s,!1,r)};Vt.unmountComponentAtNode=function(t){if(!Yl(t))throw Error(ye(40));return t._reactRootContainer?(wr(function(){Vl(null,null,t,!1,function(){t._reactRootContainer=null,t[Is]=null})}),!0):!1};Vt.unstable_batchedUpdates=zc;Vt.unstable_renderSubtreeIntoContainer=function(t,s,r,n){if(!Yl(r))throw Error(ye(200));if(t==null||t._reactInternals===void 0)throw Error(ye(38));return Vl(t,s,r,!1,n)};Vt.version="18.3.1-next-f1338f8080-20240426";function ay(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(ay)}catch(t){console.error(t)}}ay(),nf.exports=Vt;var gj=nf.exports,ih=gj;$i.createRoot=ih.createRoot,$i.hydrateRoot=ih.hydrateRoot;/**
 * @remix-run/router v1.23.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function pa(){return pa=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var r=arguments[s];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},pa.apply(this,arguments)}var Hs;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Hs||(Hs={}));const oh="popstate";function yj(t){t===void 0&&(t={});function s(n,a){let{pathname:l,search:i,hash:d}=n.location;return Lo("",{pathname:l,search:i,hash:d},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:El(a)}return vj(s,r,null,t)}function pt(t,s){if(t===!1||t===null||typeof t>"u")throw new Error(s)}function Mc(t,s){if(!t){typeof console<"u"&&console.warn(s);try{throw new Error(s)}catch{}}}function xj(){return Math.random().toString(36).substr(2,8)}function ch(t,s){return{usr:t.state,key:t.key,idx:s}}function Lo(t,s,r,n){return r===void 0&&(r=null),pa({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof s=="string"?yn(s):s,{state:r,key:s&&s.key||n||xj()})}function El(t){let{pathname:s="/",search:r="",hash:n=""}=t;return r&&r!=="?"&&(s+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(s+=n.charAt(0)==="#"?n:"#"+n),s}function yn(t){let s={};if(t){let r=t.indexOf("#");r>=0&&(s.hash=t.substr(r),t=t.substr(0,r));let n=t.indexOf("?");n>=0&&(s.search=t.substr(n),t=t.substr(0,n)),t&&(s.pathname=t)}return s}function vj(t,s,r,n){n===void 0&&(n={});let{window:a=document.defaultView,v5Compat:l=!1}=n,i=a.history,d=Hs.Pop,u=null,f=N();f==null&&(f=0,i.replaceState(pa({},i.state,{idx:f}),""));function N(){return(i.state||{idx:null}).idx}function C(){d=Hs.Pop;let y=N(),p=y==null?null:y-f;f=y,u&&u({action:d,location:E.location,delta:p})}function b(y,p){d=Hs.Push;let m=Lo(E.location,y,p);f=N()+1;let v=ch(m,f),z=E.createHref(m);try{i.pushState(v,"",z)}catch(W){if(W instanceof DOMException&&W.name==="DataCloneError")throw W;a.location.assign(z)}l&&u&&u({action:d,location:E.location,delta:1})}function L(y,p){d=Hs.Replace;let m=Lo(E.location,y,p);f=N();let v=ch(m,f),z=E.createHref(m);i.replaceState(v,"",z),l&&u&&u({action:d,location:E.location,delta:0})}function k(y){let p=a.location.origin!=="null"?a.location.origin:a.location.href,m=typeof y=="string"?y:El(y);return m=m.replace(/ $/,"%20"),pt(p,"No window.location.(origin|href) available to create URL for href: "+m),new URL(m,p)}let E={get action(){return d},get location(){return t(a,i)},listen(y){if(u)throw new Error("A history only accepts one active listener");return a.addEventListener(oh,C),u=y,()=>{a.removeEventListener(oh,C),u=null}},createHref(y){return s(a,y)},createURL:k,encodeLocation(y){let p=k(y);return{pathname:p.pathname,search:p.search,hash:p.hash}},push:b,replace:L,go(y){return i.go(y)}};return E}var dh;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(dh||(dh={}));function jj(t,s,r){return r===void 0&&(r="/"),bj(t,s,r)}function bj(t,s,r,n){let a=typeof s=="string"?yn(s):s,l=Oc(a.pathname||"/",r);if(l==null)return null;let i=ly(t);Nj(i);let d=null;for(let u=0;d==null&&u<i.length;++u){let f=Bj(l);d=Ej(i[u],f)}return d}function ly(t,s,r,n){s===void 0&&(s=[]),r===void 0&&(r=[]),n===void 0&&(n="");let a=(l,i,d)=>{let u={relativePath:d===void 0?l.path||"":d,caseSensitive:l.caseSensitive===!0,childrenIndex:i,route:l};u.relativePath.startsWith("/")&&(pt(u.relativePath.startsWith(n),'Absolute route path "'+u.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),u.relativePath=u.relativePath.slice(n.length));let f=tr([n,u.relativePath]),N=r.concat(u);l.children&&l.children.length>0&&(pt(l.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+f+'".')),ly(l.children,s,N,f)),!(l.path==null&&!l.index)&&s.push({path:f,score:zj(f,l.index),routesMeta:N})};return t.forEach((l,i)=>{var d;if(l.path===""||!((d=l.path)!=null&&d.includes("?")))a(l,i);else for(let u of iy(l.path))a(l,i,u)}),s}function iy(t){let s=t.split("/");if(s.length===0)return[];let[r,...n]=s,a=r.endsWith("?"),l=r.replace(/\?$/,"");if(n.length===0)return a?[l,""]:[l];let i=iy(n.join("/")),d=[];return d.push(...i.map(u=>u===""?l:[l,u].join("/"))),a&&d.push(...i),d.map(u=>t.startsWith("/")&&u===""?"/":u)}function Nj(t){t.sort((s,r)=>s.score!==r.score?r.score-s.score:Ij(s.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const Sj=/^:[\w-]+$/,kj=3,Cj=2,wj=1,Tj=10,Dj=-2,uh=t=>t==="*";function zj(t,s){let r=t.split("/"),n=r.length;return r.some(uh)&&(n+=Dj),s&&(n+=Cj),r.filter(a=>!uh(a)).reduce((a,l)=>a+(Sj.test(l)?kj:l===""?wj:Tj),n)}function Ij(t,s){return t.length===s.length&&t.slice(0,-1).every((n,a)=>n===s[a])?t[t.length-1]-s[s.length-1]:0}function Ej(t,s,r){let{routesMeta:n}=t,a={},l="/",i=[];for(let d=0;d<n.length;++d){let u=n[d],f=d===n.length-1,N=l==="/"?s:s.slice(l.length)||"/",C=Aj({path:u.relativePath,caseSensitive:u.caseSensitive,end:f},N),b=u.route;if(!C)return null;Object.assign(a,C.params),i.push({params:a,pathname:tr([l,C.pathname]),pathnameBase:_j(tr([l,C.pathnameBase])),route:b}),C.pathnameBase!=="/"&&(l=tr([l,C.pathnameBase]))}return i}function Aj(t,s){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,n]=Rj(t.path,t.caseSensitive,t.end),a=s.match(r);if(!a)return null;let l=a[0],i=l.replace(/(.)\/+$/,"$1"),d=a.slice(1);return{params:n.reduce((f,N,C)=>{let{paramName:b,isOptional:L}=N;if(b==="*"){let E=d[C]||"";i=l.slice(0,l.length-E.length).replace(/(.)\/+$/,"$1")}const k=d[C];return L&&!k?f[b]=void 0:f[b]=(k||"").replace(/%2F/g,"/"),f},{}),pathname:l,pathnameBase:i,pattern:t}}function Rj(t,s,r){s===void 0&&(s=!1),r===void 0&&(r=!0),Mc(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let n=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,d,u)=>(n.push({paramName:d,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(n.push({paramName:"*"}),a+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":t!==""&&t!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,s?void 0:"i"),n]}function Bj(t){try{return t.split("/").map(s=>decodeURIComponent(s).replace(/\//g,"%2F")).join("/")}catch(s){return Mc(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+s+").")),t}}function Oc(t,s){if(s==="/")return t;if(!t.toLowerCase().startsWith(s.toLowerCase()))return null;let r=s.endsWith("/")?s.length-1:s.length,n=t.charAt(r);return n&&n!=="/"?null:t.slice(r)||"/"}const Lj=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Pj=t=>Lj.test(t);function Mj(t,s){s===void 0&&(s="/");let{pathname:r,search:n="",hash:a=""}=typeof t=="string"?yn(t):t,l;if(r)if(Pj(r))l=r;else{if(r.includes("//")){let i=r;r=r.replace(/\/\/+/g,"/"),Mc(!1,"Pathnames cannot have embedded double slashes - normalizing "+(i+" -> "+r))}r.startsWith("/")?l=mh(r.substring(1),"/"):l=mh(r,s)}else l=s;return{pathname:l,search:Fj(n),hash:$j(a)}}function mh(t,s){let r=s.replace(/\/+$/,"").split("/");return t.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function Ii(t,s,r,n){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+s+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function Oj(t){return t.filter((s,r)=>r===0||s.route.path&&s.route.path.length>0)}function _c(t,s){let r=Oj(t);return s?r.map((n,a)=>a===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function Fc(t,s,r,n){n===void 0&&(n=!1);let a;typeof t=="string"?a=yn(t):(a=pa({},t),pt(!a.pathname||!a.pathname.includes("?"),Ii("?","pathname","search",a)),pt(!a.pathname||!a.pathname.includes("#"),Ii("#","pathname","hash",a)),pt(!a.search||!a.search.includes("#"),Ii("#","search","hash",a)));let l=t===""||a.pathname==="",i=l?"/":a.pathname,d;if(i==null)d=r;else{let C=s.length-1;if(!n&&i.startsWith("..")){let b=i.split("/");for(;b[0]==="..";)b.shift(),C-=1;a.pathname=b.join("/")}d=C>=0?s[C]:"/"}let u=Mj(a,d),f=i&&i!=="/"&&i.endsWith("/"),N=(l||i===".")&&r.endsWith("/");return!u.pathname.endsWith("/")&&(f||N)&&(u.pathname+="/"),u}const tr=t=>t.join("/").replace(/\/\/+/g,"/"),_j=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),Fj=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,$j=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function Wj(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const oy=["post","put","patch","delete"];new Set(oy);const Kj=["get",...oy];new Set(Kj);/**
 * React Router v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ha(){return ha=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var r=arguments[s];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},ha.apply(this,arguments)}const $c=c.createContext(null),Uj=c.createContext(null),ir=c.createContext(null),Gl=c.createContext(null),Bs=c.createContext({outlet:null,matches:[],isDataRoute:!1}),cy=c.createContext(null);function qj(t,s){let{relative:r}=s===void 0?{}:s;xn()||pt(!1);let{basename:n,navigator:a}=c.useContext(ir),{hash:l,pathname:i,search:d}=uy(t,{relative:r}),u=i;return n!=="/"&&(u=i==="/"?n:tr([n,i])),a.createHref({pathname:u,search:d,hash:l})}function xn(){return c.useContext(Gl)!=null}function or(){return xn()||pt(!1),c.useContext(Gl).location}function dy(t){c.useContext(ir).static||c.useLayoutEffect(t)}function Ls(){let{isDataRoute:t}=c.useContext(Bs);return t?lb():Hj()}function Hj(){xn()||pt(!1);let t=c.useContext($c),{basename:s,future:r,navigator:n}=c.useContext(ir),{matches:a}=c.useContext(Bs),{pathname:l}=or(),i=JSON.stringify(_c(a,r.v7_relativeSplatPath)),d=c.useRef(!1);return dy(()=>{d.current=!0}),c.useCallback(function(f,N){if(N===void 0&&(N={}),!d.current)return;if(typeof f=="number"){n.go(f);return}let C=Fc(f,JSON.parse(i),l,N.relative==="path");t==null&&s!=="/"&&(C.pathname=C.pathname==="/"?s:tr([s,C.pathname])),(N.replace?n.replace:n.push)(C,N.state,N)},[s,n,i,l,t])}const Yj=c.createContext(null);function Vj(t){let s=c.useContext(Bs).outlet;return s&&c.createElement(Yj.Provider,{value:t},s)}function uy(t,s){let{relative:r}=s===void 0?{}:s,{future:n}=c.useContext(ir),{matches:a}=c.useContext(Bs),{pathname:l}=or(),i=JSON.stringify(_c(a,n.v7_relativeSplatPath));return c.useMemo(()=>Fc(t,JSON.parse(i),l,r==="path"),[t,i,l,r])}function Gj(t,s){return Qj(t,s)}function Qj(t,s,r,n){xn()||pt(!1);let{navigator:a}=c.useContext(ir),{matches:l}=c.useContext(Bs),i=l[l.length-1],d=i?i.params:{};i&&i.pathname;let u=i?i.pathnameBase:"/";i&&i.route;let f=or(),N;if(s){var C;let y=typeof s=="string"?yn(s):s;u==="/"||(C=y.pathname)!=null&&C.startsWith(u)||pt(!1),N=y}else N=f;let b=N.pathname||"/",L=b;if(u!=="/"){let y=u.replace(/^\//,"").split("/");L="/"+b.replace(/^\//,"").split("/").slice(y.length).join("/")}let k=jj(t,{pathname:L}),E=tb(k&&k.map(y=>Object.assign({},y,{params:Object.assign({},d,y.params),pathname:tr([u,a.encodeLocation?a.encodeLocation(y.pathname).pathname:y.pathname]),pathnameBase:y.pathnameBase==="/"?u:tr([u,a.encodeLocation?a.encodeLocation(y.pathnameBase).pathname:y.pathnameBase])})),l,r,n);return s&&E?c.createElement(Gl.Provider,{value:{location:ha({pathname:"/",search:"",hash:"",state:null,key:"default"},N),navigationType:Hs.Pop}},E):E}function Jj(){let t=ab(),s=Wj(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return c.createElement(c.Fragment,null,c.createElement("h2",null,"Unexpected Application Error!"),c.createElement("h3",{style:{fontStyle:"italic"}},s),r?c.createElement("pre",{style:a},r):null,null)}const Xj=c.createElement(Jj,null);class Zj extends c.Component{constructor(s){super(s),this.state={location:s.location,revalidation:s.revalidation,error:s.error}}static getDerivedStateFromError(s){return{error:s}}static getDerivedStateFromProps(s,r){return r.location!==s.location||r.revalidation!=="idle"&&s.revalidation==="idle"?{error:s.error,location:s.location,revalidation:s.revalidation}:{error:s.error!==void 0?s.error:r.error,location:r.location,revalidation:s.revalidation||r.revalidation}}componentDidCatch(s,r){console.error("React Router caught the following error during render",s,r)}render(){return this.state.error!==void 0?c.createElement(Bs.Provider,{value:this.props.routeContext},c.createElement(cy.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function eb(t){let{routeContext:s,match:r,children:n}=t,a=c.useContext($c);return a&&a.static&&a.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=r.route.id),c.createElement(Bs.Provider,{value:s},n)}function tb(t,s,r,n){var a;if(s===void 0&&(s=[]),r===void 0&&(r=null),n===void 0&&(n=null),t==null){var l;if(!r)return null;if(r.errors)t=r.matches;else if((l=n)!=null&&l.v7_partialHydration&&s.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let i=t,d=(a=r)==null?void 0:a.errors;if(d!=null){let N=i.findIndex(C=>C.route.id&&(d==null?void 0:d[C.route.id])!==void 0);N>=0||pt(!1),i=i.slice(0,Math.min(i.length,N+1))}let u=!1,f=-1;if(r&&n&&n.v7_partialHydration)for(let N=0;N<i.length;N++){let C=i[N];if((C.route.HydrateFallback||C.route.hydrateFallbackElement)&&(f=N),C.route.id){let{loaderData:b,errors:L}=r,k=C.route.loader&&b[C.route.id]===void 0&&(!L||L[C.route.id]===void 0);if(C.route.lazy||k){u=!0,f>=0?i=i.slice(0,f+1):i=[i[0]];break}}}return i.reduceRight((N,C,b)=>{let L,k=!1,E=null,y=null;r&&(L=d&&C.route.id?d[C.route.id]:void 0,E=C.route.errorElement||Xj,u&&(f<0&&b===0?(ib("route-fallback"),k=!0,y=null):f===b&&(k=!0,y=C.route.hydrateFallbackElement||null)));let p=s.concat(i.slice(0,b+1)),m=()=>{let v;return L?v=E:k?v=y:C.route.Component?v=c.createElement(C.route.Component,null):C.route.element?v=C.route.element:v=N,c.createElement(eb,{match:C,routeContext:{outlet:N,matches:p,isDataRoute:r!=null},children:v})};return r&&(C.route.ErrorBoundary||C.route.errorElement||b===0)?c.createElement(Zj,{location:r.location,revalidation:r.revalidation,component:E,error:L,children:m(),routeContext:{outlet:null,matches:p,isDataRoute:!0}}):m()},null)}var my=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(my||{}),py=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(py||{});function sb(t){let s=c.useContext($c);return s||pt(!1),s}function rb(t){let s=c.useContext(Uj);return s||pt(!1),s}function nb(t){let s=c.useContext(Bs);return s||pt(!1),s}function hy(t){let s=nb(),r=s.matches[s.matches.length-1];return r.route.id||pt(!1),r.route.id}function ab(){var t;let s=c.useContext(cy),r=rb(),n=hy();return s!==void 0?s:(t=r.errors)==null?void 0:t[n]}function lb(){let{router:t}=sb(my.UseNavigateStable),s=hy(py.UseNavigateStable),r=c.useRef(!1);return dy(()=>{r.current=!0}),c.useCallback(function(a,l){l===void 0&&(l={}),r.current&&(typeof a=="number"?t.navigate(a):t.navigate(a,ha({fromRouteId:s},l)))},[t,s])}const ph={};function ib(t,s,r){ph[t]||(ph[t]=!0)}function ob(t,s){t==null||t.v7_startTransition,t==null||t.v7_relativeSplatPath}function Or(t){let{to:s,replace:r,state:n,relative:a}=t;xn()||pt(!1);let{future:l,static:i}=c.useContext(ir),{matches:d}=c.useContext(Bs),{pathname:u}=or(),f=Ls(),N=Fc(s,_c(d,l.v7_relativeSplatPath),u,a==="path"),C=JSON.stringify(N);return c.useEffect(()=>f(JSON.parse(C),{replace:r,state:n,relative:a}),[f,C,a,r,n]),null}function cb(t){return Vj(t.context)}function Pe(t){pt(!1)}function db(t){let{basename:s="/",children:r=null,location:n,navigationType:a=Hs.Pop,navigator:l,static:i=!1,future:d}=t;xn()&&pt(!1);let u=s.replace(/^\/*/,"/"),f=c.useMemo(()=>({basename:u,navigator:l,static:i,future:ha({v7_relativeSplatPath:!1},d)}),[u,d,l,i]);typeof n=="string"&&(n=yn(n));let{pathname:N="/",search:C="",hash:b="",state:L=null,key:k="default"}=n,E=c.useMemo(()=>{let y=Oc(N,u);return y==null?null:{location:{pathname:y,search:C,hash:b,state:L,key:k},navigationType:a}},[u,N,C,b,L,k,a]);return E==null?null:c.createElement(ir.Provider,{value:f},c.createElement(Gl.Provider,{children:r,value:E}))}function ub(t){let{children:s,location:r}=t;return Gj(Po(s),r)}new Promise(()=>{});function Po(t,s){s===void 0&&(s=[]);let r=[];return c.Children.forEach(t,(n,a)=>{if(!c.isValidElement(n))return;let l=[...s,a];if(n.type===c.Fragment){r.push.apply(r,Po(n.props.children,l));return}n.type!==Pe&&pt(!1),!n.props.index||!n.props.children||pt(!1);let i={id:n.props.id||l.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(i.children=Po(n.props.children,l)),r.push(i)}),r}/**
 * React Router DOM v6.30.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Mo(){return Mo=Object.assign?Object.assign.bind():function(t){for(var s=1;s<arguments.length;s++){var r=arguments[s];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t},Mo.apply(this,arguments)}function mb(t,s){if(t==null)return{};var r={},n=Object.keys(t),a,l;for(l=0;l<n.length;l++)a=n[l],!(s.indexOf(a)>=0)&&(r[a]=t[a]);return r}function pb(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function hb(t,s){return t.button===0&&(!s||s==="_self")&&!pb(t)}function Oo(t){return t===void 0&&(t=""),new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((s,r)=>{let n=t[r];return s.concat(Array.isArray(n)?n.map(a=>[r,a]):[[r,n]])},[]))}function fb(t,s){let r=Oo(t);return s&&s.forEach((n,a)=>{r.has(a)||s.getAll(a).forEach(l=>{r.append(a,l)})}),r}const gb=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],yb="6";try{window.__reactRouterVersion=yb}catch{}const xb="startTransition",hh=ax[xb];function vb(t){let{basename:s,children:r,future:n,window:a}=t,l=c.useRef();l.current==null&&(l.current=yj({window:a,v5Compat:!0}));let i=l.current,[d,u]=c.useState({action:i.action,location:i.location}),{v7_startTransition:f}=n||{},N=c.useCallback(C=>{f&&hh?hh(()=>u(C)):u(C)},[u,f]);return c.useLayoutEffect(()=>i.listen(N),[i,N]),c.useEffect(()=>ob(n),[n]),c.createElement(db,{basename:s,children:r,location:d.location,navigationType:d.action,navigator:i,future:n})}const jb=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",bb=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,gs=c.forwardRef(function(s,r){let{onClick:n,relative:a,reloadDocument:l,replace:i,state:d,target:u,to:f,preventScrollReset:N,viewTransition:C}=s,b=mb(s,gb),{basename:L}=c.useContext(ir),k,E=!1;if(typeof f=="string"&&bb.test(f)&&(k=f,jb))try{let v=new URL(window.location.href),z=f.startsWith("//")?new URL(v.protocol+f):new URL(f),W=Oc(z.pathname,L);z.origin===v.origin&&W!=null?f=W+z.search+z.hash:E=!0}catch{}let y=qj(f,{relative:a}),p=Nb(f,{replace:i,state:d,target:u,preventScrollReset:N,relative:a,viewTransition:C});function m(v){n&&n(v),v.defaultPrevented||p(v)}return c.createElement("a",Mo({},b,{href:k||y,onClick:E||l?n:m,ref:r,target:u}))});var fh;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(fh||(fh={}));var gh;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(gh||(gh={}));function Nb(t,s){let{target:r,replace:n,state:a,preventScrollReset:l,relative:i,viewTransition:d}=s===void 0?{}:s,u=Ls(),f=or(),N=uy(t,{relative:i});return c.useCallback(C=>{if(hb(C,r)){C.preventDefault();let b=n!==void 0?n:El(f)===El(N);u(t,{replace:b,state:a,preventScrollReset:l,relative:i,viewTransition:d})}},[f,u,N,n,a,r,t,l,i,d])}function Sb(t){let s=c.useRef(Oo(t)),r=c.useRef(!1),n=or(),a=c.useMemo(()=>fb(n.search,r.current?null:s.current),[n.search]),l=Ls(),i=c.useCallback((d,u)=>{const f=Oo(typeof d=="function"?d(a):d);r.current=!0,l("?"+f,u)},[l,a]);return[a,i]}const Wc=[{section:"Kontrol",items:[{icon:"",label:"Kontrol Paneli",path:"/dashboard"}]},{section:"Operasyon",items:[{icon:"",label:"ler",path:"/isler",collapsible:!0,children:[{label:" Listesi",path:"/isler/list"},{label:"Keif/l Takvimi",path:"/isler/takvim"},{label:"retim Plan",path:"/isler/uretim-plani"},{label:"Montaj/Sevkiyat",path:"/isler/montaj-sevkiyat"},{label:"retim Takip",path:"/isler/uretim-takip",icon:"",children:[{label:"Tm Emirler",path:"/isler/uretim-takip/siparisler"},{label:" retim",path:"/isler/uretim-takip/ic-uretim"},{label:"D retim",path:"/isler/uretim-takip/dis-siparis"},{label:"Cam Emirleri",path:"/isler/uretim-takip/cam"},{label:"Sorun Takip",path:"/isler/uretim-takip/sorunlar"}]},{label:"Montaj Takip",path:"/isler/montaj-takip",icon:"",children:[{label:"Planlanan Montajlar",path:"/isler/montaj-takip/planlanan"},{label:"Bugnk Montajlar",path:"/isler/montaj-takip/bugun"},{label:"Montaj Takvimi",path:"/isler/montaj-takip/takvim"},{label:"Bekleyen Sorunlar",path:"/isler/montaj-takip/sorunlar"}]}]},{icon:"",label:"Grevler",path:"/gorevler",collapsible:!0,children:[{label:"Grev Listesi",path:"/gorevler/list"},{label:"Personel",path:"/gorevler/personel"},{label:"Ekipler",path:"/gorevler/ekipler"},{label:"Roller",path:"/gorevler/roller"}]},{icon:"",label:"Mteriler",path:"/musteriler"},{icon:"",label:"Planlama/Takvim",path:"/planlama"}]},{section:"Stok & Satnalma",items:[{icon:"",label:"Stok",path:"/stok",collapsible:!0,children:[{label:"Stok Listesi",path:"/stok/liste"},{label:"Stok Hareketleri",path:"/stok/hareketler"},{label:"Kritik Stok",path:"/stok/kritik"},{label:"Rezervasyonlar",path:"/stok/rezervasyonlar"},{label:"Renkler",path:"/stok/renkler"}]},{icon:"",label:"Satnalma",path:"/satinalma",collapsible:!0,children:[{label:"Sipariler (PO)",path:"/satinalma/siparisler"},{label:"Eksik rnler",path:"/satinalma/eksik"},{label:"Bekleyen Teslimatlar",path:"/satinalma/bekleyen"},{label:"Tedarikiler",path:"/satinalma/tedarikciler"}]}]},{section:"Finans & Evrak",items:[{icon:"",label:"rsaliye & Fatura",path:"/evrak/irsaliye-fatura"},{icon:"",label:"demeler/Kasa",path:"/finans/odemeler-kasa"}]},{section:"Dijital Ariv & Rapor",items:[{icon:"",label:"Dijital Ariv",path:"/arsiv"},{icon:"",label:"Raporlar",path:"/raporlar"}]},{section:"Sistem",items:[{icon:"",label:"Ayarlar",path:"/ayarlar"}]}],es=t=>{if(!t)return"/";const s=t.replace(/\/+$/,"");return s===""?"/":s},kb=t=>{const s=es(t);let r=" Takip Paneli";return Wc.forEach(n=>{n.items.forEach(a=>{es(a.path)===s&&(r=a.label),a.children&&a.children.forEach(l=>{es(l.path)===s&&(r=l.label),l.children&&l.children.forEach(i=>{es(i.path)===s&&(r=i.label)})})})}),r},Cb=()=>{const t=or(),s=c.useMemo(()=>es(t.pathname),[t.pathname]),[r,n]=c.useState(()=>localStorage.getItem("sidebarCollapsed")==="true"),[a,l]=c.useState(()=>{const d=localStorage.getItem("navOpenGroups");return d?JSON.parse(d):{}});c.useEffect(()=>{localStorage.setItem("sidebarCollapsed",r)},[r]),c.useEffect(()=>{localStorage.setItem("navOpenGroups",JSON.stringify(a))},[a]),c.useEffect(()=>{const d=Tb(s);d.length>0&&l(u=>{const f={...u};return d.forEach(N=>{f[N]=!0}),f})},[s]);const i=d=>{l(u=>{const f={...u};return f[d]=!f[d],f})};return e.jsxs("aside",{className:`sidebar ${r?"collapsed":""}`,id:"sidebar",children:[e.jsxs("div",{className:"sidebar-header",children:[e.jsxs("div",{className:"sidebar-logo",children:[e.jsx("div",{className:"sidebar-logo-icon",children:"T"}),e.jsx("div",{className:"sidebar-logo-text",children:" Takip Paneli"})]}),e.jsx("button",{className:"sidebar-toggle",id:"sidebarToggle",type:"button",onClick:()=>n(d=>!d),"aria-label":"Kenar ubuunu klt",children:""})]}),e.jsx("nav",{className:"sidebar-nav",children:Wc.map(d=>e.jsxs("div",{className:"nav-section",children:[e.jsx("div",{className:"nav-section-title",children:d.section}),d.items.map(u=>u.collapsible?e.jsx(fy,{item:u,openGroups:a,activePath:s,onToggle:i,level:1},u.path):e.jsx(wb,{item:u,isActive:s===es(u.path)},u.path))]},d.section))})]})},wb=({item:t,isActive:s})=>e.jsx("div",{className:"nav-item",children:e.jsxs(gs,{to:t.path,className:`nav-link ${s?"active":""}`,"aria-current":s?"page":void 0,children:[e.jsx("span",{className:"nav-link-icon",children:t.icon}),e.jsx("span",{className:"nav-link-text",children:t.label})]})}),fy=({item:t,openGroups:s,activePath:r,onToggle:n,level:a=1})=>{var N;const l=es(t.path)===r,i=gy(t,r),f=s[t.path]!==void 0?s[t.path]:i||l;return e.jsxs("div",{className:`nav-collapsible ${f?"open":""}`,style:{marginLeft:a>1?8:0},children:[e.jsxs("button",{type:"button",className:`nav-collapsible-trigger ${l?"active":""}`,onClick:()=>n(t.path),"aria-expanded":f,style:{paddingLeft:a>1?24:void 0},children:[e.jsx("span",{className:"nav-collapsible-icon",children:t.icon||(a>1?"":"")}),e.jsx("span",{className:"nav-collapsible-text",children:t.label}),e.jsx("span",{className:"nav-collapsible-arrow",children:""})]}),f&&e.jsx("div",{className:"nav-collapsible-content",children:(N=t.children)==null?void 0:N.map(C=>{if(C.children&&C.children.length>0)return e.jsx(fy,{item:C,openGroups:s,activePath:r,onToggle:n,level:a+1},C.path);const b=es(C.path)===r;return e.jsx("div",{className:"nav-item",children:e.jsxs(gs,{to:C.path,className:`nav-link ${b?"active":""}`,"aria-current":b?"page":void 0,style:{paddingLeft:a>1?32:void 0},children:[e.jsx("span",{className:"nav-link-icon",children:a>1?"":""}),e.jsx("span",{className:"nav-link-text",children:C.label})]})},C.path)})})]})},gy=(t,s)=>{if(!t.children)return!1;for(const r of t.children)if(es(r.path)===s||r.children&&gy(r,s))return!0;return!1},Tb=t=>{const s=es(t),r=[];return Wc.forEach(n=>{n.items.forEach(a=>{a.children&&a.children.forEach(l=>{es(l.path)===s&&r.push(a.path),l.children&&l.children.forEach(i=>{es(i.path)===s&&(r.push(a.path),r.push(l.path))})})})}),r},Db=({title:t})=>{const[s,r]=c.useState("");return e.jsxs("header",{className:"topbar",children:[e.jsx("div",{className:"topbar-left",children:e.jsx("h1",{className:"topbar-title",children:t})}),e.jsxs("div",{className:"topbar-right",children:[e.jsxs("div",{className:"topbar-search",children:[e.jsx("span",{className:"topbar-search-icon",children:""}),e.jsx("input",{type:"search",placeholder:"Ara...",value:s,onChange:n=>r(n.target.value),"aria-label":"Uygulama ii arama"})]}),e.jsxs("button",{className:"topbar-user",type:"button",children:[e.jsx("div",{className:"topbar-user-avatar",children:"BA"}),e.jsxs("div",{className:"topbar-user-info",children:[e.jsx("div",{className:"topbar-user-name",children:"Batuhan"}),e.jsx("div",{className:"topbar-user-role",children:"Ynetici"})]})]})]})]})},zb=()=>{const t=or(),s=kb(t.pathname);return e.jsxs("div",{id:"app",children:[e.jsx(Cb,{}),e.jsxs("div",{className:"main-content",children:[e.jsx(Db,{title:s}),e.jsx("main",{className:"page-content",children:e.jsx(cb,{})})]})]})},Qe=({value:t,onChange:s,className:r="form-input",placeholder:n="GG.AA.YYYY",min:a,max:l,disabled:i=!1,id:d,name:u,style:f={},...N})=>{const[C,b]=c.useState(""),L=c.useRef(null);c.useEffect(()=>{if(t)try{const p=new Date(t);if(!isNaN(p.getTime())){const m=String(p.getDate()).padStart(2,"0"),v=String(p.getMonth()+1).padStart(2,"0"),z=p.getFullYear();b(`${m}.${v}.${z}`)}}catch{b("")}else b("")},[t]);const k=p=>{let m=p.target.value.replace(/[^\d.]/g,"");const v=m.replace(/\./g,"");if(v.length>=2&&v.length<4?m=v.substring(0,2)+"."+v.substring(2):v.length>=4&&(m=v.substring(0,2)+"."+v.substring(2,4)+"."+v.substring(4)),m.length>10&&(m=m.substring(0,10)),b(m),m.length===10){const z=m.split(".");if(z.length===3){const W=parseInt(z[0],10),F=parseInt(z[1],10)-1,q=parseInt(z[2],10),X=new Date(q,F,W);if(!isNaN(X.getTime())&&X.getDate()===W&&X.getMonth()===F){const Q=X.toISOString().split("T")[0];s(Q)}}}else m===""&&s("")},E=p=>{const m=p.target.value;m&&s(m)},y=()=>{!i&&L.current&&(L.current.showPicker?L.current.showPicker():(L.current.focus(),L.current.click()))};return e.jsxs("div",{style:{position:"relative",display:"flex",alignItems:"center",...f},children:[e.jsx("input",{type:"text",className:r,placeholder:n,value:C,onChange:k,maxLength:10,disabled:i,id:d,name:u,style:{flex:1,paddingRight:32},...N}),e.jsx("input",{ref:L,type:"date",value:t||"",onChange:E,min:a,max:l,disabled:i,style:{position:"absolute",right:8,width:24,height:24,opacity:0,cursor:i?"not-allowed":"pointer"},title:"Takvimden se"}),e.jsx("span",{onClick:y,style:{position:"absolute",right:8,fontSize:16,cursor:i?"not-allowed":"pointer",opacity:i?.5:.7,pointerEvents:"none"},children:""})]})},ft=({size:t="medium",text:s,fullscreen:r=!1,overlay:n=!1})=>{const a={small:"loader-small",medium:"loader-medium",large:"loader-large"},l=e.jsxs("div",{className:`loader-spinner ${a[t]||a.medium}`,children:[e.jsxs("div",{className:"loader-ring",children:[e.jsx("div",{}),e.jsx("div",{}),e.jsx("div",{}),e.jsx("div",{})]}),s&&e.jsx("div",{className:"loader-text",children:s})]});return r?e.jsx("div",{className:"loader-fullscreen",children:l}):n?e.jsx("div",{className:"loader-overlay",children:l}):e.jsx("div",{className:"loader-container",children:l})},Be=({open:t,isOpen:s,title:r,children:n,actions:a,onClose:l,size:i="medium"})=>t||s?e.jsx("div",{className:"modal-backdrop",role:"dialog","aria-modal":"true","aria-label":r||"Dialog",children:e.jsxs("div",{className:`modal modal-${i}`,onClick:u=>u.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h3",{className:"modal-title",children:r}),e.jsx("button",{className:"modal-close",type:"button",onClick:l,"aria-label":"Kapat",children:""})]}),e.jsx("div",{className:"modal-body",children:n}),a?e.jsx("div",{className:"modal-footer",children:a}):null]})}):null,Fe=({title:t,subtitle:s,actions:r})=>e.jsxs("div",{className:"page-header",children:[e.jsxs("div",{className:"page-header-top",children:[e.jsx("h2",{className:"page-title",children:t}),r?e.jsx("div",{className:"page-actions",children:r}):null]}),s?e.jsx("p",{className:"page-subtitle",children:s}):null]}),Kc="http://localhost:8000",Ib="/data/mockData.json";let bs=null,En=null;const ns=async()=>bs||En||(En=fetch(Ib).then(async t=>{if(!t.ok)throw new Error("rnek veri alnamad");const s=await t.json();return bs=s,s}),En.finally(()=>{En=null})),Eb=t=>t?typeof t=="string"?t:Array.isArray(t)?t.map(r=>{var u;const n=((u=r.loc)==null?void 0:u.slice(-1)[0])||"alan",l={productCode:"rn Kodu",colorCode:"Renk Kodu",name:"rn Ad",unit:"Birim",supplierId:"Tedariki",supplierName:"Tedariki Ad",qty:"Miktar",quantity:"Miktar",itemId:"rn",critical:"Kritik Seviye",email:"E-posta",ad:"Ad",soyad:"Soyad",baslik:"Balk"}[n]||n,d={"value_error.missing":"gerekli","type_error.none.not_allowed":"bo olamaz","type_error.integer":"say olmal","type_error.float":"say olmal","type_error.string":"metin olmal"}[r.type]||r.msg||"hatal";return`${l} ${d}`}).join(", "):String(t):"Bilinmeyen hata",Ab=()=>localStorage.getItem("userId")||null,he=async(t,s={})=>{const r={"Content-Type":"application/json"},n=Ab();n&&(r["X-User-Id"]=n);const a=await fetch(`${Kc}${t}`,{headers:r,...s});if(!a.ok){const l=await a.json().catch(()=>({})),i=Eb(l.detail)||a.statusText;throw new Error(i)}return a.json()},Rb=async()=>{const t=await ns();return{stats:t.stats,activities:t.activities,priorityJobs:t.priorityJobs,weekOverview:t.weekOverview,paymentStatus:t.paymentStatus,teamStatus:t.teamStatus}},zr=async()=>he("/jobs"),Bb=async t=>he(`/jobs/${t}`),yy=async t=>he("/jobs",{method:"POST",body:JSON.stringify(t)}),Lb=async(t,s)=>he(`/jobs/${t}/measure`,{method:"PUT",body:JSON.stringify(s)}),Pb=async(t,s)=>he(`/jobs/${t}/approval/start`,{method:"POST",body:JSON.stringify(s)}),yh=async(t,s)=>he(`/jobs/${t}/approval/payment`,{method:"PUT",body:JSON.stringify({paymentPlan:s})}),_a=async(t,s)=>he(`/jobs/${t}/stock`,{method:"PUT",body:JSON.stringify(s)}),Mb=async(t,s)=>he(`/jobs/${t}/production`,{method:"PUT",body:JSON.stringify(s)}),Ob=async(t,s)=>he(`/jobs/${t}/assembly/schedule`,{method:"PUT",body:JSON.stringify(s)}),xh=async(t,s)=>he(`/jobs/${t}/estimated-assembly`,{method:"PUT",body:JSON.stringify(s)}),_b=async(t,s)=>he(`/jobs/${t}/assembly/complete`,{method:"PUT",body:JSON.stringify(s)}),Fb=async(t,s)=>he(`/jobs/${t}/finance/close`,{method:"PUT",body:JSON.stringify(s)}),vh=async(t={})=>{const s=new URLSearchParams;t.durum&&s.append("durum",t.durum),t.oncelik&&s.append("oncelik",t.oncelik),t.assigneeType&&s.append("assigneeType",t.assigneeType),t.assigneeId&&s.append("assigneeId",t.assigneeId);const r=s.toString();return he(`/tasks${r?`?${r}`:""}`)},$b=async t=>he(`/tasks/${t}`),xy=async t=>he("/tasks",{method:"POST",body:JSON.stringify(t)}),Wb=async(t,s)=>he(`/tasks/${t}`,{method:"PUT",body:JSON.stringify(s)}),Kb=async(t,s)=>he(`/tasks/${t}/durum?durum=${s}`,{method:"PATCH"}),Ub=async t=>he(`/tasks/${t}`,{method:"DELETE"}),qb=async(t,s)=>he(`/tasks/${t}/assign`,{method:"POST",body:JSON.stringify(s)}),Ql=async(t=null)=>{const s=t!==null?`?aktifMi=${t}`:"";return he(`/personnel${s}`)},Hb=async t=>he("/personnel",{method:"POST",body:JSON.stringify(t)}),Yb=async(t,s)=>he(`/personnel/${t}`,{method:"PUT",body:JSON.stringify(s)}),Vb=async(t,s)=>he(`/personnel/${t}/aktif?aktifMi=${s}`,{method:"PATCH"}),Gb=async t=>he(`/personnel/${t}`,{method:"DELETE"}),vy=async(t=null)=>{const s=t!==null?`?aktifMi=${t}`:"";return he(`/roles${s}`)},Qb=async t=>he("/roles",{method:"POST",body:JSON.stringify(t)}),Jb=async(t,s)=>he(`/roles/${t}`,{method:"PUT",body:JSON.stringify(s)}),Xb=async t=>he(`/roles/${t}`,{method:"DELETE"}),vn=async(t=null)=>{const s=t!==null?`?aktifMi=${t}`:"";return he(`/teams${s}`)},Zb=async t=>he("/teams",{method:"POST",body:JSON.stringify(t)}),e0=async(t,s)=>he(`/teams/${t}`,{method:"PUT",body:JSON.stringify(s)}),t0=async t=>he(`/teams/${t}`,{method:"DELETE"}),Ei=async t=>he(`/teams/${t}/members`),s0=async(t,s)=>he(`/teams/${t}/members?personnel_id=${s}`,{method:"POST"}),r0=async(t,s)=>he(`/teams/${t}/members/${s}`,{method:"DELETE"}),Jl=async()=>he("/customers"),Uc=async t=>he("/customers",{method:"POST",body:JSON.stringify(t)}),n0=async(t,s)=>he(`/customers/${t}`,{method:"PUT",body:JSON.stringify(s)}),a0=async t=>he(`/customers/${t}`,{method:"DELETE"}),jy=async()=>(await ns()).planningEvents||[],ja=async()=>{try{return await he("/stock/items")}catch(t){return console.warn("API stock items failed, falling back to mock",t),(await ns()).stockItems||[]}},l0=async t=>he("/stock/items",{method:"POST",body:JSON.stringify(t)}),i0=async(t,s)=>he(`/stock/items/${t}`,{method:"PUT",body:JSON.stringify(s)}),o0=async t=>he(`/stock/items/${t}`,{method:"DELETE"}),jh=async t=>he("/stock/movements",{method:"POST",body:JSON.stringify(t)}),by=async()=>{try{return await he("/stock/movements")}catch{return(await ns()).stockMovements||[]}},Ny=async()=>(await ns()).reservations||[],bh=async t=>((await ns()).jobLogs||[]).filter(r=>r.jobId===t),c0=async t=>{const s=await ns(),r={id:t.id||`LOG-${Date.now()}`,jobId:t.jobId,action:t.action||"log",detail:t.detail||"",createdAt:t.createdAt||new Date().toISOString(),meta:t.meta||{}};return s.jobLogs=[r,...s.jobLogs||[]],bs=s,r},Dt=async(t,s)=>he(`/jobs/${t}/status`,{method:"PUT",body:JSON.stringify(s)}),An=(t,s)=>{if(!bs)return;const r=bs.jobs||[];bs.jobs=r.map(n=>n.id===t?{...n,...s}:n)},d0=(t,s=[])=>{if(!bs)return;const r={id:`PO-${Date.now()}`,supplier:"Sipari Bekleniyor",total:"0",status:"Beklemede",expectedDate:new Date(Date.now()+3*24*60*60*1e3).toISOString().slice(0,10),jobId:t,lines:s.map(n=>({name:n.name,qty:n.qty,sku:n.sku,color:n.color}))};return bs.purchaseOrders=[r,...bs.purchaseOrders||[]],r},Sy=async()=>he("/colors/"),u0=async t=>he("/colors/",{method:"POST",body:JSON.stringify(t)}),m0=async t=>he(`/colors/${t}`,{method:"DELETE"}),p0=async()=>(await ns()).purchaseOrders||[],ky=async()=>(await ns()).suppliers||[],h0=async()=>(await ns()).invoices||[],f0=async()=>(await ns()).reports||[],Cy=async(t=null,s=null)=>{let r="/documents";const n=new URLSearchParams;return t&&n.append("job_id",t),s&&n.append("doc_type",s),n.toString()&&(r+=`?${n.toString()}`),he(r)},g0=async t=>he(`/documents/job/${t}`),ba=async(t,s,r,n="",a=null,l=null)=>{const i=new FormData;i.append("file",t),i.append("docType",r),s&&i.append("jobId",s),n&&i.append("description",n),a&&i.append("folderId",a),l&&i.append("supplierId",l);const d=await fetch(`${Kc}/documents/upload`,{method:"POST",body:i});if(!d.ok){const u=await d.json().catch(()=>({}));throw new Error(u.detail||"Dosya yklenemedi")}return d.json()},wy=async t=>he(`/documents/${t}`,{method:"DELETE"}),ys=t=>`${Kc}/documents/${t}/download`,Nh=async()=>he("/folders"),y0=async t=>he("/folders",{method:"POST",body:JSON.stringify(t)}),Ty=async(t="",s="")=>{const r=new URLSearchParams;return t&&r.append("productCode",t),s&&r.append("colorCode",s),he(`/stock/items/search?${r.toString()}`)},x0=async()=>he("/stock/critical"),Ai=async t=>he("/stock/bulk-reserve",{method:"POST",body:JSON.stringify(t)}),qc=async(t=null,s=null)=>{const r=new URLSearchParams;return t&&r.append("status",t),s&&r.append("supplierId",s),he(`/purchase/orders?${r.toString()}`)},_o=async t=>he("/purchase/orders",{method:"POST",body:JSON.stringify(t)}),v0=async t=>he(`/purchase/orders/${t}/send`,{method:"PUT"}),j0=async(t,s)=>he(`/purchase/orders/${t}/receive`,{method:"POST",body:JSON.stringify(s)}),b0=async t=>he(`/purchase/orders/${t}`,{method:"DELETE"}),Hc=async()=>he("/purchase/missing-items"),cr=async(t=null)=>{try{const s=t?`?type=${t}`:"";return await he(`/suppliers/${s}`)}catch{return(await ns()).suppliers||[]}},N0=async t=>he("/suppliers/",{method:"POST",body:JSON.stringify(t)}),S0=async(t,s)=>he(`/suppliers/${t}`,{method:"PUT",body:JSON.stringify(s)}),k0=async t=>he(`/suppliers/${t}`,{method:"DELETE"}),C0=async(t,s=null)=>{const r=s?`?type=${s}`:"";return he(`/suppliers/${t}/transactions${r}`)},w0=async(t,s)=>he(`/suppliers/${t}/transactions`,{method:"POST",body:JSON.stringify(s)}),Sh=async t=>he(`/suppliers/${t}/balance`),Dy=async(t={})=>{const s=new URLSearchParams;t.jobId&&s.append("jobId",t.jobId),t.roleId&&s.append("roleId",t.roleId),t.orderType&&s.append("orderType",t.orderType),t.status&&s.append("status",t.status),t.supplierId&&s.append("supplierId",t.supplierId),t.overdue&&s.append("overdue","true");const r=s.toString();return he(`/production/${r?"?"+r:""}`)},Ri=async t=>he(`/production/by-job/${t}`),Fo=async t=>he("/production/",{method:"POST",body:JSON.stringify(t)}),kh=async(t,s)=>he(`/production/${t}/plan`,{method:"PATCH",body:JSON.stringify(s)}),T0=async t=>he(`/production/${t}`,{method:"DELETE"}),zy=async(t,s)=>he(`/production/${t}/delivery`,{method:"POST",body:JSON.stringify(s)}),D0=async(t,s,r)=>he(`/production/${t}/issues/${s}/resolve`,{method:"POST",body:JSON.stringify(r)}),z0=async()=>he("/production/summary"),Iy=async()=>he("/production/alerts"),Ey=async()=>he("/production/combinations"),I0=async()=>he("/settings"),E0=async t=>he("/settings/company",{method:"PUT",body:JSON.stringify(t)}),jn=async(t=!1)=>he(`/settings/job-roles${t?"?active_only=true":""}`),A0=async t=>he("/settings/job-roles",{method:"POST",body:JSON.stringify(t)}),R0=async(t,s)=>he(`/settings/job-roles/${t}`,{method:"PUT",body:JSON.stringify(s)}),B0=async t=>he(`/settings/job-roles/${t}`,{method:"DELETE"}),Yc=async()=>he("/settings/glass-types"),L0=async t=>he("/settings/glass-types",{method:"POST",body:JSON.stringify(t)}),P0=async t=>he(`/settings/glass-types/${t}`,{method:"DELETE"}),Vc=async(t={})=>{const s=new URLSearchParams;t.jobId&&s.append("jobId",t.jobId),t.roleId&&s.append("roleId",t.roleId),t.teamId&&s.append("teamId",t.teamId),t.status&&s.append("status",t.status),t.dateFrom&&s.append("dateFrom",t.dateFrom),t.dateTo&&s.append("dateTo",t.dateTo),t.overdue&&s.append("overdue","true");const r=s.toString();return he(`/assembly/tasks${r?"?"+r:""}`)},M0=async(t=null)=>{const s=t?`?teamId=${t}`:"";return he(`/assembly/tasks/today${s}`)},O0=async t=>he(`/assembly/tasks/by-job/${t}`),_0=async t=>he(`/assembly/tasks/create-for-job/${t}`,{method:"POST"}),Ay=async(t,s)=>he(`/assembly/tasks/${t}`,{method:"PUT",body:JSON.stringify(s)}),F0=async(t,s={})=>he(`/assembly/tasks/${t}/start`,{method:"POST",body:JSON.stringify(s)}),$0=async(t,s={})=>he(`/assembly/tasks/${t}/complete`,{method:"POST",body:JSON.stringify(s)}),W0=async(t,s={})=>he(`/assembly/tasks/complete-all/${t}`,{method:"POST",body:JSON.stringify(s)}),K0=async(t,s)=>he(`/assembly/tasks/${t}/issue`,{method:"POST",body:JSON.stringify(s)}),Ry=async(t,s)=>he(`/assembly/tasks/${t}/issues/${s}/resolve`,{method:"POST"}),U0=async()=>he("/assembly/summary"),Ch=async(t,s)=>he(`/assembly/team-availability?teamId=${t}&date=${s}`),fr={olcu:{label:"l Tasla",icon:"",color:"#3b82f6"},teknik:{label:"Teknik izim",icon:"",color:"#8b5cf6"},sozlesme:{label:"Szleme",icon:"",color:"#10b981"},teklif:{label:"Teklif",icon:"",color:"#f59e0b"},montaj:{label:"Montaj",icon:"",color:"#ec4899"},irsaliye:{label:"rsaliye",icon:"",color:"#14b8a6"},servis_oncesi:{label:"Servis ncesi",icon:"",color:"#f97316"},servis_sonrasi:{label:"Servis Sonras",icon:"",color:"#10b981"},arac:{label:"Ara Belgesi",icon:"",color:"#f59e0b"},makine:{label:"Makine Belgesi",icon:"",color:"#8b5cf6"},ofis:{label:"Ofis Belgesi",icon:"",color:"#ec4899"},genel:{label:"Genel Belge",icon:"",color:"#6b7280"},fiyat_listesi:{label:"Fiyat Listesi",icon:"",color:"#10b981"},kalite:{label:"Kalite Belgesi",icon:"",color:"#3b82f6"},tedarikci_sozlesme:{label:"Tedariki Szleme",icon:"",color:"#f97316"},diger:{label:"Dier",icon:"",color:"#6b7280"}},wh=t=>t?t.startsWith("measure_")?"olcu":t.startsWith("technical_")?"teknik":t.startsWith("servis")||fr[t]?t:"diger":"diger",q0=[{id:"jobs",label:" Belgeleri",icon:"",color:"#3b82f6"},{id:"company",label:"irket Belgeleri",icon:"",color:"#10b981"},{id:"suppliers",label:"Tedariki Belgeleri",icon:"",color:"#f97316"}],Th=t=>{if(!t)return"-";try{return new Date(t).toLocaleDateString("tr-TR",{day:"2-digit",month:"2-digit",year:"numeric"})}catch{return t}},Bi=t=>{if(!t)return"-";const s=["B","KB","MB","GB"],r=Math.floor(Math.log(t)/Math.log(1024));return`${(t/Math.pow(1024,r)).toFixed(1)} ${s[r]}`},H0=()=>{var se,oe;const[t,s]=c.useState([]),[r,n]=c.useState([]),[a,l]=c.useState([]),[i,d]=c.useState([]),[u,f]=c.useState(!0),[N,C]=c.useState(""),[b,L]=c.useState("jobs"),[k,E]=c.useState(null),[y,p]=c.useState(""),[m,v]=c.useState(null),[z,W]=c.useState(!1),[F,q]=c.useState(!1),[X,Q]=c.useState(!1),[A,ue]=c.useState(!1),[Z,ae]=c.useState({file:null,docType:"genel",description:"",jobId:"",supplierId:"",folderId:""}),[$,ne]=c.useState({name:"",icon:"",color:"#6b7280"});c.useEffect(()=>{U()},[]);const U=async()=>{try{f(!0),C("");const[O,ce,je,we]=await Promise.all([Cy().catch(()=>[]),zr().catch(()=>[]),ky().catch(()=>[]),Nh().catch(()=>[])]);s(O),n(ce),l(je),d(we)}catch(O){C(O.message||"Ariv alnamad")}finally{f(!1)}},pe=O=>{var je;const ce=r.find(we=>we.id===O);return ce?{title:ce.title,customer:((je=ce.customer)==null?void 0:je.name)||ce.customerName}:null},V=O=>{const ce=a.find(je=>je.id===O);return ce?ce.name:null},D=c.useMemo(()=>{let O=t;if(b==="jobs"?O=O.filter(ce=>ce.jobId&&!ce.supplierId&&!ce.folderId):b==="company"?(O=O.filter(ce=>ce.folderId&&!ce.jobId&&!ce.supplierId),k&&(O=O.filter(ce=>ce.folderId===k))):b==="suppliers"&&(O=O.filter(ce=>ce.supplierId)),y){const ce=y.toLowerCase();O=O.filter(je=>{var T,re,ke,Ie;const we=pe(je.jobId),Ee=V(je.supplierId);return((T=je.originalName)==null?void 0:T.toLowerCase().includes(ce))||((re=je.description)==null?void 0:re.toLowerCase().includes(ce))||((ke=we==null?void 0:we.title)==null?void 0:ke.toLowerCase().includes(ce))||((Ie=we==null?void 0:we.customer)==null?void 0:Ie.toLowerCase().includes(ce))||(Ee==null?void 0:Ee.toLowerCase().includes(ce))})}return O},[t,b,k,y,r,a]),S=c.useMemo(()=>{const O=i.find(ce=>ce.id==="FOLDER-SIRKET");return(O==null?void 0:O.subfolders)||[]},[i]),g=c.useMemo(()=>{const O=t.filter(we=>we.jobId&&!we.supplierId&&!we.folderId).length,ce=t.filter(we=>we.folderId&&!we.jobId&&!we.supplierId).length,je=t.filter(we=>we.supplierId).length;return{total:t.length,jobDocs:O,companyDocs:ce,supplierDocs:je}},[t]),x=async O=>{if(window.confirm("Bu dkman silmek istediinize emin misiniz?"))try{Q(!0),await wy(O),s(ce=>ce.filter(je=>je.id!==O)),v(null)}catch(ce){alert(ce.message||"Silinemedi")}finally{Q(!1)}},M=async()=>{if(!Z.file){alert("Ltfen bir dosya sein");return}if(!Z.jobId&&!Z.folderId&&!Z.supplierId){alert("Ltfen bir i, klasr veya tedariki sein");return}try{ue(!0);const O=await ba(Z.file,Z.jobId||null,Z.docType,Z.description,Z.folderId||null,Z.supplierId||null);s(ce=>[O,...ce]),W(!1),ae({file:null,docType:"genel",description:"",jobId:"",supplierId:"",folderId:""})}catch(O){alert(O.message||"Ykleme baarsz")}finally{ue(!1)}},w=async()=>{if(!$.name.trim()){alert("Ltfen klasr ad girin");return}try{const O=await y0({name:$.name,icon:$.icon,color:$.color,category:"company",parentId:"FOLDER-SIRKET"}),ce=await Nh();d(ce),q(!1),ne({name:"",icon:"",color:"#6b7280"})}catch(O){alert(O.message||"Klasr oluturulamad")}},j=O=>O==null?void 0:O.startsWith("image/"),B=O=>O==="application/pdf",K=c.useMemo(()=>b==="jobs"?["olcu","teknik","sozlesme","teklif","montaj","irsaliye","servis_oncesi","servis_sonrasi","diger"]:b==="company"?["arac","makine","ofis","genel"]:["fiyat_listesi","kalite","tedarikci_sozlesme","diger"],[b]);return e.jsxs("div",{className:"container",children:[e.jsx(Fe,{title:"Dijital Ariv",subtitle:"Tm irket belgelerini tek yerden ynetin",actions:e.jsx("button",{className:"btn btn-primary",onClick:()=>{ae({file:null,docType:b==="jobs"||b==="company"?"genel":"fiyat_listesi",description:"",jobId:"",supplierId:"",folderId:b==="company"&&k?k:""}),W(!0)},children:" Belge Ykle"})}),e.jsx("div",{className:"card",style:{marginBottom:16,padding:0},children:e.jsx("div",{style:{display:"flex",borderBottom:"1px solid var(--color-border)"},children:q0.map(O=>e.jsxs("button",{onClick:()=>{L(O.id),E(null),p("")},style:{flex:1,padding:"16px 20px",background:b===O.id?`${O.color}10`:"transparent",border:"none",borderBottom:b===O.id?`3px solid ${O.color}`:"3px solid transparent",cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:8,fontWeight:b===O.id?600:400,color:b===O.id?O.color:"var(--color-text-secondary)",transition:"all 0.2s"},children:[e.jsx("span",{style:{fontSize:20},children:O.icon}),e.jsx("span",{children:O.label}),e.jsx("span",{className:"badge",style:{background:b===O.id?O.color:"var(--color-bg-secondary)",color:b===O.id?"white":"var(--color-text-muted)",fontSize:11},children:O.id==="jobs"?g.jobDocs:O.id==="company"?g.companyDocs:g.supplierDocs})]},O.id))})}),e.jsxs("div",{style:{display:"flex",gap:16},children:[b==="company"&&e.jsx("div",{style:{width:250,flexShrink:0},children:e.jsxs("div",{className:"card",style:{padding:12},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsx("h4",{style:{margin:0,fontSize:14},children:" Klasrler"}),e.jsx("button",{className:"btn btn-sm btn-secondary",onClick:()=>q(!0),title:"Yeni Klasr",style:{padding:"4px 8px",fontSize:12},children:"+ Ekle"})]}),e.jsxs("div",{onClick:()=>E(null),style:{padding:"10px 12px",borderRadius:8,cursor:"pointer",background:k?"transparent":"var(--color-primary-light)",marginBottom:4,display:"flex",alignItems:"center",gap:8,transition:"background 0.2s"},children:[e.jsx("span",{children:""}),e.jsx("span",{style:{fontWeight:k?400:600},children:"Tm Belgeler"})]}),S.map(O=>e.jsxs("div",{onClick:()=>E(O.id),style:{padding:"10px 12px",borderRadius:8,cursor:"pointer",background:k===O.id?`${O.color}15`:"transparent",marginBottom:4,display:"flex",alignItems:"center",gap:8,borderLeft:k===O.id?`3px solid ${O.color}`:"3px solid transparent",transition:"all 0.2s"},children:[e.jsx("span",{children:O.icon}),e.jsx("span",{style:{fontWeight:k===O.id?600:400},children:O.name})]},O.id))]})}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{className:"card",style:{marginBottom:16,padding:12},children:e.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center"},children:[e.jsx("div",{className:"form-group",style:{flex:1,margin:0},children:e.jsx("input",{className:"form-input",type:"text",placeholder:" Dosya ad, mteri, tedariki ara...",value:y,onChange:O=>p(O.target.value)})}),y&&e.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>p(""),children:" Temizle"})]})}),u?e.jsx(ft,{text:"Belgeler ykleniyor..."}):N?e.jsxs("div",{className:"card error-card",children:[e.jsx("div",{className:"error-title",children:"Hata"}),e.jsx("div",{className:"error-message",children:N})]}):D.length===0?e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",style:{textAlign:"center",padding:48},children:[e.jsx("div",{style:{fontSize:48,marginBottom:16},children:""}),e.jsx("h3",{style:{margin:"0 0 8px 0"},children:"Belge Bulunamad"}),e.jsxs("p",{className:"text-muted",children:[b==="jobs"&&"Henz i belgesi yklenmemi.",b==="company"&&"Bu klasrde belge yok.",b==="suppliers"&&"Henz tedariki belgesi yklenmemi."]}),e.jsx("button",{className:"btn btn-primary",style:{marginTop:16},onClick:()=>W(!0),children:" lk Belgeyi Ykle"})]})}):e.jsx("div",{className:"card",children:e.jsx("div",{className:"table-container",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{width:40}}),e.jsx("th",{children:"Dosya Ad"}),e.jsx("th",{children:"Kategori"}),b==="jobs"&&e.jsx("th",{children:" / Mteri"}),b==="suppliers"&&e.jsx("th",{children:"Tedariki"}),b==="company"&&e.jsx("th",{children:"Klasr"}),e.jsx("th",{children:"Boyut"}),e.jsx("th",{children:"Tarih"}),e.jsx("th",{style:{width:120},children:"lemler"})]})}),e.jsx("tbody",{children:D.map(O=>{const ce=wh(O.type),je=fr[ce]||fr.diger,we=pe(O.jobId),Ee=V(O.supplierId),T=S.find(re=>re.id===O.folderId);return e.jsxs("tr",{style:{cursor:"pointer"},onClick:()=>v(O),children:[e.jsx("td",{children:e.jsx("span",{style:{fontSize:20},children:je.icon})}),e.jsxs("td",{children:[e.jsx("strong",{children:O.originalName}),O.description&&e.jsx("div",{className:"text-muted",style:{fontSize:12},children:O.description})]}),e.jsx("td",{children:e.jsx("span",{className:"badge",style:{background:`${je.color}20`,color:je.color},children:je.label})}),b==="jobs"&&e.jsx("td",{children:we?e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{fontWeight:500},children:we.title}),e.jsx("div",{className:"text-muted",style:{fontSize:12},children:we.customer})]}):"-"}),b==="suppliers"&&e.jsx("td",{children:Ee||"-"}),b==="company"&&e.jsx("td",{children:T?e.jsxs("span",{style:{display:"flex",alignItems:"center",gap:4},children:[T.icon," ",T.name]}):"-"}),e.jsx("td",{className:"text-muted",children:Bi(O.size)}),e.jsx("td",{children:Th(O.uploadedAt)}),e.jsx("td",{onClick:re=>re.stopPropagation(),children:e.jsxs("div",{style:{display:"flex",gap:4},children:[e.jsx("a",{href:ys(O.id),target:"_blank",rel:"noopener noreferrer",className:"btn btn-primary btn-small",title:"ndir",children:""}),e.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>v(O),title:"nizle",children:""}),e.jsx("button",{className:"btn btn-danger btn-small",onClick:()=>x(O.id),title:"Sil",children:""})]})})]},O.id)})})]})})}),!u&&D.length>0&&e.jsx("div",{style:{marginTop:12,textAlign:"right"},children:e.jsxs("span",{className:"text-muted",style:{fontSize:12},children:[D.length," belge gsteriliyor"]})})]})]}),e.jsx(Be,{isOpen:!!m,onClose:()=>v(null),title:(m==null?void 0:m.originalName)||"Belge nizleme",size:"lg",children:m&&e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-4",style:{gap:16,marginBottom:16},children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-muted",style:{fontSize:12},children:"Kategori"}),e.jsx("div",{style:{fontWeight:600},children:(()=>{const O=wh(m.type),ce=fr[O]||fr.diger;return`${ce.icon} ${ce.label}`})()})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-muted",style:{fontSize:12},children:"Boyut"}),e.jsx("div",{style:{fontWeight:600},children:Bi(m.size)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-muted",style:{fontSize:12},children:"Yklenme Tarihi"}),e.jsx("div",{style:{fontWeight:600},children:Th(m.uploadedAt)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-muted",style:{fontSize:12},children:"Referans"}),e.jsxs("div",{style:{fontWeight:600},children:[m.jobId&&((se=pe(m.jobId))==null?void 0:se.title),m.supplierId&&V(m.supplierId),m.folderId&&((oe=S.find(O=>O.id===m.folderId))==null?void 0:oe.name)]})]})]}),m.description&&e.jsxs("div",{style:{marginBottom:16,padding:12,background:"var(--color-bg-secondary)",borderRadius:8},children:[e.jsx("div",{className:"text-muted",style:{fontSize:12,marginBottom:4},children:"Aklama"}),e.jsx("div",{children:m.description})]}),e.jsx("div",{style:{border:"1px solid var(--color-border)",borderRadius:8,overflow:"hidden",minHeight:300},children:j(m.mimeType)?e.jsx("img",{src:ys(m.id),alt:m.originalName,style:{width:"100%",height:"auto",display:"block"}}):B(m.mimeType)?e.jsx("iframe",{src:ys(m.id),title:m.originalName,style:{width:"100%",height:500,border:"none"}}):e.jsxs("div",{style:{padding:48,textAlign:"center"},children:[e.jsx("div",{style:{fontSize:64,marginBottom:16},children:""}),e.jsx("h3",{style:{margin:"0 0 8px 0"},children:"nizleme Mevcut Deil"}),e.jsx("p",{className:"text-muted",children:"Bu dosya tr iin nizleme desteklenmiyor."})]})}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:16,paddingTop:16,borderTop:"1px solid var(--color-border)"},children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>v(null),children:"Kapat"}),e.jsx("a",{href:ys(m.id),target:"_blank",rel:"noopener noreferrer",className:"btn btn-primary",children:" ndir"}),e.jsx("button",{className:"btn btn-danger",onClick:()=>x(m.id),disabled:X,children:" Sil"})]})]})}),e.jsx(Be,{isOpen:z,onClose:()=>W(!1),title:" Belge Ykle",size:"md",children:e.jsxs("div",{style:{padding:8},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Dosya *"}),e.jsx("input",{type:"file",className:"form-input",accept:".pdf,.png,.jpg,.jpeg,.doc,.docx,.xls,.xlsx,.dwg,.dxf,.zip,.rar",onChange:O=>ae(ce=>{var je;return{...ce,file:((je=O.target.files)==null?void 0:je[0])||null}})}),Z.file&&e.jsxs("div",{className:"text-muted",style:{fontSize:12,marginTop:4},children:[Z.file.name," (",Bi(Z.file.size),")"]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Belge Tr *"}),e.jsx("select",{className:"form-select",value:Z.docType,onChange:O=>ae(ce=>({...ce,docType:O.target.value})),children:K.map(O=>{var ce,je;return e.jsxs("option",{value:O,children:[(ce=fr[O])==null?void 0:ce.icon," ",(je=fr[O])==null?void 0:je.label]},O)})})]}),b==="jobs"&&e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:" *"}),e.jsxs("select",{className:"form-select",value:Z.jobId,onChange:O=>ae(ce=>({...ce,jobId:O.target.value})),children:[e.jsx("option",{value:"",children:"--  Sein --"}),r.map(O=>{var ce;return e.jsxs("option",{value:O.id,children:[O.title," - ",((ce=O.customer)==null?void 0:ce.name)||O.customerName]},O.id)})]})]}),b==="company"&&e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Klasr *"}),e.jsxs("select",{className:"form-select",value:Z.folderId,onChange:O=>ae(ce=>({...ce,folderId:O.target.value})),children:[e.jsx("option",{value:"",children:"-- Klasr Sein --"}),S.map(O=>e.jsxs("option",{value:O.id,children:[O.icon," ",O.name]},O.id))]})]}),b==="suppliers"&&e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Tedariki *"}),e.jsxs("select",{className:"form-select",value:Z.supplierId,onChange:O=>ae(ce=>({...ce,supplierId:O.target.value})),children:[e.jsx("option",{value:"",children:"-- Tedariki Sein --"}),a.map(O=>e.jsx("option",{value:O.id,children:O.name},O.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Aklama (Opsiyonel)"}),e.jsx("textarea",{className:"form-input",placeholder:"Belge hakknda ksa aklama...",value:Z.description,onChange:O=>ae(ce=>({...ce,description:O.target.value})),rows:2})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:20,paddingTop:16,borderTop:"1px solid var(--color-border)"},children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>W(!1),disabled:A,children:"ptal"}),e.jsx("button",{className:"btn btn-primary",onClick:M,disabled:A||!Z.file,children:A?" Ykleniyor...":" Ykle"})]})]})}),e.jsx(Be,{isOpen:F,onClose:()=>q(!1),title:" Yeni Klasr Olutur",size:"sm",children:e.jsxs("div",{style:{padding:8},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Klasr Ad *"}),e.jsx("input",{type:"text",className:"form-input",placeholder:"rn: Szlemeler",value:$.name,onChange:O=>ne(ce=>({...ce,name:O.target.value}))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"kon"}),e.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:["","","","","","","","","",""].map(O=>e.jsx("button",{type:"button",onClick:()=>ne(ce=>({...ce,icon:O})),style:{padding:"8px 12px",fontSize:20,border:$.icon===O?"2px solid var(--color-primary)":"1px solid var(--color-border)",borderRadius:8,background:$.icon===O?"var(--color-primary-light)":"transparent",cursor:"pointer"},children:O},O))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Renk"}),e.jsx("div",{style:{display:"flex",gap:8},children:["#3b82f6","#10b981","#f59e0b","#8b5cf6","#ec4899","#f97316","#6b7280"].map(O=>e.jsx("button",{type:"button",onClick:()=>ne(ce=>({...ce,color:O})),style:{width:32,height:32,borderRadius:"50%",background:O,border:$.color===O?"3px solid #1f2937":"none",cursor:"pointer"}},O))})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8,marginTop:20,paddingTop:16,borderTop:"1px solid var(--color-border)"},children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>q(!1),children:"ptal"}),e.jsx("button",{className:"btn btn-primary",onClick:w,disabled:!$.name.trim(),children:" Olutur"})]})]})})]})},br=({value:t="",onChange:s,onSelect:r,options:n=[],onSearch:a,placeholder:l="Ara...",displayKey:i="name",valueKey:d="id",renderOption:u,allowCreate:f=!1,createLabel:N="Yeni ekle",onCreate:C,disabled:b=!1,required:L=!1,error:k="",label:E="",className:y="",inputClassName:p="",debounceMs:m=200,minChars:v=1,maxResults:z=10,autoFocus:W=!1,tabIndex:F=0})=>{const[q,X]=c.useState(t),[Q,A]=c.useState(!1),[ue,Z]=c.useState(-1),[ae,$]=c.useState([]),[ne,U]=c.useState(!1),pe=c.useRef(null),V=c.useRef(null),D=c.useRef(null);c.useEffect(()=>{X(t)},[t]);const S=c.useCallback(async B=>{if(!B||B.length<v){$([]),A(!1);return}U(!0);try{let K;if(a)K=await a(B);else{const se=B.toLowerCase();K=n.filter(oe=>{const O=typeof oe=="string"?oe:oe[i]||"",ce=typeof oe=="string"?oe:String(oe[d]||"");return O.toLowerCase().includes(se)||ce.toLowerCase().includes(se)})}$(K.slice(0,z)),A(K.length>0||f&&B.length>0),Z(-1)}catch(K){console.error("Autocomplete search error:",K),$([])}finally{U(!1)}},[n,a,i,d,v,z,f]),g=B=>{const K=B.target.value;X(K),s==null||s(K),D.current&&clearTimeout(D.current),D.current=setTimeout(()=>{S(K)},m)},x=(B,K=!1)=>{const se=typeof B=="string"?B:B[i]||"",oe=typeof B=="string"?B:B[d]||"";if(X(oe||se),A(!1),Z(-1),s==null||s(oe||se),r==null||r(B,oe),K&&pe.current){const O=pe.current.closest("form");if(O){const ce=Array.from(O.querySelectorAll("input, select, textarea, button")),je=ce.indexOf(pe.current);je>=0&&je<ce.length-1&&setTimeout(()=>{var we;return(we=ce[je+1])==null?void 0:we.focus()},10)}}},M=()=>{C&&q&&(C(q),A(!1))},w=B=>{if(!(!Q&&B.key!=="ArrowDown"&&B.key!=="Enter"))switch(B.key){case"ArrowDown":if(B.preventDefault(),!Q&&q.length>=v)S(q);else{const K=f?ae.length:ae.length-1;Z(se=>Math.min(se+1,K))}break;case"ArrowUp":B.preventDefault(),Z(K=>Math.max(K-1,-1));break;case"Enter":B.preventDefault(),ue>=0&&ue<ae.length?x(ae[ue]):ue===ae.length&&f?M():ae.length===1&&x(ae[0]);break;case"Tab":Q&&ae.length>0?ue>=0&&ue<ae.length?x(ae[ue],!0):ae.length===1?x(ae[0],!0):ue===ae.length&&f&&M():A(!1);break;case"Escape":A(!1),Z(-1);break}};c.useEffect(()=>{const B=K=>{pe.current&&!pe.current.contains(K.target)&&V.current&&!V.current.contains(K.target)&&A(!1)};return document.addEventListener("mousedown",B),()=>document.removeEventListener("mousedown",B)},[]),c.useEffect(()=>{if(V.current&&ue>=0){const B=V.current.querySelectorAll(".autocomplete-item");B[ue]&&B[ue].scrollIntoView({block:"nearest"})}},[ue]),c.useEffect(()=>()=>{D.current&&clearTimeout(D.current)},[]);const j=(B,K)=>{if(u)return u(B,K);const se=typeof B=="string"?B:B[i]||"",oe=typeof B=="string"?"":B[d]||"";return e.jsxs("div",{className:"autocomplete-option-content",children:[e.jsx("span",{className:"autocomplete-option-value",children:oe}),e.jsx("span",{className:"autocomplete-option-label",children:se})]})};return e.jsxs("div",{className:`autocomplete-container ${y}`,children:[E&&e.jsxs("label",{className:"form-label",children:[E,L&&e.jsx("span",{style:{color:"var(--color-danger)"},children:" *"})]}),e.jsxs("div",{className:"autocomplete-input-wrapper",ref:pe,children:[e.jsx("input",{type:"text",className:`form-input ${p} ${k?"input-error":""}`,value:q,onChange:g,onKeyDown:w,onFocus:()=>{q.length>=v&&S(q)},placeholder:l,disabled:b,required:L,autoFocus:W,tabIndex:F,autoComplete:"off"}),ne&&e.jsx("div",{className:"autocomplete-loading",children:e.jsx("span",{className:"spinner-small"})})]}),Q&&e.jsxs("div",{className:"autocomplete-dropdown",ref:V,children:[ae.length>0?e.jsx(e.Fragment,{children:ae.map((B,K)=>e.jsx("div",{className:`autocomplete-item ${K===ue?"highlighted":""}`,onClick:()=>x(B),onMouseEnter:()=>Z(K),children:j(B,K)},typeof B=="string"?B:B[d]||K))}):null,f&&q&&e.jsxs("div",{className:`autocomplete-item autocomplete-create ${ue===ae.length?"highlighted":""}`,onClick:M,onMouseEnter:()=>Z(ae.length),children:[e.jsx("span",{className:"autocomplete-create-icon",children:""}),e.jsxs("span",{children:[N,': "',q,'"']})]})]}),k&&e.jsx("div",{className:"form-error",children:k})]})},Y0=[{id:"company",label:"irket Bilgileri",icon:""},{id:"general",label:"Genel Ayarlar",icon:""},{id:"jobRoles",label:" Kollar",icon:""},{id:"glassTypes",label:"Cam Tipleri",icon:""}],Dh=[{value:"internal",label:" retim",color:"var(--success)"},{value:"external",label:"D Sipari",color:"var(--warning)"}],V0=()=>{const[t,s]=c.useState("company"),[r,n]=c.useState(!0),[a,l]=c.useState(""),[i,d]=c.useState({}),[u,f]=c.useState([]),[N,C]=c.useState([]),[b,L]=c.useState([]),[k,E]=c.useState({name:"",logo:null,logoUrl:"",address:"",city:"",phone:"",phone2:"",email:"",website:"",taxOffice:"",taxNumber:"",iban:""}),[y,p]=c.useState(!1),[m,v]=c.useState(!1),[z,W]=c.useState(null),[F,q]=c.useState({name:"",description:"",productionType:"internal",requiresGlass:!1,defaultGlassSupplier:null,defaultSupplier:null,estimatedDays:5,active:!0,assemblyStages:[]}),[X,Q]=c.useState(!1),[A,ue]=c.useState({name:"",code:""}),[Z,ae]=c.useState(!1);c.useEffect(()=>{$()},[]);const $=async()=>{try{n(!0),l("");const[S,g,x,M]=await Promise.all([I0(),jn(),Yc(),cr()]);d(S),f(g||[]),C(x||[]),L(M||[]),S.company&&E(w=>({...w,...S.company}))}catch(S){l(S.message||"Ayarlar alnamad")}finally{n(!1)}},ne=(S=null)=>{S?(W(S),q({name:S.name||"",description:S.description||"",productionType:S.productionType||"internal",requiresGlass:S.requiresGlass||!1,defaultGlassSupplier:S.defaultGlassSupplier||null,defaultSupplier:S.defaultSupplier||null,estimatedDays:S.estimatedDays||5,active:S.active!==!1,assemblyStages:S.assemblyStages||[]})):(W(null),q({name:"",description:"",productionType:"internal",requiresGlass:!1,defaultGlassSupplier:null,defaultSupplier:null,estimatedDays:5,active:!0,assemblyStages:[]})),v(!0)},U=async()=>{if(!F.name.trim()){alert(" kolu ad gerekli");return}try{ae(!0),z?await R0(z.id,F):await A0(F),await $(),v(!1)}catch(S){alert(S.message)}finally{ae(!1)}},pe=async S=>{if(confirm("Bu i kolunu pasif yapmak istediinize emin misiniz?"))try{ae(!0),await B0(S),await $()}catch(g){alert(g.message)}finally{ae(!1)}},V=async()=>{if(!A.name.trim()||!A.code.trim()){alert("Cam ad ve kodu gerekli");return}try{ae(!0),await L0(A),await $(),Q(!1),ue({name:"",code:""})}catch(S){alert(S.message)}finally{ae(!1)}},D=async S=>{if(confirm("Bu cam tipini silmek istediinize emin misiniz?"))try{ae(!0),await P0(S),await $()}catch(g){alert(g.message)}finally{ae(!1)}};return r?e.jsxs("div",{children:[e.jsx(Fe,{title:"Ayarlar",subtitle:"Sistem ve i kolu yaplandrmas"}),e.jsx("div",{className:"card subtle-card",children:"Ayarlar ykleniyor..."})]}):a?e.jsxs("div",{children:[e.jsx(Fe,{title:"Ayarlar",subtitle:"Sistem ve i kolu yaplandrmas"}),e.jsxs("div",{className:"card error-card",children:[e.jsx("div",{className:"error-title",children:"Ayarlar alnamad"}),e.jsx("div",{className:"error-message",children:a})]})]}):e.jsxs("div",{children:[e.jsx(Fe,{title:"Ayarlar",subtitle:"Sistem ve i kolu yaplandrmas"}),e.jsx("div",{className:"card",style:{marginBottom:"1.5rem"},children:e.jsx("div",{style:{display:"flex",gap:"0.5rem",padding:"0.5rem"},children:Y0.map(S=>e.jsxs("button",{className:`btn ${t===S.id?"btn-primary":"btn-ghost"}`,onClick:()=>s(S.id),style:{flex:1},children:[e.jsx("span",{style:{marginRight:"0.5rem"},children:S.icon}),S.label]},S.id))})}),t==="company"&&e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("h3",{className:"card-title",children:" irket Bilgileri"}),e.jsx("p",{className:"text-muted",style:{margin:0,fontSize:12},children:"PDF ve belgelerde kullanlacak irket bilgileri"})]}),e.jsx("button",{className:"btn btn-primary",onClick:async()=>{try{p(!0),await E0(k),alert("irket bilgileri kaydedildi!")}catch(S){alert("Hata: "+(S.message||"Kaydedilemedi"))}finally{p(!1)}},disabled:y,children:y?"Kaydediliyor...":" Kaydet"})]}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1.5rem"},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",children:"irket Ad *"}),e.jsx("input",{type:"text",className:"form-input",value:k.name||"",onChange:S=>E(g=>({...g,name:S.target.value})),placeholder:"ABC PVC Sistemleri Ltd. ti."})]}),e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",children:"Adres"}),e.jsx("textarea",{className:"form-input",value:k.address||"",onChange:S=>E(g=>({...g,address:S.target.value})),placeholder:"Sanayi Mahallesi, 123. Sokak No:45",rows:2})]}),e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",children:"ehir / le"}),e.jsx("input",{type:"text",className:"form-input",value:k.city||"",onChange:S=>E(g=>({...g,city:S.target.value})),placeholder:"stanbul / mraniye"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",children:"Telefon"}),e.jsx("input",{type:"text",className:"form-input",value:k.phone||"",onChange:S=>E(g=>({...g,phone:S.target.value})),placeholder:"+90 212 555 00 00"})]}),e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",children:"Telefon 2"}),e.jsx("input",{type:"text",className:"form-input",value:k.phone2||"",onChange:S=>E(g=>({...g,phone2:S.target.value})),placeholder:"+90 532 555 00 00"})]})]})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:[e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",children:"E-posta"}),e.jsx("input",{type:"email",className:"form-input",value:k.email||"",onChange:S=>E(g=>({...g,email:S.target.value})),placeholder:"info@abcpvc.com"})]}),e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",children:"Web Sitesi"}),e.jsx("input",{type:"text",className:"form-input",value:k.website||"",onChange:S=>E(g=>({...g,website:S.target.value})),placeholder:"www.abcpvc.com"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"1rem"},children:[e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",children:"Vergi Dairesi"}),e.jsx("input",{type:"text",className:"form-input",value:k.taxOffice||"",onChange:S=>E(g=>({...g,taxOffice:S.target.value})),placeholder:"mraniye"})]}),e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",children:"Vergi No"}),e.jsx("input",{type:"text",className:"form-input",value:k.taxNumber||"",onChange:S=>E(g=>({...g,taxNumber:S.target.value})),placeholder:"1234567890"})]})]}),e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",children:"IBAN"}),e.jsx("input",{type:"text",className:"form-input",value:k.iban||"",onChange:S=>E(g=>({...g,iban:S.target.value})),placeholder:"TR00 0000 0000 0000 0000 0000 00"})]}),e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",children:"Logo"}),e.jsx("div",{style:{border:"2px dashed var(--color-border)",borderRadius:8,padding:16,textAlign:"center",background:"var(--color-bg-secondary)"},children:k.logoUrl?e.jsxs("div",{children:[e.jsx("img",{src:k.logoUrl,alt:"Logo",style:{maxWidth:150,maxHeight:80,marginBottom:8}}),e.jsx("br",{}),e.jsx("button",{className:"btn btn-danger btn-small",onClick:()=>E(S=>({...S,logoUrl:"",logo:null})),children:"Logoyu Kaldr"})]}):e.jsxs("div",{className:"text-muted",children:[e.jsx("div",{style:{fontSize:32,marginBottom:8},children:""}),e.jsx("div",{style:{fontSize:12},children:"Logo ykleme (yaknda)"})]})})]})]})]})})]}),t==="general"&&e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"card-title",children:"Genel Ayarlar"})}),e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"metric-list",children:(i.general||[]).map(S=>e.jsxs("div",{className:"metric-row",children:[e.jsxs("div",{children:[e.jsx("div",{className:"metric-label",children:S.label}),e.jsx("div",{className:"page-subtitle",children:S.description})]}),e.jsx("span",{className:`badge badge-${S.value?"success":"secondary"}`,children:S.value?"Ak":"Kapal"})]},S.id))})})]}),t==="jobRoles"&&e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("h3",{className:"card-title",children:" Kollar Yaplandrmas"}),e.jsx("p",{className:"page-subtitle",children:"Her i kolunun retim tipini ve bamllklarn belirleyin"})]}),e.jsx("button",{className:"btn btn-primary",onClick:()=>ne(),children:"+ Yeni  Kolu"})]}),e.jsx("div",{className:"card-body",children:e.jsxs("table",{className:"data-table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:" Kolu"}),e.jsx("th",{children:"retim Tipi"}),e.jsx("th",{children:"Cam Gerekli"}),e.jsx("th",{children:"Varsaylan Tedariki"}),e.jsx("th",{children:"Tahmini Sre"}),e.jsx("th",{children:"Durum"}),e.jsx("th",{style:{width:"100px"},children:"lem"})]})}),e.jsxs("tbody",{children:[u.map(S=>{const g=Dh.find(M=>M.value===S.productionType),x=b.find(M=>M.id===(S.defaultSupplier||S.defaultGlassSupplier));return e.jsxs("tr",{style:{opacity:S.active===!1?.5:1},children:[e.jsxs("td",{children:[e.jsx("div",{style:{fontWeight:600},children:S.name}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:S.description})]}),e.jsx("td",{children:e.jsx("span",{className:"badge",style:{background:(g==null?void 0:g.color)||"var(--bg-tertiary)",color:"#fff"},children:(g==null?void 0:g.label)||S.productionType})}),e.jsx("td",{children:S.requiresGlass?e.jsx("span",{className:"badge badge-info",children:" Evet"}):e.jsx("span",{className:"badge badge-secondary",children:"Hayr"})}),e.jsx("td",{children:x?x.name:e.jsx("span",{style:{color:"var(--text-muted)"},children:""})}),e.jsxs("td",{children:[S.estimatedDays," gn"]}),e.jsx("td",{children:e.jsx("span",{className:`badge badge-${S.active!==!1?"success":"secondary"}`,children:S.active!==!1?"Aktif":"Pasif"})}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",gap:"0.25rem"},children:[e.jsx("button",{className:"btn btn-sm btn-ghost",onClick:()=>ne(S),title:"Dzenle",children:""}),S.active!==!1&&e.jsx("button",{className:"btn btn-sm btn-ghost",onClick:()=>pe(S.id),title:"Pasif Yap",style:{color:"var(--danger)"},children:""})]})})]},S.id)}),u.length===0&&e.jsx("tr",{children:e.jsx("td",{colSpan:7,style:{textAlign:"center",padding:"2rem",color:"var(--text-muted)"},children:"Henz i kolu tanmlanmam"})})]})]})})]}),t==="glassTypes"&&e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("h3",{className:"card-title",children:"Cam Tipleri"}),e.jsx("p",{className:"page-subtitle",children:"Cam siparilerinde kullanlacak cam tiplerini tanmlayn"})]}),e.jsx("button",{className:"btn btn-primary",onClick:()=>Q(!0),children:"+ Yeni Cam Tipi"})]}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(250px, 1fr))",gap:"1rem"},children:[N.map(S=>e.jsx("div",{className:"card",style:{margin:0,background:"var(--bg-secondary)",border:"1px solid var(--border-color)"},children:e.jsx("div",{className:"card-body",style:{padding:"1rem"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs("div",{children:[e.jsxs("div",{style:{fontWeight:600,marginBottom:"0.25rem"},children:[" ",S.name]}),e.jsx("div",{className:"badge badge-secondary",children:S.code})]}),e.jsx("button",{className:"btn btn-sm btn-ghost",onClick:()=>D(S.id),style:{color:"var(--danger)"},children:""})]})})},S.id)),N.length===0&&e.jsx("div",{style:{gridColumn:"1 / -1",textAlign:"center",padding:"2rem",color:"var(--text-muted)"},children:"Henz cam tipi tanmlanmam"})]})})]}),e.jsxs(Be,{isOpen:m,onClose:()=>v(!1),title:z?" Kolu Dzenle":"Yeni  Kolu",size:"medium",children:[e.jsxs("div",{className:"form-grid",children:[e.jsxs("div",{className:"form-group",style:{gridColumn:"1 / -1"},children:[e.jsx("label",{className:"form-label",children:" Kolu Ad *"}),e.jsx("input",{type:"text",className:"form-input",value:F.name,onChange:S=>q({...F,name:S.target.value}),placeholder:"rn: PVC Dorama"})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"1 / -1"},children:[e.jsx("label",{className:"form-label",children:"Aklama"}),e.jsx("input",{type:"text",className:"form-input",value:F.description,onChange:S=>q({...F,description:S.target.value}),placeholder:"Ksa aklama"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"retim Tipi *"}),e.jsx("select",{className:"form-select",value:F.productionType,onChange:S=>q({...F,productionType:S.target.value}),children:Dh.map(S=>e.jsx("option",{value:S.value,children:S.label},S.value))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Tahmini retim Sresi (gn)"}),e.jsx("input",{type:"number",className:"form-input",value:F.estimatedDays,onChange:S=>q({...F,estimatedDays:parseInt(S.target.value)||5}),min:1})]}),F.productionType==="internal"&&e.jsx("div",{className:"form-group",style:{gridColumn:"1 / -1"},children:e.jsxs("label",{className:"form-label",style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("input",{type:"checkbox",checked:F.requiresGlass,onChange:S=>q({...F,requiresGlass:S.target.checked})}),"Cam bamll var (Dardan cam siparii gerekir)"]})}),F.productionType==="internal"&&F.requiresGlass&&e.jsxs("div",{className:"form-group",style:{gridColumn:"1 / -1"},children:[e.jsx("label",{className:"form-label",children:"Varsaylan Cam Tedarikisi"}),e.jsx(br,{value:F.defaultGlassSupplier||"",onChange:S=>q({...F,defaultGlassSupplier:S}),options:b,displayKey:"name",valueKey:"id",placeholder:"Tedariki ara...",onSelect:S=>q({...F,defaultGlassSupplier:(S==null?void 0:S.id)||null})})]}),F.productionType==="external"&&e.jsxs("div",{className:"form-group",style:{gridColumn:"1 / -1"},children:[e.jsx("label",{className:"form-label",children:"Varsaylan Tedariki"}),e.jsx(br,{value:F.defaultSupplier||"",onChange:S=>q({...F,defaultSupplier:S}),options:b,displayKey:"name",valueKey:"id",placeholder:"Tedariki ara...",onSelect:S=>q({...F,defaultSupplier:(S==null?void 0:S.id)||null})})]}),e.jsx("div",{className:"form-group",style:{gridColumn:"1 / -1"},children:e.jsxs("label",{className:"form-label",style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("input",{type:"checkbox",checked:F.active,onChange:S=>q({...F,active:S.target.checked})}),"Aktif ( olutururken seilebilir)"]})}),e.jsxs("div",{className:"form-group",style:{gridColumn:"1 / -1",marginTop:"1rem"},children:[e.jsxs("label",{className:"form-label",style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{children:" Montaj Aamalar"}),e.jsx("button",{type:"button",className:"btn btn-sm btn-secondary",onClick:()=>q({...F,assemblyStages:[...F.assemblyStages,{id:null,name:"",order:F.assemblyStages.length+1}]}),children:"+ Aama Ekle"})]}),F.assemblyStages.length===0?e.jsx("div",{style:{padding:"1rem",background:"var(--bg-secondary)",borderRadius:8,textAlign:"center",color:"var(--text-muted)",fontSize:"0.85rem"},children:"Henz montaj aamas eklenmedi. Montaj takibi iin aamalar ekleyin."}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:F.assemblyStages.map((S,g)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",padding:"0.5rem",background:"var(--bg-secondary)",borderRadius:6},children:[e.jsx("span",{style:{width:24,height:24,display:"flex",alignItems:"center",justifyContent:"center",background:"var(--primary)",color:"#fff",borderRadius:"50%",fontSize:"0.75rem",fontWeight:600},children:g+1}),e.jsx("input",{type:"text",className:"form-input",value:S.name,onChange:x=>{const M=[...F.assemblyStages];M[g]={...M[g],name:x.target.value},q({...F,assemblyStages:M})},placeholder:"Aama ad (rn: PVC Montaj)",style:{flex:1}}),e.jsx("button",{type:"button",className:"btn btn-sm btn-ghost",disabled:g===0,onClick:()=>{const x=[...F.assemblyStages];[x[g-1],x[g]]=[x[g],x[g-1]],x.forEach((M,w)=>M.order=w+1),q({...F,assemblyStages:x})},title:"Yukar Ta",children:""}),e.jsx("button",{type:"button",className:"btn btn-sm btn-ghost",disabled:g===F.assemblyStages.length-1,onClick:()=>{const x=[...F.assemblyStages];[x[g],x[g+1]]=[x[g+1],x[g]],x.forEach((M,w)=>M.order=w+1),q({...F,assemblyStages:x})},title:"Aa Ta",children:""}),e.jsx("button",{type:"button",className:"btn btn-sm btn-ghost",style:{color:"var(--danger)"},onClick:()=>{const x=F.assemblyStages.filter((M,w)=>w!==g);x.forEach((M,w)=>M.order=w+1),q({...F,assemblyStages:x})},title:"Sil",children:""})]},S.id||g))}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginTop:"0.5rem"},children:"Montaj aamalar, i montaja getiinde otomatik olarak grev olarak oluturulur."})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"0.5rem",marginTop:"1.5rem"},children:[e.jsx("button",{className:"btn btn-ghost",onClick:()=>v(!1),children:"ptal"}),e.jsx("button",{className:"btn btn-primary",onClick:U,disabled:Z,children:Z?"Kaydediliyor...":"Kaydet"})]})]}),e.jsxs(Be,{isOpen:X,onClose:()=>Q(!1),title:"Yeni Cam Tipi",size:"small",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Cam Ad *"}),e.jsx("input",{type:"text",className:"form-input",value:A.name,onChange:S=>ue({...A,name:S.target.value}),placeholder:"rn: 4+16+4 Iscam"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Cam Kodu *"}),e.jsx("input",{type:"text",className:"form-input",value:A.code,onChange:S=>ue({...A,code:S.target.value}),placeholder:"rn: 4-16-4"})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"0.5rem",marginTop:"1.5rem"},children:[e.jsx("button",{className:"btn btn-ghost",onClick:()=>Q(!1),children:"ptal"}),e.jsx("button",{className:"btn btn-primary",onClick:V,disabled:Z,children:Z?"Kaydediliyor...":"Kaydet"})]})]})]})},et=({columns:t,rows:s,data:r,getKey:n=i=>i.id||i.key||i.name,onRowClick:a,emptyMessage:l="Kayt bulunamad"})=>{const i=r||s||[];return e.jsx("div",{className:"table-container",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsx("tr",{children:t.map(d=>e.jsx("th",{children:d.label},d.accessor))})}),e.jsx("tbody",{children:i.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:t.length,children:e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"empty-state-icon",children:""}),e.jsx("div",{className:"empty-state-title",children:l}),e.jsx("div",{className:"empty-state-description",children:"Filtreleri deitirerek tekrar deneyin."})]})})}):i.map(d=>e.jsx("tr",{onClick:a?()=>a(d):void 0,style:a?{cursor:"pointer"}:void 0,children:t.map(u=>e.jsx("td",{children:u.render?u.render(d[u.accessor],d):d[u.accessor]},u.accessor))},n(d)))})]})})},G0={KAPALI:{label:"Kapand",tone:"success",icon:""},URETIME_HAZIR:{label:"retime Hazr",tone:"success",icon:""},URETIMDE:{label:"retimde",tone:"primary",icon:""},SONRA_URETILECEK:{label:"Sonra retilecek",tone:"info",icon:""},MONTAJA_HAZIR:{label:"Montaja Hazr",tone:"success",icon:""},MONTAJ_TERMIN:{label:"Montaj Terminli",tone:"primary",icon:""},ANLASMA_TAMAMLANDI:{label:"Anlama Tamam",tone:"success",icon:""},ANLASMA_YAPILIYOR:{label:"Anlama Yaplyor",tone:"primary",icon:""},FIYAT_VERILDI:{label:"Fiyat Verildi",tone:"warning",icon:""},OLCU_ALINDI:{label:"l Alnd",tone:"success",icon:""}},zh=t=>{const s=G0[t];return s?e.jsxs("span",{className:`badge badge-${s.tone}`,children:[s.icon," ",s.label]}):e.jsx("span",{className:"badge badge-secondary",children:t||"Bilinmiyor"})},Q0=()=>{var S;const[t,s]=c.useState([]),[r,n]=c.useState([]),[a,l]=c.useState([]),[i,d]=c.useState(!0),[u,f]=c.useState(""),[N,C]=c.useState(""),[b,L]=c.useState(!1),[k,E]=c.useState(null),[y,p]=c.useState(null),[m,v]=c.useState(null),[z,W]=c.useState(!1),[F,q]=c.useState(null),[X,Q]=c.useState({name:"",segment:"B2C",location:"",contact:"",phone:"",phone2:"",address:""});c.useEffect(()=>{(async()=>{try{d(!0),f("");const[x,M,w]=await Promise.all([Jl(),zr(),Cy()]);s(x),n(M),l(w)}catch(x){f(x.message||"Veriler alnamad")}finally{d(!1)}})()},[]);const A=g=>r.filter(x=>x.customerId===g&&!x.deleted),ue=g=>a.filter(x=>x.jobId===g),Z=g=>{var x,M,w;return((x=g==null?void 0:g.offer)==null?void 0:x.total)||((w=(M=g==null?void 0:g.approval)==null?void 0:M.paymentPlan)==null?void 0:w.total)||0},ae=g=>{const x=A(g),M=x.filter(B=>B.status==="KAPALI").length,w=x.length-M,j=x.reduce((B,K)=>B+Z(K),0);return{total:x.length,closed:M,active:w,totalAmount:j}},$=async g=>{g.preventDefault();try{if(W(!0),f(""),F){const x=await n0(F.id,X);s(M=>M.map(w=>w.id===x.id?x:w)),q(null)}else{const x=await Uc(X);s(M=>[x,...M])}Q({name:"",segment:"B2C",location:"",contact:"",phone:"",phone2:"",address:""}),L(!1)}catch(x){f(x.message||"Mteri kayd baarsz")}finally{W(!1)}},ne=g=>{q(g),Q({name:g.name||"",segment:g.segment||"B2C",location:g.location||"",contact:g.contact||"",phone:g.phone||"",phone2:g.phone2||"",address:g.address||""}),L(!0)},U=async g=>{try{await a0(g.id),s(x=>x.map(M=>M.id===g.id?{...M,deleted:!0}:M)),v(null),L(!1),q(null)}catch(x){f(x.message||"Silme ilemi baarsz")}},pe=c.useMemo(()=>t.filter(g=>!g.deleted),[t]),V=c.useMemo(()=>{const g=N.toLowerCase().trim();return g?pe.filter(x=>(x.name||"").toLowerCase().includes(g)||(x.phone||"").includes(g)||(x.location||"").toLowerCase().includes(g)||(x.accountCode||"").toLowerCase().includes(g)):pe},[pe,N]),D=[{label:"Mteri",accessor:"name",render:(g,x)=>e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:600},children:x.name}),x.accountCode&&e.jsxs("div",{className:"text-muted",style:{fontSize:11},children:[" ",x.accountCode]})]})},{label:"Segment",accessor:"segment",render:g=>e.jsx("span",{className:`badge badge-${g==="B2B"?"primary":"secondary"}`,children:g})},{label:"Lokasyon",accessor:"location"},{label:"letiim",accessor:"phone",render:(g,x)=>e.jsxs("div",{style:{fontSize:12},children:[x.phone&&e.jsxs("div",{children:[" ",x.phone]}),x.contact&&e.jsxs("div",{children:[" ",x.contact]})]})},{label:"ler",accessor:"jobs",render:(g,x)=>{const M=ae(x.id);return e.jsxs("div",{style:{fontSize:12},children:[e.jsx("span",{style:{fontWeight:600},children:M.total})," i",M.active>0&&e.jsxs("span",{className:"text-muted",children:[" (",M.active," aktif)"]})]})}}];return e.jsxs("div",{children:[e.jsx(Fe,{title:"Mteriler",subtitle:"Mteri listesi ve i gemii",actions:e.jsx("button",{className:"btn btn-primary",type:"button",onClick:()=>{q(null),Q({name:"",segment:"B2C",location:"",contact:"",phone:"",phone2:"",address:""}),L(!0)},children:"+ Yeni Mteri"})}),e.jsx("div",{className:"card subtle-card",style:{marginBottom:16},children:e.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center"},children:[e.jsx("span",{style:{fontSize:18},children:""}),e.jsx("input",{className:"form-input",placeholder:"Mteri ad, telefon, lokasyon veya cari kod ara...",value:N,onChange:g=>C(g.target.value),style:{flex:1,maxWidth:400}}),N&&e.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>C(""),children:"Temizle"}),e.jsxs("span",{className:"text-muted",style:{fontSize:12},children:[V.length," mteri"]})]})}),e.jsx(Be,{open:b,title:F?"Mteri Gncelle":"Yeni Mteri Ekle",size:"medium",onClose:()=>{L(!1),q(null),Q({name:"",segment:"B2C",location:"",contact:"",phone:"",phone2:"",address:""})},actions:e.jsxs(e.Fragment,{children:[F&&e.jsx("button",{className:"btn btn-danger",type:"button",onClick:()=>v(F),disabled:z,children:"Sil"}),e.jsx("button",{className:"btn btn-secondary",type:"button",onClick:()=>L(!1),disabled:z,children:"Vazge"}),e.jsx("button",{className:"btn btn-primary",type:"submit",form:"customer-form",disabled:z,children:z?"Kaydediliyor...":F?"Gncelle":"Kaydet"})]}),children:e.jsxs("form",{id:"customer-form",onSubmit:$,children:[e.jsxs("div",{style:{marginBottom:20},children:[e.jsx("h4",{style:{margin:"0 0 12px 0",fontSize:14,color:"var(--color-primary)"},children:" Temel Bilgiler"}),e.jsxs("div",{className:"grid grid-2",style:{gap:12},children:[e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",children:"Ad Soyad / Firma Ad *"}),e.jsx("input",{className:"form-input",value:X.name,onChange:g=>Q(x=>({...x,name:g.target.value})),required:!0,placeholder:"rn: Ahmet Kaya veya ABC Yap Ltd."})]}),e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",children:"Segment"}),e.jsxs("select",{className:"form-select",value:X.segment,onChange:g=>Q(x=>({...x,segment:g.target.value})),children:[e.jsx("option",{value:"B2C",children:"B2C (Bireysel)"}),e.jsx("option",{value:"B2B",children:"B2B (Kurumsal)"})]})]})]})]}),e.jsxs("div",{style:{marginBottom:20},children:[e.jsx("h4",{style:{margin:"0 0 12px 0",fontSize:14,color:"var(--color-primary)"},children:" Adres Bilgileri"}),e.jsxs("div",{className:"grid grid-2",style:{gap:12},children:[e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",children:"l / le"}),e.jsx("input",{className:"form-input",value:X.location,onChange:g=>Q(x=>({...x,location:g.target.value})),placeholder:"rn: Nevehir / Merkez"})]}),e.jsxs("div",{className:"form-group",style:{margin:0,gridColumn:"span 2"},children:[e.jsx("label",{className:"form-label",children:"Ak Adres"}),e.jsx("textarea",{className:"form-input",value:X.address,onChange:g=>Q(x=>({...x,address:g.target.value})),placeholder:"Mahalle, sokak, bina no...",rows:2,style:{resize:"vertical"}})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{style:{margin:"0 0 12px 0",fontSize:14,color:"var(--color-primary)"},children:" letiim"}),e.jsxs("div",{className:"grid grid-2",style:{gap:12},children:[e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",children:"Telefon 1 (Birincil)"}),e.jsx("input",{className:"form-input",value:X.phone,onChange:g=>Q(x=>({...x,phone:g.target.value})),placeholder:"+90 5XX XXX XX XX"})]}),e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",children:"Telefon 2 (Yedek)"}),e.jsx("input",{className:"form-input",value:X.phone2,onChange:g=>Q(x=>({...x,phone2:g.target.value})),placeholder:"+90 5XX XXX XX XX"})]}),e.jsxs("div",{className:"form-group",style:{margin:0,gridColumn:"span 2"},children:[e.jsx("label",{className:"form-label",children:"E-posta"}),e.jsx("input",{className:"form-input",type:"email",value:X.contact,onChange:g=>Q(x=>({...x,contact:g.target.value})),placeholder:"ornek@email.com"})]})]})]})]})}),e.jsx(Be,{open:!!m,title:"Silme Onay",size:"small",onClose:()=>v(null),actions:e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-secondary",type:"button",onClick:()=>v(null),children:"Vazge"}),e.jsx("button",{className:"btn btn-danger",type:"button",onClick:()=>m&&U(m),children:"Sil"})]}),children:e.jsxs("p",{children:[e.jsx("strong",{children:m==null?void 0:m.name})," mterisini silmek zeresiniz. Bu ilem geri alnabilir."]})}),e.jsx(Be,{open:!!k,title:k?` ${k.name}`:"",size:"large",onClose:()=>E(null),actions:e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-secondary",type:"button",onClick:()=>ne(k),children:" Dzenle"}),e.jsx("button",{className:"btn btn-primary",type:"button",onClick:()=>E(null),children:"Kapat"})]}),children:k&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:20},children:[e.jsxs("div",{style:{background:"linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%)",padding:16,borderRadius:12,border:"1px solid var(--color-border)"},children:[e.jsxs("div",{className:"grid grid-3",style:{gap:16},children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-muted",style:{fontSize:11,marginBottom:4},children:"Segment"}),e.jsx("span",{className:`badge badge-${k.segment==="B2B"?"primary":"secondary"}`,children:k.segment})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-muted",style:{fontSize:11,marginBottom:4},children:"Cari Kod"}),e.jsxs("div",{style:{fontWeight:600},children:[" ",k.accountCode||"-"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-muted",style:{fontSize:11,marginBottom:4},children:"Lokasyon"}),e.jsxs("div",{style:{fontWeight:600},children:[" ",k.location||"-"]})]})]}),e.jsxs("div",{className:"grid grid-2",style:{gap:16,marginTop:16},children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-muted",style:{fontSize:11,marginBottom:4},children:"Telefon"}),e.jsxs("div",{children:[k.phone&&e.jsxs("div",{children:[" ",k.phone]}),k.phone2&&e.jsxs("div",{style:{fontSize:12,color:"var(--color-text-secondary)"},children:[" ",k.phone2]}),!k.phone&&!k.phone2&&e.jsx("span",{className:"text-muted",children:"-"})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-muted",style:{fontSize:11,marginBottom:4},children:"E-posta"}),e.jsx("div",{children:k.contact?` ${k.contact}`:e.jsx("span",{className:"text-muted",children:"-"})})]})]}),k.address&&e.jsxs("div",{style:{marginTop:16},children:[e.jsx("div",{className:"text-muted",style:{fontSize:11,marginBottom:4},children:"Adres"}),e.jsxs("div",{style:{fontSize:13},children:[" ",k.address]})]})]}),(()=>{const g=ae(k.id);return e.jsxs("div",{className:"grid grid-4",style:{gap:12},children:[e.jsxs("div",{className:"card subtle-card",style:{padding:12,textAlign:"center"},children:[e.jsx("div",{style:{fontSize:24,fontWeight:700,color:"var(--color-primary)"},children:g.total}),e.jsx("div",{className:"text-muted",style:{fontSize:11},children:"Toplam "})]}),e.jsxs("div",{className:"card subtle-card",style:{padding:12,textAlign:"center"},children:[e.jsx("div",{style:{fontSize:24,fontWeight:700,color:"var(--color-warning)"},children:g.active}),e.jsx("div",{className:"text-muted",style:{fontSize:11},children:"Aktif"})]}),e.jsxs("div",{className:"card subtle-card",style:{padding:12,textAlign:"center"},children:[e.jsx("div",{style:{fontSize:24,fontWeight:700,color:"var(--color-success)"},children:g.closed}),e.jsx("div",{className:"text-muted",style:{fontSize:11},children:"Tamamlanan"})]}),e.jsxs("div",{className:"card subtle-card",style:{padding:12,textAlign:"center"},children:[e.jsxs("div",{style:{fontSize:18,fontWeight:700},children:["",g.totalAmount.toLocaleString("tr-TR")]}),e.jsx("div",{className:"text-muted",style:{fontSize:11},children:"Toplam Tutar"})]})]})})(),e.jsxs("div",{children:[e.jsxs("h4",{style:{margin:"0 0 12px 0",fontSize:14,display:"flex",alignItems:"center",gap:8},children:[" ler",e.jsx("span",{className:"badge badge-secondary",children:A(k.id).length})]}),A(k.id).length===0?e.jsxs("div",{className:"card subtle-card",style:{padding:30,textAlign:"center"},children:[e.jsx("div",{style:{fontSize:32,marginBottom:8},children:""}),e.jsx("div",{style:{fontWeight:600,marginBottom:4},children:"Henz i kayd yok"}),e.jsx("div",{className:"text-muted",style:{fontSize:13},children:"Bu mteriye ait i bulunmuyor"})]}):e.jsx("div",{style:{border:"1px solid var(--color-border)",borderRadius:8,overflow:"hidden"},children:e.jsx("div",{style:{maxHeight:300,overflow:"auto"},children:e.jsxs("table",{className:"table",style:{fontSize:13,marginBottom:0},children:[e.jsx("thead",{style:{position:"sticky",top:0,background:"var(--color-bg)"},children:e.jsxs("tr",{children:[e.jsx("th",{children:" Kodu"}),e.jsx("th",{children:"Balk"}),e.jsx("th",{children:"Tarih"}),e.jsx("th",{children:"Tutar"}),e.jsx("th",{children:"Durum"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:A(k.id).map(g=>e.jsxs("tr",{style:{cursor:"pointer"},onClick:()=>p(g),children:[e.jsx("td",{children:e.jsx("code",{style:{fontSize:11},children:g.id})}),e.jsx("td",{style:{fontWeight:600},children:g.title||"-"}),e.jsx("td",{className:"text-muted",style:{fontSize:12},children:g.createdAt?new Date(g.createdAt).toLocaleDateString("tr-TR"):"-"}),e.jsx("td",{children:Z(g)>0?`${Z(g).toLocaleString("tr-TR")}`:e.jsx("span",{className:"text-muted",children:"-"})}),e.jsx("td",{children:zh(g.status)}),e.jsx("td",{children:e.jsx("button",{className:"btn btn-secondary btn-small",onClick:x=>{x.stopPropagation(),p(g)},children:"Detay"})})]},g.id))})]})})})]})]})}),e.jsx(Be,{open:!!y,title:y?` ${y.title||y.id}`:"",size:"medium",onClose:()=>p(null),actions:e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-secondary",type:"button",onClick:()=>window.open(`/isler/list?job=${y==null?void 0:y.id}`,"_blank"),children:" e Git (Tam Detay)"}),e.jsx("button",{className:"btn btn-primary",type:"button",onClick:()=>p(null),children:"Kapat"})]}),children:y&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16},children:[e.jsx("div",{style:{background:"var(--color-bg-secondary)",padding:16,borderRadius:12},children:e.jsxs("div",{className:"grid grid-2",style:{gap:12},children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-muted",style:{fontSize:11},children:" Kodu"}),e.jsx("code",{style:{fontSize:12},children:y.id})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-muted",style:{fontSize:11},children:"Durum"}),zh(y.status)]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-muted",style:{fontSize:11},children:"Oluturma"}),e.jsx("div",{children:y.createdAt?new Date(y.createdAt).toLocaleDateString("tr-TR"):"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-muted",style:{fontSize:11},children:"Balang Tipi"}),e.jsx("div",{children:y.startType||"-"})]})]})}),y.roles&&y.roles.length>0&&e.jsxs("div",{children:[e.jsx("h4",{style:{margin:"0 0 8px 0",fontSize:13},children:"  Kollar"}),e.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:y.roles.map((g,x)=>e.jsx("span",{className:"badge badge-primary",children:g.name||g.label||g.id},x))})]}),e.jsxs("div",{children:[e.jsx("h4",{style:{margin:"0 0 8px 0",fontSize:13},children:" Finansal"}),e.jsxs("div",{className:"grid grid-2",style:{gap:8},children:[e.jsxs("div",{className:"card subtle-card",style:{padding:12},children:[e.jsx("div",{className:"text-muted",style:{fontSize:11},children:"Toplam Tutar"}),e.jsxs("div",{style:{fontSize:18,fontWeight:700},children:["",Z(y).toLocaleString("tr-TR")]})]}),e.jsxs("div",{className:"card subtle-card",style:{padding:12},children:[e.jsx("div",{className:"text-muted",style:{fontSize:11},children:"Anlama Tarihi"}),e.jsx("div",{style:{fontSize:14,fontWeight:600},children:(S=y.offer)!=null&&S.agreedDate?new Date(y.offer.agreedDate).toLocaleDateString("tr-TR"):"-"})]})]})]}),(()=>{const g=ue(y.id);return g.length===0?null:e.jsxs("div",{children:[e.jsxs("h4",{style:{margin:"0 0 8px 0",fontSize:13},children:[" Dkmanlar (",g.length,")"]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:g.map(x=>e.jsxs("div",{className:"card subtle-card",style:{padding:"10px 14px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsxs("div",{style:{fontWeight:600,fontSize:13},children:[x.type==="olcu"&&" ",x.type==="teknik"&&" ",x.type==="sozlesme"&&" ",x.description||x.originalName]}),e.jsx("div",{className:"text-muted",style:{fontSize:11},children:new Date(x.uploadedAt).toLocaleDateString("tr-TR")})]}),e.jsx("a",{href:`http://localhost:8000/documents/file/${x.filename}`,target:"_blank",rel:"noopener noreferrer",className:"btn btn-secondary btn-small",children:"Grntle"})]},x.id))})]})})(),y.notes&&e.jsxs("div",{children:[e.jsx("h4",{style:{margin:"0 0 8px 0",fontSize:13},children:" Not"}),e.jsx("div",{className:"card subtle-card",style:{padding:12,fontSize:13},children:y.notes})]})]})}),i?e.jsx(ft,{text:"Mteriler ykleniyor..."}):u?e.jsxs("div",{className:"card error-card",children:[e.jsx("div",{className:"error-title",children:"Liste yklenemedi"}),e.jsx("div",{className:"error-message",children:u})]}):V.length===0?e.jsxs("div",{className:"card subtle-card",style:{padding:40,textAlign:"center"},children:[e.jsx("div",{style:{fontSize:48,marginBottom:12},children:""}),e.jsx("div",{style:{fontWeight:600,marginBottom:8},children:N?"Sonu bulunamad":"Henz mteri yok"}),e.jsx("div",{className:"text-muted",children:N?"Farkl bir arama kriteri deneyin":"Yeni mteri eklemek iin butona tklayn"})]}):e.jsx(et,{columns:D,rows:V,getKey:g=>g.id,onRowClick:g=>E(g)})]})},Ks=({icon:t,label:s,value:r,change:n,tone:a="primary",trend:l="neutral"})=>{const i=l==="negative"?"stat-change negative":"stat-change positive";return e.jsxs("div",{className:"stat-card",children:[e.jsx("div",{className:`stat-icon ${a}`,children:t}),e.jsxs("div",{className:"stat-content",children:[e.jsx("div",{className:"stat-label",children:s}),e.jsx("div",{className:"stat-value",children:r}),n?e.jsx("div",{className:i,children:n}):null]})]})},J0=["OLCU_RANDEVU_BEKLIYOR","SERVIS_RANDEVU_BEKLIYOR"],X0=t=>{if(!t)return"";const s=new Date(t),n=new Date-s,a=Math.floor(n/6e4),l=Math.floor(n/36e5),i=Math.floor(n/864e5);return a<60?`${a} dk nce`:l<24?`${l} saat nce`:i===0?"Bugn":i===1?"Dn":`${i} gn nce`},Z0=()=>{const[t,s]=c.useState({stats:[],activities:[],priorityJobs:[],weekOverview:[],paymentStatus:{},teamStatus:{}}),[r,n]=c.useState([]),[a,l]=c.useState([]),[i,d]=c.useState([]),[u,f]=c.useState([]),[N,C]=c.useState([]),[b,L]=c.useState(!0),[k,E]=c.useState("");return c.useEffect(()=>{(async()=>{try{L(!0),E("");const[p,m,v,z,W,F]=await Promise.all([Rb(),zr().catch(()=>[]),x0().catch(()=>[]),Hc().catch(()=>[]),qc().catch(()=>[]),Iy().catch(()=>[])]);s(p);const q=(m||[]).filter(Q=>J0.includes(Q.status)).slice(0,5);n(q),l((v||[]).slice(0,5)),d((z||[]).slice(0,5));const X=(W||[]).filter(Q=>["sent","partial"].includes(Q.status)).slice(0,5);f(X),C((F||[]).slice(0,5))}catch(p){E(p.message||"Bilinmeyen bir hata olutu")}finally{L(!1)}})()},[]),e.jsxs("div",{children:[e.jsx(Fe,{title:"Kontrol Paneli",subtitle:" srelerinizin genel durumunu grntleyin"}),b?e.jsx("div",{className:"card subtle-card",children:"Veriler ykleniyor..."}):k?e.jsxs("div",{className:"card error-card",children:[e.jsx("div",{className:"error-title",children:"Veri alnamad"}),e.jsx("div",{className:"error-message",children:k})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"stats-grid",children:t.stats.map(y=>e.jsx(Ks,{icon:y.icon,label:y.label,value:y.value,change:y.change,trend:y.trend,tone:y.tone},y.id))}),r.length>0&&e.jsxs("div",{className:"card",style:{marginTop:24,border:"2px solid var(--color-warning)",background:"var(--color-warning-bg)"},children:[e.jsxs("div",{className:"card-header",style:{borderBottom:"1px solid rgba(245, 158, 11, 0.2)"},children:[e.jsxs("h3",{className:"card-title",style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{style:{fontSize:20},children:""}),"Randevu Bekliyor",e.jsx("span",{className:"badge badge-warning",style:{marginLeft:8},children:r.length})]}),e.jsx(gs,{to:"/isler/list",className:"btn btn-secondary btn-small",children:"Tmn Gr"})]}),e.jsx("div",{className:"card-body",style:{padding:0},children:e.jsx("div",{style:{display:"flex",flexDirection:"column"},children:r.map(y=>{var p;return e.jsxs(gs,{to:"/isler/list",style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 16px",borderBottom:"1px solid rgba(245, 158, 11, 0.1)",textDecoration:"none",color:"inherit",transition:"background 0.2s"},onMouseOver:m=>m.currentTarget.style.background="rgba(245, 158, 11, 0.1)",onMouseOut:m=>m.currentTarget.style.background="transparent",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[e.jsx("span",{style:{fontSize:18},children:y.startType==="SERVIS"?"":""}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:600},children:y.customerName}),e.jsxs("div",{style:{fontSize:12,color:"var(--color-text-light)"},children:[y.title,"  ",((p=y.roles)==null?void 0:p.map(m=>m.name).join(", "))||" kolu belirtilmemi"]})]})]}),e.jsxs("div",{style:{textAlign:"right"},children:[e.jsx("div",{className:"badge badge-warning",style:{fontSize:11},children:y.startType==="SERVIS"?"Servis":"l"}),e.jsx("div",{style:{fontSize:11,color:"var(--color-text-light)",marginTop:4},children:X0(y.createdAt)})]})]},y.id)})})}),e.jsx("div",{className:"card-footer",style:{background:"rgba(245, 158, 11, 0.05)",padding:"10px 16px",fontSize:12,color:"var(--color-text-light)"},children:" Bu mterileri arayp randevu belirlemeniz gerekiyor."})]}),N.length>0&&e.jsxs("div",{className:"card",style:{marginTop:24,border:"2px solid var(--color-danger)",background:"var(--color-danger-bg)"},children:[e.jsxs("div",{className:"card-header",style:{borderBottom:"1px solid rgba(239, 68, 68, 0.2)"},children:[e.jsxs("h3",{className:"card-title",style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{style:{fontSize:20},children:""}),"retim/Tedarik Uyarlar",e.jsx("span",{className:"badge badge-danger",style:{marginLeft:8},children:N.length})]}),e.jsx(gs,{to:"/uretim/siparisler",className:"btn btn-secondary btn-small",children:"Tmn Gr"})]}),e.jsx("div",{className:"card-body",style:{padding:0},children:e.jsx("div",{style:{display:"flex",flexDirection:"column"},children:N.map((y,p)=>e.jsxs(gs,{to:`/isler/list?job=${y.jobId}`,style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 16px",borderBottom:"1px solid rgba(239, 68, 68, 0.1)",textDecoration:"none",color:"inherit",transition:"background 0.2s"},onMouseOver:m=>m.currentTarget.style.background="rgba(239, 68, 68, 0.1)",onMouseOut:m=>m.currentTarget.style.background="transparent",children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[e.jsx("span",{style:{fontSize:18},children:y.type==="overdue"?"":y.type==="due_today"?"":""}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:600},children:y.message}),e.jsxs("div",{style:{fontSize:12,color:"var(--color-text-light)"},children:[y.jobTitle,"  ",y.roleName]})]})]}),e.jsxs("div",{style:{textAlign:"right"},children:[e.jsx("div",{className:`badge badge-${y.severity==="high"?"danger":"warning"}`,style:{fontSize:11},children:y.type==="overdue"?"GECKT":y.type==="due_today"?"BUGN":"SORUN"}),y.estimatedDelivery&&e.jsx("div",{style:{fontSize:11,color:"var(--color-text-light)",marginTop:4},children:new Date(y.estimatedDelivery).toLocaleDateString("tr-TR")})]})]},p))})}),e.jsx("div",{className:"card-footer",style:{background:"rgba(239, 68, 68, 0.05)",padding:"10px 16px",fontSize:12,color:"var(--color-text-light)"},children:" Geciken veya sorunlu sipariler acil mdahale gerektiriyor."})]}),(a.length>0||i.length>0||u.length>0)&&e.jsxs("div",{className:"grid grid-3",style:{marginTop:24},children:[a.length>0&&e.jsxs("div",{className:"card",style:{border:"2px solid var(--color-danger)",background:"var(--color-danger-bg)"},children:[e.jsxs("div",{className:"card-header",style:{borderBottom:"1px solid rgba(239, 68, 68, 0.2)"},children:[e.jsxs("h3",{className:"card-title",style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{style:{fontSize:18},children:""}),"Kritik Stok",e.jsx("span",{className:"badge badge-danger",style:{marginLeft:4},children:a.length})]}),e.jsx(gs,{to:"/stok/kritik",className:"btn btn-secondary btn-small",children:"Tm"})]}),e.jsx("div",{style:{padding:"8px 0"},children:a.map(y=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px 16px",borderBottom:"1px solid rgba(239, 68, 68, 0.1)",fontSize:13},children:[e.jsxs("span",{children:[e.jsx("strong",{children:y.productCode}),"-",y.colorCode,e.jsx("div",{className:"text-muted",style:{fontSize:11},children:y.name})]}),e.jsxs("span",{style:{color:"var(--color-danger)",fontWeight:600},children:[y.available," ",y.unit]})]},y.id))})]}),i.length>0&&e.jsxs("div",{className:"card",style:{border:"2px solid var(--color-warning)",background:"var(--color-warning-bg)"},children:[e.jsxs("div",{className:"card-header",style:{borderBottom:"1px solid rgba(245, 158, 11, 0.2)"},children:[e.jsxs("h3",{className:"card-title",style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{style:{fontSize:18},children:""}),"Sipari Gerekli",e.jsx("span",{className:"badge badge-warning",style:{marginLeft:4},children:i.length})]}),e.jsx(gs,{to:"/satinalma/eksik",className:"btn btn-secondary btn-small",children:"Sipari Ver"})]}),e.jsx("div",{style:{padding:"8px 0"},children:i.map(y=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px 16px",borderBottom:"1px solid rgba(245, 158, 11, 0.1)",fontSize:13},children:[e.jsxs("span",{children:[e.jsx("strong",{children:y.productCode}),"-",y.colorCode,e.jsx("div",{className:"text-muted",style:{fontSize:11},children:y.name})]}),e.jsxs("span",{style:{color:"var(--color-warning)",fontWeight:600},children:["+",y.suggestedQty]})]},y.itemId))})]}),u.length>0&&e.jsxs("div",{className:"card",style:{border:"2px solid var(--color-info)",background:"var(--color-info-bg)"},children:[e.jsxs("div",{className:"card-header",style:{borderBottom:"1px solid rgba(59, 130, 246, 0.2)"},children:[e.jsxs("h3",{className:"card-title",style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{style:{fontSize:18},children:""}),"Bekleyen PO",e.jsx("span",{className:"badge badge-info",style:{marginLeft:4},children:u.length})]}),e.jsx(gs,{to:"/satinalma/bekleyen",className:"btn btn-secondary btn-small",children:"Tm"})]}),e.jsx("div",{style:{padding:"8px 0"},children:u.map(y=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px 16px",borderBottom:"1px solid rgba(59, 130, 246, 0.1)",fontSize:13},children:[e.jsxs("span",{children:[e.jsx("strong",{children:y.id}),e.jsx("div",{className:"text-muted",style:{fontSize:11},children:y.supplierName})]}),e.jsxs("span",{children:[e.jsx("span",{className:`badge badge-${y.status==="partial"?"warning":"info"}`,style:{fontSize:10},children:y.status==="partial"?"Ksmi":"Bekliyor"}),y.expectedDate&&e.jsx("div",{className:"text-muted",style:{fontSize:10,marginTop:2},children:y.expectedDate})]})]},y.id))})]})]}),e.jsxs("div",{className:"grid grid-2",style:{marginTop:24},children:[e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header",children:[e.jsx("h3",{className:"card-title",children:"Son Aktiviteler"}),e.jsx("button",{className:"btn btn-secondary btn-icon",type:"button",children:""})]}),e.jsx("div",{className:"card-body",children:e.jsx(et,{columns:[{label:"lem",accessor:"action"},{label:"Kullanc",accessor:"user"},{label:"Tarih",accessor:"time"}],rows:t.activities})})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header",children:[e.jsx("h3",{className:"card-title",children:"ncelikli ler"}),e.jsx("button",{className:"btn btn-secondary",type:"button",children:"Tmn Gr"})]}),e.jsx("div",{className:"card-body",children:e.jsx(et,{columns:[{label:" Ad",accessor:"name"},{label:"Durum",accessor:"status",render:(y,p)=>eN(p.status,p.badge)},{label:"Termin",accessor:"dueDate"}],rows:t.priorityJobs})})]})]}),e.jsxs("div",{className:"grid grid-3",style:{marginTop:24},children:[e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"card-title",children:"Bu Hafta"})}),e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"metric-list",children:t.weekOverview.map(y=>e.jsxs("div",{className:"metric-row",children:[e.jsx("span",{className:"metric-label",children:y.label}),e.jsx("span",{className:"metric-value",children:y.value})]},y.label))})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"card-title",children:"deme Durumu"})}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"metric-list",children:[e.jsxs("div",{className:"metric-row",children:[e.jsx("span",{className:"metric-label",children:"Bekleyen"}),e.jsx("span",{className:"metric-value warning",children:t.paymentStatus.pending})]}),e.jsxs("div",{className:"metric-row",children:[e.jsx("span",{className:"metric-label",children:"Bu Ay Tahsilat"}),e.jsx("span",{className:"metric-value success",children:t.paymentStatus.collected})]}),e.jsxs("div",{className:"metric-row",children:[e.jsx("span",{className:"metric-label",children:"Bu Ay deme"}),e.jsx("span",{className:"metric-value danger",children:t.paymentStatus.paid})]})]})})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"card-title",children:"Ekip Durumu"})}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"metric-list",children:[e.jsxs("div",{className:"metric-row",children:[e.jsx("span",{className:"metric-label",children:"Atlye"}),e.jsxs("span",{className:"metric-value",children:[t.teamStatus.workshop," kii"]})]}),e.jsxs("div",{className:"metric-row",children:[e.jsx("span",{className:"metric-label",children:"Montaj"}),e.jsxs("span",{className:"metric-value",children:[t.teamStatus.assembly," kii"]})]}),e.jsxs("div",{className:"metric-row",children:[e.jsx("span",{className:"metric-label",children:"Ofis"}),e.jsxs("span",{className:"metric-value",children:[t.teamStatus.office," kii"]})]})]})})]})]})]})]})},eN=(t,s="secondary")=>e.jsx("span",{className:`badge badge-${s}`,children:t}),tN=()=>{const[t,s]=c.useState([]),[r,n]=c.useState(!0),[a,l]=c.useState("");return c.useEffect(()=>{(async()=>{try{n(!0),l("");const d=await h0();s(d)}catch(d){l(d.message||"Evraklar alnamad")}finally{n(!1)}})()},[]),e.jsxs("div",{children:[e.jsx(Fe,{title:"rsaliye & Fatura",subtitle:"Kesilmi veya taslak evraklar"}),r?e.jsx("div",{className:"card subtle-card",children:"Evraklar ykleniyor..."}):a?e.jsxs("div",{className:"card error-card",children:[e.jsx("div",{className:"error-title",children:"Evraklar alnamad"}),e.jsx("div",{className:"error-message",children:a})]}):e.jsx(et,{columns:[{label:"Evrak No",accessor:"id"},{label:"Mteri",accessor:"customer"},{label:"Tip",accessor:"type"},{label:"Tutar",accessor:"amount"},{label:"Tarih",accessor:"date"},{label:"Durum",accessor:"status"}],rows:t})]})},Kt=t=>new Intl.NumberFormat("tr-TR").format(t||0),Ih=t=>t?new Date(t).toLocaleDateString("tr-TR"):"-",sN={pending:{label:"Bekliyor",tone:"warning",icon:""},overdue:{label:"Gecikmi",tone:"danger",icon:""},today:{label:"Bugn",tone:"primary",icon:""},afterDelivery:{label:"Montaj Bitti",tone:"info",icon:""},chequeWaiting:{label:"ek Bekliyor",tone:"secondary",icon:""},chequeReceived:{label:"ek Alnd",tone:"success",icon:""},collected:{label:"Tahsil Edildi",tone:"success",icon:""}},Li={MONTAJA_HAZIR:{label:"Montaja Hazr",icon:""},MONTAJ_TERMIN:{label:"Montaj Terminli",icon:""},MUHASEBE_BEKLIYOR:{label:"Muhasebe Bekliyor",icon:""},KAPALI:{label:"Kapand",icon:""}},rN=()=>{const[t,s]=c.useState([]),[r,n]=c.useState([]),[a,l]=c.useState(!0),[i,d]=c.useState(""),[u,f]=c.useState("pending"),[N,C]=c.useState("all"),[b,L]=c.useState(null),[k,E]=c.useState(null),[y,p]=c.useState(null),[m,v]=c.useState(null),[z,W]=c.useState({amount:"",isPartial:!1,hasDiscount:!1,discountAmount:"",discountReason:"",note:""}),[F,q]=c.useState(!1),[X,Q]=c.useState([]);c.useEffect(()=>{A()},[]);const A=async()=>{try{l(!0),d("");const[x,M]=await Promise.all([zr(),Jl()]);s(x.filter(w=>!w.deleted)),n(M)}catch(x){d(x.message||"Veriler alnamad")}finally{l(!1)}},ue=x=>{const M=r.find(w=>w.id===x);return(M==null?void 0:M.name)||"Bilinmiyor"},Z=x=>["MUHASEBE_BEKLIYOR","KAPALI"].includes(x.status),ae=c.useMemo(()=>{const x=new Date;x.setHours(0,0,0,0);const M=[];return t.forEach(w=>{var K,se,oe,O,ce,je;const j=(K=w.approval)==null?void 0:K.paymentPlan;if(!j)return;const B={jobId:w.id,jobTitle:w.title||w.id,customerId:w.customerId,customerName:w.customerName||ue(w.customerId),jobStatus:w.status};if(((se=j.cash)==null?void 0:se.amount)>0){const we=j.cash.date?new Date(j.cash.date):null;let Ee="pending";j.cash.status==="collected"?Ee="collected":we&&(we<x?Ee="overdue":we.toDateString()===x.toDateString()&&(Ee="today")),M.push({...B,id:`${w.id}-cash`,type:"cash",typeLabel:"Nakit",amount:j.cash.amount,date:j.cash.date,status:Ee,collectedData:j.cash.collectedData||null})}if(((oe=j.card)==null?void 0:oe.amount)>0){const we=j.card.date?new Date(j.card.date):null;let Ee="pending";j.card.status==="collected"?Ee="collected":we&&(we<x?Ee="overdue":we.toDateString()===x.toDateString()&&(Ee="today")),M.push({...B,id:`${w.id}-card`,type:"card",typeLabel:"Kredi Kart",amount:j.card.amount,date:j.card.date,status:Ee,collectedData:j.card.collectedData||null})}if(((O=j.cheque)==null?void 0:O.total)>0){const we=j.cheque.received&&((ce=j.cheque.items)==null?void 0:ce.length)>0;M.push({...B,id:`${w.id}-cheque`,type:"cheque",typeLabel:`ek (${j.cheque.count||"?"} adet)`,amount:j.cheque.total,date:null,status:j.cheque.status==="collected"?"collected":we?"chequeReceived":"chequeWaiting",chequeDetails:j.cheque.items||[],chequeCount:j.cheque.count||0,chequeReceived:j.cheque.received||!1,collectedData:j.cheque.collectedData||null})}if(((je=j.afterDelivery)==null?void 0:je.amount)>0){let we="pending";j.afterDelivery.status==="collected"?we="collected":Z(w)&&(we="afterDelivery"),M.push({...B,id:`${w.id}-afterDelivery`,type:"afterDelivery",typeLabel:"Teslim Sonras",amount:j.afterDelivery.amount,date:null,status:we,note:j.afterDelivery.note,collectedData:j.afterDelivery.collectedData||null})}}),M},[t,r]),$=c.useMemo(()=>{let x=ae;u==="pending"?x=x.filter(w=>w.status!=="collected"):x=x.filter(w=>w.status==="collected"),N!=="all"&&(x=x.filter(w=>w.type===N));const M={overdue:0,today:1,afterDelivery:2,chequeWaiting:3,chequeReceived:4,pending:5,collected:6};return x.sort((w,j)=>{const B=M[w.status]??99,K=M[j.status]??99;return B!==K?B-K:w.date&&j.date?new Date(w.date)-new Date(j.date):0}),x},[ae,u,N]),ne=c.useMemo(()=>{const x=ae.filter(j=>j.status!=="collected"),M=new Date;M.setHours(0,0,0,0);const w=new Date(M);return w.setDate(w.getDate()+7),{overdueCount:x.filter(j=>j.status==="overdue").length,overdueAmount:x.filter(j=>j.status==="overdue").reduce((j,B)=>j+B.amount,0),todayCount:x.filter(j=>j.status==="today").length,todayAmount:x.filter(j=>j.status==="today").reduce((j,B)=>j+B.amount,0),afterDeliveryCount:x.filter(j=>j.status==="afterDelivery").length,afterDeliveryAmount:x.filter(j=>j.status==="afterDelivery").reduce((j,B)=>j+B.amount,0),chequeWaitingCount:x.filter(j=>j.status==="chequeWaiting").length,thisWeekCount:x.filter(j=>{if(!j.date)return!1;const B=new Date(j.date);return B>=M&&B<=w}).length,thisWeekAmount:x.filter(j=>{if(!j.date)return!1;const B=new Date(j.date);return B>=M&&B<=w}).reduce((j,B)=>j+B.amount,0),totalPending:x.reduce((j,B)=>j+B.amount,0),totalCollected:ae.filter(j=>j.status==="collected").reduce((j,B)=>j+B.amount,0)}},[ae]),U=x=>{W({amount:x.amount,isPartial:!1,hasDiscount:!1,discountAmount:"",discountReason:"",note:""}),L(x)},pe=x=>{const M=x.chequeCount||1,w=x.chequeDetails||[],j=[];for(let B=0;B<M;B++)j.push(w[B]||{bank:"",chequeNo:"",amount:Math.round(x.amount/M),due:""});Q(j),E(x)},V=async()=>{if(b)try{q(!0);const x=t.find(B=>B.id===b.jobId);if(!x)throw new Error(" bulunamad");const M={...x.approval.paymentPlan},w=b.type,j={collectedAt:new Date().toISOString(),originalAmount:b.amount,collectedAmount:Number(z.amount)||b.amount,isPartial:z.isPartial,discountAmount:z.hasDiscount?Number(z.discountAmount):0,discountReason:z.discountReason,note:z.note};w==="cash"?M.cash={...M.cash,status:"collected",collectedData:j}:w==="card"?M.card={...M.card,status:"collected",collectedData:j}:w==="cheque"?M.cheque={...M.cheque,status:"collected",collectedData:j}:w==="afterDelivery"&&(M.afterDelivery={...M.afterDelivery,status:"collected",collectedData:j}),await yh(x.id,M),await A(),L(null)}catch(x){d(x.message||"Tahsilat kaydedilemedi")}finally{q(!1)}},D=async()=>{if(k)try{q(!0);const x=t.find(w=>w.id===k.jobId);if(!x)throw new Error(" bulunamad");const M={...x.approval.paymentPlan};M.cheque={...M.cheque,received:!0,items:X,count:X.length,total:X.reduce((w,j)=>w+Number(j.amount||0),0)},await yh(x.id,M),await A(),E(null)}catch(x){d(x.message||"ek detaylar kaydedilemedi")}finally{q(!1)}},S=x=>{const M=sN[x];return M?e.jsxs("span",{className:`badge badge-${M.tone}`,children:[M.icon," ",M.label]}):e.jsx("span",{className:"badge badge-secondary",children:x})},g=x=>{switch(x){case"cash":return"";case"card":return"";case"cheque":return"";case"afterDelivery":return"";default:return""}};return e.jsxs("div",{children:[e.jsx(Fe,{title:"demeler / Kasa",subtitle:"Tahsilat takibi ve hatrlatmalar"}),a?e.jsx(ft,{text:"demeler ykleniyor..."}):i?e.jsxs("div",{className:"card error-card",children:[e.jsx("div",{className:"error-title",children:"Hata"}),e.jsx("div",{className:"error-message",children:i})]}):e.jsxs(e.Fragment,{children:[(ne.overdueCount>0||ne.todayCount>0||ne.afterDeliveryCount>0||ne.chequeWaitingCount>0)&&e.jsxs("div",{style:{background:"linear-gradient(135deg, #fef3c7 0%, #fde68a 100%)",padding:16,borderRadius:12,marginBottom:16,border:"1px solid #f59e0b"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:12},children:[e.jsx("span",{style:{fontSize:20},children:""}),e.jsx("span",{style:{fontWeight:700,fontSize:16},children:"Dikkat Gerektiren demeler"})]}),e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:16},children:[ne.overdueCount>0&&e.jsxs("div",{style:{background:"#fecaca",padding:"8px 16px",borderRadius:8,display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{children:""}),e.jsxs("div",{children:[e.jsxs("div",{style:{fontWeight:600},children:["Gecikmi: ",ne.overdueCount]}),e.jsxs("div",{style:{fontSize:13,color:"#991b1b"},children:["",Kt(ne.overdueAmount)]})]})]}),ne.todayCount>0&&e.jsxs("div",{style:{background:"#dbeafe",padding:"8px 16px",borderRadius:8,display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{children:""}),e.jsxs("div",{children:[e.jsxs("div",{style:{fontWeight:600},children:["Bugn: ",ne.todayCount]}),e.jsxs("div",{style:{fontSize:13,color:"#1e40af"},children:["",Kt(ne.todayAmount)]})]})]}),ne.afterDeliveryCount>0&&e.jsxs("div",{style:{background:"#d1fae5",padding:"8px 16px",borderRadius:8,display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{children:""}),e.jsxs("div",{children:[e.jsxs("div",{style:{fontWeight:600},children:["Montaj Biten: ",ne.afterDeliveryCount]}),e.jsxs("div",{style:{fontSize:13,color:"#065f46"},children:["",Kt(ne.afterDeliveryAmount)]})]})]}),ne.chequeWaitingCount>0&&e.jsxs("div",{style:{background:"#e5e7eb",padding:"8px 16px",borderRadius:8,display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{children:""}),e.jsxs("div",{children:[e.jsxs("div",{style:{fontWeight:600},children:["ek Bekliyor: ",ne.chequeWaitingCount]}),e.jsx("div",{style:{fontSize:13,color:"#374151"},children:"Detay girilecek"})]})]})]})]}),e.jsxs("div",{className:"stats-grid",style:{marginBottom:16},children:[e.jsx("div",{className:"card",style:{padding:16},children:e.jsxs("div",{className:"metric-row",children:[e.jsx("div",{className:"metric-icon",children:""}),e.jsxs("div",{children:[e.jsx("div",{className:"metric-label",children:"Bekleyen Toplam"}),e.jsxs("div",{className:"metric-value",children:["",Kt(ne.totalPending)]})]})]})}),e.jsx("div",{className:"card",style:{padding:16},children:e.jsxs("div",{className:"metric-row",children:[e.jsx("div",{className:"metric-icon",children:""}),e.jsxs("div",{children:[e.jsx("div",{className:"metric-label",children:"Bu Hafta Alnacak"}),e.jsxs("div",{className:"metric-value",children:["",Kt(ne.thisWeekAmount)]}),e.jsxs("div",{className:"text-muted",style:{fontSize:11},children:[ne.thisWeekCount," deme"]})]})]})}),e.jsx("div",{className:"card",style:{padding:16},children:e.jsxs("div",{className:"metric-row",children:[e.jsx("div",{className:"metric-icon",children:""}),e.jsxs("div",{children:[e.jsx("div",{className:"metric-label",children:"Tahsil Edilen"}),e.jsxs("div",{className:"metric-value",style:{color:"var(--color-success)"},children:["",Kt(ne.totalCollected)]})]})]})})]}),e.jsxs("div",{className:"card",style:{marginBottom:16},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"12px 16px",borderBottom:"1px solid var(--color-border)"},children:[e.jsxs("div",{style:{display:"flex",gap:8},children:[e.jsxs("button",{className:`btn ${u==="pending"?"btn-primary":"btn-secondary"}`,onClick:()=>f("pending"),children:[" Bekleyen (",ae.filter(x=>x.status!=="collected").length,")"]}),e.jsxs("button",{className:`btn ${u==="collected"?"btn-primary":"btn-secondary"}`,onClick:()=>f("collected"),children:[" Tahsil Edilen (",ae.filter(x=>x.status==="collected").length,")"]})]}),e.jsxs("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[e.jsx("span",{className:"text-muted",style:{fontSize:12},children:"Filtre:"}),e.jsxs("select",{className:"form-select",value:N,onChange:x=>C(x.target.value),style:{width:150},children:[e.jsx("option",{value:"all",children:"Tm"}),e.jsx("option",{value:"cash",children:" Nakit"}),e.jsx("option",{value:"card",children:" Kart"}),e.jsx("option",{value:"cheque",children:" ek"}),e.jsx("option",{value:"afterDelivery",children:" Teslim Sonras"})]})]})]}),e.jsx("div",{className:"table-container",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Tarih"}),e.jsx("th",{children:"Mteri"}),e.jsx("th",{children:""}),e.jsx("th",{children:"Tip"}),e.jsx("th",{children:"Tutar"}),e.jsx("th",{children:"Durum"}),e.jsx("th",{children:"lemler"})]})}),e.jsx("tbody",{children:$.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:7,children:e.jsxs("div",{style:{padding:40,textAlign:"center"},children:[e.jsx("div",{style:{fontSize:48,marginBottom:12},children:u==="pending"?"":""}),e.jsx("div",{style:{fontWeight:600},children:u==="pending"?"Bekleyen deme yok!":"Henz tahsilat kayd yok"})]})})}):$.map(x=>e.jsxs("tr",{style:{background:x.status==="overdue"?"#fef2f2":x.status==="today"?"#eff6ff":x.status==="afterDelivery"?"#ecfdf5":void 0},children:[e.jsx("td",{children:x.date?e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:600},children:Ih(x.date)}),x.status==="overdue"&&e.jsx("div",{style:{fontSize:11,color:"var(--color-danger)"},children:"Gecikmi!"})]}):e.jsx("span",{className:"text-muted",children:"-"})}),e.jsx("td",{children:e.jsx("div",{style:{fontWeight:600},children:x.customerName})}),e.jsxs("td",{children:[e.jsx("div",{style:{fontSize:13},children:x.jobTitle}),e.jsx("code",{style:{fontSize:10},children:x.jobId})]}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[e.jsx("span",{children:g(x.type)}),e.jsx("span",{children:x.typeLabel})]})}),e.jsx("td",{children:e.jsxs("strong",{style:{fontSize:15},children:["",Kt(x.amount)]})}),e.jsx("td",{children:S(x.status)}),e.jsx("td",{children:e.jsxs("div",{style:{display:"flex",gap:6},children:[x.status==="collected"?e.jsx("button",{className:"btn btn-success btn-small",onClick:()=>p(x),children:" deme Alnd"}):x.status==="chequeWaiting"?e.jsx("button",{className:"btn btn-primary btn-small",onClick:()=>pe(x),children:"ek Detay Gir"}):e.jsx("button",{className:"btn btn-success btn-small",onClick:()=>U(x),children:"Tahsil Et"}),e.jsx("button",{className:"btn btn-secondary btn-small",onClick:()=>v(x),children:"e Git"})]})})]},x.id))})]})})]})]}),e.jsx(Be,{open:!!b,title:" deme Tahsil Et",size:"medium",onClose:()=>L(null),actions:e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>L(null),disabled:F,children:"ptal"}),e.jsx("button",{className:"btn btn-success",onClick:V,disabled:F,children:F?"Kaydediliyor...":" Tahsil Et"})]}),children:b&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16},children:[e.jsx("div",{style:{background:"var(--color-bg-secondary)",padding:16,borderRadius:8},children:e.jsxs("div",{className:"grid grid-2",style:{gap:12},children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-muted",style:{fontSize:11},children:"Mteri"}),e.jsx("div",{style:{fontWeight:600},children:b.customerName})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-muted",style:{fontSize:11},children:""}),e.jsx("div",{style:{fontWeight:600},children:b.jobTitle})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-muted",style:{fontSize:11},children:"deme Tipi"}),e.jsxs("div",{children:[g(b.type)," ",b.typeLabel]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-muted",style:{fontSize:11},children:"Beklenen Tutar"}),e.jsxs("div",{style:{fontWeight:700,fontSize:18},children:["",Kt(b.amount)]})]})]})}),e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",children:"Alnan Tutar"}),e.jsx("input",{type:"number",className:"form-input",value:z.amount,onChange:x=>W(M=>({...M,amount:x.target.value})),style:{fontSize:18,fontWeight:600}})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8,cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:z.isPartial,onChange:x=>W(M=>({...M,isPartial:x.target.checked}))}),e.jsx("span",{children:"Ksmi tahsilat (kalan tutar sonra alnacak)"})]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8,cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:z.hasDiscount,onChange:x=>W(M=>({...M,hasDiscount:x.target.checked}))}),e.jsx("span",{children:"skonto ile kapat"})]})]}),z.hasDiscount&&e.jsxs("div",{className:"grid grid-2",style:{gap:12,padding:12,background:"#fef3c7",borderRadius:8},children:[e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",children:"skonto Tutar *"}),e.jsx("input",{type:"number",className:"form-input",value:z.discountAmount,onChange:x=>W(M=>({...M,discountAmount:x.target.value})),required:!0})]}),e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",children:"skonto Sebebi *"}),e.jsx("input",{type:"text",className:"form-input",value:z.discountReason,onChange:x=>W(M=>({...M,discountReason:x.target.value})),placeholder:"rn: Nakit indirimi",required:!0})]})]}),e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",children:"Not (Opsiyonel)"}),e.jsx("textarea",{className:"form-input",value:z.note,onChange:x=>W(M=>({...M,note:x.target.value})),rows:2})]})]})}),e.jsx(Be,{open:!!k,title:" ek Detaylar Gir",size:"large",onClose:()=>E(null),actions:e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>E(null),disabled:F,children:"ptal"}),e.jsx("button",{className:"btn btn-primary",onClick:D,disabled:F,children:F?"Kaydediliyor...":" ekleri Kaydet"})]}),children:k&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16},children:[e.jsx("div",{style:{background:"var(--color-bg-secondary)",padding:12,borderRadius:8},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsxs("div",{children:[e.jsx("span",{style:{fontWeight:600},children:k.customerName}),e.jsxs("span",{className:"text-muted",children:[" - ",k.jobTitle]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted",children:"Toplam: "}),e.jsxs("strong",{children:["",Kt(k.amount)]})]})]})}),e.jsx("div",{style:{border:"1px solid var(--color-border)",borderRadius:8,overflow:"hidden"},children:e.jsxs("table",{className:"table",style:{marginBottom:0},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Banka"}),e.jsx("th",{children:"ek No"}),e.jsx("th",{children:"Tutar"}),e.jsx("th",{children:"Vade Tarihi"})]})}),e.jsx("tbody",{children:X.map((x,M)=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("input",{type:"text",className:"form-input",value:x.bank,onChange:w=>{const j=[...X];j[M]={...j[M],bank:w.target.value},Q(j)},placeholder:"Banka ad"})}),e.jsx("td",{children:e.jsx("input",{type:"text",className:"form-input",value:x.chequeNo,onChange:w=>{const j=[...X];j[M]={...j[M],chequeNo:w.target.value},Q(j)},placeholder:"ek numaras"})}),e.jsx("td",{children:e.jsx("input",{type:"number",className:"form-input",value:x.amount,onChange:w=>{const j=[...X];j[M]={...j[M],amount:Number(w.target.value)},Q(j)},style:{width:120}})}),e.jsx("td",{children:e.jsx(Qe,{value:x.due,onChange:w=>{const j=[...X];j[M]={...j[M],due:w},Q(j)}})})]},M))})]})}),e.jsxs("div",{style:{textAlign:"right",fontSize:13},children:[e.jsx("span",{className:"text-muted",children:"Girilen toplam: "}),e.jsxs("strong",{children:["",Kt(X.reduce((x,M)=>x+Number(M.amount||0),0))]})]})]})}),e.jsx(Be,{open:!!y,title:" deme Detay",size:"medium",onClose:()=>p(null),actions:e.jsx("button",{className:"btn btn-primary",onClick:()=>p(null),children:"Kapat"}),children:y&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16},children:[e.jsx("div",{style:{background:"#ecfdf5",padding:16,borderRadius:8},children:e.jsxs("div",{className:"grid grid-2",style:{gap:12},children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-muted",style:{fontSize:11},children:"Mteri"}),e.jsx("div",{style:{fontWeight:600},children:y.customerName})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-muted",style:{fontSize:11},children:""}),e.jsx("div",{style:{fontWeight:600},children:y.jobTitle})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-muted",style:{fontSize:11},children:"deme Tipi"}),e.jsxs("div",{children:[g(y.type)," ",y.typeLabel]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-muted",style:{fontSize:11},children:"Tutar"}),e.jsxs("div",{style:{fontWeight:700,fontSize:18,color:"var(--color-success)"},children:["",Kt(y.amount)]})]})]})}),y.collectedData&&e.jsxs("div",{style:{border:"1px solid var(--color-border)",padding:16,borderRadius:8},children:[e.jsx("h4",{style:{margin:"0 0 12px 0",fontSize:14},children:" Tahsilat Bilgileri"}),e.jsxs("div",{className:"grid grid-2",style:{gap:12},children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-muted",style:{fontSize:11},children:"Tahsilat Tarihi"}),e.jsx("div",{children:Ih(y.collectedData.collectedAt)})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-muted",style:{fontSize:11},children:"Alnan Tutar"}),e.jsxs("div",{style:{fontWeight:600},children:["",Kt(y.collectedData.collectedAmount)]})]}),y.collectedData.isPartial&&e.jsx("div",{style:{gridColumn:"span 2"},children:e.jsx("span",{className:"badge badge-warning",children:"Ksmi Tahsilat"})}),y.collectedData.discountAmount>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-muted",style:{fontSize:11},children:"skonto"}),e.jsxs("div",{style:{color:"var(--color-warning)"},children:["",Kt(y.collectedData.discountAmount)]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-muted",style:{fontSize:11},children:"skonto Sebebi"}),e.jsx("div",{children:y.collectedData.discountReason||"-"})]})]}),y.collectedData.note&&e.jsxs("div",{style:{gridColumn:"span 2"},children:[e.jsx("div",{className:"text-muted",style:{fontSize:11},children:"Not"}),e.jsx("div",{children:y.collectedData.note})]})]})]})]})}),e.jsx(Be,{open:!!m,title:m?` ${m.jobTitle}`:"",size:"medium",onClose:()=>v(null),actions:e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>window.open(`/isler/list?job=${m==null?void 0:m.jobId}&stage=6`,"_blank"),children:" Tam Detay (Yeni Sekme)"}),e.jsx("button",{className:"btn btn-primary",onClick:()=>v(null),children:"Kapat"})]}),children:m&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16},children:[e.jsx("div",{style:{background:"var(--color-bg-secondary)",padding:16,borderRadius:8},children:e.jsxs("div",{className:"grid grid-2",style:{gap:12},children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-muted",style:{fontSize:11},children:" Kodu"}),e.jsx("code",{children:m.jobId})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-muted",style:{fontSize:11},children:"Mteri"}),e.jsx("div",{style:{fontWeight:600},children:m.customerName})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-muted",style:{fontSize:11},children:" Bal"}),e.jsx("div",{style:{fontWeight:600},children:m.jobTitle})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-muted",style:{fontSize:11},children:" Durumu"}),e.jsx("div",{children:Li[m.jobStatus]?e.jsxs("span",{children:[Li[m.jobStatus].icon," ",Li[m.jobStatus].label]}):e.jsx("span",{children:m.jobStatus})})]})]})}),e.jsx("div",{style:{textAlign:"center",padding:20},children:e.jsx("div",{className:"text-muted",style:{marginBottom:8},children:'Detayl i bilgileri iin "Tam Detay" butonuna tklayn'})})]})})]})},nN={todo:{label:"Yaplacak",tone:"secondary",icon:""},in_progress:{label:"Devam Ediyor",tone:"primary",icon:""},blocked:{label:"Bloke",tone:"warning",icon:""},done:{label:"Tamamland",tone:"success",icon:""}},aN={low:{label:"Dk",tone:"secondary"},med:{label:"Orta",tone:"info"},high:{label:"Yksek",tone:"warning"}},Eh=t=>{const s=nN[t]||{label:t,tone:"secondary",icon:""};return e.jsxs("span",{className:`badge badge-${s.tone}`,children:[s.icon," ",s.label]})},Ah=t=>{const s=aN[t]||{label:t,tone:"secondary"};return e.jsx("span",{className:`badge badge-${s.tone}`,children:s.label})},Pi=t=>{if(!t)return"-";try{const s=new Date(t),r=String(s.getDate()).padStart(2,"0"),n=String(s.getMonth()+1).padStart(2,"0"),a=s.getFullYear();return`${r}/${n}/${a}`}catch{return t}},Fa=t=>{if(!t)return"-";try{const s=new Date(t),r=String(s.getDate()).padStart(2,"0"),n=String(s.getMonth()+1).padStart(2,"0"),a=s.getFullYear(),l=String(s.getHours()).padStart(2,"0"),i=String(s.getMinutes()).padStart(2,"0");return`${r}/${n}/${a} ${l}:${i}`}catch{return t}},$a={baslik:"",aciklama:"",oncelik:"med",durum:"todo",baslangicTarihi:"",bitisTarihi:""},lN=()=>{const[t,s]=c.useState([]),[r,n]=c.useState([]),[a,l]=c.useState([]),[i,d]=c.useState(!0),[u,f]=c.useState(""),[N,C]=c.useState(""),[b,L]=c.useState(""),[k,E]=c.useState(""),[y,p]=c.useState(!1),[m,v]=c.useState(!1),[z,W]=c.useState(!1),[F,q]=c.useState(null),[X,Q]=c.useState($a),[A,ue]=c.useState({}),[Z,ae]=c.useState(!1),[$,ne]=c.useState(null),[U,pe]=c.useState(null),[V,D]=c.useState(null),[S,g]=c.useState({assigneeType:"personnel",assigneeId:"",note:""});c.useEffect(()=>{(async()=>{try{d(!0),f("");const[re,ke,Ie]=await Promise.all([vh(),Ql(!0),vn(!0)]);s(re),n(ke),l(Ie)}catch(re){f(re.message||"Grevler alnamad")}finally{d(!1)}})()},[]);const x=c.useMemo(()=>{const T=t.filter(Re=>!Re.deleted).length,re=t.filter(Re=>!Re.deleted&&Re.durum==="todo").length,ke=t.filter(Re=>!Re.deleted&&Re.durum==="in_progress").length,Ie=t.filter(Re=>!Re.deleted&&Re.durum==="blocked").length,Ne=t.filter(Re=>!Re.deleted&&Re.durum==="done").length;return{total:T,todo:re,inProgress:ke,blocked:Ie,done:Ne}},[t]),M=T=>T.assigneeName?T.assigneeType==="team"?` ${T.assigneeName}`:T.assigneeName:"Atanmam",w=c.useMemo(()=>{let T=t.filter(ke=>!ke.deleted);b&&(T=T.filter(ke=>ke.durum===b)),k&&(T=T.filter(ke=>ke.oncelik===k));const re=N.trim().toLowerCase();return re&&(T=T.filter(ke=>(ke.baslik||"").toLowerCase().includes(re)||(ke.aciklama||"").toLowerCase().includes(re))),T},[t,N,b,k]),j=()=>{q(null),Q($a),ue({}),p(!0)},B=T=>{q(T),Q({baslik:T.baslik||"",aciklama:T.aciklama||"",oncelik:T.oncelik||"med",durum:T.durum||"todo",baslangicTarihi:T.baslangicTarihi||"",bitisTarihi:T.bitisTarihi||""}),ue({}),p(!0)},K=T=>{pe(T),g({assigneeType:"personnel",assigneeId:"",note:""}),v(!0)},se=async T=>{try{const re=await $b(T.id);D(re),W(!0)}catch(re){f(re.message||"Grev detay alnamad")}},oe=()=>{const T={};if(X.baslik.trim()||(T.baslik="Balk gerekli"),X.baslangicTarihi&&X.bitisTarihi){const re=new Date(X.baslangicTarihi);new Date(X.bitisTarihi)<re&&(T.bitisTarihi="Biti tarihi balang tarihinden nce olamaz")}return ue(T),Object.keys(T).length===0},O=async T=>{if(T.preventDefault(),!!oe())try{if(ae(!0),f(""),F){const re=await Wb(F.id,X);s(ke=>ke.map(Ie=>Ie.id===re.id?re:Ie)),q(null)}else{const re=await xy(X);s(ke=>[re,...ke])}Q($a),p(!1)}catch(re){f(re.message||"Grev kaydedilemedi")}finally{ae(!1)}},ce=async()=>{if($)try{await Ub($.id),s(T=>T.map(re=>re.id===$.id?{...re,deleted:!0}:re)),ne(null)}catch(T){f(T.message||"Grev silinemedi")}},je=async T=>{if(T.preventDefault(),!U||!S.assigneeId){f("Ltfen atama yaplacak kii veya ekibi sein");return}try{ae(!0),f(""),await qb(U.id,S);const re=await vh();s(re),v(!1),pe(null),g({assigneeType:"personnel",assigneeId:"",note:""})}catch(re){f(re.message||"Atama yaplamad")}finally{ae(!1)}},we=async(T,re)=>{try{const ke=await Kb(T.id,re);s(Ie=>Ie.map(Ne=>Ne.id===ke.id?ke:Ne))}catch(ke){f(ke.message||"Durum gncellenemedi")}},Ee=c.useMemo(()=>[{accessor:"baslik",label:"Grev",render:(T,re)=>e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:T}),re.aciklama&&e.jsxs("div",{className:"text-sm text-muted",children:[re.aciklama.substring(0,50),"..."]})]})},{accessor:"oncelik",label:"ncelik",render:T=>Ah(T)},{accessor:"durum",label:"Durum",render:T=>Eh(T)},{accessor:"bitisTarihi",label:"Termin",render:T=>Pi(T)},{accessor:"assignee",label:"Atanan",render:(T,re)=>M(re)},{accessor:"actions",label:"lem",render:(T,re)=>e.jsxs("div",{className:"action-buttons",children:[e.jsx("button",{className:"btn btn-sm btn-secondary",type:"button",onClick:ke=>{ke.stopPropagation(),se(re)},title:"Detay",children:""}),e.jsx("button",{className:"btn btn-sm btn-primary",type:"button",onClick:ke=>{ke.stopPropagation(),B(re)},title:"Dzenle",children:""}),e.jsx("button",{className:"btn btn-sm btn-info",type:"button",onClick:ke=>{ke.stopPropagation(),K(re)},title:"Ata",children:""}),e.jsx("button",{className:"btn btn-sm btn-danger",type:"button",onClick:ke=>{ke.stopPropagation(),ne(re)},title:"Sil",children:""})]})}],[]);return i?e.jsx(ft,{}):e.jsxs("div",{children:[e.jsx(Fe,{title:"Grevler",subtitle:"Ekip grevlerinizi durumlarna gre takip edin",actions:e.jsx("button",{className:"btn btn-primary",type:"button",onClick:j,children:"+ Yeni Grev"})}),u&&e.jsxs("div",{className:"card error-card",children:[e.jsx("div",{className:"error-title",children:"Hata"}),e.jsx("div",{className:"error-message",children:u})]}),e.jsxs("div",{className:"stats-grid",style:{marginBottom:24},children:[e.jsx(Ks,{icon:"",label:"Toplam Grev",value:x.total,tone:"primary"}),e.jsx(Ks,{icon:"",label:"Yaplacak",value:x.todo,tone:"secondary"}),e.jsx(Ks,{icon:"",label:"Devam Ediyor",value:x.inProgress,tone:"primary"}),e.jsx(Ks,{icon:"",label:"Bloke",value:x.blocked,tone:"warning"}),e.jsx(Ks,{icon:"",label:"Tamamland",value:x.done,tone:"success"})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("div",{className:"filters",children:[e.jsx("input",{type:"text",className:"input",placeholder:"Ara (balk, aklama)...",value:N,onChange:T=>C(T.target.value)}),e.jsxs("select",{className:"select",value:b,onChange:T=>L(T.target.value),children:[e.jsx("option",{value:"",children:"Tm Durumlar"}),e.jsx("option",{value:"todo",children:"Yaplacak"}),e.jsx("option",{value:"in_progress",children:"Devam Ediyor"}),e.jsx("option",{value:"blocked",children:"Bloke"}),e.jsx("option",{value:"done",children:"Tamamland"})]}),e.jsxs("select",{className:"select",value:k,onChange:T=>E(T.target.value),children:[e.jsx("option",{value:"",children:"Tm ncelikler"}),e.jsx("option",{value:"low",children:"Dk"}),e.jsx("option",{value:"med",children:"Orta"}),e.jsx("option",{value:"high",children:"Yksek"})]})]})}),e.jsx(et,{columns:Ee,rows:w,emptyMessage:"Henz grev bulunmamaktadr. Yeni grev oluturmak iin stteki 'Yeni Grev' butonuna tklayn."})]}),e.jsx(Be,{isOpen:y,onClose:()=>{p(!1),q(null),Q($a),ue({})},title:F?" Grev Dzenle":" Yeni Grev Olutur",children:e.jsxs("form",{onSubmit:O,children:[e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{className:"form-label",children:[" Balk ",e.jsx("span",{style:{color:"var(--color-danger)"},children:"*"})]}),e.jsx("input",{type:"text",className:`form-input ${A.baslik?"input-error":""}`,value:X.baslik,onChange:T=>Q({...X,baslik:T.target.value}),placeholder:"rn: Atlye kesim listesi hazrlama"}),A.baslik&&e.jsxs("div",{className:"form-error",style:{marginTop:6,fontSize:13,color:"var(--color-danger)"},children:[" ",A.baslik]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:" Aklama"}),e.jsx("textarea",{className:"form-textarea",rows:"4",value:X.aciklama,onChange:T=>Q({...X,aciklama:T.target.value}),placeholder:"Grev detaylarn buraya yazabilirsiniz...",style:{minHeight:100}})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16,marginBottom:20},children:[e.jsxs("div",{className:"form-group",style:{marginBottom:0},children:[e.jsx("label",{className:"form-label",children:" ncelik"}),e.jsxs("select",{className:"form-select",value:X.oncelik,onChange:T=>Q({...X,oncelik:T.target.value}),children:[e.jsx("option",{value:"low",children:" Dk"}),e.jsx("option",{value:"med",children:" Orta"}),e.jsx("option",{value:"high",children:" Yksek"})]})]}),e.jsxs("div",{className:"form-group",style:{marginBottom:0},children:[e.jsx("label",{className:"form-label",children:" Durum"}),e.jsxs("select",{className:"form-select",value:X.durum,onChange:T=>Q({...X,durum:T.target.value}),children:[e.jsx("option",{value:"todo",children:" Yaplacak"}),e.jsx("option",{value:"in_progress",children:" Devam Ediyor"}),e.jsx("option",{value:"blocked",children:" Bloke"}),e.jsx("option",{value:"done",children:" Tamamland"})]})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16,marginBottom:20},children:[e.jsxs("div",{className:"form-group",style:{marginBottom:0},children:[e.jsx("label",{className:"form-label",children:" Balang Tarihi"}),e.jsx(Qe,{value:X.baslangicTarihi?X.baslangicTarihi.split("T")[0]:"",onChange:T=>Q({...X,baslangicTarihi:T?`${T}T00:00:00`:""}),style:{fontSize:16}})]}),e.jsxs("div",{className:"form-group",style:{marginBottom:0},children:[e.jsx("label",{className:"form-label",children:" Biti Tarihi"}),e.jsx(Qe,{className:`form-input ${A.bitisTarihi?"input-error":""}`,value:X.bitisTarihi?X.bitisTarihi.split("T")[0]:"",onChange:T=>Q({...X,bitisTarihi:T?`${T}T00:00:00`:""}),style:{fontSize:16}}),A.bitisTarihi&&e.jsxs("div",{className:"form-error",style:{marginTop:6,fontSize:13,color:"var(--color-danger)"},children:[" ",A.bitisTarihi]})]})]}),e.jsxs("div",{className:"modal-actions",style:{marginTop:24,paddingTop:20,borderTop:"1px solid var(--color-border)"},children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>p(!1),children:" ptal"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:Z,children:Z?" Kaydediliyor...":F?" Gncelle":" Olutur"})]})]})}),e.jsx(Be,{isOpen:m,onClose:()=>{v(!1),pe(null),g({assigneeType:"personnel",assigneeId:"",note:""})},title:" Grev Ata",children:U&&e.jsxs("form",{onSubmit:je,children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:" Grev"}),e.jsx("div",{style:{padding:"12px 14px",background:"var(--color-bg)",border:"1px solid var(--color-border)",borderRadius:8,fontSize:14,color:"var(--color-text)"},children:U.baslik})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{className:"form-label",children:[" Atama Tipi ",e.jsx("span",{style:{color:"var(--color-danger)"},children:"*"})]}),e.jsxs("select",{className:"form-select",value:S.assigneeType,onChange:T=>g({...S,assigneeType:T.target.value,assigneeId:""}),children:[e.jsx("option",{value:"personnel",children:" Personel"}),e.jsx("option",{value:"team",children:" Ekip"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{className:"form-label",children:[S.assigneeType==="personnel"?" Personel":" Ekip"," ",e.jsx("span",{style:{color:"var(--color-danger)"},children:"*"})]}),e.jsxs("select",{className:"form-select",value:S.assigneeId,onChange:T=>g({...S,assigneeId:T.target.value}),children:[e.jsx("option",{value:"",children:"Sein..."}),S.assigneeType==="personnel"?r.filter(T=>T.aktifMi&&!T.deleted).map(T=>e.jsxs("option",{value:T.id,children:[T.ad," ",T.soyad," ",T.email?`(${T.email})`:""]},T.id)):a.filter(T=>T.aktifMi&&!T.deleted).map(T=>e.jsxs("option",{value:T.id,children:[T.ad," ",T.aciklama?`- ${T.aciklama}`:""]},T.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:" Not (Opsiyonel)"}),e.jsx("textarea",{className:"form-textarea",rows:"3",value:S.note,onChange:T=>g({...S,note:T.target.value}),placeholder:"Atama ile ilgili notlarnz buraya yazabilirsiniz...",style:{minHeight:80}})]}),e.jsxs("div",{className:"modal-actions",style:{marginTop:24,paddingTop:20,borderTop:"1px solid var(--color-border)"},children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>v(!1),children:" ptal"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:Z||!S.assigneeId,children:Z?" Atanyor...":" Ata"})]})]})}),e.jsx(Be,{isOpen:z,onClose:()=>{W(!1),D(null)},title:" Grev Detay",size:"large",children:V&&e.jsxs("div",{children:[e.jsxs("div",{style:{marginBottom:32,paddingBottom:20,borderBottom:"2px solid var(--color-border)"},children:[e.jsx("h2",{style:{fontSize:24,fontWeight:700,marginBottom:12,color:"var(--color-text)"},children:V.baslik}),V.aciklama&&e.jsx("p",{style:{fontSize:15,color:"var(--color-text-light)",lineHeight:1.6,margin:0},children:V.aciklama})]}),e.jsxs("div",{style:{marginBottom:32},children:[e.jsx("h3",{style:{fontSize:16,fontWeight:600,marginBottom:16,color:"var(--color-text)"},children:" Grev Bilgileri"}),e.jsxs("div",{className:"grid grid-2",style:{gap:16},children:[e.jsxs("div",{style:{padding:16,background:"var(--color-bg)",borderRadius:8,border:"1px solid var(--color-border)"},children:[e.jsx("div",{style:{fontSize:12,color:"var(--color-text-light)",marginBottom:6},children:" ncelik"}),e.jsx("div",{style:{fontSize:15,fontWeight:600},children:Ah(V.oncelik)})]}),e.jsxs("div",{style:{padding:16,background:"var(--color-bg)",borderRadius:8,border:"1px solid var(--color-border)"},children:[e.jsx("div",{style:{fontSize:12,color:"var(--color-text-light)",marginBottom:6},children:" Durum"}),e.jsx("div",{style:{fontSize:15,fontWeight:600},children:Eh(V.durum)})]}),e.jsxs("div",{style:{padding:16,background:"var(--color-bg)",borderRadius:8,border:"1px solid var(--color-border)"},children:[e.jsx("div",{style:{fontSize:12,color:"var(--color-text-light)",marginBottom:6},children:" Balang"}),e.jsx("div",{style:{fontSize:15,fontWeight:500},children:Pi(V.baslangicTarihi)||"-"})]}),e.jsxs("div",{style:{padding:16,background:"var(--color-bg)",borderRadius:8,border:"1px solid var(--color-border)"},children:[e.jsx("div",{style:{fontSize:12,color:"var(--color-text-light)",marginBottom:6},children:" Biti"}),e.jsx("div",{style:{fontSize:15,fontWeight:500},children:Pi(V.bitisTarihi)||"-"})]}),e.jsxs("div",{style:{padding:16,background:"var(--color-bg)",borderRadius:8,border:"1px solid var(--color-border)"},children:[e.jsx("div",{style:{fontSize:12,color:"var(--color-text-light)",marginBottom:6},children:" Oluturulma"}),e.jsx("div",{style:{fontSize:13,fontWeight:500},children:Fa(V.createdAt)})]}),e.jsxs("div",{style:{padding:16,background:"var(--color-bg)",borderRadius:8,border:"1px solid var(--color-border)"},children:[e.jsx("div",{style:{fontSize:12,color:"var(--color-text-light)",marginBottom:6},children:" Gncellenme"}),e.jsx("div",{style:{fontSize:13,fontWeight:500},children:Fa(V.updatedAt)})]})]})]}),e.jsxs("div",{style:{marginBottom:32},children:[e.jsx("h3",{style:{fontSize:16,fontWeight:600,marginBottom:16,color:"var(--color-text)"},children:" Mevcut Atamalar"}),V.currentAssignments&&V.currentAssignments.length>0?e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:12},children:V.currentAssignments.map(T=>{const re=r.reduce((Ne,Re)=>(Ne[Re.id]=Re,Ne),{}),ke=a.reduce((Ne,Re)=>(Ne[Re.id]=Re,Ne),{});let Ie="Bilinmiyor";if(T.assigneeType==="personnel"){const Ne=re[T.assigneeId];Ne&&(Ie=`${Ne.ad} ${Ne.soyad}`)}else if(T.assigneeType==="team"){const Ne=ke[T.assigneeId];Ne&&(Ie=` ${Ne.ad}`)}return e.jsxs("div",{style:{padding:16,background:"var(--color-bg)",borderRadius:8,border:"1px solid var(--color-primary)",borderLeftWidth:4},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:8},children:[e.jsx("span",{style:{fontSize:18},children:T.assigneeType==="personnel"?"":""}),e.jsx("strong",{style:{fontSize:15},children:T.assigneeType==="personnel"?"Personel":"Ekip"}),e.jsx("span",{style:{fontSize:15,fontWeight:500},children:Ie})]}),T.note&&e.jsxs("div",{style:{marginTop:8,padding:8,background:"var(--color-white)",borderRadius:4,fontSize:13,color:"var(--color-text-light)"},children:[" ",T.note]}),e.jsxs("div",{style:{fontSize:12,color:"var(--color-text-light)",marginTop:8},children:[" ",Fa(T.createdAt)," tarihinde atand"]})]},T.id)})}):e.jsx("div",{style:{padding:24,textAlign:"center",background:"var(--color-bg)",borderRadius:8,border:"1px dashed var(--color-border)",color:"var(--color-text-light)"},children:" Henz atama yaplmam"})]}),V.assignmentHistory&&V.assignmentHistory.length>0&&e.jsxs("div",{style:{marginBottom:32},children:[e.jsx("h3",{style:{fontSize:16,fontWeight:600,marginBottom:16,color:"var(--color-text)"},children:" Atama Gemii"}),e.jsx("div",{style:{maxHeight:350,overflowY:"auto",display:"flex",flexDirection:"column",gap:10},children:V.assignmentHistory.map(T=>{const re=r.reduce((Ne,Re)=>(Ne[Re.id]=Re,Ne),{}),ke=a.reduce((Ne,Re)=>(Ne[Re.id]=Re,Ne),{});let Ie="Bilinmiyor";if(T.assigneeType==="personnel"){const Ne=re[T.assigneeId];Ne&&(Ie=`${Ne.ad} ${Ne.soyad}`)}else if(T.assigneeType==="team"){const Ne=ke[T.assigneeId];Ne&&(Ie=` ${Ne.ad}`)}return e.jsxs("div",{style:{padding:12,background:"var(--color-bg)",borderRadius:6,borderLeft:T.active?"4px solid var(--color-primary)":"4px solid var(--color-border)",border:"1px solid var(--color-border)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:6},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{children:T.assigneeType==="personnel"?"":""}),e.jsx("strong",{style:{fontSize:14},children:T.assigneeType==="personnel"?"Personel":"Ekip"}),e.jsx("span",{style:{fontSize:14},children:Ie})]}),T.active&&e.jsx("span",{className:"badge badge-success",style:{fontSize:11},children:" Aktif"})]}),e.jsxs("div",{style:{fontSize:12,color:"var(--color-text-light)",marginBottom:T.note?6:0},children:[" ",Fa(T.createdAt)]}),T.note&&e.jsxs("div",{style:{fontSize:13,color:"var(--color-text-light)",marginTop:6,paddingTop:6,borderTop:"1px solid var(--color-border)"},children:[" ",T.note]})]},T.id)})})]}),e.jsxs("div",{className:"modal-actions",style:{marginTop:32,paddingTop:24,borderTop:"2px solid var(--color-border)",display:"flex",gap:12,justifyContent:"flex-end"},children:[V.durum!=="done"&&e.jsx("button",{type:"button",className:"btn btn-success",onClick:()=>{const T=V.durum==="todo"?"in_progress":V.durum==="in_progress"?"done":"todo";we(V,T),W(!1)},children:V.durum==="todo"?" Balat":V.durum==="in_progress"?" Tamamla":" Yeniden A"}),e.jsx("button",{type:"button",className:"btn btn-primary",onClick:()=>{W(!1),B(V)},children:" Dzenle"}),e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>W(!1),children:" Kapat"})]})]})}),e.jsxs(Be,{isOpen:!!$,onClose:()=>ne(null),title:" Grev Sil",children:[e.jsxs("div",{style:{padding:"8px 0"},children:[e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",marginBottom:24,fontSize:48},children:""}),e.jsxs("p",{style:{fontSize:16,textAlign:"center",marginBottom:8,color:"var(--color-text)",lineHeight:1.6},children:[e.jsx("strong",{style:{fontSize:18,color:"var(--color-danger)"},children:$&&$.baslik})," ","grevini silmek istediinize emin misiniz?"]}),e.jsx("p",{style:{fontSize:13,textAlign:"center",color:"var(--color-text-light)",marginBottom:0},children:"Bu ilem geri alnamaz ve grev listeden kaldrlacaktr."})]}),e.jsxs("div",{className:"modal-actions",style:{marginTop:32,paddingTop:20,borderTop:"1px solid var(--color-border)"},children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>ne(null),children:" ptal"}),e.jsx("button",{type:"button",className:"btn btn-danger",onClick:ce,children:" Sil"})]})]})]})},Wa={ad:"",soyad:"",email:"",telefon:"",unvan:"",aktifMi:!0,rolId:""},iN=()=>{const[t,s]=c.useState([]),[r,n]=c.useState([]),[a,l]=c.useState(!0),[i,d]=c.useState(""),[u,f]=c.useState(""),[N,C]=c.useState(null),[b,L]=c.useState(!1),[k,E]=c.useState(null),[y,p]=c.useState(Wa),[m,v]=c.useState({}),[z,W]=c.useState(!1),[F,q]=c.useState(null),[X,Q]=c.useState(null);c.useEffect(()=>{(async()=>{try{l(!0),d("");const[S,g]=await Promise.all([Ql(),vy(!0)]);s(S),n(g)}catch(S){d(S.message||"Personel verileri alnamad")}finally{l(!1)}})()},[]);const A=c.useMemo(()=>{let D=t.filter(g=>!g.deleted);N!==null&&(D=D.filter(g=>g.aktifMi===N));const S=u.trim().toLowerCase();return S&&(D=D.filter(g=>(g.ad||"").toLowerCase().includes(S)||(g.soyad||"").toLowerCase().includes(S)||(g.email||"").toLowerCase().includes(S)||(g.unvan||"").toLowerCase().includes(S))),D},[t,u,N]),ue=()=>{E(null),p(Wa),v({}),L(!0)},Z=D=>{E(D),p({ad:D.ad||"",soyad:D.soyad||"",email:D.email||"",telefon:D.telefon||"",unvan:D.unvan||"",aktifMi:D.aktifMi!==!1,rolId:D.rolId||""}),v({}),L(!0)},ae=()=>{const D={};return y.ad.trim()||(D.ad="Ad gerekli"),y.soyad.trim()||(D.soyad="Soyad gerekli"),y.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(y.email)||(D.email="Geerli bir e-posta adresi girin"):D.email="E-posta gerekli",v(D),Object.keys(D).length===0},$=async D=>{if(D.preventDefault(),!!ae())try{if(W(!0),d(""),k){const S=await Yb(k.id,y);s(g=>g.map(x=>x.id===S.id?S:x)),E(null)}else{const S=await Hb(y);s(g=>[S,...g])}p(Wa),L(!1)}catch(S){d(S.message||"Kayt baarsz")}finally{W(!1)}},ne=async(D,S)=>{try{const g=await Vb(D.id,S);s(x=>x.map(M=>M.id===g.id?g:M))}catch(g){d(g.message||"Durum gncelleme baarsz")}},U=async()=>{if(F)try{await Gb(F.id),s(D=>D.map(S=>S.id===F.id?{...S,deleted:!0,aktifMi:!1}:S)),q(null)}catch(D){d(D.message||"Silme ilemi baarsz")}},pe=D=>{const S=r.find(g=>g.id===D);return S?S.ad:"Rol yok"},V=c.useMemo(()=>[{accessor:"ad",label:"Ad Soyad",render:(D,S)=>e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:`${S.ad} ${S.soyad}`}),S.unvan&&e.jsx("div",{className:"text-sm text-muted",children:S.unvan})]})},{accessor:"email",label:"E-posta"},{accessor:"telefon",label:"Telefon"},{accessor:"rolId",label:"Rol",render:D=>e.jsx("span",{className:"badge badge-secondary",children:pe(D)})},{accessor:"aktifMi",label:"Durum",render:D=>e.jsx("span",{className:`badge ${D?"badge-success":"badge-secondary"}`,children:D?"Aktif":"Pasif"})},{accessor:"actions",label:"lem",render:(D,S)=>e.jsxs("div",{className:"action-buttons",children:[e.jsx("button",{className:"btn btn-sm btn-secondary",type:"button",onClick:g=>{g.stopPropagation(),Z(S)},children:"Dzenle"}),e.jsx("button",{className:`btn btn-sm ${S.aktifMi?"btn-warning":"btn-success"}`,type:"button",onClick:g=>{g.stopPropagation(),ne(S,!S.aktifMi)},children:S.aktifMi?"Pasif Yap":"Aktif Yap"}),e.jsx("button",{className:"btn btn-sm btn-danger",type:"button",onClick:g=>{g.stopPropagation(),q(S)},children:"Sil"})]})}],[r]);return a?e.jsx(ft,{}):e.jsxs("div",{children:[e.jsx(Fe,{title:"Personel Ynetimi",subtitle:"Personel bilgilerini grntleyin ve ynetin",actions:e.jsx("button",{className:"btn btn-primary",type:"button",onClick:ue,children:"+ Yeni Personel"})}),i&&e.jsxs("div",{className:"card error-card",children:[e.jsx("div",{className:"error-title",children:"Hata"}),e.jsx("div",{className:"error-message",children:i})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("div",{className:"filters",children:[e.jsx("input",{type:"text",className:"input",placeholder:"Ara (ad, soyad, e-posta, nvan)...",value:u,onChange:D=>f(D.target.value)}),e.jsxs("select",{className:"select",value:N===null?"all":N?"aktif":"pasif",onChange:D=>{const S=D.target.value;C(S==="all"?null:S==="aktif")},children:[e.jsx("option",{value:"all",children:"Tm"}),e.jsx("option",{value:"aktif",children:"Aktif"}),e.jsx("option",{value:"pasif",children:"Pasif"})]})]})}),e.jsx(et,{columns:V,rows:A})]}),e.jsx(Be,{isOpen:b,onClose:()=>{L(!1),E(null),p(Wa),v({})},title:k?" Personel Dzenle":" Yeni Personel",children:e.jsxs("form",{onSubmit:$,children:[e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{className:"form-label",children:[" Ad ",e.jsx("span",{style:{color:"var(--color-danger)"},children:"*"})]}),e.jsx("input",{type:"text",className:`form-input ${m.ad?"input-error":""}`,value:y.ad,onChange:D=>p({...y,ad:D.target.value}),placeholder:"rn: Ahmet"}),m.ad&&e.jsxs("div",{className:"form-error",style:{marginTop:6,fontSize:13,color:"var(--color-danger)"},children:[" ",m.ad]})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{className:"form-label",children:[" Soyad ",e.jsx("span",{style:{color:"var(--color-danger)"},children:"*"})]}),e.jsx("input",{type:"text",className:`form-input ${m.soyad?"input-error":""}`,value:y.soyad,onChange:D=>p({...y,soyad:D.target.value}),placeholder:"rn: Ylmaz"}),m.soyad&&e.jsxs("div",{className:"form-error",style:{marginTop:6,fontSize:13,color:"var(--color-danger)"},children:[" ",m.soyad]})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{className:"form-label",children:[" E-posta ",e.jsx("span",{style:{color:"var(--color-danger)"},children:"*"})]}),e.jsx("input",{type:"email",className:`form-input ${m.email?"input-error":""}`,value:y.email,onChange:D=>p({...y,email:D.target.value}),placeholder:"ornek@email.com"}),m.email&&e.jsxs("div",{className:"form-error",style:{marginTop:6,fontSize:13,color:"var(--color-danger)"},children:[" ",m.email]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16,marginBottom:20},children:[e.jsxs("div",{className:"form-group",style:{marginBottom:0},children:[e.jsx("label",{className:"form-label",children:" Telefon"}),e.jsx("input",{type:"text",className:"form-input",value:y.telefon,onChange:D=>p({...y,telefon:D.target.value}),placeholder:"+90 555 123 4567"})]}),e.jsxs("div",{className:"form-group",style:{marginBottom:0},children:[e.jsx("label",{className:"form-label",children:" nvan"}),e.jsx("input",{type:"text",className:"form-input",value:y.unvan,onChange:D=>p({...y,unvan:D.target.value}),placeholder:"rn: Proje Mdr"})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16,marginBottom:20},children:[e.jsxs("div",{className:"form-group",style:{marginBottom:0},children:[e.jsx("label",{className:"form-label",children:" Rol"}),e.jsxs("select",{className:"form-select",value:y.rolId,onChange:D=>p({...y,rolId:D.target.value}),children:[e.jsx("option",{value:"",children:"Rol sein..."}),r.map(D=>e.jsx("option",{value:D.id,children:D.ad},D.id))]})]}),e.jsx("div",{className:"form-group",style:{marginBottom:0,display:"flex",alignItems:"flex-end"},children:e.jsxs("label",{className:"form-label",style:{display:"flex",alignItems:"center",gap:8,cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:y.aktifMi,onChange:D=>p({...y,aktifMi:D.target.checked}),style:{width:18,height:18,cursor:"pointer"}})," Aktif"]})})]}),e.jsxs("div",{className:"modal-actions",style:{marginTop:24,paddingTop:20,borderTop:"1px solid var(--color-border)"},children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>L(!1),children:" ptal"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:z,children:z?" Kaydediliyor...":k?" Gncelle":" Olutur"})]})]})}),e.jsxs(Be,{isOpen:!!F,onClose:()=>q(null),title:" Personel Sil",children:[e.jsxs("div",{style:{padding:"8px 0"},children:[e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",marginBottom:24,fontSize:48},children:""}),e.jsxs("p",{style:{fontSize:16,textAlign:"center",marginBottom:8,color:"var(--color-text)",lineHeight:1.6},children:[e.jsx("strong",{style:{fontSize:18,color:"var(--color-danger)"},children:F&&`${F.ad} ${F.soyad}`})," ","personelini silmek istediinize emin misiniz?"]}),e.jsx("p",{style:{fontSize:13,textAlign:"center",color:"var(--color-text-light)",marginBottom:0},children:"Bu ilem geri alnamaz ve personel listeden kaldrlacaktr."})]}),e.jsxs("div",{className:"modal-actions",style:{marginTop:32,paddingTop:20,borderTop:"1px solid var(--color-border)"},children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>q(null),children:" ptal"}),e.jsx("button",{type:"button",className:"btn btn-danger",onClick:U,children:" Sil"})]})]})]})},Ka={ad:"",aciklama:"",aktifMi:!0},oN=()=>{const[t,s]=c.useState([]),[r,n]=c.useState([]),[a,l]=c.useState(!0),[i,d]=c.useState(""),[u,f]=c.useState(""),[N,C]=c.useState(null),[b,L]=c.useState(!1),[k,E]=c.useState(!1),[y,p]=c.useState(null),[m,v]=c.useState([]),[z,W]=c.useState(null),[F,q]=c.useState(Ka),[X,Q]=c.useState({}),[A,ue]=c.useState(!1),[Z,ae]=c.useState(null),[$,ne]=c.useState("");c.useEffect(()=>{(async()=>{try{l(!0),d("");const[se,oe]=await Promise.all([vn(),Ql(!0)]);s(se),n(oe)}catch(se){d(se.message||"Ekip verileri alnamad")}finally{l(!1)}})()},[]);const U=c.useMemo(()=>{let K=t.filter(oe=>!oe.deleted);N!==null&&(K=K.filter(oe=>oe.aktifMi===N));const se=u.trim().toLowerCase();return se&&(K=K.filter(oe=>(oe.ad||"").toLowerCase().includes(se)||(oe.aciklama||"").toLowerCase().includes(se))),K},[t,u,N]),pe=()=>{W(null),q(Ka),Q({}),L(!0)},V=K=>{W(K),q({ad:K.ad||"",aciklama:K.aciklama||"",aktifMi:K.aktifMi!==!1}),Q({}),L(!0)},D=async K=>{p(K);try{const se=await Ei(K.id);v(se),E(!0)}catch(se){d(se.message||"yeler yklenemedi")}},S=()=>{const K={};return F.ad.trim()||(K.ad="Ekip ad gerekli"),Q(K),Object.keys(K).length===0},g=async K=>{if(K.preventDefault(),!!S())try{if(ue(!0),d(""),z){const se=await e0(z.id,F);s(oe=>oe.map(O=>O.id===se.id?se:O)),W(null)}else{const se=await Zb(F);s(oe=>[se,...oe])}q(Ka),L(!1)}catch(se){d(se.message||"Kayt baarsz")}finally{ue(!1)}},x=async()=>{if(Z)try{await t0(Z.id),s(K=>K.map(se=>se.id===Z.id?{...se,deleted:!0,aktifMi:!1}:se)),ae(null)}catch(K){d(K.message||"Silme ilemi baarsz")}},M=async()=>{if(!(!y||!$))try{await s0(y.id,$);const K=await Ei(y.id);v(K),ne("")}catch(K){d(K.message||"ye ekleme baarsz")}},w=async K=>{if(y)try{await r0(y.id,K);const se=await Ei(y.id);v(se)}catch(se){d(se.message||"ye karma baarsz")}},j=K=>{const se=r.find(oe=>oe.id===K);return se?`${se.ad} ${se.soyad}`:"Bilinmiyor"},B=c.useMemo(()=>[{accessor:"ad",label:"Ekip Ad"},{accessor:"aciklama",label:"Aklama"},{accessor:"aktifMi",label:"Durum",render:K=>e.jsx("span",{className:`badge ${K?"badge-success":"badge-secondary"}`,children:K?"Aktif":"Pasif"})},{accessor:"actions",label:"lem",render:(K,se)=>e.jsxs("div",{className:"action-buttons",children:[e.jsx("button",{className:"btn btn-sm btn-secondary",type:"button",onClick:oe=>{oe.stopPropagation(),D(se)},children:"yeler"}),e.jsx("button",{className:"btn btn-sm btn-secondary",type:"button",onClick:oe=>{oe.stopPropagation(),V(se)},children:"Dzenle"}),e.jsx("button",{className:"btn btn-sm btn-danger",type:"button",onClick:oe=>{oe.stopPropagation(),ae(se)},children:"Sil"})]})}],[r]);return a?e.jsx(ft,{}):e.jsxs("div",{children:[e.jsx(Fe,{title:"Ekip Ynetimi",subtitle:"Ekipleri grntleyin ve ynetin",actions:e.jsx("button",{className:"btn btn-primary",type:"button",onClick:pe,children:"+ Yeni Ekip"})}),i&&e.jsxs("div",{className:"card error-card",children:[e.jsx("div",{className:"error-title",children:"Hata"}),e.jsx("div",{className:"error-message",children:i})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("div",{className:"filters",children:[e.jsx("input",{type:"text",className:"input",placeholder:"Ara (ad, aklama)...",value:u,onChange:K=>f(K.target.value)}),e.jsxs("select",{className:"select",value:N===null?"all":N?"aktif":"pasif",onChange:K=>{const se=K.target.value;C(se==="all"?null:se==="aktif")},children:[e.jsx("option",{value:"all",children:"Tm"}),e.jsx("option",{value:"aktif",children:"Aktif"}),e.jsx("option",{value:"pasif",children:"Pasif"})]})]})}),e.jsx(et,{columns:B,rows:U})]}),e.jsx(Be,{isOpen:b,onClose:()=>{L(!1),W(null),q(Ka),Q({})},title:z?" Ekip Dzenle":" Yeni Ekip",children:e.jsxs("form",{onSubmit:g,children:[e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{className:"form-label",children:[" Ekip Ad ",e.jsx("span",{style:{color:"var(--color-danger)"},children:"*"})]}),e.jsx("input",{type:"text",className:`form-input ${X.ad?"input-error":""}`,value:F.ad,onChange:K=>q({...F,ad:K.target.value}),placeholder:"rn: retim Ekibi"}),X.ad&&e.jsxs("div",{className:"form-error",style:{marginTop:6,fontSize:13,color:"var(--color-danger)"},children:[" ",X.ad]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:" Aklama"}),e.jsx("textarea",{className:"form-textarea",rows:"4",value:F.aciklama,onChange:K=>q({...F,aciklama:K.target.value}),placeholder:"Ekip hakknda aklama yazabilirsiniz...",style:{minHeight:100}})]}),e.jsx("div",{className:"form-group",children:e.jsxs("label",{className:"form-label",style:{display:"flex",alignItems:"center",gap:8,cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:F.aktifMi,onChange:K=>q({...F,aktifMi:K.target.checked}),style:{width:18,height:18,cursor:"pointer"}})," Aktif"]})}),e.jsxs("div",{className:"modal-actions",style:{marginTop:24,paddingTop:20,borderTop:"1px solid var(--color-border)"},children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>L(!1),children:" ptal"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:A,children:A?" Kaydediliyor...":z?" Gncelle":" Olutur"})]})]})}),e.jsxs(Be,{isOpen:k,onClose:()=>{E(!1),p(null),v([]),ne("")},title:y?` ${y.ad} - yeler`:" Ekip yeleri",children:[e.jsxs("div",{className:"form-group",style:{marginBottom:24},children:[e.jsx("label",{className:"form-label",children:" Yeni ye Ekle"}),e.jsxs("div",{style:{display:"flex",gap:12},children:[e.jsxs("select",{className:"form-select",style:{flex:1},value:$,onChange:K=>ne(K.target.value),children:[e.jsx("option",{value:"",children:"Personel sein..."}),r.filter(K=>K.aktifMi&&!K.deleted&&!m.some(se=>se.personnelId===K.id)).map(K=>e.jsxs("option",{value:K.id,children:[K.ad," ",K.soyad," ",K.email?`(${K.email})`:""]},K.id))]}),e.jsx("button",{type:"button",className:"btn btn-primary",onClick:M,disabled:!$,children:" Ekle"})]})]}),e.jsxs("div",{style:{borderTop:"1px solid var(--color-border)",paddingTop:16},children:[e.jsx("h4",{style:{fontSize:15,fontWeight:600,marginBottom:12,color:"var(--color-text)"},children:" Mevcut yeler"}),m.length===0?e.jsx("div",{style:{padding:32,textAlign:"center",background:"var(--color-bg)",borderRadius:8,border:"1px dashed var(--color-border)",color:"var(--color-text-light)"},children:" Henz ye eklenmemi"}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:m.map(K=>e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:12,background:"var(--color-bg)",borderRadius:8,border:"1px solid var(--color-border)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{style:{fontSize:18},children:""}),e.jsx("span",{style:{fontSize:14,fontWeight:500},children:j(K.personnelId)})]}),e.jsx("button",{type:"button",className:"btn btn-sm btn-danger",onClick:()=>w(K.personnelId),children:" kar"})]},K.id))})]})]}),e.jsxs(Be,{isOpen:!!Z,onClose:()=>ae(null),title:" Ekip Sil",children:[e.jsxs("div",{style:{padding:"8px 0"},children:[e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",marginBottom:24,fontSize:48},children:""}),e.jsxs("p",{style:{fontSize:16,textAlign:"center",marginBottom:8,color:"var(--color-text)",lineHeight:1.6},children:[e.jsx("strong",{style:{fontSize:18,color:"var(--color-danger)"},children:Z&&Z.ad})," ","ekibini silmek istediinize emin misiniz?"]}),e.jsx("p",{style:{fontSize:13,textAlign:"center",color:"var(--color-text-light)",marginBottom:0},children:"Bu ilem geri alnamaz ve ekip listeden kaldrlacaktr."})]}),e.jsxs("div",{className:"modal-actions",style:{marginTop:32,paddingTop:20,borderTop:"1px solid var(--color-border)"},children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>ae(null),children:" ptal"}),e.jsx("button",{type:"button",className:"btn btn-danger",onClick:x,children:" Sil"})]})]})]})},Ua={ad:"",aciklama:"",permissions:[],aktifMi:!0},cN=[{value:"*",label:"Tm Yetkiler (Admin)"},{value:"tasks.*",label:"Tm Grev lemleri"},{value:"tasks.view",label:"Grevleri Grntle"},{value:"tasks.create",label:"Grev Olutur"},{value:"tasks.update",label:"Grev Gncelle"},{value:"tasks.delete",label:"Grev Sil"},{value:"personnel.*",label:"Tm Personel lemleri"},{value:"personnel.view",label:"Personeli Grntle"},{value:"personnel.create",label:"Personel Olutur"},{value:"personnel.update",label:"Personel Gncelle"},{value:"teams.*",label:"Tm Ekip lemleri"},{value:"teams.view",label:"Ekipleri Grntle"},{value:"teams.create",label:"Ekip Olutur"},{value:"teams.update",label:"Ekip Gncelle"}],dN=()=>{const[t,s]=c.useState([]),[r,n]=c.useState(!0),[a,l]=c.useState(""),[i,d]=c.useState(""),[u,f]=c.useState(null),[N,C]=c.useState(!1),[b,L]=c.useState(null),[k,E]=c.useState(Ua),[y,p]=c.useState({}),[m,v]=c.useState(!1),[z,W]=c.useState(null);c.useEffect(()=>{(async()=>{try{n(!0),l("");const ne=await vy();s(ne)}catch(ne){l(ne.message||"Rol verileri alnamad")}finally{n(!1)}})()},[]);const F=c.useMemo(()=>{let $=t.filter(U=>!U.deleted);u!==null&&($=$.filter(U=>U.aktifMi===u));const ne=i.trim().toLowerCase();return ne&&($=$.filter(U=>(U.ad||"").toLowerCase().includes(ne)||(U.aciklama||"").toLowerCase().includes(ne))),$},[t,i,u]),q=()=>{L(null),E(Ua),p({}),C(!0)},X=$=>{L($),E({ad:$.ad||"",aciklama:$.aciklama||"",permissions:$.permissions||[],aktifMi:$.aktifMi!==!1}),p({}),C(!0)},Q=()=>{const $={};return k.ad.trim()||($.ad="Rol ad gerekli"),p($),Object.keys($).length===0},A=$=>{E(ne=>{const U=ne.permissions||[];return U.includes($)?{...ne,permissions:U.filter(pe=>pe!==$)}:{...ne,permissions:[...U,$]}})},ue=async $=>{if($.preventDefault(),!!Q())try{if(v(!0),l(""),b){const ne=await Jb(b.id,k);s(U=>U.map(pe=>pe.id===ne.id?ne:pe)),L(null)}else{const ne=await Qb(k);s(U=>[ne,...U])}E(Ua),C(!1)}catch(ne){l(ne.message||"Kayt baarsz")}finally{v(!1)}},Z=async()=>{if(z)try{await Xb(z.id),s($=>$.map(ne=>ne.id===z.id?{...ne,deleted:!0,aktifMi:!1}:ne)),W(null)}catch($){l($.message||"Silme ilemi baarsz")}},ae=c.useMemo(()=>[{accessor:"ad",label:"Rol Ad"},{accessor:"aciklama",label:"Aklama"},{accessor:"permissions",label:"zinler",render:$=>e.jsxs("span",{className:"badge badge-info",children:[($==null?void 0:$.length)||0," izin"]})},{accessor:"aktifMi",label:"Durum",render:$=>e.jsx("span",{className:`badge ${$?"badge-success":"badge-secondary"}`,children:$?"Aktif":"Pasif"})},{accessor:"actions",label:"lem",render:($,ne)=>e.jsxs("div",{className:"action-buttons",children:[e.jsx("button",{className:"btn btn-sm btn-secondary",type:"button",onClick:U=>{U.stopPropagation(),X(ne)},children:"Dzenle"}),e.jsx("button",{className:"btn btn-sm btn-danger",type:"button",onClick:U=>{U.stopPropagation(),W(ne)},children:"Sil"})]})}],[]);return r?e.jsx(ft,{}):e.jsxs("div",{children:[e.jsx(Fe,{title:"Rol Ynetimi",subtitle:"Rolleri ve izinleri ynetin",actions:e.jsx("button",{className:"btn btn-primary",type:"button",onClick:q,children:"+ Yeni Rol"})}),a&&e.jsxs("div",{className:"card error-card",children:[e.jsx("div",{className:"error-title",children:"Hata"}),e.jsx("div",{className:"error-message",children:a})]}),e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsxs("div",{className:"filters",children:[e.jsx("input",{type:"text",className:"input",placeholder:"Ara (ad, aklama)...",value:i,onChange:$=>d($.target.value)}),e.jsxs("select",{className:"select",value:u===null?"all":u?"aktif":"pasif",onChange:$=>{const ne=$.target.value;f(ne==="all"?null:ne==="aktif")},children:[e.jsx("option",{value:"all",children:"Tm"}),e.jsx("option",{value:"aktif",children:"Aktif"}),e.jsx("option",{value:"pasif",children:"Pasif"})]})]})}),e.jsx(et,{columns:ae,rows:F})]}),e.jsx(Be,{isOpen:N,onClose:()=>{C(!1),L(null),E(Ua),p({})},title:b?" Rol Dzenle":" Yeni Rol",children:e.jsxs("form",{onSubmit:ue,children:[e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{className:"form-label",children:[" Rol Ad ",e.jsx("span",{style:{color:"var(--color-danger)"},children:"*"})]}),e.jsx("input",{type:"text",className:`form-input ${y.ad?"input-error":""}`,value:k.ad,onChange:$=>E({...k,ad:$.target.value}),placeholder:"rn: admin, manager, user"}),y.ad&&e.jsxs("div",{className:"form-error",style:{marginTop:6,fontSize:13,color:"var(--color-danger)"},children:[" ",y.ad]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:" Aklama"}),e.jsx("textarea",{className:"form-textarea",rows:"3",value:k.aciklama,onChange:$=>E({...k,aciklama:$.target.value}),placeholder:"Rol hakknda aklama yazabilirsiniz...",style:{minHeight:80}})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:" zinler"}),e.jsx("div",{style:{padding:16,background:"var(--color-bg)",borderRadius:8,border:"1px solid var(--color-border)",maxHeight:200,overflowY:"auto",display:"flex",flexDirection:"column",gap:10},children:cN.map($=>e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8,cursor:"pointer",padding:"4px 0"},children:[e.jsx("input",{type:"checkbox",checked:k.permissions.includes($.value),onChange:()=>A($.value),style:{width:18,height:18,cursor:"pointer"}}),e.jsx("span",{style:{fontSize:14},children:$.label})]},$.value))})]}),e.jsx("div",{className:"form-group",children:e.jsxs("label",{className:"form-label",style:{display:"flex",alignItems:"center",gap:8,cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:k.aktifMi,onChange:$=>E({...k,aktifMi:$.target.checked}),style:{width:18,height:18,cursor:"pointer"}})," Aktif"]})}),e.jsxs("div",{className:"modal-actions",style:{marginTop:24,paddingTop:20,borderTop:"1px solid var(--color-border)"},children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>C(!1),children:" ptal"}),e.jsx("button",{type:"submit",className:"btn btn-primary",disabled:m,children:m?" Kaydediliyor...":b?" Gncelle":" Olutur"})]})]})}),e.jsxs(Be,{isOpen:!!z,onClose:()=>W(null),title:" Rol Sil",children:[e.jsxs("div",{style:{padding:"8px 0"},children:[e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",marginBottom:24,fontSize:48},children:""}),e.jsxs("p",{style:{fontSize:16,textAlign:"center",marginBottom:8,color:"var(--color-text)",lineHeight:1.6},children:[e.jsx("strong",{style:{fontSize:18,color:"var(--color-danger)"},children:z&&z.ad})," ","roln silmek istediinize emin misiniz?"]}),e.jsx("p",{style:{fontSize:13,textAlign:"center",color:"var(--color-text-light)",marginBottom:0},children:"Bu ilem geri alnamaz ve rol listeden kaldrlacaktr."})]}),e.jsxs("div",{className:"modal-actions",style:{marginTop:32,paddingTop:20,borderTop:"1px solid var(--color-border)"},children:[e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>W(null),children:" ptal"}),e.jsx("button",{type:"button",className:"btn btn-danger",onClick:Z,children:" Sil"})]})]})]})},uN=()=>{const[t,s]=c.useState([]),[r,n]=c.useState(!0),[a,l]=c.useState(""),[i,d]=c.useState(!1),[u,f]=c.useState(null),[N,C]=c.useState({customerId:"",customerName:"",title:"",startType:"OLCU",newCustomer:!1,segment:"B2B",location:"",contact:""});c.useEffect(()=>{(async()=>{try{n(!0),l("");const E=await Jl();s(E.filter(y=>!y.deleted))}catch(E){l(E.message||"Mteriler alnamad")}finally{n(!1)}})()},[]);const b=async k=>{k.preventDefault();try{d(!0),l("");let E=N.customerId,y=N.customerName;if(N.newCustomer){const m=await Uc({name:N.customerName,segment:N.segment,location:N.location,contact:N.contact});E=m.id,y=m.name,s(v=>[m,...v])}const p=await yy({customerId:E,customerName:y,title:N.title,startType:N.startType});f(p),C({customerId:"",customerName:"",title:"",startType:"OLCU",newCustomer:!1,segment:"B2B",location:"",contact:""})}catch(E){l(E.message||" oluturulamad")}finally{d(!1)}},L=t.find(k=>k.id===N.customerId);return e.jsxs("div",{children:[e.jsx(Fe,{title:"Yeni  Balat (Wizard)",subtitle:"Mteri se ve balang trn belirle"}),a?e.jsxs("div",{className:"card error-card",children:[e.jsx("div",{className:"error-title",children:"Hata"}),e.jsx("div",{className:"error-message",children:a})]}):null,e.jsxs("form",{className:"card",onSubmit:b,children:[e.jsxs("div",{className:"grid grid-2",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",htmlFor:"job-title",children:" Bal"}),e.jsx("input",{id:"job-title",className:"form-input",placeholder:"rn: Balkon PVC Dorama",value:N.title,onChange:k=>C(E=>({...E,title:k.target.value})),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",htmlFor:"start-type",children:"Balatma Tr"}),e.jsxs("select",{id:"start-type",className:"form-select",value:N.startType,onChange:k=>C(E=>({...E,startType:k.target.value})),children:[e.jsx("option",{value:"OLCU",children:"l ile Balat"}),e.jsx("option",{value:"FIYATLANDIRMA",children:"Fiyatlandrma ile Balat"})]})]})]}),e.jsxs("div",{className:"card",style:{marginTop:12},children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"card-title",children:"Mteri"})}),e.jsxs("div",{className:"card-body",style:{display:"flex",gap:16,flexDirection:"column"},children:[e.jsxs("label",{className:"form-label",style:{display:"flex",gap:8,alignItems:"center"},children:[e.jsx("input",{type:"radio",name:"customer-mode",checked:!N.newCustomer,onChange:()=>C(k=>({...k,newCustomer:!1}))}),"Mevcut mteriden se"]}),N.newCustomer?null:e.jsxs("select",{className:"form-select",value:N.customerId,onChange:k=>{const E=k.target.value,y=t.find(p=>p.id===E);C(p=>({...p,customerId:E,customerName:(y==null?void 0:y.name)||""}))},required:!0,children:[e.jsx("option",{value:"",children:"Mteri sein"}),t.map(k=>e.jsxs("option",{value:k.id,children:[k.name," (",k.segment,")"]},k.id))]}),e.jsxs("label",{className:"form-label",style:{display:"flex",gap:8,alignItems:"center"},children:[e.jsx("input",{type:"radio",name:"customer-mode",checked:N.newCustomer,onChange:()=>C(k=>({...k,newCustomer:!0,customerId:"",customerName:""}))}),"Yeni mteri olutur"]}),N.newCustomer?e.jsxs("div",{className:"grid grid-2",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",htmlFor:"new-name",children:"Ad"}),e.jsx("input",{id:"new-name",className:"form-input",value:N.customerName,onChange:k=>C(E=>({...E,customerName:k.target.value})),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",htmlFor:"new-segment",children:"Segment"}),e.jsxs("select",{id:"new-segment",className:"form-select",value:N.segment,onChange:k=>C(E=>({...E,segment:k.target.value})),children:[e.jsx("option",{value:"B2B",children:"B2B"}),e.jsx("option",{value:"B2C",children:"B2C"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",htmlFor:"new-location",children:"Lokasyon"}),e.jsx("input",{id:"new-location",className:"form-input",value:N.location,onChange:k=>C(E=>({...E,location:k.target.value}))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",htmlFor:"new-contact",children:"letiim"}),e.jsx("input",{id:"new-contact",className:"form-input",value:N.contact,onChange:k=>C(E=>({...E,contact:k.target.value}))})]})]}):L?e.jsxs("div",{className:"card subtle-card",children:[e.jsxs("div",{className:"metric-row",children:[e.jsx("span",{className:"metric-label",children:"Segment"}),e.jsx("span",{className:"metric-value",children:L.segment})]}),e.jsxs("div",{className:"metric-row",children:[e.jsx("span",{className:"metric-label",children:"Lokasyon"}),e.jsx("span",{className:"metric-value",children:L.location})]}),e.jsxs("div",{className:"metric-row",children:[e.jsx("span",{className:"metric-label",children:"letiim"}),e.jsx("span",{className:"metric-value",children:L.contact})]})]}):null]})]}),e.jsxs("div",{className:"page-actions",style:{marginTop:16},children:[e.jsx("button",{className:"btn btn-secondary",type:"button",onClick:()=>f(null),children:"Temizle"}),e.jsx("button",{className:"btn btn-primary",type:"submit",disabled:i,children:i?"Kaydediliyor...":"Kaydet ve Balat"})]})]}),u?e.jsxs("div",{className:"card",style:{marginTop:24},children:[e.jsxs("div",{className:"card-header",children:[e.jsx("h3",{className:"card-title",children:" oluturuldu"}),e.jsx("span",{className:"badge badge-primary",children:u.id})]}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"metric-list",children:[e.jsxs("div",{className:"metric-row",children:[e.jsx("span",{className:"metric-label",children:" Bal"}),e.jsx("span",{className:"metric-value",children:u.title})]}),e.jsxs("div",{className:"metric-row",children:[e.jsx("span",{className:"metric-label",children:"Mteri"}),e.jsx("span",{className:"metric-value",children:u.customerName})]}),e.jsxs("div",{className:"metric-row",children:[e.jsx("span",{className:"metric-label",children:"Durum"}),e.jsx("span",{className:"metric-value",children:u.status})]}),e.jsxs("div",{className:"metric-row",children:[e.jsx("span",{className:"metric-label",children:"Balatma"}),e.jsx("span",{className:"metric-value",children:u.startType})]})]})})]}):null]})},mN=[{code:"+90",iso:"TR",flag:"",format:"### ### ## ##"},{code:"+49",iso:"DE",flag:"",format:"### ### ####"},{code:"+44",iso:"GB",flag:"",format:"#### ### ###"},{code:"+1",iso:"US",flag:"",format:"### ### ####"},{code:"+33",iso:"FR",flag:"",format:"# ## ## ## ##"},{code:"+31",iso:"NL",flag:"",format:"## ### ####"},{code:"+32",iso:"BE",flag:"",format:"### ## ## ##"},{code:"+43",iso:"AT",flag:"",format:"### ### ####"},{code:"+41",iso:"CH",flag:"",format:"## ### ## ##"},{code:"+46",iso:"SE",flag:"",format:"## ### ## ##"},{code:"+47",iso:"NO",flag:"",format:"### ## ###"},{code:"+45",iso:"DK",flag:"",format:"## ## ## ##"},{code:"+358",iso:"FI",flag:"",format:"## ### ####"},{code:"+39",iso:"IT",flag:"",format:"### ### ####"},{code:"+34",iso:"ES",flag:"",format:"### ### ###"},{code:"+30",iso:"GR",flag:"",format:"### ### ####"},{code:"+7",iso:"RU",flag:"",format:"### ### ## ##"},{code:"+380",iso:"UA",flag:"",format:"## ### ## ##"},{code:"+994",iso:"AZ",flag:"",format:"## ### ## ##"},{code:"+995",iso:"GE",flag:"",format:"### ### ###"},{code:"+374",iso:"AM",flag:"",format:"## ### ###"},{code:"+972",iso:"IL",flag:"",format:"## ### ####"},{code:"+966",iso:"SA",flag:"",format:"## ### ####"},{code:"+971",iso:"AE",flag:"",format:"## ### ####"},{code:"+86",iso:"CN",flag:"",format:"### #### ####"},{code:"+81",iso:"JP",flag:"",format:"## #### ####"},{code:"+82",iso:"KR",flag:"",format:"## #### ####"},{code:"+91",iso:"IN",flag:"",format:"##### #####"},{code:"+61",iso:"AU",flag:"",format:"### ### ###"},{code:"+55",iso:"BR",flag:"",format:"## ##### ####"},{code:"+48",iso:"PL",flag:"",format:"### ### ###"},{code:"+420",iso:"CZ",flag:"",format:"### ### ###"},{code:"+36",iso:"HU",flag:"",format:"## ### ####"},{code:"+40",iso:"RO",flag:"",format:"### ### ###"},{code:"+359",iso:"BG",flag:"",format:"## ### ####"}],By=t=>{if(!t)return null;const s=t.replace(/\s/g,""),r=[...mN].sort((n,a)=>a.code.length-n.code.length);for(const n of r)if(s.startsWith(n.code))return n;return null},pN=t=>{if(!t)return"";let s=t.replace(/[^\d+]/g,"");s&&!s.startsWith("+")&&(s="+"+s);const r=By(s);if(!r)return s;const n=s.substring(r.code.length);if(!n)return r.code+" ";let a="",l=0;for(let i=0;i<r.format.length&&l<n.length;i++)r.format[i]==="#"?(a+=n[l],l++):a+=r.format[i];return r.code+" "+a};function Rh({value:t="",onChange:s,placeholder:r="+90 5XX XXX XX XX",required:n=!1,disabled:a=!1,label:l,className:i=""}){const d=c.useMemo(()=>By(t),[t]),u=f=>{let N=f.target.value;N=N.replace(/[^\d+\s]/g,"");const C=pN(N);s(C)};return e.jsxs("div",{className:`phone-input-wrapper ${i}`,children:[l&&e.jsx("label",{className:"form-label",children:l}),e.jsxs("div",{style:{display:"flex",alignItems:"center",border:"1px solid var(--color-border)",borderRadius:8,overflow:"hidden",background:a?"var(--color-bg-secondary)":"white"},children:[e.jsx("div",{style:{padding:"10px 12px",background:"var(--color-bg-secondary)",borderRight:"1px solid var(--color-border)",display:"flex",alignItems:"center",gap:6,minWidth:70,justifyContent:"center"},children:d?e.jsxs(e.Fragment,{children:[e.jsx("span",{style:{fontSize:18},children:d.flag}),e.jsx("span",{style:{fontWeight:600,fontSize:13,color:"var(--color-text)"},children:d.iso})]}):e.jsx("span",{style:{fontSize:13,color:"var(--color-text-light)"},children:""})}),e.jsx("input",{type:"tel",value:t,onChange:u,placeholder:r,required:n,disabled:a,style:{flex:1,padding:"10px 12px",border:"none",outline:"none",fontSize:15,fontFamily:"ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace",letterSpacing:.5,background:"transparent"}})]})]})}const _n=t=>({...t,roles:Array.isArray(t==null?void 0:t.roles)?t.roles:[],payments:(t==null?void 0:t.payments)||{},offer:(t==null?void 0:t.offer)||{},files:(t==null?void 0:t.files)||{},measure:(t==null?void 0:t.measure)||{},pendingPO:(t==null?void 0:t.pendingPO)||[]}),qa=t=>{if(!t)return"Bilinmeyen hata";if(typeof t=="string")return t;if(t.message)return t.message;if(t.detail)return t.detail;try{return JSON.stringify(t)}catch{return String(t)}},be=t=>new Intl.NumberFormat("tr-TR").format(t||0),hN=t=>{if(!t&&t!==0)return"";const s=String(t).replace(/[^\d]/g,"");return s?new Intl.NumberFormat("tr-TR").format(Number(s)):""},bt=({value:t,onChange:s,placeholder:r,className:n="form-input",style:a={}})=>{const[l,i]=c.useState("");c.useEffect(()=>{t!=null&&t!==""?i(hN(t)):i("")},[t]);const d=u=>{const C=u.target.value.replace(/[^\d.,]/g,"").replace(/[^\d]/g,""),b=C?new Intl.NumberFormat("tr-TR").format(Number(C)):"";i(b),s(C?Number(C):"")};return e.jsx("input",{type:"text",className:n,placeholder:r,value:l,onChange:d,style:{textAlign:"right",...a}})},Mi=t=>{if(!t)return"-";try{return new Date(t).toLocaleDateString("tr-TR",{day:"2-digit",month:"2-digit",year:"numeric"})}catch{return t}},Et=t=>t?Number(typeof t=="object"?t.amount||t.total||0:t||0):0,fN=()=>{const[t,s]=Sb();Ls();const[r,n]=c.useState([]),[a,l]=c.useState([]),[i,d]=c.useState(""),[u,f]=c.useState("all"),[N,C]=c.useState(!0),[b,L]=c.useState(""),[k,E]=c.useState(!1),[y,p]=c.useState(!1),[m,v]=c.useState(!1),[z,W]=c.useState(null),[F,q]=c.useState(""),[X,Q]=c.useState(!1),[A,ue]=c.useState(""),[Z,ae]=c.useState({customerId:"",customerName:"",startType:"OLCU",title:"",phone:"+90 ",phone2:"",address:"",newCustomer:!1,segment:"B2B",location:"",contact:"",roles:[],isArchive:!1,archiveDate:"",archiveCompletedDate:"",archiveTotalAmount:"",archiveNote:"",archiveFiles:[],customerFiles:[],serviceNote:"",serviceFixedFee:""}),[$,ne]=c.useState([]),[U,pe]=c.useState("");c.useEffect(()=>{(async()=>{try{C(!0),L("");const[j,B]=await Promise.all([zr(),Jl()]);n(j.map(_n)),l(B.filter(se=>!se.deleted));const K=await jn(!0);ne(K)}catch(j){L(j.message||" listesi alnamad")}finally{C(!1)}})()},[]),c.useEffect(()=>{const w=t.get("job"),j=t.get("stage");if(w&&r.length>0&&!y){const B=r.find(K=>K.id===w);B&&(W(B),p(!0),j&&setTimeout(()=>{const K=document.querySelector(`[data-stage="${j}"]`);K&&K.click()},100))}},[t,r,y]);const V=c.useCallback(()=>{p(!1),W(null),q("");const w=new URLSearchParams(t);w.delete("job"),w.delete("stage"),s(w,{replace:!0})},[t,s]),D=c.useMemo(()=>{const w=i.trim().toLowerCase();return r.filter(j=>u==="all"?!0:(j.status||"").toUpperCase()===u.toUpperCase()).filter(j=>w?(j.title||"").toLowerCase().includes(w)||(j.customerName||"").toLowerCase().includes(w)||(j.id||"").toLowerCase().includes(w):!0)},[r,i,u]),S=[{label:" Kodu",accessor:"id"},{label:"Balk",accessor:"title"},{label:"Mteri",accessor:"customerName"},{label:" Kollar",accessor:"roles",render:(w,j)=>!j.roles||j.roles.length===0?e.jsx("span",{className:"text-muted",children:"Belirtilmemi"}):e.jsx("div",{style:{display:"flex",gap:6,flexWrap:"wrap"},children:j.roles.map(B=>e.jsx("span",{className:"badge badge-secondary",children:B.name},B.id||B.name))})},{label:"Durum",accessor:"status",render:(w,j)=>Fn(j.status)},{label:"Balatma",accessor:"startType",render:(w,j)=>{const B={OLCU:" l",MUSTERI_OLCUSU:" Mteri ls",SERVIS:" Servis",ARSIV:" Ariv"};return e.jsx("span",{className:j.isArchive||j.startType==="ARSIV"?"badge badge-secondary":"",children:B[j.startType]||j.startType})}}],g=async w=>{p(!0),v(!0),q(""),W(_n(w));try{const j=await Bb(w.id);W(_n(j))}catch(j){q(j.message||" detay alnamad")}finally{v(!1)}},x=w=>{ae(j=>j.roles.find(K=>K.id===w.id)?{...j,roles:j.roles.filter(K=>K.id!==w.id)}:{...j,roles:[...j.roles,w]})};c.useMemo(()=>{const w=U.trim().toLowerCase();return w?$.filter(j=>j.name.toLowerCase().includes(w)||(j.description||"").toLowerCase().includes(w)):$},[$,U]);const M=c.useMemo(()=>{const w=A.trim().toLowerCase();return w?w.length<2?[]:a.filter(j=>{const B=(j.name||"").toLowerCase().includes(w),K=(j.phone||"").replace(/\s/g,"").includes(w.replace(/\s/g,"")),se=(j.phone2||"").replace(/\s/g,"").includes(w.replace(/\s/g,""));return B||K||se}).slice(0,10):[]},[a,A]);return e.jsxs("div",{children:[e.jsx(Fe,{title:" Listesi",subtitle:"Aktif tm ilerinizi tek ekranda takip edin",actions:e.jsx("button",{className:"btn btn-primary",type:"button",onClick:()=>{ae({customerId:"",customerName:"",startType:"OLCU",title:"",newCustomer:!1,segment:"B2B",location:"",contact:"",roles:[],isArchive:!1,archiveDate:"",archiveCompletedDate:"",archiveTotalAmount:"",archiveNote:"",archiveFiles:[]}),E(!0)},children:"+ Yeni  Balat"})}),e.jsxs("div",{className:"filter-bar",children:[e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{className:"filter-label",htmlFor:"search",children:"Arama"}),e.jsx("input",{id:"search",className:"filter-input",type:"search",placeholder:" ad, mteri veya i kodu",value:i,onChange:w=>d(w.target.value)})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{className:"filter-label",htmlFor:"status",children:"Durum"}),e.jsxs("select",{id:"status",className:"filter-select",value:u,onChange:w=>f(w.target.value),children:[e.jsx("option",{value:"all",children:"Tm"}),e.jsxs("optgroup",{label:"l/Keif",children:[e.jsx("option",{value:"OLCU_RANDEVU_BEKLIYOR",children:"Randevu Bekliyor"}),e.jsx("option",{value:"OLCU_RANDEVULU",children:"Randevu Verildi"}),e.jsx("option",{value:"OLCU_ALINDI",children:"l Alnd"}),e.jsx("option",{value:"MUSTERI_OLCUSU_BEKLENIYOR",children:"Mteri ls Bekleniyor"}),e.jsx("option",{value:"MUSTERI_OLCUSU_YUKLENDI",children:"Mteri ls Yklendi"})]}),e.jsxs("optgroup",{label:"Fiyatlandrma",children:[e.jsx("option",{value:"FIYATLANDIRMA",children:"Fiyat Verilecek"}),e.jsx("option",{value:"FIYAT_VERILDI",children:"Fiyat Verildi - Onay Bekliyor"}),e.jsx("option",{value:"ANLASILAMADI",children:"Anlalamad"})]}),e.jsxs("optgroup",{label:"Anlama",children:[e.jsx("option",{value:"ANLASMA_YAPILIYOR",children:"Anlama Yaplyor"}),e.jsx("option",{value:"ANLASMA_TAMAMLANDI",children:"Anlama Tamamland"})]}),e.jsx("optgroup",{label:"Stok/Rezervasyon",children:e.jsx("option",{value:"SONRA_URETILECEK",children:"Sonra retilecek"})}),e.jsxs("optgroup",{label:"retim",children:[e.jsx("option",{value:"URETIME_HAZIR",children:"retime Hazr"}),e.jsx("option",{value:"URETIMDE",children:"retimde"})]}),e.jsxs("optgroup",{label:"Montaj",children:[e.jsx("option",{value:"MONTAJA_HAZIR",children:"Montaja Hazr"}),e.jsx("option",{value:"MONTAJ_TERMIN",children:"Montaj Terminli"})]}),e.jsxs("optgroup",{label:"Finans",children:[e.jsx("option",{value:"MUHASEBE_BEKLIYOR",children:"Muhasebe Bekliyor"}),e.jsx("option",{value:"KAPALI",children:"Kapal"})]}),e.jsxs("optgroup",{label:"Servis",children:[e.jsx("option",{value:"SERVIS_RANDEVU_BEKLIYOR",children:"Servis Randevusu Bekliyor"}),e.jsx("option",{value:"SERVIS_RANDEVULU",children:"Servis Randevulu"}),e.jsx("option",{value:"SERVIS_YAPILIYOR",children:"Servis Yaplyor"}),e.jsx("option",{value:"SERVIS_DEVAM_EDIYOR",children:"Servis Devam Ediyor"}),e.jsx("option",{value:"SERVIS_ODEME_BEKLIYOR",children:"Servis deme Bekliyor"}),e.jsx("option",{value:"SERVIS_KAPALI",children:"Servis Tamamland"})]})]})]})]}),N?e.jsx(ft,{text:"ler ykleniyor..."}):b?e.jsxs("div",{className:"card error-card",children:[e.jsx("div",{className:"error-title",children:"Liste yklenemedi"}),e.jsx("div",{className:"error-message",children:b})]}):e.jsx(et,{columns:S,rows:D,getKey:w=>w.id,onRowClick:g}),e.jsx(Be,{open:k,title:" Yeni  Balat",size:"large",onClose:()=>{E(!1),ue("")},actions:e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-secondary",type:"button",onClick:()=>E(!1),disabled:X,children:"Vazge"}),e.jsx("button",{className:"btn btn-primary",type:"submit",form:"job-modal-form",disabled:X,children:X?"Kaydediliyor...":Z.isArchive?" Arive Kaydet":"i Balat"})]}),children:e.jsxs("form",{id:"job-modal-form",onSubmit:async w=>{w.preventDefault();try{Q(!0),L("");let j=Z.customerId,B=Z.customerName;if(Z.newCustomer){const oe=await Uc({name:Z.customerName,segment:Z.segment,phone:Z.phone,phone2:Z.phone2,address:Z.address,location:Z.location,contact:Z.contact});j=oe.id,B=oe.name,l(O=>[oe,...O])}const K={customerId:j,customerName:B,title:Z.title,startType:Z.isArchive?"ARSIV":Z.startType,roles:Z.roles};Z.isArchive&&(K.isArchive=!0,K.archiveDate=Z.archiveDate,K.archiveCompletedDate=Z.archiveCompletedDate,K.archiveTotalAmount=Z.archiveTotalAmount?Number(Z.archiveTotalAmount):null,K.archiveNote=Z.archiveNote);const se=await yy(K);if(Z.isArchive&&Z.archiveFiles.length>0)for(const oe of Z.archiveFiles)try{await ba(oe.file,se.id,oe.type,`Ariv - ${oe.file.name}`)}catch(O){console.warn("Dosya yklenemedi:",oe.file.name,O)}n(oe=>[_n(se),...oe]),ae(oe=>({...oe,roles:[],isArchive:!1,archiveDate:"",archiveCompletedDate:"",archiveTotalAmount:"",archiveNote:"",archiveFiles:[]})),ue(""),E(!1)}catch(j){L(j.message||" oluturulamad")}finally{Q(!1)}},children:[e.jsxs("div",{className:"card subtle-card",style:{marginBottom:16},children:[e.jsxs("div",{className:"card-header",style:{padding:"12px 16px"},children:[e.jsx("h4",{className:"card-title",style:{fontSize:14},children:" Mteri"}),e.jsxs("div",{style:{display:"flex",gap:8},children:[e.jsx("button",{type:"button",className:`btn btn-small ${Z.newCustomer?"btn-secondary":"btn-primary"}`,onClick:()=>ae(w=>({...w,newCustomer:!1})),children:"Mevcut"}),e.jsx("button",{type:"button",className:`btn btn-small ${Z.newCustomer?"btn-primary":"btn-secondary"}`,onClick:()=>ae(w=>({...w,newCustomer:!0,customerId:"",customerName:""})),children:"+ Yeni"})]})]}),e.jsx("div",{className:"card-body",style:{padding:16},children:Z.newCustomer?e.jsxs("div",{className:"grid grid-2",style:{gap:12},children:[e.jsxs("div",{className:"form-group",style:{gridColumn:"1 / -1"},children:[e.jsx("label",{className:"form-label",children:"Ad Soyad *"}),e.jsx("input",{className:"form-input",value:Z.customerName,onChange:w=>ae(j=>({...j,customerName:w.target.value})),placeholder:"rn: Ahmet Ylmaz",required:!0})]}),e.jsx("div",{className:"form-group",children:e.jsx(Rh,{label:" Telefon 1 *",value:Z.phone,onChange:w=>ae(j=>({...j,phone:w})),required:!0})}),e.jsx("div",{className:"form-group",children:e.jsx(Rh,{label:" Telefon 2 (istee bal)",value:Z.phone2,onChange:w=>ae(j=>({...j,phone2:w}))})}),e.jsxs("div",{className:"form-group",style:{gridColumn:"1 / -1"},children:[e.jsx("label",{className:"form-label",children:" Adres"}),e.jsx("textarea",{className:"form-textarea",value:Z.address,onChange:w=>ae(j=>({...j,address:w.target.value})),placeholder:"Tam adres...",rows:2})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Segment"}),e.jsxs("select",{className:"form-select",value:Z.segment,onChange:w=>ae(j=>({...j,segment:w.target.value})),children:[e.jsx("option",{value:"B2C",children:"Bireysel (B2C)"}),e.jsx("option",{value:"B2B",children:"Kurumsal (B2B)"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"le / Semt"}),e.jsx("input",{className:"form-input",value:Z.location,onChange:w=>ae(j=>({...j,location:w.target.value})),placeholder:"rn: Kadky"})]})]}):e.jsxs("div",{children:[e.jsxs("div",{className:"form-group",style:{marginBottom:12},children:[e.jsx("label",{className:"form-label",children:" Mteri Ara (sim veya Telefon)"}),e.jsx("input",{className:"form-input",placeholder:"rn: Ahmet veya 532 123...",value:A,onChange:w=>ue(w.target.value),autoFocus:!0})]}),Z.customerId&&e.jsx("div",{style:{padding:12,background:"var(--color-success-bg)",borderRadius:8,border:"1px solid var(--color-success)",marginBottom:12},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsxs("div",{style:{fontWeight:600},children:[" ",Z.customerName]}),(()=>{const w=a.find(j=>j.id===Z.customerId);return w!=null&&w.phone?e.jsxs("div",{style:{fontSize:12},children:[" ",w.phone]}):null})()]}),e.jsx("button",{type:"button",className:"btn btn-secondary btn-small",onClick:()=>ae(w=>({...w,customerId:"",customerName:""})),children:"Deitir"})]})}),!Z.customerId&&A.length>=2&&e.jsx("div",{style:{maxHeight:200,overflow:"auto",border:"1px solid var(--color-border)",borderRadius:8},children:M.length===0?e.jsxs("div",{style:{padding:16,textAlign:"center"},className:"text-muted",children:['"',A,'" ile eleen mteri bulunamad']}):M.map(w=>e.jsxs("div",{style:{padding:"10px 16px",cursor:"pointer",borderBottom:"1px solid var(--color-border)",transition:"background 0.2s"},className:"hover-row",onClick:()=>{ae(j=>({...j,customerId:w.id,customerName:w.name})),ue("")},children:[e.jsx("div",{style:{fontWeight:600},children:w.name}),e.jsxs("div",{style:{fontSize:12,color:"var(--color-text-light)"},children:[w.phone&&` ${w.phone}`,w.phone&&w.address&&"  ",w.address&&` ${w.address.substring(0,30)}...`]})]},w.id))}),!Z.customerId&&A.length<2&&e.jsx("div",{className:"text-muted",style:{fontSize:12},children:" En az 2 karakter girerek mteri arayn"})]})})]}),e.jsxs("div",{className:"card subtle-card",style:{marginBottom:16},children:[e.jsx("div",{className:"card-header",style:{padding:"12px 16px"},children:e.jsx("h4",{className:"card-title",style:{fontSize:14},children:"  Bilgileri"})}),e.jsxs("div",{className:"card-body",style:{padding:16},children:[e.jsxs("div",{className:"grid grid-2",style:{gap:12},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:" Bal *"}),e.jsx("input",{className:"form-input",value:Z.title,onChange:w=>ae(j=>({...j,title:w.target.value})),placeholder:"rn: Balkon PVC Dorama",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Balatma Tr"}),e.jsxs("select",{className:"form-select",value:Z.isArchive?"ARSIV":Z.startType,onChange:w=>{const j=w.target.value;ae(j==="ARSIV"?B=>({...B,isArchive:!0,startType:"OLCU"}):B=>({...B,isArchive:!1,startType:j}))},children:[e.jsx("option",{value:"OLCU",children:" l Randevusu"}),e.jsx("option",{value:"MUSTERI_OLCUSU",children:" Mteri ls"}),e.jsx("option",{value:"SERVIS",children:" Servis/Bakm"}),e.jsx("option",{value:"ARSIV",children:" Ariv Kayd (Tamamlanm )"})]})]})]}),e.jsxs("div",{className:"text-muted",style:{fontSize:12,marginTop:8},children:[!Z.isArchive&&Z.startType==="OLCU"&&" l randevusu verilecek, sonra fiyatlandrlacak.",!Z.isArchive&&Z.startType==="MUSTERI_OLCUSU"&&" Mteri ls ile direkt fiyatlandrmaya geilecek.",!Z.isArchive&&Z.startType==="SERVIS"&&" Servis randevusu ve sabit cret belirlenecek.",Z.isArchive&&" Gemite tamamlanm bir ii sisteme kaydedin. Sre haritas atlanr."]}),Z.isArchive&&e.jsxs("div",{style:{marginTop:16,padding:16,background:"linear-gradient(135deg, #fef3c7 0%, #fde68a 100%)",borderRadius:12,border:"1px solid #f59e0b"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:12},children:[e.jsx("span",{style:{fontSize:18},children:""}),e.jsx("span",{style:{fontWeight:600,color:"#92400e"},children:"Ariv Bilgileri"})]}),e.jsxs("div",{className:"grid grid-2",style:{gap:12},children:[e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",children:" Anlama Tarihi *"}),e.jsx(Qe,{value:Z.archiveDate,onChange:w=>ae(j=>({...j,archiveDate:w})),max:new Date().toISOString().split("T")[0]})]}),e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",children:" Tamamlanma Tarihi"}),e.jsx(Qe,{value:Z.archiveCompletedDate,onChange:w=>ae(j=>({...j,archiveCompletedDate:w})),max:new Date().toISOString().split("T")[0]})]}),e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",children:" Toplam Tutar ()"}),e.jsx("input",{type:"number",className:"form-input",value:Z.archiveTotalAmount,onChange:w=>ae(j=>({...j,archiveTotalAmount:w.target.value})),placeholder:"rn: 15000",min:"0"})]}),e.jsxs("div",{className:"form-group",style:{margin:0,gridColumn:"span 2"},children:[e.jsx("label",{className:"form-label",children:" Not (Opsiyonel)"}),e.jsx("textarea",{className:"form-input",value:Z.archiveNote,onChange:w=>ae(j=>({...j,archiveNote:w.target.value})),placeholder:"Ariv kayd ile ilgili notlar...",rows:2,style:{resize:"vertical"}})]})]}),Z.roles.length>0&&e.jsxs("div",{style:{marginTop:16},children:[e.jsx("div",{style:{fontWeight:600,fontSize:13,marginBottom:8,color:"#92400e"},children:"  Kollarna Gre Belge Ykleme (Opsiyonel)"}),e.jsx("div",{className:"text-muted",style:{fontSize:11,marginBottom:12},children:"Her i kolu iin ayr ayr l, teknik izim, szleme ve montaj fotoraflar ykleyebilirsiniz."}),Z.roles.map(w=>{const j=Z.archiveFiles.filter(B=>B.roleId===w.id);return e.jsxs("div",{style:{marginBottom:12,padding:12,background:"white",borderRadius:8,border:"1px solid #e5e7eb"},children:[e.jsxs("div",{style:{fontWeight:600,fontSize:12,marginBottom:8,color:"#374151"},children:[" ",w.name]}),j.length>0&&e.jsx("div",{style:{marginBottom:8},children:j.map((B,K)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"4px 8px",background:"#f9fafb",borderRadius:4,marginBottom:4,fontSize:11},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6,flex:1,minWidth:0},children:[e.jsx("span",{children:B.type==="olcu"?"":B.type==="teknik"?"":B.type==="sozlesme"?"":B.type==="montaj"?"":""}),e.jsx("span",{style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:B.file.name}),e.jsx("span",{className:"badge badge-secondary",style:{fontSize:9,padding:"2px 6px"},children:B.type==="olcu"?"l":B.type==="teknik"?"Teknik":B.type==="sozlesme"?"Szleme":B.type==="montaj"?"Montaj":"Dier"})]}),e.jsx("button",{type:"button",onClick:()=>{ae(se=>({...se,archiveFiles:se.archiveFiles.filter(oe=>!(oe.roleId===w.id&&oe.file.name===B.file.name&&oe.type===B.type))}))},style:{background:"none",border:"none",color:"#dc2626",cursor:"pointer",padding:"2px 4px",fontSize:10},title:"Dosyay Kaldr",children:""})]},`${w.id}-${K}`))}),e.jsx("div",{style:{display:"flex",gap:6,flexWrap:"wrap"},children:[{type:"olcu",label:" l",color:"#3b82f6"},{type:"teknik",label:" Teknik",color:"#8b5cf6"},{type:"sozlesme",label:" Szleme",color:"#10b981"},{type:"montaj",label:" Montaj",color:"#f59e0b"}].map(B=>e.jsxs("label",{style:{display:"inline-flex",alignItems:"center",gap:4,padding:"4px 10px",background:`${B.color}10`,border:`1px dashed ${B.color}`,borderRadius:6,cursor:"pointer",fontSize:11,color:B.color,transition:"all 0.2s"},children:[B.label,e.jsx("input",{type:"file",multiple:!0,accept:".pdf,.png,.jpg,.jpeg,.doc,.docx,.xls,.xlsx",style:{display:"none"},onChange:K=>{const oe=Array.from(K.target.files||[]).map(O=>({file:O,type:B.type,roleId:w.id,roleName:w.name}));ae(O=>({...O,archiveFiles:[...O.archiveFiles,...oe]})),K.target.value=""}})]},B.type))})]},w.id)}),e.jsxs("div",{style:{marginTop:8,padding:12,background:"#f3f4f6",borderRadius:8,border:"1px dashed #9ca3af"},children:[e.jsx("div",{style:{fontWeight:600,fontSize:12,marginBottom:8,color:"#6b7280"},children:" Genel Belgeler (Tm i iin)"}),Z.archiveFiles.filter(w=>!w.roleId).map((w,j)=>e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"4px 8px",background:"white",borderRadius:4,marginBottom:4,fontSize:11},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:6},children:[e.jsx("span",{children:""}),e.jsx("span",{children:w.file.name})]}),e.jsx("button",{type:"button",onClick:()=>{const K=Z.archiveFiles.filter(se=>!se.roleId)[j];ae(se=>({...se,archiveFiles:se.archiveFiles.filter(oe=>oe!==K)}))},style:{background:"none",border:"none",color:"#dc2626",cursor:"pointer",fontSize:10},title:"Dosyay Kaldr",children:""})]},`general-${j}`)),e.jsxs("label",{style:{display:"inline-flex",alignItems:"center",gap:4,padding:"4px 10px",background:"white",border:"1px dashed #9ca3af",borderRadius:6,cursor:"pointer",fontSize:11,color:"#6b7280"},children:[" Genel Dosya Ekle",e.jsx("input",{type:"file",multiple:!0,accept:".pdf,.png,.jpg,.jpeg,.doc,.docx,.xls,.xlsx",style:{display:"none"},onChange:w=>{const B=Array.from(w.target.files||[]).map(K=>({file:K,type:"sozlesme"}));ae(K=>({...K,archiveFiles:[...K.archiveFiles,...B]})),w.target.value=""}})]})]})]}),Z.roles.length===0&&e.jsx("div",{style:{marginTop:16,padding:12,background:"#fef3c7",borderRadius:8,fontSize:12,color:"#92400e"},children:" Belge yklemek iin nce i kollarn sein."})]})]})]}),e.jsxs("div",{className:"card subtle-card",children:[e.jsxs("div",{className:"card-header",style:{padding:"12px 16px"},children:[e.jsx("h4",{className:"card-title",style:{fontSize:14},children:"  Kollar"}),e.jsxs("span",{className:"badge badge-secondary",children:[Z.roles.length," seili"]})]}),e.jsxs("div",{className:"card-body",style:{padding:16},children:[Z.roles.length>0&&e.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap",marginBottom:12},children:Z.roles.map(w=>e.jsxs("span",{className:"badge badge-primary",style:{padding:"6px 12px",display:"inline-flex",gap:8,alignItems:"center",cursor:"pointer"},onClick:()=>x(w),children:[w.name,e.jsx("span",{style:{opacity:.7},children:""})]},w.id))}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fill, minmax(140px, 1fr))",gap:8},children:$.map(w=>{const j=Z.roles.some(B=>B.id===w.id);return e.jsx("button",{type:"button",style:{padding:"10px 12px",border:j?"2px solid var(--color-primary)":"1px solid var(--color-border)",borderRadius:8,background:j?"var(--color-primary-bg)":"var(--color-bg-secondary)",cursor:"pointer",textAlign:"left",transition:"all 0.2s"},onClick:()=>x(w),children:e.jsxs("div",{style:{fontWeight:600,fontSize:13,color:j?"var(--color-primary)":"var(--color-text)"},children:[j&&" ",w.name]})},w.id)})}),Z.roles.length===0&&e.jsx("div",{className:"text-muted",style:{fontSize:12,marginTop:8},children:" En az bir i kolu sein"})]})]})]})}),e.jsx(Be,{open:y,title:` Detay ${z?`- ${z.id}`:""}`,size:"xxlarge",onClose:V,children:m?e.jsx("div",{children:"Ykleniyor..."}):F?e.jsxs("div",{className:"error-card",children:[e.jsx("div",{className:"error-title",children:"Hata"}),e.jsx("div",{className:"error-message",children:F})]}):z?e.jsx(gN,{job:z,customers:a,onUpdated:async w=>{W(w),n(j=>j.map(B=>B.id===w.id?w:B))}}):null})]})},Al={OLCU_RANDEVU_BEKLIYOR:{label:"Randevu Bekliyor",tone:"warning",icon:""},OLCU_RANDEVULU:{label:"Randevu Verildi",tone:"info",icon:""},OLCU_ALINDI:{label:"l Alnd",tone:"success",icon:""},MUSTERI_OLCUSU_BEKLENIYOR:{label:"Mteri ls Bekleniyor",tone:"warning",icon:""},MUSTERI_OLCUSU_YUKLENDI:{label:"Mteri ls Yklendi",tone:"success",icon:""},FIYATLANDIRMA:{label:"Fiyat Verilecek",tone:"secondary",icon:""},FIYAT_VERILDI:{label:"Fiyat Verildi - Onay Bekliyor",tone:"warning",icon:""},ANLASILAMADI:{label:"Anlalamad",tone:"danger",icon:""},ANLASMA_YAPILIYOR:{label:"Anlama Yaplyor",tone:"primary",icon:""},ANLASMA_TAMAMLANDI:{label:"Anlama Tamamland",tone:"success",icon:""},SONRA_URETILECEK:{label:"Sonra retilecek",tone:"info",icon:""},URETIME_HAZIR:{label:"retime Hazr",tone:"success",icon:""},URETIMDE:{label:"retimde",tone:"primary",icon:""},MONTAJA_HAZIR:{label:"Montaja Hazr",tone:"success",icon:""},MONTAJ_TERMIN:{label:"Montaj Terminli",tone:"primary",icon:""},MUHASEBE_BEKLIYOR:{label:"Muhasebe Bekliyor",tone:"secondary",icon:""},KAPALI:{label:"Kapal",tone:"success",icon:""},SERVIS_RANDEVU_BEKLIYOR:{label:"Servis Randevusu Bekliyor",tone:"warning",icon:""},SERVIS_RANDEVULU:{label:"Servis Randevulu",tone:"primary",icon:""},SERVIS_YAPILIYOR:{label:"Servis Yaplyor",tone:"info",icon:""},SERVIS_DEVAM_EDIYOR:{label:"Servis Devam Ediyor",tone:"warning",icon:""},SERVIS_ODEME_BEKLIYOR:{label:"Servis deme Bekliyor",tone:"warning",icon:""},SERVIS_KAPALI:{label:"Servis Tamamland",tone:"success",icon:""}},Fn=t=>{const s=Al[t];if(s)return e.jsxs("span",{className:`badge badge-${s.tone}`,children:[s.icon," ",s.label]});const r=t||"Bilinmiyor",n=r.toLowerCase();let a="secondary";return(n.includes("l")||n.includes("olcu"))&&(a="primary"),n.includes("fiyat")&&(a="secondary"),n.includes("teklif")&&(a="secondary"),n.includes("onay")&&(a="warning"),n.includes("stok")&&(a="warning"),(n.includes("hazr")||n.includes("hazir"))&&(a="success"),(n.includes("anlama")||n.includes("anlasma"))&&(a="info"),n.includes("retim")&&(a="warning"),n.includes("montaj")&&(a="primary"),n.includes("muhasebe")&&(a="secondary"),(n.includes("kapal")||n.includes("kapali"))&&(a="success"),n.includes("servis")&&(a="info"),e.jsx("span",{className:`badge badge-${a}`,children:r})},$o=[{id:"measure",label:"l/Keif",statuses:["OLCU_RANDEVU_BEKLIYOR","OLCU_RANDEVULU","OLCU_ALINDI","MUSTERI_OLCUSU_BEKLENIYOR","MUSTERI_OLCUSU_YUKLENDI"]},{id:"pricing",label:"Fiyatlandrma",statuses:["FIYATLANDIRMA","FIYAT_VERILDI","ANLASILAMADI"]},{id:"agreement",label:"Anlama",statuses:["ANLASMA_YAPILIYOR"]},{id:"stock",label:"Stok/Rezervasyon",statuses:["ANLASMA_TAMAMLANDI","SONRA_URETILECEK"]},{id:"production",label:"retim",statuses:["URETIME_HAZIR","URETIMDE"]},{id:"assembly",label:"Montaj",statuses:["MONTAJA_HAZIR","MONTAJ_TERMIN"]},{id:"finance",label:"Finans Kapan",statuses:["MUHASEBE_BEKLIYOR"]},{id:"summary",label:"zet",statuses:["KAPALI"]}],Wo=[{id:"service_schedule",label:"Randevu",statuses:["SERVIS_RANDEVU_BEKLIYOR"]},{id:"service_start",label:"Balat",statuses:["SERVIS_RANDEVULU"]},{id:"service_work",label:"Servis",statuses:["SERVIS_YAPILIYOR","SERVIS_DEVAM_EDIYOR"]},{id:"service_payment",label:"deme",statuses:["SERVIS_ODEME_BEKLIYOR"]},{id:"service_done",label:"zet",statuses:["SERVIS_KAPALI"]}],Oi=(t,s)=>{var l,i;const r=$o.find(d=>d.id===s)||Wo.find(d=>d.id===s);if(!r||!t.logs)return[];const n=r.statuses||[],a=[];for(const d of t.logs)if(d.action==="status.updated"&&d.note){const u=d.note.match(/(\w+)\s*->\s*(\w+)/);if(u){const[,f,N]=u;(n.includes(f)||n.includes(N))&&a.push({from:f,to:N,at:d.at,fromLabel:((l=Al[f])==null?void 0:l.label)||f,toLabel:((i=Al[N])==null?void 0:i.label)||N})}}return a},gN=({job:t,customers:s=[],onUpdated:r})=>{var nd,ad,ld,id,od,cd,dd,ud,md,pd,hd,fd,gd,yd,xd,vd,jd,bd,Nd,Sd,kd,Cd,wd,Td,Dd,zd,Id,Ed,Ad,Rd,Bd,Ld,Pd,Md,Od,_d,Fd,$d,Wd,Kd,Ud,qd,Hd,Yd,Vd,Gd,Qd,Jd,Xd,Zd,eu,tu,su,ru,nu,au,lu,iu,ou,cu,du,uu,mu,pu,hu,fu,gu,yu,xu,vu,ju,bu,Nu,Su,ku,Cu,wu,Tu,Du,zu,Iu,Eu,Au,Ru,Bu,Lu,Pu,Mu,Ou,_u,Fu,$u,Wu,Ku,Uu,qu,Hu,Yu,Vu,Gu,Qu,Ju,Xu,Zu,em,tm,sm,rm,nm,am,lm,im,om,cm,dm,um,mm,pm,hm,fm,gm,ym,xm,vm,jm,bm,Nm,Sm,km,Cm,wm,Tm,Dm,zm,Im,Em,Am,Rm,Bm,Lm,Pm,Mm,Om,_m,Fm,$m,Wm,Km,Um,qm,Hm,Ym,Vm,Gm,Qm,Jm,Xm;const n=s.find(o=>o.id===t.customerId)||{},[a,l]=c.useState(""),[i,d]=c.useState(!1),[u,f]=c.useState(!1),[N,C]=c.useState(""),[b,L]=c.useState([]),[k,E]=c.useState(""),[y,p]=c.useState(""),[m,v]=c.useState(""),[z,W]=c.useState(null),[F,q]=c.useState(1),[X,Q]=c.useState(!1),[A,ue]=c.useState([]),[Z,ae]=c.useState(!1),[$,ne]=c.useState(null),[U,pe]=c.useState(1),[V,D]=c.useState(!1),[S,g]=c.useState(""),[x,M]=c.useState(""),[w,j]=c.useState({orders:[],summary:{}}),[B,K]=c.useState(!1),[se,oe]=c.useState(!1),[O,ce]=c.useState(!1),[je,we]=c.useState({roles:[],summary:{}}),[Ee,T]=c.useState(null),[re,ke]=c.useState([]),[Ie,Ne]=c.useState([]),[Re,Oe]=c.useState([]),[R,le]=c.useState([]),[ie,De]=c.useState({roleId:"",roleName:"",productionType:"internal",productionDescription:"",productionQty:1,productionUnit:"adet",productionEstDelivery:"",productionNotes:"",productionSupplierId:"",productionSupplierName:"",requiresGlass:!1,includeGlass:!1,glassItems:[{glassType:"",glassName:"",quantity:1,combination:""}],glassSupplierId:"",glassSupplierName:"",glassEstDelivery:""}),[Me,ee]=c.useState({deliveries:[],deliveryDate:"",deliveryNote:""}),[fe,qe]=c.useState([]),[P,de]=c.useState(""),[ve,We]=c.useState(!1),[tt,H]=c.useState(t.pendingPO||[]),[G,Se]=c.useState([]),[I,me]=c.useState({measureNote:"",appointment:"",measureCall:!1,measureConfirmed:!1,measureDraftFile:"",techDrawingFile:"",orderNo:"",cariCode:"",offerExpanded:!0,offerTotal:"",pricingNotifiedDate:"",rejectionReason:"",rejectionCategory:"",rejectionFollowUp:"",showRejectionModal:!1,roleDiscounts:{},showNegotiationPanel:!1,payCash:"",payCashDate:"",payCard:"",payCardDate:"",payAfter:"",payAfterNote:"",chequeLines:[],chequesReceived:!1,chequeCount:"",chequeTotalAmount:"",stockReady:!0,stockNote:"",productionStatus:"URETIMDE",agreementDate:"",assemblyDate:"",assemblyNote:"",assemblyTeam:[],proofNote:"",estimatedAssemblyDate:"",estimatedAssemblyNote:"",financeTotal:"",financeCash:"",financeCard:"",financeCheque:"",discountAmount:"",discountNote:"",rolePrices:{},serviceAppointmentDate:"",serviceAppointmentTime:"10:00",serviceFixedFee:"",serviceNote:"",serviceVisitDate:"",serviceVisitTime:"",serviceWorkNote:"",serviceMaterials:"",serviceExtraCost:"",servicePaymentCash:"",servicePaymentCard:"",servicePaymentTransfer:"",serviceDiscount:"",serviceDiscountNote:"",serviceNewAppointmentDate:"",serviceNewAppointmentTime:"10:00",serviceNewAppointmentNote:""}),[ut,ms]=c.useState(!1),[at,Ir]=c.useState([]),[Ct,Gc]=c.useState(!1),[Qc,HN]=c.useState([]);c.useEffect(()=>{var te;const o=t.measure||{},h=t.offer||{},_=t.payments||{},Y=((te=t.assembly)==null?void 0:te.schedule)||{},J=t.finance||{};me(ge=>{var xe,ze,_e,Le,ct,Ve,rt,Ce,Ae,He,xt,Wt,Ke;return{...ge,measureNote:o.note||"",appointment:o.appointment||"",measureCall:o.call||!1,measureConfirmed:o.confirm||!1,orderNo:h.orderNo||"",cariCode:h.cariCode||t.customerAccountCode||"",offerTotal:h.total||"",payCash:_.cash||"",payCard:_.card||"",payCheque:_.cheque||"",payAfter:_.after||"",chequeLines:_.chequeLines||[],productionStatus:t.status==="ANLASMADA"?"ANLASMADA":t.status==="MONTAJA_HAZIR"?"MONTAJA_HAZIR":"URETIMDE",agreementDate:t.agreementDate||"",assemblyDate:Y.date||((xe=t.estimatedAssembly)==null?void 0:xe.date)||"",assemblyNote:Y.note||((ze=t.estimatedAssembly)==null?void 0:ze.note)||"",assemblyTeam:Array.isArray(Y.team)?Y.team:Y.team?[Y.team]:[],estimatedAssemblyDate:((_e=t.estimatedAssembly)==null?void 0:_e.date)||"",estimatedAssemblyNote:((Le=t.estimatedAssembly)==null?void 0:Le.note)||"",financeTotal:J.total||h.total||"",financeCash:J.cash||_.cash||"",rolePrices:t.rolePrices||{},serviceAppointmentDate:((ct=t.service)==null?void 0:ct.appointmentDate)||"",serviceAppointmentTime:((Ve=t.service)==null?void 0:Ve.appointmentTime)||"10:00",serviceFixedFee:((rt=t.service)==null?void 0:rt.fixedFee)||"",serviceNote:((Ce=t.service)==null?void 0:Ce.note)||"",serviceWorkNote:((Ae=t.service)==null?void 0:Ae.workNote)||"",serviceMaterials:((He=t.service)==null?void 0:He.materials)||"",serviceExtraCost:((xt=t.service)==null?void 0:xt.extraCost)||"",serviceExtraNote:((Wt=t.service)==null?void 0:Wt.extraNote)||"",serviceCloseNote:((Ke=t.service)==null?void 0:Ke.closeNote)||"",financeCard:J.card||_.card||"",financeCheque:J.cheque||_.cheque||"",discountAmount:J.discount||"",discountNote:J.discountNote||""}})},[t]);const Er=t.startType==="SERVIS",dr=Er?Wo:$o,Xl=(o,h)=>h.find(_=>_.statuses.includes(o))||h[0],Ar=Xl(t.status||"OLCU_RANDEVU_BEKLIYOR",dr),[Jc,Zl]=c.useState(Ar.id);c.useEffect(()=>{const o=Xl(t.status||"OLCU_RANDEVU_BEKLIYOR",dr);Zl(o.id)},[t.id,t.status,dr]);const Qt=o=>Jc===o,Ly=o=>Zl(o),Xc=o=>{const h=dr.findIndex(Y=>Y.id===Ar.id),_=dr.findIndex(Y=>Y.id===o);return _<h?"done":_===h?"current":"pending"},Ge=Xc(Jc)==="done",Rr=async(o,h,_={})=>{try{await c0({jobId:t.id,action:o,detail:h,meta:_});const Y=await bh(t.id);qe(Y)}catch{}},Py=async()=>{try{Gc(!0);const o=await g0(t.id);Ir(o)}catch{}finally{Gc(!1)}},My=o=>{const h=o.startType==="SERVIS"?Wo:$o,_=Xl(o.status,h);_.id!==Ar.id&&Zl(_.id)},Oy=(o,h)=>!(h!=null&&h.skipAdvance),st=async(o,h,_={})=>{try{d(!0),l("");const Y=await o(),J=_n(Y);r(J),await Rr("update",`Aama: ${Ar.label}`,{stage:Ar.id,...h||{}}),Oy(J,h)&&My(J)}catch(Y){l(qa(Y)||"lem baarsz")}finally{d(!1)}},bn=async(o,h,_="")=>{if(o)try{ms(!0);const Y=await ba(o,t.id,h,_);return Ir(J=>[Y,...J]),Y}catch(Y){return l(Y.message||"Dosya yklenemedi"),null}finally{ms(!1)}},ei=async o=>{try{await wy(o),Ir(h=>h.filter(_=>_.id!==o))}catch(h){l(h.message||"Dosya silinemedi")}},_y=async()=>{try{f(!0),C("");const h=(await ja()||[]).map(_=>({..._,available:Math.max(0,(_.onHand||0)-(_.reserved||0))}));L(h)}catch(o){C(o.message||"Stok listesi alnamad")}finally{f(!1)}},Zc=async()=>{K(!0);let o={orders:[],summary:{}},h=[],_=[],Y=[],J=[];try{o=await Ri(t.id)}catch(xe){console.warn("Orders load error:",xe)}try{h=await jn(!0)}catch(xe){console.warn("Roles load error:",xe)}try{_=await cr()}catch(xe){console.warn("Suppliers load error:",xe)}try{Y=await Yc()}catch(xe){console.warn("Glass types load error:",xe)}try{J=await Ey()}catch(xe){console.warn("Combinations load error:",xe)}let te=[];try{te=await vn(!0)}catch(xe){console.warn("Teams load error:",xe)}let ge={roles:[],summary:{}};try{ge=await O0(t.id)}catch(xe){console.warn("Assembly tasks load error:",xe)}return j(o||{orders:[],summary:{}}),ke(h||[]),Ne(_||[]),Oe(Y||[]),le(J||[]),Se(te||[]),we(ge||{roles:[],summary:{}}),K(!1),{ordersData:o,rolesData:h,suppliersData:_,glassData:Y,combData:J,teamsData:te,assemblyData:ge}};c.useEffect(()=>{_y(),Py(),(async()=>{try{de("");const h=await bh(t.id);qe(h)}catch(h){de(h.message||"Loglar alnamad")}})(),H(t.pendingPO||[]),Zc()},[t==null?void 0:t.id]);const Fy=o=>o?o.available<=0?{label:"Tkendi",tone:"danger"}:o.available<=o.critical?{label:"Kritik",tone:"danger"}:o.available<=o.critical+Math.max(5,o.critical*.25)?{label:"Dk",tone:"warning"}:{label:"Salkl",tone:"success"}:{label:"-",tone:"secondary"},Br=c.useMemo(()=>{if(!t.roles||t.roles.length===0)return{required:!0,reason:" kolu yok"};const o=t.roles.map(J=>J.id),h=re.filter(J=>o.includes(J.id)),_=h.length>0&&h.every(J=>J.productionType==="external"),Y=h.some(J=>J.productionType==="internal");return _?{required:!1,reason:"Tm i kollar d retim - stok opsiyonel",allExternal:!0}:Y?{required:!0,reason:" retim i kolu mevcut - stok gerekli",hasInternal:!0}:{required:!0,reason:"Varsaylan - stok gerekli"}},[t.roles,re]),ti=c.useMemo(()=>{const o=k.trim().toLowerCase(),h=y.trim().toLowerCase(),_=m.trim().toLowerCase();let Y=b;return o&&(Y=Y.filter(J=>(J.name||"").toLowerCase().includes(o)||(J.supplierName||J.supplier||"").toLowerCase().includes(o)||(J.colorName||"").toLowerCase().includes(o))),h&&(Y=Y.filter(J=>(J.productCode||J.sku||"").toLowerCase().includes(h))),_&&(Y=Y.filter(J=>(J.colorCode||J.color||"").toLowerCase().includes(_))),Y},[b,k,y,m]),ed=c.useMemo(()=>{const o=b.reduce((_,Y)=>_+(Y.available||0),0),h=b.filter(_=>Fy(_).tone!=="success").length;return{total:o,critical:h}},[b]),$t=c.useMemo(()=>{var _;const o=Number(((_=t.offer)==null?void 0:_.total)||0);return Number(I.offerTotal||0)||o||0},[t.offer,I.offerTotal]),Nn=c.useMemo(()=>{var o;return I.chequesReceived&&((o=I.chequeLines)==null?void 0:o.length)>0?(I.chequeLines||[]).reduce((h,_)=>h+Number(_.amount||0),0):Number(I.chequeTotalAmount||0)},[I.chequeLines,I.chequesReceived,I.chequeTotalAmount]),Lr=c.useMemo(()=>Number(I.payCash||0)+Number(I.payCard||0)+Nn+Number(I.payAfter||0),[I.payCash,I.payCard,I.payAfter,Nn]),Pr=c.useMemo(()=>Math.abs(Lr-$t)<1,[Lr,$t]),si=c.useMemo(()=>{const o=I.chequeLines||[];if(o.length===0)return 0;const h=new Date,_=o.reduce((J,te)=>J+Number(te.amount||0),0);if(_<=0)return 0;const Y=o.reduce((J,te)=>{const ge=te.due?new Date(te.due):h,xe=Math.max(0,Math.round((ge-h)/(1e3*60*60*24)));return J+Number(te.amount||0)*xe},0);return Math.round(Y/_)},[I.chequeLines]),td=o=>{A.some(h=>h.id===o.id)||(ne(o),pe(1),ae(!0))},sd=()=>{if(!$||U<=0)return;const o={id:$.id,name:$.name,productCode:$.productCode||$.sku,colorCode:$.colorCode||$.color,sku:$.sku||$.productCode,qty:U,unit:$.unit||"adet",available:$.available,onHand:$.onHand,reserved:$.reserved||0,supplier:$.supplier||$.supplierName,color:$.color||$.colorName,colorName:$.colorName};ue(h=>[...h,o]),ae(!1),ne(null),pe(1),E(""),p(""),v("")},rd=o=>{ue(h=>h.filter(_=>_.id!==o))},ri=t.status||"";return e.jsxs("div",{className:"grid grid-1",style:{gap:16},children:[((nd=t.estimatedAssembly)==null?void 0:nd.date)&&e.jsxs("div",{style:{background:"linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%)",border:"1px solid #3b82f6",borderRadius:8,padding:"12px 16px",display:"flex",alignItems:"center",justifyContent:"space-between",flexWrap:"wrap",gap:12},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[e.jsx("span",{style:{fontSize:24},children:""}),e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:11,color:"#1d4ed8",fontWeight:500},children:"MTERYE SYLENLEN MONTAJ TERMN"}),e.jsx("div",{style:{fontSize:16,fontWeight:700,color:"#1e40af"},children:new Date(t.estimatedAssembly.date).toLocaleDateString("tr-TR",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),t.estimatedAssembly.note&&e.jsx("div",{style:{fontSize:12,color:"#64748b",marginTop:2},children:t.estimatedAssembly.note})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[(()=>{const o=new Date;o.setHours(0,0,0,0);const h=new Date(t.estimatedAssembly.date);h.setHours(0,0,0,0);const _=Math.ceil((h-o)/(1e3*60*60*24));let Y="var(--color-success)",J="var(--color-success-bg)",te=`${_} gn kald`;return _<0?(Y="var(--color-danger)",J="var(--color-danger-bg)",te=`${Math.abs(_)} gn geti!`):_===0?(Y="var(--color-warning)",J="#fef3cd",te="BUGN!"):_<=7&&(Y="var(--color-warning)",J="#fef3cd"),e.jsx("div",{style:{padding:"8px 16px",borderRadius:8,background:J,color:Y,fontWeight:700,fontSize:14},children:te})})(),!Ge&&!["KAPALI","SERVIS_KAPALI"].includes(t.status)&&e.jsx("button",{className:"btn btn-secondary btn-small",type:"button",title:"Montaj terminini gncelle",onClick:()=>{var _,Y;const o=((_=t.estimatedAssembly)==null?void 0:_.date)||"",h=prompt("Yeni montaj termini (GG.AA.YYYY):",o);if(h&&h!==o){const J=prompt("Not (opsiyonel):",((Y=t.estimatedAssembly)==null?void 0:Y.note)||"");st(()=>xh(t.id,{date:h,note:J||""}),{transition:t.status})}},children:""})]})]}),e.jsxs("div",{className:"card subtle-card",children:[e.jsxs("div",{className:"card-header",children:[e.jsx("h3",{className:"card-title",children:"Sre Haritas"}),e.jsx("span",{className:"badge badge-secondary",children:Ar.label})]}),e.jsx("div",{className:"card-body",style:{overflowX:"auto",paddingBottom:16},children:e.jsx("div",{style:{display:"flex",alignItems:"flex-start",minWidth:"max-content",padding:"0 12px"},children:dr.map((o,h)=>{var _e,Le;const _=Xc(o.id),Y=_==="current",J=_==="done",te=h===dr.length-1,ge=((_e=o.statuses)==null?void 0:_e.length)||1,xe=Y?(Le=o.statuses)==null?void 0:Le.indexOf(t.status):J?ge:-1;let ze="#e2e8f0";return Y&&(ze="#3b82f6"),J&&(ze="#22c55e"),e.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[e.jsxs("div",{"data-stage":o.id,style:{display:"flex",flexDirection:"column",alignItems:"center",cursor:"pointer",position:"relative",zIndex:1,width:100},onClick:()=>Ly(o.id),children:[e.jsx("div",{style:{width:36,height:36,borderRadius:"50%",backgroundColor:Y?"white":ze,border:`2px solid ${ze}`,display:"flex",alignItems:"center",justifyContent:"center",fontWeight:700,color:Y?ze:"white",marginBottom:8,transition:"all 0.2s",boxShadow:Y?`0 0 0 4px ${ze}33`:"none"},children:J?"":h+1}),e.jsx("div",{style:{fontSize:12,fontWeight:Y?700:500,color:Y?"#0f172a":"#64748b",textAlign:"center",lineHeight:1.3},children:o.label})]}),!te&&e.jsx("div",{style:{display:"flex",alignItems:"center",position:"relative",marginTop:-20},children:e.jsx("div",{style:{width:ge>1?30+(ge-1)*16:60,height:3,backgroundColor:J?"#22c55e":"#e2e8f0",display:"flex",alignItems:"center",justifyContent:"space-evenly",position:"relative"},children:ge>1&&Array.from({length:ge-1}).map((ct,Ve)=>{var Ce,Ae;const rt=J||Y&&Ve<xe;return e.jsx("div",{style:{width:8,height:8,borderRadius:"50%",backgroundColor:rt?"#22c55e":Y&&Ve===xe?"#3b82f6":"#cbd5e1",border:Y&&Ve===xe?"2px solid #3b82f6":"none",boxShadow:Y&&Ve===xe?"0 0 0 2px rgba(59,130,246,0.3)":"none",transition:"all 0.2s"},title:(Ce=o.statuses)!=null&&Ce[Ve+1]&&((Ae=Al[o.statuses[Ve+1]])==null?void 0:Ae.label)||""},Ve)})})})]},o.id)})})}),e.jsx("div",{className:"card-footer text-muted",children:"Setiiniz aamann formu aada alr. nceki aamalara dnp dzeltme yapabilirsiniz."})]}),e.jsx("div",{className:"card subtle-card",style:{marginBottom:16},children:e.jsxs("div",{className:"grid grid-2",style:{gap:16},children:[e.jsxs("div",{children:[e.jsxs("div",{className:"metric-row",style:{marginBottom:8},children:[e.jsx("span",{className:"metric-label",children:"Durum"}),Fn(t.status)]}),e.jsxs("div",{className:"metric-row",style:{marginBottom:8},children:[e.jsx("span",{className:"metric-label",children:"Balk"}),e.jsx("span",{className:"metric-value",children:t.title})]}),e.jsxs("div",{className:"metric-row",children:[e.jsx("span",{className:"metric-label",children:" No"}),e.jsx("span",{className:"metric-value",style:{fontSize:12},children:t.id})]})]}),e.jsxs("div",{style:{borderLeft:"1px solid var(--color-border)",paddingLeft:16},children:[e.jsxs("div",{style:{fontWeight:600,fontSize:16,marginBottom:8},children:[" ",t.customerName]}),n.phone&&e.jsxs("div",{style:{fontSize:13,marginBottom:4},children:[" ",n.phone,n.phone2&&` / ${n.phone2}`]}),n.address&&e.jsxs("div",{style:{fontSize:12,color:"var(--color-text-light)"},children:[" ",n.address]}),!n.phone&&!n.address&&e.jsx("div",{className:"text-muted",style:{fontSize:12},children:"Mteri detaylar bulunamad"})]})]})}),a?e.jsxs("div",{className:"card error-card",children:[e.jsx("div",{className:"error-title",children:"Hata"}),e.jsx("div",{className:"error-message",children:a})]}):null,Qt("measure")&&e.jsxs("div",{className:"card",children:[Ge&&(()=>{const o=Oi(t,"measure");return e.jsxs("div",{style:{background:"linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%)",borderBottom:"1px solid var(--color-border)",padding:"12px 16px",color:"#475569"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:o.length>0?10:0},children:[e.jsx("span",{style:{fontSize:18},children:""}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:600,fontSize:13},children:"Ariv Grnm"}),e.jsx("div",{style:{fontSize:11,opacity:.8},children:"Bu aama tamamland. Sadece grntleme modundasnz."})]})]}),o.length>0&&e.jsxs("div",{style:{marginTop:8,paddingTop:8,borderTop:"1px solid rgba(0,0,0,0.1)"},children:[e.jsx("div",{style:{fontSize:11,fontWeight:600,marginBottom:6,color:"#64748b"},children:" Geilen Alt Aamalar:"}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:6},children:o.map((h,_)=>e.jsxs("span",{className:"badge badge-secondary",style:{fontSize:10},children:[h.toLabel,"  ",new Date(h.at).toLocaleDateString("tr-TR")]},_))})]})]})})(),e.jsxs("div",{className:"card-header",children:[e.jsx("h3",{className:"card-title",children:t.startType==="MUSTERI_OLCUSU"?" Mteri ls":" l / Keif"}),Fn(t.status)]}),e.jsxs("div",{className:"card-body grid grid-1",style:{gap:16},children:[((ad=t.roles)==null?void 0:ad.length)>0&&e.jsx("div",{style:{display:"flex",gap:6,flexWrap:"wrap"},children:t.roles.map(o=>e.jsx("span",{className:"badge badge-secondary",children:o.name},o.id||o.name))}),Ge&&e.jsxs("div",{className:"card subtle-card",style:{background:"#f8fafc"},children:[e.jsx("div",{className:"card-header",style:{padding:"12px 16px"},children:e.jsx("h4",{className:"card-title",style:{fontSize:14},children:" l Bilgileri zeti"})}),e.jsxs("div",{className:"card-body",style:{padding:16},children:[e.jsxs("div",{className:"grid grid-2",style:{gap:16,marginBottom:16},children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-muted",style:{fontSize:12},children:"RANDEVU TARH"}),e.jsx("div",{style:{fontWeight:600},children:(id=(ld=t.measure)==null?void 0:ld.appointment)!=null&&id.date?new Date(t.measure.appointment.date).toLocaleString("tr-TR",{dateStyle:"long",timeStyle:"short"}):"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-muted",style:{fontSize:12},children:"MTER"}),e.jsx("div",{style:{fontWeight:600},children:t.customerName})]})]}),((cd=(od=t.measure)==null?void 0:od.measurements)==null?void 0:cd.note)&&e.jsxs("div",{style:{marginBottom:16,padding:12,background:"white",borderRadius:8,border:"1px solid var(--color-border)"},children:[e.jsx("div",{className:"text-muted",style:{fontSize:12,marginBottom:4},children:"NOT"}),e.jsx("div",{children:t.measure.measurements.note})]}),at.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-muted",style:{fontSize:12,marginBottom:8},children:" YKL DOSYALAR"}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:8},children:at.map(o=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px 12px",background:"white",borderRadius:6,border:"1px solid var(--color-border)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{children:""}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:500,fontSize:13},children:o.fileName||o.filename}),e.jsx("div",{className:"text-muted",style:{fontSize:11},children:o.type})]})]}),e.jsx("a",{href:`http://localhost:8000/documents/${o.id}/download`,className:"btn btn-sm",style:{fontSize:11,padding:"4px 8px"},download:!0,children:" ndir"})]},o.id))})]})]})]}),!Ge&&t.status==="OLCU_RANDEVU_BEKLIYOR"&&t.startType!=="MUSTERI_OLCUSU"&&e.jsxs("div",{className:"card subtle-card",children:[e.jsx("div",{className:"card-header",style:{padding:"12px 16px"},children:e.jsx("h4",{className:"card-title",style:{fontSize:14},children:" Randevu Bilgileri"})}),e.jsxs("div",{className:"card-body",style:{padding:16},children:[e.jsxs("div",{className:"grid grid-3",style:{gap:12},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Randevu Tarihi *"}),e.jsx(Qe,{value:((dd=I.appointment)==null?void 0:dd.split("T")[0])||"",onChange:o=>{var _,Y;const h=(_=I.appointment)!=null&&_.includes("T")?(Y=I.appointment.split("T")[1])==null?void 0:Y.slice(0,5):"10:00";me(J=>({...J,appointment:o?`${o}T${h}`:""}))}})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Saat *"}),e.jsx("input",{className:"form-input",type:"time",value:(ud=I.appointment)!=null&&ud.includes("T")?(md=I.appointment.split("T")[1])==null?void 0:md.slice(0,5):"10:00",onChange:o=>{var _;const h=((_=I.appointment)==null?void 0:_.split("T")[0])||"";h&&me(Y=>({...Y,appointment:`${h}T${o.target.value}`}))}})]})]}),e.jsxs("div",{className:"form-group",style:{marginTop:12},children:[e.jsx("label",{className:"form-label",children:"Adres / Not"}),e.jsx("textarea",{className:"form-textarea",placeholder:"Mteri adresi, iletiim bilgileri, notlar...",rows:2,value:I.measureNote,onChange:o=>me(h=>({...h,measureNote:o.target.value}))})]}),e.jsx("button",{className:"btn btn-success",type:"button",style:{marginTop:12},disabled:i||!I.appointment,onClick:()=>st(()=>Lb(t.id,{measurements:{note:I.measureNote},appointment:{date:I.appointment},status:"OLCU_RANDEVULU"}),{transition:"OLCU_RANDEVULU"}),children:" Randevuyu Kaydet"}),!I.appointment&&e.jsx("div",{className:"text-muted",style:{fontSize:12,marginTop:8},children:" Randevu tarihi zorunludur."})]})]}),!Ge&&t.status==="OLCU_RANDEVULU"&&e.jsxs("div",{className:"card",style:{border:"2px solid var(--color-info)",background:"var(--color-info-bg)"},children:[e.jsxs("div",{className:"card-header",style:{padding:"12px 16px"},children:[e.jsx("h4",{className:"card-title",style:{fontSize:14},children:" Randevu Bilgisi"}),e.jsx("span",{className:"badge badge-info",children:"lye Gidilecek"})]}),e.jsxs("div",{className:"card-body",style:{padding:16},children:[e.jsxs("div",{className:"grid grid-2",style:{gap:16},children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-muted",style:{fontSize:12},children:"RANDEVU"}),e.jsx("div",{style:{fontWeight:600,fontSize:16},children:(hd=(pd=t.measure)==null?void 0:pd.appointment)!=null&&hd.date?new Date(t.measure.appointment.date).toLocaleString("tr-TR",{dateStyle:"long",timeStyle:"short"}):"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-muted",style:{fontSize:12},children:"MTER"}),e.jsx("div",{style:{fontWeight:600},children:t.customerName})]})]}),((gd=(fd=t.measure)==null?void 0:fd.measurements)==null?void 0:gd.note)&&e.jsxs("div",{style:{marginTop:12,padding:10,background:"white",borderRadius:6},children:[e.jsx("strong",{children:"Not:"})," ",t.measure.measurements.note]}),e.jsx("button",{className:"btn btn-primary",type:"button",style:{marginTop:16},disabled:i,onClick:()=>st(()=>Dt(t.id,{status:"OLCU_ALINDI"}),{transition:"OLCU_ALINDI"}),children:" l Alnd - Dosya Yklemeye Ge"})]})]}),!Ge&&(t.status==="OLCU_ALINDI"||t.startType==="MUSTERI_OLCUSU")&&((yd=t.roles)==null?void 0:yd.length)>0&&e.jsxs("div",{className:"card subtle-card",children:[e.jsxs("div",{className:"card-header",style:{padding:"12px 16px"},children:[e.jsx("h4",{className:"card-title",style:{fontSize:14},children:" izim Dosyalar"}),e.jsx("span",{className:"text-muted",style:{fontSize:12},children:"Her i kolu iin dosya ykleyin"})]}),e.jsxs("div",{className:"card-body",style:{padding:16},children:[t.roles.map(o=>{const h=o.id||o.name,_=at.filter(xe=>xe.type===`measure_${h}`),Y=at.filter(xe=>xe.type===`technical_${h}`),J=_.length>0,te=Y.length>0,ge=J&&te;return e.jsxs("div",{style:{marginBottom:16,padding:16,background:ge?"var(--color-success-bg)":"var(--color-bg-secondary)",borderRadius:8,border:ge?"1px solid var(--color-success)":"1px solid var(--color-border)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsxs("div",{style:{fontWeight:600,display:"flex",alignItems:"center",gap:8},children:[ge&&e.jsx("span",{style:{color:"var(--color-success)"},children:""}),o.name]}),ge&&e.jsx("span",{className:"badge badge-success",children:"Tamamland"})]}),e.jsxs("div",{className:"grid grid-2",style:{gap:12},children:[e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{className:"form-label",children:["l izimi ",!J&&e.jsx("span",{style:{color:"var(--color-danger)"},children:"*"})]}),e.jsxs("div",{className:"file-upload-zone",children:[e.jsx("input",{type:"file",id:`measure-file-${h}`,accept:".pdf,.jpg,.jpeg,.png,.dwg,.dxf",style:{display:"none"},onChange:async xe=>{var _e;const ze=(_e=xe.target.files)==null?void 0:_e[0];ze&&(await bn(ze,`measure_${h}`,`${o.name} - l izimi`),xe.target.value="")}}),e.jsx("label",{htmlFor:`measure-file-${h}`,className:"btn btn-secondary btn-small",style:{cursor:"pointer"},children:" Dosya Se"}),J&&e.jsx("span",{className:"badge badge-success",style:{marginLeft:8},children:""})]}),_.map(xe=>e.jsxs("div",{style:{marginTop:8,display:"flex",alignItems:"center",gap:8,fontSize:12},children:[e.jsxs("a",{href:ys(xe.id),target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-primary)"},children:[" ",xe.originalName]}),e.jsx("button",{type:"button",className:"btn btn-danger btn-small btn-icon",style:{padding:"2px 6px",fontSize:10},onClick:()=>ei(xe.id),title:"Belgeyi Sil",children:""})]},xe.id))]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{className:"form-label",children:["Teknik izim ",!te&&e.jsx("span",{style:{color:"var(--color-danger)"},children:"*"})]}),e.jsxs("div",{className:"file-upload-zone",children:[e.jsx("input",{type:"file",id:`tech-file-${h}`,accept:".pdf,.jpg,.jpeg,.png,.dwg,.dxf",style:{display:"none"},onChange:async xe=>{var _e;const ze=(_e=xe.target.files)==null?void 0:_e[0];ze&&(await bn(ze,`technical_${h}`,`${o.name} - Teknik izim`),xe.target.value="")}}),e.jsx("label",{htmlFor:`tech-file-${h}`,className:"btn btn-secondary btn-small",style:{cursor:"pointer"},children:" Dosya Se"}),te&&e.jsx("span",{className:"badge badge-success",style:{marginLeft:8},children:""})]}),Y.map(xe=>e.jsxs("div",{style:{marginTop:8,display:"flex",alignItems:"center",gap:8,fontSize:12},children:[e.jsxs("a",{href:ys(xe.id),target:"_blank",rel:"noopener noreferrer",style:{color:"var(--color-primary)"},children:[" ",xe.originalName]}),e.jsx("button",{type:"button",className:"btn btn-danger btn-small btn-icon",style:{padding:"2px 6px",fontSize:10},onClick:()=>ei(xe.id),title:"Belgeyi Sil",children:""})]},xe.id))]})]})]},h)}),t.roles.every(h=>{const _=h.id||h.name,Y=at.some(te=>te.type===`measure_${_}`),J=at.some(te=>te.type===`technical_${_}`);return Y&&J})?e.jsx("button",{className:"btn btn-success",type:"button",style:{marginTop:8},disabled:i,onClick:()=>st(()=>Dt(t.id,{status:"FIYATLANDIRMA"}),{transition:"FIYATLANDIRMA"}),children:" Fiyatlandrmaya Ge"}):e.jsx("div",{className:"text-muted",style:{padding:12,background:"var(--color-warning-bg)",borderRadius:8,fontSize:13},children:" Fiyatlandrmaya gemek iin tm i kollarnn dosyalar yklenmelidir."})]})]}),t.status==="MUSTERI_OLCUSU_BEKLENIYOR"&&e.jsx("div",{className:"card",style:{border:"2px solid var(--color-warning)",background:"var(--color-warning-bg)"},children:e.jsxs("div",{className:"card-body",style:{padding:20,textAlign:"center"},children:[e.jsx("div",{style:{fontSize:48,marginBottom:12},children:""}),e.jsx("div",{style:{fontWeight:600,marginBottom:8},children:"Mteri ls Bekleniyor"}),e.jsx("div",{className:"text-muted",children:"Yukardaki alanlara mteriden gelen l dosyalarn ykleyin."})]})}),Qc.length>0&&e.jsxs("div",{className:"card error-card",children:[e.jsx("div",{className:"error-title",children:" Eksikler var"}),e.jsx("ul",{style:{margin:"8px 0 0 16px",padding:0},children:Qc.map((o,h)=>e.jsx("li",{style:{marginBottom:4},children:o},h))})]})]})]}),Qt("pricing")&&e.jsxs("div",{className:"card",children:[Ge&&(()=>{const o=Oi(t,"pricing");return e.jsxs("div",{style:{background:"linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%)",borderBottom:"1px solid var(--color-border)",padding:"12px 16px",color:"#475569"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:o.length>0?10:0},children:[e.jsx("span",{style:{fontSize:18},children:""}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:600,fontSize:13},children:"Ariv Grnm"}),e.jsx("div",{style:{fontSize:11,opacity:.8},children:"Bu aama tamamland. Sadece grntleme modundasnz."})]})]}),o.length>0&&e.jsxs("div",{style:{marginTop:8,paddingTop:8,borderTop:"1px solid rgba(0,0,0,0.1)"},children:[e.jsx("div",{style:{fontSize:11,fontWeight:600,marginBottom:6,color:"#64748b"},children:" Geilen Alt Aamalar:"}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:6},children:o.map((h,_)=>e.jsxs("span",{className:"badge badge-secondary",style:{fontSize:10},children:[h.toLabel,"  ",new Date(h.at).toLocaleDateString("tr-TR")]},_))})]})]})})(),e.jsxs("div",{className:"card-header",children:[e.jsx("h3",{className:"card-title",children:" Fiyatlandrma"}),Fn(t.status)]}),e.jsxs("div",{className:"card-body grid grid-1",style:{gap:16},children:[Ge&&e.jsxs("div",{className:"card subtle-card",style:{background:"#f8fafc"},children:[e.jsx("div",{className:"card-header",style:{padding:"12px 16px"},children:e.jsx("h4",{className:"card-title",style:{fontSize:14},children:" Fiyatlandrma zeti"})}),e.jsxs("div",{className:"card-body",style:{padding:16},children:[((xd=t.offer)==null?void 0:xd.rolePrices)&&Object.keys(t.offer.rolePrices).length>0&&e.jsxs("div",{style:{marginBottom:16},children:[e.jsx("div",{className:"text-muted",style:{fontSize:12,marginBottom:8},children:" KOLU FYATLARI"}),(vd=t.roles)==null?void 0:vd.map(o=>{var Y;const h=o.id||o.name,_=((Y=t.offer.rolePrices)==null?void 0:Y[h])||0;return e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px 12px",background:"white",borderRadius:6,marginBottom:4,border:"1px solid var(--color-border)"},children:[e.jsx("span",{children:o.name}),e.jsxs("span",{style:{fontWeight:600},children:[be(_)," "]})]},h)}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"12px",background:"var(--color-primary-bg)",borderRadius:6,marginTop:8},children:[e.jsx("span",{style:{fontWeight:600},children:"TOPLAM"}),e.jsxs("span",{style:{fontWeight:700,color:"var(--color-primary)"},children:[be(((jd=t.offer)==null?void 0:jd.total)||0)," "]})]})]}),((bd=t.offer)==null?void 0:bd.notifiedDate)&&e.jsxs("div",{style:{marginBottom:16},children:[e.jsx("div",{className:"text-muted",style:{fontSize:12,marginBottom:4},children:"FYAT BLDRM TARH"}),e.jsx("div",{style:{fontWeight:500},children:new Date(t.offer.notifiedDate).toLocaleDateString("tr-TR")})]}),at.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-muted",style:{fontSize:12,marginBottom:8},children:" YKL DOSYALAR"}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:8},children:at.map(o=>e.jsxs("a",{href:ys(o.id),target:"_blank",rel:"noopener noreferrer",className:"btn btn-sm",style:{fontSize:11},children:[" ",o.originalName," "]},o.id))})]})]})]}),!Ge&&t.status==="FIYATLANDIRMA"&&e.jsxs(e.Fragment,{children:[at.length>0&&e.jsxs("div",{className:"card subtle-card",children:[e.jsx("div",{className:"card-header",style:{padding:"12px 16px"},children:e.jsx("h4",{className:"card-title",style:{fontSize:14},children:" Ykl Dosyalar"})}),e.jsx("div",{className:"card-body",style:{padding:16},children:e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:8},children:at.map(o=>e.jsxs("a",{href:ys(o.id),target:"_blank",rel:"noopener noreferrer",style:{padding:"6px 12px",background:"var(--color-bg-secondary)",borderRadius:6,fontSize:12,textDecoration:"none",color:"var(--color-text)"},children:[" ",o.originalName]},o.id))})})]}),((Nd=t.roles)==null?void 0:Nd.length)>0&&e.jsxs("div",{className:"card subtle-card",children:[e.jsx("div",{className:"card-header",style:{padding:"12px 16px"},children:e.jsx("h4",{className:"card-title",style:{fontSize:14},children:"  Kolu Bazl Fiyatlandrma"})}),e.jsxs("div",{className:"card-body",style:{padding:16},children:[e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:12},children:t.roles.map(o=>{const h=o.id||o.name;return e.jsxs("div",{className:"metric-row",style:{padding:"12px 16px",background:"var(--color-bg-secondary)",borderRadius:8},children:[e.jsx("div",{style:{fontWeight:600,minWidth:180},children:o.name}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx(bt,{placeholder:"0",style:{width:150},value:I.rolePrices[h]||"",onChange:_=>me(Y=>({...Y,rolePrices:{...Y.rolePrices,[h]:_}}))}),e.jsx("span",{style:{color:"var(--color-text-light)"},children:""})]})]},h)})}),e.jsxs("div",{style:{marginTop:16,padding:"16px",background:"var(--color-primary)",borderRadius:8,color:"white",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{style:{fontWeight:600},children:"TOPLAM"}),e.jsxs("span",{style:{fontSize:24,fontWeight:700},children:[be(Object.values(I.rolePrices).reduce((o,h)=>o+(Number(h)||0),0))," "]})]})]})]}),e.jsxs("div",{className:"card subtle-card",children:[e.jsx("div",{className:"card-header",style:{padding:"12px 16px"},children:e.jsx("h4",{className:"card-title",style:{fontSize:14},children:" Mteriye Bildirim"})}),e.jsxs("div",{className:"card-body",style:{padding:16},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Fiyat Bildirim Tarihi *"}),e.jsx(Qe,{value:I.pricingNotifiedDate||new Date().toISOString().split("T")[0],onChange:o=>me(h=>({...h,pricingNotifiedDate:o}))})]}),e.jsx("button",{className:"btn btn-success",type:"button",style:{marginTop:12},disabled:i||Object.values(I.rolePrices).every(o=>!o),onClick:()=>{const o=Object.values(I.rolePrices).reduce((h,_)=>h+(Number(_)||0),0);st(()=>Dt(t.id,{status:"FIYAT_VERILDI",offer:{total:o,rolePrices:I.rolePrices,notifiedDate:I.pricingNotifiedDate||new Date().toISOString().split("T")[0]}}),{transition:"FIYAT_VERILDI"})},children:" Fiyat Mteriye Bildirildi"})]})]})]}),!Ge&&t.status==="FIYAT_VERILDI"&&(()=>{var ge,xe,ze,_e,Le,ct,Ve,rt;const o=((ge=t.offer)==null?void 0:ge.rolePrices)||{},h=((xe=t.offer)==null?void 0:xe.total)||((ze=t.roles)==null?void 0:ze.reduce((Ce,Ae)=>{const He=Ae.id||Ae.name;return Ce+(Number(o[He])||0)},0))||0,_=I.roleDiscounts||{},Y=Object.values(_).reduce((Ce,Ae)=>Ce+(Number(Ae)||0),0),J=h-Y,te=((Le=(_e=t.offer)==null?void 0:_e.negotiationHistory)==null?void 0:Le.length)>0;return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"card",style:{border:"2px solid var(--color-warning)",background:"var(--color-warning-bg)"},children:e.jsxs("div",{className:"card-body",style:{padding:20},children:[e.jsxs("div",{className:"grid grid-3",style:{gap:16,marginBottom:16},children:[e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{className:"text-muted",style:{fontSize:12},children:"LK FYAT"}),e.jsx("div",{style:{fontSize:20,fontWeight:700,color:h>0?"var(--color-text)":"var(--color-danger)"},children:h>0?`${be(h)} `:"Fiyat Girilmedi!"})]}),e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{className:"text-muted",style:{fontSize:12},children:"BLDRM TARH"}),e.jsx("div",{style:{fontWeight:600},children:(ct=t.offer)!=null&&ct.notifiedDate?new Date(t.offer.notifiedDate).toLocaleDateString("tr-TR"):"-"})]}),e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{className:"text-muted",style:{fontSize:12},children:"MTER"}),e.jsx("div",{style:{fontWeight:600},children:t.customerName})]})]}),((Ve=t.roles)==null?void 0:Ve.length)>0&&e.jsxs("div",{style:{borderTop:"1px solid var(--color-border)",paddingTop:12,marginTop:12},children:[e.jsx("div",{style:{fontSize:12,color:"var(--color-text-light)",marginBottom:8},children:" Kolu Bazl Fiyatlar:"}),t.roles.map(Ce=>{const Ae=Ce.id||Ce.name,He=Number(o[Ae])||0;return e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:13,marginBottom:4},children:[e.jsx("span",{children:Ce.name}),e.jsx("span",{style:{color:He>0?"inherit":"var(--color-danger)"},children:He>0?`${be(He)} `:"Girilmedi"})]},Ae)})]})]})}),h===0&&e.jsx("div",{className:"card",style:{border:"2px solid var(--color-danger)",background:"var(--color-danger-bg)"},children:e.jsxs("div",{className:"card-body",style:{padding:16},children:[e.jsx("div",{style:{fontWeight:600,color:"var(--color-danger)",marginBottom:8},children:" Bu i iin fiyat girilmemi!"}),e.jsx("div",{className:"text-muted",style:{fontSize:13,marginBottom:12},children:"Fiyatlandrma aamasna geri dnp i kolu bazl fiyatlar girmeniz gerekmektedir."}),e.jsx("button",{className:"btn btn-warning",type:"button",disabled:i,onClick:()=>st(()=>Dt(t.id,{status:"FIYATLANDIRMA"}),{transition:"FIYATLANDIRMA"}),children:" Fiyatlandrmaya Geri Dn"})]})}),e.jsxs("div",{className:"card subtle-card",children:[e.jsx("div",{className:"card-header",style:{padding:"12px 16px"},children:e.jsx("h4",{className:"card-title",style:{fontSize:14},children:" Fiyat Gemii"})}),e.jsxs("div",{className:"card-body",style:{padding:te?0:16},children:[te?e.jsxs("table",{className:"table",style:{margin:0},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Tarih"}),e.jsx("th",{children:"lk Fiyat"}),e.jsx("th",{children:"skonto"}),e.jsx("th",{children:"Son Fiyat"})]})}),e.jsx("tbody",{children:t.offer.negotiationHistory.map((Ce,Ae)=>e.jsxs("tr",{children:[e.jsx("td",{children:new Date(Ce.date).toLocaleDateString("tr-TR")}),e.jsxs("td",{children:[be(Ce.originalTotal)," "]}),e.jsxs("td",{style:{color:"var(--color-danger)"},children:["-",be(Ce.discountTotal)," "]}),e.jsxs("td",{style:{fontWeight:600},children:[be(Ce.finalTotal)," "]})]},Ae))})]}):e.jsx("div",{style:{color:"var(--color-text-light)",fontSize:13,textAlign:"center"},children:"Henz fiyat deiiklii veya pazarlk yaplmad."}),t.rejection&&e.jsxs("div",{style:{marginTop:te?12:0,padding:te?"12px 16px":0,borderTop:te?"1px solid var(--color-border)":"none"},children:[e.jsx("div",{style:{fontWeight:600,color:"var(--color-danger)",marginBottom:8,fontSize:13},children:" Red Gemii"}),e.jsxs("div",{style:{fontSize:12,color:"var(--color-text-light)"},children:[e.jsx("strong",{children:"Tarih:"})," ",t.rejection.rejectedAt?new Date(t.rejection.rejectedAt).toLocaleDateString("tr-TR"):"-",t.rejection.reason&&e.jsxs("span",{children:[" | ",e.jsx("strong",{children:"Sebep:"})," ",t.rejection.reason]}),t.rejection.previousTotal&&e.jsxs("span",{children:[" | ",e.jsx("strong",{children:"Red Edilen Fiyat:"})," ",be(t.rejection.previousTotal)," "]})]})]})]})]}),I.showNegotiationPanel&&h>0?e.jsxs("div",{className:"card",style:{border:"2px solid var(--color-primary)"},children:[e.jsxs("div",{className:"card-header",style:{padding:"12px 16px",background:"var(--color-primary-bg)"},children:[e.jsx("h4",{className:"card-title",style:{fontSize:14},children:" skonto / Pazarlk"}),e.jsx("button",{type:"button",className:"btn btn-secondary btn-small",onClick:()=>me(Ce=>({...Ce,showNegotiationPanel:!1,roleDiscounts:{}})),children:"ptal"})]}),e.jsxs("div",{className:"card-body",style:{padding:16},children:[e.jsx("div",{style:{fontSize:13,color:"var(--color-text-light)",marginBottom:12},children:"Her i kolu iin yaplacak iskonto tutarn girin:"}),(rt=t.roles)==null?void 0:rt.map(Ce=>{const Ae=Ce.id||Ce.name,He=Number(o[Ae])||0,xt=Number(_[Ae]||0),Wt=He-xt;return e.jsxs("div",{style:{padding:"12px 16px",background:"var(--color-bg-secondary)",borderRadius:8,marginBottom:8},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:8},children:[e.jsx("span",{style:{fontWeight:600},children:Ce.name}),e.jsxs("span",{style:{fontSize:13},children:["Mevcut: ",be(He)," "]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[e.jsxs("div",{style:{flex:1},children:[e.jsx("label",{className:"form-label",style:{fontSize:12},children:"skonto Tutar"}),e.jsx(bt,{placeholder:"0",value:_[Ae]||"",onChange:Ke=>me(Ns=>({...Ns,roleDiscounts:{...Ns.roleDiscounts,[Ae]:Ke}}))})]}),e.jsxs("div",{style:{textAlign:"right"},children:[e.jsx("div",{style:{fontSize:12,color:"var(--color-text-light)"},children:"Yeni Fiyat"}),e.jsxs("div",{style:{fontWeight:700,fontSize:16,color:xt>0?"var(--color-success)":"inherit"},children:[be(Wt)," "]})]})]})]},Ae)}),e.jsxs("div",{style:{marginTop:16,padding:16,background:Y>0?"var(--color-success-bg)":"var(--color-bg-secondary)",borderRadius:8,border:Y>0?"2px solid var(--color-success)":"none"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[e.jsx("span",{children:"lk Toplam:"}),e.jsxs("span",{children:[be(h)," "]})]}),Y>0&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8,color:"var(--color-danger)"},children:[e.jsx("span",{children:"Toplam skonto:"}),e.jsxs("span",{children:["-",be(Y)," "]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontWeight:700,fontSize:18,paddingTop:8,borderTop:"1px solid var(--color-border)"},children:[e.jsx("span",{children:"ANLAILAN FYAT:"}),e.jsxs("span",{style:{color:"var(--color-success)"},children:[be(J)," "]})]})]}),e.jsx("button",{className:"btn btn-success",type:"button",style:{width:"100%",marginTop:16},disabled:i,onClick:()=>{var xt,Wt;const Ae=[...((xt=t.offer)==null?void 0:xt.negotiationHistory)||[],{date:new Date().toISOString(),originalTotal:h,discountTotal:Y,finalTotal:J,roleDiscounts:{..._}}],He={};(Wt=t.roles)==null||Wt.forEach(Ke=>{const Ns=Ke.id||Ke.name,$y=Number(o[Ns])||0;He[Ns]=$y-(Number(_[Ns])||0)}),st(()=>Dt(t.id,{status:"ANLASMA_YAPILIYOR",offer:{...t.offer,total:J,rolePrices:He,negotiationHistory:Ae,agreedDate:new Date().toISOString()}}),{transition:"ANLASMA_YAPILIYOR"})},children:" Bu Fiyatla Anlald - Devam Et"})]})]}):e.jsxs("div",{style:{display:"flex",gap:12},children:[e.jsx("button",{className:"btn btn-success",type:"button",style:{flex:1},disabled:i,onClick:()=>st(()=>Dt(t.id,{status:"ANLASMA_YAPILIYOR",offer:{...t.offer,agreedDate:new Date().toISOString()}}),{transition:"ANLASMA_YAPILIYOR"}),children:" Fiyat Onayland"}),e.jsx("button",{className:"btn btn-warning",type:"button",style:{flex:1},disabled:i,onClick:()=>me(Ce=>({...Ce,showNegotiationPanel:!0})),children:" Pazarlk / skonto"}),e.jsx("button",{className:"btn btn-danger",type:"button",style:{flex:1},disabled:i,onClick:()=>me(Ce=>({...Ce,showRejectionModal:!0})),children:" Reddedildi"})]}),I.showRejectionModal&&e.jsxs("div",{className:"card",style:{border:"2px solid var(--color-danger)",background:"var(--color-danger-bg)"},children:[e.jsx("div",{className:"card-header",style:{padding:"12px 16px"},children:e.jsx("h4",{className:"card-title",style:{fontSize:14,color:"var(--color-danger)"},children:" Ret / Anlalamad"})}),e.jsxs("div",{className:"card-body",style:{padding:16},children:[e.jsxs("div",{className:"grid grid-2",style:{gap:12},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Ret Kategorisi *"}),e.jsxs("select",{className:"form-select",value:I.rejectionCategory||"",onChange:Ce=>me(Ae=>({...Ae,rejectionCategory:Ce.target.value})),children:[e.jsx("option",{value:"",children:"Sein..."}),e.jsx("option",{value:"FIYAT_YUKSEK",children:" Fiyat Yksek Bulundu"}),e.jsx("option",{value:"ZAMANLAMA",children:" Zamanlama Uymuyor"}),e.jsx("option",{value:"BASKA_FIRMA",children:" Baka Firmaya Gitti"}),e.jsx("option",{value:"PROJE_IPTAL",children:" Projeyi ptal Etti"}),e.jsx("option",{value:"DUSUNUYOR",children:" Dnyor / Bekliyor"}),e.jsx("option",{value:"DIGER",children:" Dier"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Takip Tarihi"}),e.jsx(Qe,{value:I.rejectionFollowUp||"",onChange:Ce=>me(Ae=>({...Ae,rejectionFollowUp:Ce})),min:new Date().toISOString().split("T")[0]}),e.jsx("div",{className:"text-muted",style:{fontSize:11,marginTop:4},children:" Bu tarihte tekrar aranacak"})]})]}),e.jsxs("div",{className:"form-group",style:{marginTop:12},children:[e.jsx("label",{className:"form-label",children:"Aklama / Not *"}),e.jsx("textarea",{className:"form-textarea",placeholder:"Detayl aklama yazn...",rows:3,value:I.rejectionReason||"",onChange:Ce=>me(Ae=>({...Ae,rejectionReason:Ce.target.value}))})]}),e.jsxs("div",{style:{display:"flex",gap:12,marginTop:12},children:[e.jsx("button",{className:"btn btn-secondary",type:"button",onClick:()=>me(Ce=>({...Ce,showRejectionModal:!1})),children:"ptal"}),e.jsx("button",{className:"btn btn-danger",type:"button",disabled:i||!I.rejectionReason||!I.rejectionCategory,onClick:()=>st(()=>Dt(t.id,{status:"ANLASILAMADI",rejection:{category:I.rejectionCategory,reason:I.rejectionReason,followUpDate:I.rejectionFollowUp||null,date:new Date().toISOString(),lastOffer:t.offer}}),{transition:"ANLASILAMADI"}),children:"i Anlalamad Olarak aretle"})]}),(!I.rejectionReason||!I.rejectionCategory)&&e.jsx("div",{className:"text-muted",style:{fontSize:12,marginTop:8},children:" Kategori ve aklama zorunludur."})]})]})]})})(),t.status==="ANLASILAMADI"&&(()=>{var te,ge,xe,ze,_e,Le,ct,Ve,rt,Ce;const o={FIYAT_YUKSEK:{label:"Fiyat Yksek Bulundu",icon:"",color:"warning"},ZAMANLAMA:{label:"Zamanlama Uymuyor",icon:"",color:"secondary"},BASKA_FIRMA:{label:"Baka Firmaya Gitti",icon:"",color:"danger"},PROJE_IPTAL:{label:"Projeyi ptal Etti",icon:"",color:"danger"},DUSUNUYOR:{label:"Dnyor / Bekliyor",icon:"",color:"info"},DIGER:{label:"Dier",icon:"",color:"secondary"}},h=o[(te=t.rejection)==null?void 0:te.category]||o.DIGER,_=((ge=t.rejection)==null?void 0:ge.lastOffer)||t.offer,Y=(xe=t.rejection)==null?void 0:xe.followUpDate,J=Y&&new Date(t.rejection.followUpDate)<=new Date;return e.jsxs("div",{className:"card",style:{border:"2px solid var(--color-danger)"},children:[e.jsxs("div",{className:"card-header",style:{background:"var(--color-danger)",color:"white"},children:[e.jsx("h3",{className:"card-title",style:{color:"white"},children:" Anlalamad"}),e.jsx("span",{style:{fontSize:12,opacity:.9},children:(ze=t.rejection)!=null&&ze.date?new Date(t.rejection.date).toLocaleDateString("tr-TR"):""})]}),e.jsxs("div",{className:"card-body",style:{padding:20},children:[e.jsxs("div",{className:"grid grid-2",style:{gap:16,marginBottom:16},children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-muted",style:{fontSize:12},children:"MTER"}),e.jsx("div",{style:{fontWeight:600,fontSize:16},children:t.customerName}),n.phone&&e.jsxs("div",{style:{fontSize:13,marginTop:4},children:[" ",n.phone]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-muted",style:{fontSize:12},children:"RET SEBEB"}),e.jsxs("div",{style:{fontWeight:600},children:[h.icon," ",h.label]})]})]}),((_e=t.rejection)==null?void 0:_e.reason)&&e.jsxs("div",{style:{padding:12,background:"var(--color-danger-bg)",borderRadius:8,marginBottom:16},children:[e.jsx("div",{style:{fontWeight:600,marginBottom:4},children:"Aklama:"}),e.jsx("div",{children:t.rejection.reason})]}),Y&&e.jsx("div",{style:{padding:12,background:J?"var(--color-warning-bg)":"var(--color-bg-secondary)",borderRadius:8,marginBottom:16,border:J?"2px solid var(--color-warning)":"none"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("span",{style:{fontSize:12,color:"var(--color-text-light)"},children:" TAKP TARH"}),e.jsx("div",{style:{fontWeight:600},children:new Date(t.rejection.followUpDate).toLocaleDateString("tr-TR")})]}),J&&e.jsx("span",{className:"badge badge-warning",children:" Takip Zaman!"})]})}),e.jsxs("div",{className:"card subtle-card",style:{marginBottom:16},children:[e.jsx("div",{className:"card-header",style:{padding:"12px 16px"},children:e.jsx("h4",{className:"card-title",style:{fontSize:14},children:"  zeti"})}),e.jsxs("div",{className:"card-body",style:{padding:16},children:[e.jsxs("div",{className:"metric-row",style:{marginBottom:8},children:[e.jsx("span",{className:"metric-label",children:" l Alnd"}),e.jsx("span",{className:"metric-value",children:(ct=(Le=t.measure)==null?void 0:Le.measurements)!=null&&ct.date?new Date(t.measure.measurements.date).toLocaleDateString("tr-TR"):(rt=(Ve=t.measure)==null?void 0:Ve.appointment)!=null&&rt.date?new Date(t.measure.appointment.date).toLocaleDateString("tr-TR"):"-"})]}),at.length>0&&e.jsxs("div",{className:"metric-row",style:{marginBottom:8},children:[e.jsx("span",{className:"metric-label",children:" Ykl Dosyalar"}),e.jsxs("span",{className:"metric-value",children:[at.length," dosya"]})]}),e.jsxs("div",{style:{borderTop:"1px solid var(--color-border)",paddingTop:12,marginTop:12},children:[e.jsx("div",{style:{fontWeight:600,marginBottom:8},children:" Son Fiyat Teklifi:"}),(_==null?void 0:_.rolePrices)&&Object.entries(_.rolePrices).map(([Ae,He])=>{var xt,Wt;return e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:13,marginBottom:4},children:[e.jsx("span",{children:((Wt=(xt=t.roles)==null?void 0:xt.find(Ke=>(Ke.id||Ke.name)===Ae))==null?void 0:Wt.name)||Ae}),e.jsxs("span",{children:[be(He)," "]})]},Ae)}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontWeight:700,fontSize:16,marginTop:8,paddingTop:8,borderTop:"1px solid var(--color-border)"},children:[e.jsx("span",{children:"TOPLAM:"}),e.jsxs("span",{children:[be((_==null?void 0:_.total)||0)," "]})]})]}),((Ce=_==null?void 0:_.negotiationHistory)==null?void 0:Ce.length)>0&&e.jsxs("div",{style:{marginTop:12},children:[e.jsx("div",{style:{fontWeight:600,marginBottom:8,fontSize:13},children:" Pazarlk Gemii:"}),_.negotiationHistory.map((Ae,He)=>e.jsxs("div",{style:{fontSize:12,color:"var(--color-text-light)",marginBottom:4},children:[new Date(Ae.date).toLocaleDateString("tr-TR"),": ",be(Ae.originalTotal),"   ",be(Ae.finalTotal)," ",e.jsxs("span",{style:{color:"var(--color-danger)"},children:[" (-",be(Ae.discountTotal)," )"]})]},He))]})]})]}),e.jsxs("div",{style:{padding:16,background:"var(--color-bg-secondary)",borderRadius:8,border:"1px dashed var(--color-border)"},children:[e.jsx("div",{style:{fontWeight:600,marginBottom:8},children:" Mteri Geri Dnd m?"}),e.jsx("div",{className:"text-muted",style:{fontSize:13,marginBottom:12},children:"Mteri tekrar ilgileniyorsa, son fiyat zerinden yeni iskonto yapabilir veya mevcut fiyatla devam edebilirsiniz."}),e.jsx("button",{className:"btn btn-primary",type:"button",disabled:i,onClick:()=>{st(()=>Dt(t.id,{status:"FIYAT_VERILDI",offer:{..._,reactivatedAt:new Date().toISOString(),reactivatedFrom:t.rejection}}),{transition:"FIYAT_VERILDI"})},children:" i Yeniden Aktifletir"})]})]})]})})()]})]}),Qt("agreement")&&e.jsxs("div",{className:"card",children:[Ge&&(()=>{const o=Oi(t,"agreement");return e.jsxs("div",{style:{background:"linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%)",borderBottom:"1px solid var(--color-border)",padding:"12px 16px",color:"#475569"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:10,marginBottom:o.length>0?10:0},children:[e.jsx("span",{style:{fontSize:18},children:""}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:600,fontSize:13},children:"Ariv Grnm"}),e.jsx("div",{style:{fontSize:11,opacity:.8},children:"Bu aama tamamland. Sadece grntleme modundasnz."})]})]}),o.length>0&&e.jsxs("div",{style:{marginTop:8,paddingTop:8,borderTop:"1px solid rgba(0,0,0,0.1)"},children:[e.jsx("div",{style:{fontSize:11,fontWeight:600,marginBottom:6,color:"#64748b"},children:" Geilen Alt Aamalar:"}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:6},children:o.map((h,_)=>e.jsxs("span",{className:"badge badge-secondary",style:{fontSize:10},children:[h.toLabel,"  ",new Date(h.at).toLocaleDateString("tr-TR")]},_))})]})]})})(),e.jsxs("div",{className:"card-header",children:[e.jsx("h3",{className:"card-title",children:" Anlama"}),Fn(t.status)]}),e.jsxs("div",{className:"card-body grid grid-1",style:{gap:16},children:[e.jsx("div",{className:"card",style:{background:"var(--color-success-bg)",border:"1px solid var(--color-success)"},children:e.jsx("div",{className:"card-body",style:{padding:16},children:e.jsxs("div",{className:"grid grid-3",style:{gap:16},children:[e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{className:"text-muted",style:{fontSize:12},children:"MTER"}),e.jsx("div",{style:{fontWeight:600},children:t.customerName})]}),e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{className:"text-muted",style:{fontSize:12},children:"ANLAILAN FYAT"}),e.jsxs("div",{style:{fontSize:24,fontWeight:700,color:"var(--color-success)"},children:[be(((Sd=t.offer)==null?void 0:Sd.total)||0)," "]})]}),e.jsxs("div",{style:{textAlign:"center"},children:[e.jsx("div",{className:"text-muted",style:{fontSize:12},children:"ONAY TARH"}),e.jsx("div",{style:{fontWeight:600},children:(kd=t.approval)!=null&&kd.approvedAt?new Date(t.approval.approvedAt).toLocaleDateString("tr-TR"):new Date().toLocaleDateString("tr-TR")})]})]})})}),e.jsxs("div",{className:"card subtle-card",children:[e.jsx("div",{className:"card-header",style:{padding:"12px 16px"},children:e.jsx("h4",{className:"card-title",style:{fontSize:14},children:" Fiyat Gemii"})}),e.jsxs("div",{className:"card-body",style:{padding:((wd=(Cd=t.offer)==null?void 0:Cd.negotiationHistory)==null?void 0:wd.length)>0?0:16},children:[((Dd=(Td=t.offer)==null?void 0:Td.negotiationHistory)==null?void 0:Dd.length)>0?e.jsxs("table",{className:"table",style:{margin:0},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Tarih"}),e.jsx("th",{children:"lk Fiyat"}),e.jsx("th",{children:"skonto"}),e.jsx("th",{children:"Son Fiyat"})]})}),e.jsx("tbody",{children:t.offer.negotiationHistory.map((o,h)=>e.jsxs("tr",{children:[e.jsx("td",{children:new Date(o.date).toLocaleDateString("tr-TR")}),e.jsxs("td",{children:[be(o.originalTotal)," "]}),e.jsxs("td",{style:{color:"var(--color-danger)"},children:["-",be(o.discountTotal)," "]}),e.jsxs("td",{style:{fontWeight:600},children:[be(o.finalTotal)," "]})]},h))})]}):e.jsx("div",{style:{color:"var(--color-text-light)",fontSize:13,textAlign:"center"},children:"Dorudan anlald, pazarlk yaplmad."}),t.rejection&&e.jsxs("div",{style:{marginTop:((Id=(zd=t.offer)==null?void 0:zd.negotiationHistory)==null?void 0:Id.length)>0?12:0,padding:((Ad=(Ed=t.offer)==null?void 0:Ed.negotiationHistory)==null?void 0:Ad.length)>0?"12px 16px":0,borderTop:((Bd=(Rd=t.offer)==null?void 0:Rd.negotiationHistory)==null?void 0:Bd.length)>0?"1px solid var(--color-border)":"none"},children:[e.jsx("div",{style:{fontWeight:600,color:"var(--color-danger)",marginBottom:8,fontSize:13},children:" Red Gemii"}),e.jsxs("div",{style:{fontSize:12,color:"var(--color-text-light)"},children:[e.jsx("strong",{children:"Tarih:"})," ",t.rejection.rejectedAt?new Date(t.rejection.rejectedAt).toLocaleDateString("tr-TR"):"-",t.rejection.reason&&e.jsxs("span",{children:[" | ",e.jsx("strong",{children:"Sebep:"})," ",t.rejection.reason]}),t.rejection.previousTotal&&e.jsxs("span",{children:[" | ",e.jsx("strong",{children:"Red Edilen Fiyat:"})," ",be(t.rejection.previousTotal)," "]})]})]})]})]}),Ge&&((Ld=t.approval)==null?void 0:Ld.paymentPlan)&&e.jsxs("div",{className:"card subtle-card",style:{padding:16,background:"#f8fafc"},children:[e.jsx("h4",{style:{margin:"0 0 16px 0",fontSize:14},children:" deme Plan zeti"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:12},children:[(((Pd=t.approval.paymentPlan.cash)==null?void 0:Pd.amount)>0||t.approval.paymentPlan.cash>0)&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px 12px",background:"white",borderRadius:6,border:"1px solid var(--color-border)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{children:""}),e.jsx("span",{style:{fontWeight:500},children:"Nakit"}),((Md=t.approval.paymentPlan.cash)==null?void 0:Md.date)&&e.jsx("span",{className:"badge badge-secondary",style:{fontSize:10},children:new Date(t.approval.paymentPlan.cash.date).toLocaleDateString("tr-TR")})]}),e.jsxs("span",{style:{fontWeight:600},children:[be(((Od=t.approval.paymentPlan.cash)==null?void 0:Od.amount)||t.approval.paymentPlan.cash||0)," "]})]}),(((_d=t.approval.paymentPlan.card)==null?void 0:_d.amount)>0||t.approval.paymentPlan.card>0)&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px 12px",background:"white",borderRadius:6,border:"1px solid var(--color-border)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{children:""}),e.jsx("span",{style:{fontWeight:500},children:"Kredi Kart"}),((Fd=t.approval.paymentPlan.card)==null?void 0:Fd.date)&&e.jsx("span",{className:"badge badge-secondary",style:{fontSize:10},children:new Date(t.approval.paymentPlan.card.date).toLocaleDateString("tr-TR")})]}),e.jsxs("span",{style:{fontWeight:600},children:[be((($d=t.approval.paymentPlan.card)==null?void 0:$d.amount)||t.approval.paymentPlan.card||0)," "]})]}),(((Wd=t.approval.paymentPlan.cheque)==null?void 0:Wd.total)>0||t.approval.paymentPlan.cheque>0)&&e.jsxs("div",{style:{padding:"10px 12px",background:"white",borderRadius:6,border:"1px solid var(--color-border)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:((Ud=(Kd=t.approval.paymentPlan.cheque)==null?void 0:Kd.items)==null?void 0:Ud.length)>0?8:0},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{children:""}),e.jsx("span",{style:{fontWeight:500},children:"ek"}),((qd=t.approval.paymentPlan.cheque)==null?void 0:qd.count)>0&&e.jsxs("span",{className:"badge badge-secondary",style:{fontSize:10},children:[t.approval.paymentPlan.cheque.count," adet"]}),((Hd=t.approval.paymentPlan.cheque)==null?void 0:Hd.received)&&e.jsx("span",{className:"badge badge-success",style:{fontSize:10},children:"Teslim alnd"})]}),e.jsxs("span",{style:{fontWeight:600},children:[be(((Yd=t.approval.paymentPlan.cheque)==null?void 0:Yd.total)||t.approval.paymentPlan.cheque||0)," "]})]}),((Gd=(Vd=t.approval.paymentPlan.cheque)==null?void 0:Vd.items)==null?void 0:Gd.length)>0&&e.jsx("div",{style:{fontSize:12,borderTop:"1px solid var(--color-border)",paddingTop:8},children:t.approval.paymentPlan.cheque.items.map((o,h)=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"4px 0",borderBottom:h<t.approval.paymentPlan.cheque.items.length-1?"1px dashed var(--color-border)":"none"},children:[e.jsxs("span",{className:"text-muted",children:[o.bank," - ",o.chequeNo||o.number]}),e.jsxs("span",{children:[be(o.amount),"  ",e.jsxs("span",{className:"text-muted",children:["(",Mi(o.due),")"]})]})]},h))})]}),(((Qd=t.approval.paymentPlan.afterDelivery)==null?void 0:Qd.amount)>0||t.approval.paymentPlan.afterDelivery>0)&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"10px 12px",background:"var(--color-warning-bg)",borderRadius:6,border:"1px solid var(--color-warning)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{children:""}),e.jsx("span",{style:{fontWeight:500},children:"Teslim Sonras"}),((Jd=t.approval.paymentPlan.afterDelivery)==null?void 0:Jd.note)&&e.jsxs("span",{className:"text-muted",style:{fontSize:11},children:["(",t.approval.paymentPlan.afterDelivery.note,")"]})]}),e.jsxs("span",{style:{fontWeight:600},children:[be(((Xd=t.approval.paymentPlan.afterDelivery)==null?void 0:Xd.amount)||t.approval.paymentPlan.afterDelivery||0)," "]})]})]}),e.jsxs("div",{style:{marginTop:12,padding:12,background:"var(--color-primary-bg)",borderRadius:6,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{style:{fontWeight:600},children:"TOPLAM"}),e.jsxs("span",{style:{fontWeight:700,fontSize:18,color:"var(--color-primary)"},children:[be(t.approval.paymentPlan.total||((Zd=t.offer)==null?void 0:Zd.total)||0)," "]})]})]}),!Ge&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"card subtle-card",style:{padding:16},children:[e.jsx("h4",{style:{margin:"0 0 16px 0",fontSize:14,color:"var(--text-secondary)"},children:" deme Plan"}),e.jsxs("div",{style:{marginBottom:16,padding:12,background:"var(--color-bg-secondary)",borderRadius:8},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:8},children:[e.jsx("span",{style:{fontSize:16},children:""}),e.jsx("span",{style:{fontWeight:600},children:"Nakit"})]}),e.jsxs("div",{className:"grid grid-2",style:{gap:12},children:[e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",style:{fontSize:11},children:"Tutar"}),e.jsx(bt,{placeholder:"0",value:I.payCash,onChange:o=>me(h=>({...h,payCash:o}))})]}),e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsxs("label",{className:"form-label",style:{fontSize:11},children:["deme Tarihi ",e.jsx("span",{className:"text-muted",children:"(bo = bugn)"})]}),e.jsx(Qe,{value:I.payCashDate||"",onChange:o=>me(h=>({...h,payCashDate:o}))})]})]})]}),e.jsxs("div",{style:{marginBottom:16,padding:12,background:"var(--color-bg-secondary)",borderRadius:8},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:8},children:[e.jsx("span",{style:{fontSize:16},children:""}),e.jsx("span",{style:{fontWeight:600},children:"Kredi Kart"})]}),e.jsxs("div",{className:"grid grid-2",style:{gap:12},children:[e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",style:{fontSize:11},children:"Tutar"}),e.jsx(bt,{placeholder:"0",value:I.payCard,onChange:o=>me(h=>({...h,payCard:o}))})]}),e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsxs("label",{className:"form-label",style:{fontSize:11},children:["ekim Tarihi ",e.jsx("span",{className:"text-muted",children:"(bo = bugn)"})]}),e.jsx(Qe,{value:I.payCardDate||"",onChange:o=>me(h=>({...h,payCardDate:o}))})]})]})]}),e.jsxs("div",{style:{marginBottom:16,padding:12,background:"var(--color-warning-bg)",borderRadius:8,border:"1px solid var(--color-warning)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:8},children:[e.jsx("span",{style:{fontSize:16},children:""}),e.jsx("span",{style:{fontWeight:600},children:"Teslim Sonras"}),e.jsx("span",{className:"badge badge-warning",style:{fontSize:10},children:"Montaj bitince hatrlatlacak"})]}),e.jsxs("div",{className:"grid grid-2",style:{gap:12},children:[e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",style:{fontSize:11},children:"Tutar"}),e.jsx(bt,{placeholder:"0",value:I.payAfter,onChange:o=>me(h=>({...h,payAfter:o}))})]}),e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",style:{fontSize:11},children:"Not"}),e.jsx("input",{className:"form-input",placeholder:"Opsiyonel not...",value:I.payAfterNote||"",onChange:o=>me(h=>({...h,payAfterNote:o.target.value}))})]})]})]}),e.jsxs("div",{style:{padding:12,background:"var(--color-bg-secondary)",borderRadius:8},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:8},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{style:{fontSize:16},children:""}),e.jsx("span",{style:{fontWeight:600},children:"ek"})]}),e.jsxs("div",{style:{fontWeight:700,color:"var(--color-primary)"},children:["Toplam: ",be(Nn)," "]})]}),e.jsxs("div",{style:{marginBottom:12,padding:10,background:"white",borderRadius:6,display:"flex",alignItems:"center",gap:12},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8,cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:I.chequesReceived||!1,onChange:o=>me(h=>({...h,chequesReceived:o.target.checked})),style:{width:18,height:18}}),e.jsx("span",{style:{fontWeight:500},children:"ekler teslim alnd"})]}),!I.chequesReceived&&e.jsx("span",{className:"text-muted",style:{fontSize:11},children:"(Alnmadysa sadece adet ve toplam tutar girin)"})]}),!I.chequesReceived&&e.jsxs("div",{className:"grid grid-2",style:{gap:12},children:[e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",style:{fontSize:11},children:"ek Adedi"}),e.jsx("input",{className:"form-input",type:"number",min:"0",placeholder:"0",value:I.chequeCount||"",onChange:o=>me(h=>({...h,chequeCount:o.target.value}))})]}),e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",style:{fontSize:11},children:"Toplam Tutar"}),e.jsx(bt,{placeholder:"0",value:I.chequeTotalAmount||"",onChange:o=>me(h=>({...h,chequeTotalAmount:o}))})]})]})]})]}),I.chequesReceived&&e.jsxs("div",{className:"card subtle-card",style:{padding:16},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:12},children:[e.jsx("h4",{style:{margin:0,fontSize:14,color:"var(--text-secondary)"},children:" ek Detaylar"}),e.jsxs("span",{className:"text-muted",style:{fontSize:12},children:[((eu=I.chequeLines)==null?void 0:eu.length)||0," ek  Ort. vade: ",si," gn"]})]}),e.jsx("div",{style:{padding:12,background:"var(--color-bg-secondary)",borderRadius:8,marginBottom:12},children:e.jsxs("div",{className:"grid grid-3",style:{gap:12},children:[e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",style:{fontSize:11},children:"Tutar *"}),e.jsx(bt,{placeholder:"0",value:I.chequeDraftAmount||"",onChange:o=>me(h=>({...h,chequeDraftAmount:o}))})]}),e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",style:{fontSize:11},children:"Vade Tarihi *"}),e.jsx(Qe,{value:I.chequeDraftDue||"",onChange:o=>me(h=>({...h,chequeDraftDue:o}))})]}),e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",style:{fontSize:11},children:"Banka *"}),e.jsx("input",{className:"form-input",placeholder:"Banka ad",value:I.chequeDraftBank||"",onChange:o=>me(h=>({...h,chequeDraftBank:o.target.value}))})]}),e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",style:{fontSize:11},children:"ube"}),e.jsx("input",{className:"form-input",placeholder:"ube ad (opsiyonel)",value:I.chequeDraftBranch||"",onChange:o=>me(h=>({...h,chequeDraftBranch:o.target.value}))})]}),e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",style:{fontSize:11},children:"ek No *"}),e.jsx("input",{className:"form-input",placeholder:"ek numaras",value:I.chequeDraftNumber||"",onChange:o=>me(h=>({...h,chequeDraftNumber:o.target.value}))})]}),e.jsx("div",{className:"form-group",style:{margin:0,display:"flex",alignItems:"flex-end"},children:e.jsx("button",{type:"button",className:"btn btn-primary",style:{width:"100%"},disabled:!I.chequeDraftAmount||!I.chequeDraftDue||!I.chequeDraftBank||!I.chequeDraftNumber,onClick:()=>{const o=Number(I.chequeDraftAmount||0);o&&me(h=>({...h,chequeLines:[...h.chequeLines,{amount:o,due:h.chequeDraftDue||"",bank:h.chequeDraftBank||"",branch:h.chequeDraftBranch||"",chequeNo:h.chequeDraftNumber||"",id:Date.now()}],chequeDraftAmount:"",chequeDraftDue:"",chequeDraftBank:"",chequeDraftBranch:"",chequeDraftNumber:""}))},children:"+ ek Ekle"})})]})}),(((tu=I.chequeLines)==null?void 0:tu.length)||0)>0&&e.jsxs("div",{style:{marginTop:12},children:[e.jsx("div",{className:"text-muted",style:{fontSize:11,marginBottom:8},children:"EKLENM EKLER"}),e.jsx("div",{className:"table-container",style:{maxHeight:200,overflow:"auto"},children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Tutar"}),e.jsx("th",{children:"Vade"}),e.jsx("th",{children:"Banka"}),e.jsx("th",{children:"ube"}),e.jsx("th",{children:"ek No"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:(I.chequeLines||[]).map((o,h)=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("strong",{children:[be(o.amount)," "]})}),e.jsx("td",{children:Mi(o.due)}),e.jsx("td",{children:o.bank||"-"}),e.jsx("td",{children:o.branch||"-"}),e.jsx("td",{children:o.chequeNo||o.number||"-"}),e.jsx("td",{children:e.jsx("button",{type:"button",className:"btn btn-danger btn-small btn-icon",onClick:()=>me(_=>({..._,chequeLines:_.chequeLines.filter((Y,J)=>J!==h)})),title:"eki Kaldr",children:""})})]},o.id||`${o.chequeNo}-${h}`))})]})})]})]}),e.jsxs("div",{className:"card subtle-card",style:{padding:16},children:[e.jsx("h4",{style:{margin:"0 0 12px 0",fontSize:14,color:"var(--text-secondary)"},children:" zet"}),e.jsxs("div",{className:"grid grid-2",style:{gap:12},children:[e.jsxs("div",{className:"metric-row",style:{background:"var(--bg-tertiary)",padding:"12px",borderRadius:8},children:[e.jsx("div",{children:e.jsx("div",{className:"metric-label",children:"Teklif Toplam"})}),e.jsxs("strong",{style:{fontSize:18},children:[be($t)," "]})]}),e.jsxs("div",{className:"metric-row",style:{background:Pr?"var(--color-success-bg)":"var(--color-danger-bg)",padding:"12px",borderRadius:8},children:[e.jsx("div",{children:e.jsx("div",{className:"metric-label",children:"deme Toplam"})}),e.jsxs("strong",{style:{fontSize:18,color:Pr?"var(--color-success)":"var(--color-danger)"},children:[be(Lr)," "]})]})]}),!Pr&&e.jsxs("div",{className:"error-text",style:{marginTop:8,padding:8,background:"var(--color-danger-bg)",borderRadius:4},children:[" Toplam deme, teklif tutaryla elemiyor. Fark: ",be(Math.abs($t-Lr))," "]}),si>90&&e.jsxs("div",{style:{marginTop:8,padding:8,background:"#fef3cd",borderRadius:4,color:"#856404"},children:[" Ortalama vade ",si," gn. Uzun vade iin ek onay gerekebilir."]})]}),!Ge&&e.jsxs("div",{className:"card",style:{padding:16,background:"var(--color-primary-bg)",border:"1px solid var(--color-primary)"},children:[e.jsxs("h4",{style:{margin:"0 0 12px 0",fontSize:14,display:"flex",alignItems:"center",gap:8},children:[" Tahmini Montaj Tarihi",e.jsx("span",{className:"badge badge-primary",style:{fontSize:10,fontWeight:400},children:"Mteriye sylenen"})]}),e.jsxs("div",{className:"grid grid-2",style:{gap:12},children:[e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",style:{fontSize:11},children:"Montaj Termini *"}),e.jsx(Qe,{value:I.estimatedAssemblyDate||"",onChange:o=>me(h=>({...h,estimatedAssemblyDate:o}))})]}),e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",style:{fontSize:11},children:"Not (opsiyonel)"}),e.jsx("input",{className:"form-input",placeholder:"rn: 2. kat hazr olunca...",value:I.estimatedAssemblyNote||"",onChange:o=>me(h=>({...h,estimatedAssemblyNote:o.target.value}))})]})]}),e.jsx("div",{className:"text-muted",style:{fontSize:12,marginTop:8},children:"Bu tarih tm aamalarda grnr ve montaj planlamasnda referans olarak kullanlr."})]}),e.jsxs("div",{className:"card subtle-card",style:{padding:16},children:[e.jsx("h4",{style:{margin:"0 0 12px 0",fontSize:14,color:"var(--text-secondary)"},children:" Szleme Dosyas"}),e.jsxs("div",{className:"file-upload-zone",children:[e.jsx("input",{type:"file",id:"contract-file",accept:".pdf,.jpg,.jpeg,.png",style:{display:"none"},onChange:async o=>{var _;const h=(_=o.target.files)==null?void 0:_[0];h&&(await bn(h,"sozlesme","mzal Szleme"),o.target.value="")}}),e.jsx("label",{htmlFor:"contract-file",className:"btn btn-secondary",style:{cursor:"pointer"},children:" Szleme Ykle"}),at.filter(o=>o.type==="sozlesme").length>0&&e.jsxs("span",{className:"badge badge-success",style:{marginLeft:8},children:[" ",at.filter(o=>o.type==="sozlesme").length," dosya yklendi"]})]}),at.filter(o=>o.type==="sozlesme").map(o=>e.jsxs("div",{className:"metric-row",style:{marginTop:8,fontSize:13},children:[e.jsxs("a",{href:ys(o.id),target:"_blank",rel:"noopener noreferrer",className:"text-primary",children:[" ",o.originalName]}),e.jsx("button",{type:"button",className:"btn btn-danger btn-small btn-icon",onClick:()=>ei(o.id),title:"Belgeyi Sil",children:""})]},o.id)),e.jsx("div",{className:"text-muted",style:{fontSize:12,marginTop:8},children:"Mteriye imzalatlan szlemeyi ykleyin"})]}),e.jsx("div",{className:"btn-group",style:{gap:12,marginTop:8},children:e.jsx("button",{className:"btn btn-success",type:"button",disabled:i||!Pr,onClick:()=>st(async()=>{var _,Y;if(!Pr)throw new Error("deme toplam teklif tutaryla elemiyor.");if(I.chequesReceived&&(I.chequeLines||[]).reduce((te,ge)=>te+Number(ge.amount||0),0)!==Nn)throw new Error("ek paralar toplam hatal.");const o={paymentPlan:{cash:{amount:Number(I.payCash||0),date:I.payCashDate||new Date().toISOString().split("T")[0],status:"pending"},card:{amount:Number(I.payCard||0),date:I.payCardDate||new Date().toISOString().split("T")[0],status:"pending"},cheque:{total:Nn,received:I.chequesReceived||!1,count:I.chequesReceived?((_=I.chequeLines)==null?void 0:_.length)||0:Number(I.chequeCount||0),items:I.chequesReceived?I.chequeLines||[]:[],status:"pending"},afterDelivery:{amount:Number(I.payAfter||0),note:I.payAfterNote||"",status:"pending"},total:Lr},contractUrl:((Y=at.find(J=>J.type==="sozlesme"))==null?void 0:Y.id)||null,stockNeeds:[],estimatedAssembly:I.estimatedAssemblyDate?{date:I.estimatedAssemblyDate,note:I.estimatedAssemblyNote||"",setAt:new Date().toISOString()}:null},h=await Pb(t.id,o);return An(t.id,{approval:{paymentPlan:o.paymentPlan},offer:{...t.offer,total:$t},estimatedAssembly:o.estimatedAssembly}),h}),children:" Anlamay Tamamla - Stok Kontrolne Ge"})}),!Pr&&e.jsxs("div",{className:"text-muted",style:{fontSize:12,color:"var(--color-danger)"},children:[" deme toplam teklif tutaryla elemiyor. Fark: ",be(Math.abs($t-Lr))," "]})]})]})]}),Qt("stock")&&e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header",style:{alignItems:"center"},children:[e.jsx("h3",{className:"card-title",children:"Stok / Rezervasyon"}),t.status==="SONRA_URETILECEK"?e.jsx("div",{className:"badge badge-info",children:" Sonra retilecek"}):Ge?e.jsx("div",{className:"badge badge-success",children:(su=t.stock)!=null&&su.ready?" retime Alnd":" Rezerve Edildi"}):e.jsxs("div",{className:"badge badge-secondary",children:["Mevcut: ",ed.total,"  Kritik: ",ed.critical]})]}),e.jsx("div",{className:"card-body",style:{display:"grid",gap:12},children:t.status==="SONRA_URETILECEK"?e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{background:"linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%)",padding:16,borderRadius:12,border:"1px solid #3b82f6",marginBottom:8},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[e.jsx("span",{style:{fontSize:28},children:""}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:700,color:"#1e40af",marginBottom:4},children:"Bu i sonra retilmek zere bekletiliyor"}),e.jsx("div",{style:{fontSize:13,color:"#1e40af"},children:'Stok rezerve edilmi durumda. Hazr olduunda "retime Al" butonuna tklayn.'}),((ru=t.stock)==null?void 0:ru.estimatedDate)&&e.jsxs("div",{style:{fontSize:12,color:"#3b82f6",marginTop:4},children:[" Tahmini Tarih: ",e.jsx("strong",{children:new Date(t.stock.estimatedDate).toLocaleDateString("tr-TR")})]})]})]})}),((nu=t.stock)==null?void 0:nu.purchaseNotes)&&e.jsxs("div",{className:"text-muted",style:{fontStyle:"italic",marginBottom:8},children:[" ",t.stock.purchaseNotes]}),e.jsxs("div",{className:"card subtle-card",children:[e.jsxs("div",{className:"card-header",style:{padding:"12px 16px"},children:[e.jsx("h4",{className:"card-title",style:{fontSize:14},children:"Rezerve Edilen rnler"}),e.jsxs("span",{className:"badge badge-info",children:[((lu=(au=t.stock)==null?void 0:au.items)==null?void 0:lu.length)||0," kalem"]})]}),(((ou=(iu=t.stock)==null?void 0:iu.items)==null?void 0:ou.length)||0)===0?e.jsx("div",{className:"text-muted",style:{padding:16},children:"Bu i iin stok bilgisi kaydedilmemi."}):e.jsx("div",{className:"table-container",children:e.jsxs("table",{className:"table",style:{fontSize:13},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"rn"}),e.jsx("th",{children:"rn Kodu"}),e.jsx("th",{children:"Renk"}),e.jsx("th",{children:"Rezerve"}),e.jsx("th",{children:"Gncel Stok"}),e.jsx("th",{children:"Durum"})]})}),e.jsx("tbody",{children:t.stock.items.map((o,h)=>{const _=b.find(xe=>xe.id===o.id),Y=(_==null?void 0:_.available)||0,J=(_==null?void 0:_.onHand)||0,te=J>=o.qty,ge=Y<o.qty&&J>=o.qty;return e.jsxs("tr",{style:{background:te?ge?"rgba(251, 191, 36, 0.1)":"transparent":"rgba(239, 68, 68, 0.1)"},children:[e.jsx("td",{style:{fontWeight:600},children:o.name}),e.jsx("td",{children:e.jsx("code",{style:{fontSize:11},children:o.productCode||"-"})}),e.jsx("td",{children:e.jsx("span",{className:"badge badge-secondary",style:{fontSize:10},children:o.colorCode||"-"})}),e.jsxs("td",{children:[e.jsx("strong",{children:o.qty})," ",o.unit||"adet"]}),e.jsx("td",{children:e.jsxs("span",{style:{color:te?"var(--color-success)":"var(--color-danger)"},children:[Y,"/",J]})}),e.jsx("td",{children:te?ge?e.jsx("span",{style:{color:"var(--color-warning)",fontSize:12},children:" Rezerve stoktan kullanlacak"}):e.jsx("span",{style:{color:"var(--color-success)",fontSize:12},children:" Hazr"}):e.jsxs("span",{style:{color:"var(--color-danger)",fontSize:12},children:[" Stok yetersiz (",o.qty-J," eksik)"]})})]},h)})})]})})]}),(()=>{var J;const o=(((J=t.stock)==null?void 0:J.items)||[]).map(te=>{const ge=b.find(_e=>_e.id===te.id),xe=(ge==null?void 0:ge.onHand)||0,ze=(ge==null?void 0:ge.available)||0;return{...te,currentOnHand:xe,currentAvailable:ze,hasEnough:xe>=te.qty,usesReserved:ze<te.qty&&xe>=te.qty,shortage:Math.max(0,te.qty-xe)}}),h=o.filter(te=>!te.hasEnough),_=o.filter(te=>te.usesReserved),Y=h.length===0;return e.jsxs(e.Fragment,{children:[h.length>0&&e.jsxs("div",{style:{background:"rgba(239, 68, 68, 0.1)",border:"1px solid var(--color-danger)",borderRadius:8,padding:12},children:[e.jsx("div",{style:{fontWeight:600,color:"var(--color-danger)",marginBottom:8},children:" Stok Yetersiz - retime Alnamaz"}),e.jsx("div",{style:{fontSize:12,color:"var(--color-text-secondary)"},children:"Bu i iin planlanan stok, baka ilerde kullanlm veya eksik kalm:"}),e.jsx("ul",{style:{margin:"8px 0 0 0",paddingLeft:20,fontSize:12},children:h.map((te,ge)=>e.jsxs("li",{children:[e.jsx("strong",{children:te.name}),": ",te.qty," gerekli, ",te.currentOnHand," mevcut (",te.shortage," eksik)"]},ge))})]}),_.length>0&&h.length===0&&e.jsxs("div",{style:{background:"rgba(251, 191, 36, 0.1)",border:"1px solid var(--color-warning)",borderRadius:8,padding:12},children:[e.jsx("div",{style:{fontWeight:600,color:"var(--color-warning)",marginBottom:4},children:" Dikkat: Baka ilere ait rezerve stok kullanlacak"}),e.jsx("div",{style:{fontSize:12},children:"Bu ilem devam ederse, aadaki rnler iin baka ilerin stou etkilenecektir."})]}),e.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginTop:8},children:e.jsx("button",{className:"btn btn-success",type:"button",style:{padding:"12px 24px"},disabled:i||!Y,onClick:()=>st(async()=>{var _e,Le,ct,Ve;if(_.length>0&&!window.confirm(`Baz rnler iin baka ilere ait rezerve stok kullanlacak.
Bu, dier ilerin stok ihtiyacn etkileyecektir.

Devam etmek istiyor musunuz?`))return;const te={jobId:t.id,items:(((_e=t.stock)==null?void 0:_e.items)||[]).map(rt=>({itemId:rt.id,qty:rt.qty})),reserveType:"consume",note:"retime alnd - Stoktan dld"},ge=await Ai(te),xe={ready:!0,purchaseNotes:((Le=t.stock)==null?void 0:Le.purchaseNotes)||"retime alnd",items:((ct=t.stock)==null?void 0:ct.items)||[]},ze=await _a(t.id,xe);return await Rr("stock_consumed","retime alnd - Stoktan dld",{consumed:(Ve=t.stock)==null?void 0:Ve.items}),ge.results&&L(rt=>rt.map(Ce=>{const Ae=ge.results.find(He=>He.itemId===Ce.id);return Ae?{...Ce,onHand:Ae.newOnHand,reserved:Ae.newReserved,available:Ae.available}:Ce})),ze}),children:i?" leniyor...":" retime Al"})})]})})()]}):Ge?e.jsxs(e.Fragment,{children:[((cu=t.stock)==null?void 0:cu.purchaseNotes)&&e.jsxs("div",{className:"text-muted",style:{fontStyle:"italic",marginBottom:8},children:[" ",t.stock.purchaseNotes]}),e.jsxs("div",{className:"card subtle-card",children:[e.jsxs("div",{className:"card-header",style:{padding:"12px 16px"},children:[e.jsx("h4",{className:"card-title",style:{fontSize:14},children:"Kullanlan Stok Kalemleri"}),e.jsxs("span",{className:"badge badge-secondary",children:[((uu=(du=t.stock)==null?void 0:du.items)==null?void 0:uu.length)||0," kalem"]})]}),(((pu=(mu=t.stock)==null?void 0:mu.items)==null?void 0:pu.length)||0)===0?e.jsx("div",{className:"text-muted",style:{padding:16},children:"Bu i iin stok bilgisi kaydedilmemi."}):e.jsx("div",{className:"table-container",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"rn"}),e.jsx("th",{children:"rn Kodu"}),e.jsx("th",{children:"Renk Kodu"}),e.jsx("th",{children:"Miktar"}),e.jsx("th",{children:"Birim"})]})}),e.jsx("tbody",{children:t.stock.items.map((o,h)=>e.jsxs("tr",{children:[e.jsx("td",{style:{fontWeight:600},children:o.name}),e.jsx("td",{children:e.jsx("code",{children:o.productCode||"-"})}),e.jsx("td",{children:o.colorCode||"-"}),e.jsx("td",{children:e.jsx("strong",{children:o.qty})}),e.jsx("td",{children:o.unit||"adet"})]},h))})]})})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",gap:12},children:[e.jsx("div",{className:"text-muted",children:" iin birden fazla kalem rezerve edebilirsiniz."}),e.jsx("button",{className:"btn btn-primary",type:"button",onClick:()=>Q(!0),children:" Stoktan Kalem Ekle"})]}),e.jsxs("div",{className:"card subtle-card",children:[e.jsxs("div",{className:"card-header",style:{padding:"12px 16px"},children:[e.jsx("h4",{className:"card-title",style:{fontSize:14},children:"Seili Kalemler"}),e.jsxs("span",{className:"badge badge-secondary",children:[A.length," kalem"]})]}),A.length===0?e.jsx("div",{className:"text-muted",style:{padding:16},children:'Henz ekleme yapmadnz. "Stoktan Ekle" butonuna tklayn.'}):e.jsx("div",{className:"table-container",style:{maxHeight:200,overflow:"auto"},children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Kalem"}),e.jsx("th",{children:"Kod"}),e.jsx("th",{children:"Renk"}),e.jsx("th",{children:"Mevcut"}),e.jsx("th",{children:"Miktar"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:A.map(o=>e.jsxs("tr",{children:[e.jsx("td",{style:{fontWeight:600},children:o.name}),e.jsx("td",{className:"text-muted",children:o.productCode||o.sku}),e.jsx("td",{children:e.jsx("span",{className:"badge badge-secondary",children:o.colorCode||o.color||"-"})}),e.jsxs("td",{children:[o.available," ",o.unit]}),e.jsx("td",{style:{minWidth:100},children:e.jsx("input",{type:"number",className:"form-input",min:"1",value:o.qty,onChange:h=>{const _=Number(h.target.value)||1;ue(Y=>Y.map(J=>J.id===o.id?{...J,qty:_}:J))},style:{width:80}})}),e.jsx("td",{children:e.jsx("button",{className:"btn btn-danger btn-small btn-icon",type:"button",onClick:()=>rd(o.id),title:"Satr Kaldr",children:""})})]},o.id))})]})})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Rezervasyon Notu"}),e.jsx("textarea",{className:"form-textarea",placeholder:"Satnalma / rezervasyon notu",value:I.stockNote,onChange:o=>me(h=>({...h,stockNote:o.target.value})),rows:3})]}),!Br.required&&e.jsxs("div",{className:"card",style:{border:"2px solid var(--color-info)",background:"rgba(59, 130, 246, 0.05)",padding:16,marginBottom:12},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:8},children:[e.jsx("span",{style:{fontSize:20},children:""}),e.jsx("strong",{style:{color:"var(--color-info)"},children:"D retim i"})]}),e.jsxs("div",{className:"text-muted",style:{fontSize:13},children:[Br.reason,". Stok eklemeden dorudan retime geebilirsiniz."]})]}),A.some(o=>o.qty>o.available)&&e.jsxs("div",{className:"card",style:{border:"2px solid var(--color-danger)",background:"var(--color-danger-bg)",padding:16},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:8},children:[e.jsx("span",{style:{fontSize:20},children:""}),e.jsx("strong",{style:{color:"var(--color-danger)"},children:"Yetersiz Stok"})]}),e.jsx("div",{className:"text-muted",style:{marginBottom:8},children:"Aadaki kalemler iin stok yetersiz. Sipari oluturmanz gerekiyor:"}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:4},children:A.filter(o=>o.qty>o.available).map(o=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",padding:"6px 8px",background:"white",borderRadius:4,fontSize:13},children:[e.jsxs("span",{children:[e.jsx("strong",{children:o.name})," (",o.productCode||o.sku,")"]}),e.jsxs("span",{children:["Talep: ",e.jsx("strong",{children:o.qty}),"  Mevcut: ",e.jsx("strong",{style:{color:"var(--color-danger)"},children:o.available})," ",e.jsxs("span",{style:{color:"var(--color-danger)",fontWeight:600},children:[" Eksik: ",o.qty-o.available]})]})]},o.id))}),e.jsx("button",{className:"btn btn-warning",type:"button",style:{marginTop:12},onClick:()=>{const o=A.filter(h=>h.qty>h.available);alert(`${o.length} kalem iin sipari oluturulacak. (Satnalma modlne ynlendirilecek)`)},children:" Eksik rnler in Sipari Olutur"})]}),e.jsxs("div",{style:{display:"flex",gap:12,marginTop:8,flexWrap:"wrap"},children:[e.jsx("button",{className:"btn btn-secondary",type:"button",style:{flex:1,padding:"14px 20px",minWidth:150},disabled:i,onClick:()=>{D(!0),g(""),M("")},children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:4},children:[e.jsx("span",{style:{fontSize:20},children:""}),e.jsx("span",{style:{fontWeight:600},children:"Sonra ret"}),e.jsx("span",{style:{fontSize:11,opacity:.8},children:Br.required?"Stok rezerve edilir":"D retim"})]})}),e.jsx("button",{className:"btn btn-success",type:"button",style:{flex:1,padding:"14px 20px",minWidth:150},disabled:i||A.length>0&&A.some(o=>o.qty>(o.onHand||o.available)),onClick:()=>st(async()=>{if(A.length===0){const te={ready:!0,purchaseNotes:I.stockNote||(Br.required?"retime alnd":"D retim - stoksuz devam"),items:[],skipStock:!Br.required};return await _a(t.id,te)}if(A.some(te=>te.qty>te.available&&te.qty<=(te.onHand||0))&&!window.confirm(`Baz rnler iin rezerve edilmi stok kullanlacak.
Bu, baka ilerin stok ihtiyacn etkileyebilir.

Devam etmek istiyor musunuz?`))return;const h={jobId:t.id,items:A.map(te=>({itemId:te.id,qty:te.qty})),reserveType:"consume",note:I.stockNote||"retime alnd - Stoktan dld"},_=await Ai(h),Y={ready:!0,purchaseNotes:I.stockNote||"retime alnd - Stoktan dld",items:A.map(te=>({id:te.id,name:te.name,productCode:te.productCode,colorCode:te.colorCode,qty:te.qty,unit:te.unit}))},J=await _a(t.id,Y);return An(t.id,{pendingPO:[]}),H([]),await Rr("stock_consumed","retime alnd - Stoktan dld",{consumed:A}),_.results&&L(te=>te.map(ge=>{const xe=_.results.find(ze=>ze.itemId===ge.id);return xe?{...ge,onHand:xe.newOnHand,reserved:xe.newReserved,available:xe.available}:ge})),ue([]),J}),children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",gap:4},children:[e.jsx("span",{style:{fontSize:20},children:""}),e.jsx("span",{style:{fontWeight:600},children:"Hemen retime Al"}),e.jsx("span",{style:{fontSize:11,opacity:.8},children:A.length>0?"Stoktan dlr":Br.required?"retime ge":"D retim"})]})})]}),A.some(o=>o.qty>(o.onHand||o.available))&&e.jsx("div",{className:"text-muted",style:{fontSize:12,marginTop:8,textAlign:"center"},children:" Yetersiz fiziksel stok olduu iin retime alnamaz. nce sipari oluturun."}),A.some(o=>o.qty>o.available&&o.qty<=(o.onHand||0))&&e.jsx("div",{style:{fontSize:12,marginTop:8,textAlign:"center",color:"var(--color-warning)"},children:" Baz rnler iin baka ilere ait rezerve stok kullanlacak!"})]})})]}),e.jsx(Be,{open:X,title:" Stoktan Kalem Ekle",size:"xxlarge",onClose:()=>{Q(!1),W(null),q(1),E(""),p(""),v(""),ae(!1),ne(null)},actions:e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{flex:1,textAlign:"left",fontSize:13,color:"var(--text-muted)"},children:A.length>0&&` ${A.length} kalem seildi`}),e.jsx("button",{className:"btn btn-secondary",type:"button",onClick:()=>Q(!1),children:"ptal"}),e.jsxs("button",{className:"btn btn-success",type:"button",onClick:()=>{Q(!1),E(""),p(""),v("")},disabled:A.length===0,children:[" Seimi Tamamla (",A.length," kalem)"]})]}),children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16,minHeight:550},children:[e.jsxs("div",{style:{background:"linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%)",padding:16,borderRadius:12,border:"1px solid var(--color-border)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:12},children:[e.jsx("span",{style:{fontSize:18},children:""}),e.jsx("span",{style:{fontWeight:600},children:"Hzl rn Ara"}),e.jsx("span",{className:"text-muted",style:{fontSize:12},children:"(rne tklayarak sepete ekle)"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr auto",gap:12,alignItems:"end"},children:[e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",style:{fontSize:11,marginBottom:4},children:"rn Ad / Tedariki"}),e.jsx("input",{id:"stock-search-modal",className:"form-input",placeholder:"rn ara...",value:k,onChange:o=>E(o.target.value),autoFocus:!0,style:{fontSize:14,padding:"10px 14px"}})]}),e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",style:{fontSize:11,marginBottom:4},children:"rn Kodu"}),e.jsx("input",{className:"form-input",placeholder:"Kod...",value:y,onChange:o=>p(o.target.value),style:{fontSize:14,padding:"10px 14px"}})]}),e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",style:{fontSize:11,marginBottom:4},children:"Renk Kodu"}),e.jsx("input",{className:"form-input",placeholder:"Renk...",value:m,onChange:o=>v(o.target.value),style:{fontSize:14,padding:"10px 14px"}})]}),(k||y||m)&&e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>{E(""),p(""),v("")},style:{height:44},children:"Temizle"})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16,flex:1},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:8},children:[e.jsxs("h4",{style:{margin:0,fontSize:14,display:"flex",alignItems:"center",gap:8},children:[" Seilen rnler",A.length>0&&e.jsx("span",{className:"badge badge-success",children:A.length})]}),A.length>0&&e.jsx("button",{type:"button",className:"btn btn-danger btn-small",onClick:()=>ue([]),children:"Tmn Temizle"})]}),e.jsx("div",{style:{flex:1,border:"2px dashed var(--color-border)",borderRadius:12,overflow:"hidden",background:A.length===0?"var(--color-bg-secondary)":"var(--color-bg)"},children:A.length===0?e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%",padding:40,color:"var(--color-text-light)"},children:[e.jsx("div",{style:{fontSize:48,marginBottom:12},children:""}),e.jsx("div",{style:{fontWeight:600,marginBottom:8},children:"Henz rn seilmedi"}),e.jsxs("div",{style:{fontSize:13,textAlign:"center"},children:["Sa taraftaki listeden rnlere tklayarak",e.jsx("br",{}),"sepete ekleyebilirsiniz"]})]}):e.jsx("div",{style:{maxHeight:380,overflow:"auto"},children:e.jsxs("table",{className:"table",style:{fontSize:13},children:[e.jsx("thead",{style:{position:"sticky",top:0,background:"var(--color-bg)",zIndex:1},children:e.jsxs("tr",{children:[e.jsx("th",{children:"rn"}),e.jsx("th",{style:{width:"15%"},children:"Kod"}),e.jsx("th",{style:{width:"10%"},children:"Renk"}),e.jsx("th",{style:{width:"15%"},children:"Miktar"}),e.jsx("th",{style:{width:"10%"},children:"Stok"}),e.jsx("th",{style:{width:"8%"}})]})}),e.jsx("tbody",{children:A.map(o=>{const h=o.qty>(o.available||0),_=o.qty>(o.available||0)&&o.qty<=(o.onHand||0);return e.jsxs("tr",{style:{background:h?_?"rgba(251, 191, 36, 0.1)":"rgba(239, 68, 68, 0.1)":"transparent"},children:[e.jsxs("td",{children:[e.jsx("div",{style:{fontWeight:600},children:o.name}),o.colorName&&e.jsx("div",{className:"text-muted",style:{fontSize:11},children:o.colorName})]}),e.jsx("td",{children:e.jsx("code",{style:{fontSize:11},children:o.productCode})}),e.jsx("td",{children:e.jsx("span",{className:"badge badge-secondary",style:{fontSize:11},children:o.colorCode||"-"})}),e.jsxs("td",{children:[e.jsx("input",{type:"number",className:"form-input",style:{width:70,padding:"4px 8px",fontSize:13,textAlign:"center",border:h?"2px solid var(--color-warning)":void 0},value:o.qty,min:"1",max:o.onHand||999,onChange:Y=>{const J=Number(Y.target.value);ue(te=>te.map(ge=>ge.id===o.id?{...ge,qty:J}:ge))}}),e.jsx("span",{className:"text-muted",style:{fontSize:11,marginLeft:4},children:o.unit})]}),e.jsx("td",{children:e.jsxs("span",{style:{fontSize:12,color:(o.available||0)>=o.qty?"var(--color-success)":"var(--color-warning)"},children:[o.available,"/",o.onHand]})}),e.jsx("td",{children:e.jsx("button",{type:"button",className:"btn btn-danger btn-small btn-icon",onClick:()=>rd(o.id),style:{padding:"4px 8px"},title:"Satr Kaldr",children:""})})]},o.id)})})]})})}),A.some(o=>o.qty>(o.available||0)&&o.qty<=(o.onHand||0))&&e.jsx("div",{style:{marginTop:8,padding:"8px 12px",background:"rgba(251, 191, 36, 0.15)",border:"1px solid var(--color-warning)",borderRadius:8,fontSize:12,color:"var(--color-warning)"},children:" Baz rnler iin baka ilere ait rezerve stok kullanlacak!"}),A.some(o=>o.qty>(o.onHand||0))&&e.jsx("div",{style:{marginTop:8,padding:"8px 12px",background:"rgba(239, 68, 68, 0.15)",border:"1px solid var(--color-danger)",borderRadius:8,fontSize:12,color:"var(--color-danger)"},children:" Baz rnler iin yeterli stok yok! Ltfen miktarlar dzeltin."})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:8},children:[e.jsx("h4",{style:{margin:0,fontSize:14},children:" Stok Listesi"}),e.jsxs("span",{className:"text-muted",style:{fontSize:12},children:[ti.length," rn"]})]}),u?e.jsx("div",{style:{flex:1,display:"flex",alignItems:"center",justifyContent:"center"},children:e.jsx(ft,{size:"small",text:"Stok listesi ykleniyor..."})}):N?e.jsxs("div",{className:"card error-card",children:[e.jsx("div",{className:"error-title",children:"Stok alnamad"}),e.jsx("div",{className:"error-message",children:N})]}):e.jsx("div",{style:{flex:1,border:"1px solid var(--color-border)",borderRadius:12,overflow:"hidden"},children:e.jsx("div",{style:{maxHeight:380,overflow:"auto"},children:e.jsxs("table",{className:"table",style:{fontSize:12},children:[e.jsx("thead",{style:{position:"sticky",top:0,background:"var(--color-bg)",zIndex:1},children:e.jsxs("tr",{children:[e.jsx("th",{children:"rn"}),e.jsx("th",{style:{width:"12%"},children:"Kod"}),e.jsx("th",{style:{width:"8%"},children:"Renk"}),e.jsx("th",{style:{width:"15%"},children:"Stok"}),e.jsx("th",{style:{width:"10%"}})]})}),e.jsx("tbody",{children:ti.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:5,children:e.jsxs("div",{style:{padding:30,textAlign:"center"},children:[e.jsx("div",{style:{fontSize:24,marginBottom:8},children:""}),e.jsx("div",{style:{fontWeight:600},children:"rn Bulunamad"})]})})}):ti.slice(0,100).map(o=>{const h=A.some(J=>J.id===o.id),_=(o.reserved||0)>0,Y=(o.onHand||0)>0&&!h;return e.jsxs("tr",{style:{background:h?"var(--color-success-bg, rgba(34, 197, 94, 0.1))":_?"rgba(251, 191, 36, 0.05)":"transparent",cursor:Y?"pointer":"not-allowed",opacity:Y?1:.6},onClick:()=>Y&&td(o),children:[e.jsxs("td",{children:[e.jsx("div",{style:{fontWeight:600,fontSize:12},children:o.name}),e.jsx("div",{className:"text-muted",style:{fontSize:10},children:o.supplierName||o.supplier||"-"})]}),e.jsx("td",{children:e.jsx("code",{style:{fontSize:10,padding:"2px 4px"},children:o.productCode||o.sku})}),e.jsx("td",{children:e.jsx("span",{className:"badge badge-secondary",style:{fontSize:10},children:o.colorCode||o.color||"-"})}),e.jsxs("td",{children:[e.jsxs("div",{style:{fontSize:12},children:[e.jsx("strong",{style:{color:(o.available||0)>0?"var(--color-success)":(o.onHand||0)>0?"var(--color-warning)":"var(--color-danger)"},children:o.available||0}),e.jsxs("span",{className:"text-muted",children:["/",o.onHand||0]})]}),_&&e.jsxs("div",{style:{fontSize:10,color:"var(--color-warning)"},children:[" ",o.reserved," res."]})]}),e.jsx("td",{children:h?e.jsx("span",{style:{color:"var(--color-success)",fontSize:16},children:""}):Y?e.jsx("button",{type:"button",className:"btn btn-primary btn-small",style:{padding:"4px 8px",fontSize:11},onClick:J=>{J.stopPropagation(),td(o)},children:"+ Ekle"}):e.jsx("span",{className:"text-muted",style:{fontSize:10},children:(o.onHand||0)===0?"Stok yok":"Eklendi"})})]},o.id)})})]})})})]})]})]})}),e.jsx(Be,{open:Z,title:"Miktar Girin",size:"small",onClose:()=>{ae(!1),ne(null),pe(1)},actions:e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-secondary",type:"button",onClick:()=>{ae(!1),ne(null)},children:"ptal"}),e.jsx("button",{className:"btn btn-success",type:"button",onClick:sd,disabled:!$||U<=0||U>(($==null?void 0:$.onHand)||0),children:" Sepete Ekle"})]}),children:$&&e.jsxs("div",{children:[e.jsxs("div",{style:{background:"var(--color-bg-secondary)",padding:16,borderRadius:8,marginBottom:16},children:[e.jsx("div",{style:{fontWeight:700,fontSize:16,marginBottom:8},children:$.name}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:8},children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-muted",style:{fontSize:11},children:"Kod: "}),e.jsx("code",{children:$.productCode||$.sku})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted",style:{fontSize:11},children:"Renk: "}),e.jsx("span",{className:"badge badge-secondary",children:$.colorCode||"-"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted",style:{fontSize:11},children:"Kullanlabilir: "}),e.jsx("strong",{style:{color:"var(--color-success)"},children:$.available||0})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-muted",style:{fontSize:11},children:"Fiziksel: "}),e.jsx("strong",{children:$.onHand||0})]})]})]}),(($==null?void 0:$.reserved)||0)>0&&e.jsxs("div",{style:{background:"rgba(251, 191, 36, 0.15)",border:"1px solid var(--color-warning)",borderRadius:8,padding:12,marginBottom:16,fontSize:12},children:[e.jsx("strong",{style:{color:"var(--color-warning)"},children:" Bu stok rezerve edilmi!"}),e.jsxs("div",{className:"text-muted",children:["Baka i iin ",$.reserved," adet rezerve. Yine de kullanabilirsiniz."]})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{className:"form-label",children:["Miktar (",$.unit||"adet",")"]}),e.jsx("input",{type:"number",className:"form-input",value:U,onChange:o=>pe(Number(o.target.value)),onKeyDown:o=>{o.key==="Enter"&&U>0&&U<=(($==null?void 0:$.onHand)||0)&&(o.preventDefault(),sd())},min:"1",max:($==null?void 0:$.onHand)||999,autoFocus:!0,style:{fontSize:24,padding:"16px",textAlign:"center",fontWeight:700}}),U>(($==null?void 0:$.available)||0)&&U<=(($==null?void 0:$.onHand)||0)&&e.jsxs("div",{style:{color:"var(--color-warning)",fontSize:12,marginTop:8},children:[" Rezerve stoktan kullanlacak! (",U-(($==null?void 0:$.available)||0)," adet)"]}),U>(($==null?void 0:$.onHand)||0)&&e.jsxs("div",{style:{color:"var(--color-danger)",fontSize:12,marginTop:8},children:[" Stok yetersiz! Maksimum: ",($==null?void 0:$.onHand)||0]}),e.jsx("div",{className:"text-muted",style:{fontSize:11,marginTop:8,textAlign:"center"},children:" Enter tuu ile hzlca ekleyebilirsiniz"})]})]})}),e.jsx(Be,{open:V,title:" Sonra retilecek - zet",size:"medium",onClose:()=>D(!1),actions:e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-secondary",type:"button",onClick:()=>D(!1),children:"ptal"}),e.jsx("button",{className:"btn btn-primary",type:"button",disabled:i||!S,onClick:()=>st(async()=>{const o={jobId:t.id,items:A.map(te=>({itemId:te.id,qty:te.qty})),reserveType:"reserve",note:x||"Sonra retilecek - Rezerve edildi"},h=await Ai(o),_={ready:!1,purchaseNotes:x||"Sonra retilecek - Rezerve edildi",estimatedDate:S,items:A.map(te=>({id:te.id,name:te.name,productCode:te.productCode,colorCode:te.colorCode,qty:te.qty,unit:te.unit,available:te.available,onHand:te.onHand}))},Y=await _a(t.id,_),J=A.filter(te=>te.qty>te.available).map(te=>({...te,missing:te.qty-te.available}));if(J.length>0){const te=d0(t.id,J);An(t.id,{pendingPO:J,estimatedDate:S}),H(J),await Rr("stock_reserved","Stok rezerve edildi - Sonra retilecek",{reserved:A,pending:J,estimatedDate:S,poId:te==null?void 0:te.id})}else An(t.id,{pendingPO:[],estimatedDate:S}),H([]),await Rr("stock_reserved","Stok rezerve edildi",{reserved:A,estimatedDate:S});return h.results&&L(te=>te.map(ge=>{const xe=h.results.find(ze=>ze.itemId===ge.id);return xe?{...ge,onHand:xe.newOnHand,reserved:xe.newReserved,available:xe.available}:ge})),ue([]),D(!1),Y}),children:i?" leniyor...":" Rezerve Et ve Kaydet"}),!S&&e.jsx("div",{style:{color:"var(--color-danger)",fontSize:12,marginTop:4},children:" Tahmini hazr olma tarihi seiniz"})]}),children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:20},children:[e.jsxs("div",{style:{background:"linear-gradient(135deg, #fef3c7 0%, #fde68a 100%)",padding:16,borderRadius:12,border:"1px solid #f59e0b"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:8},children:[e.jsx("span",{style:{fontSize:20},children:""}),e.jsx("span",{style:{fontWeight:700},children:"Sonra retilecek"})]}),e.jsx("div",{style:{fontSize:13,color:"#92400e"},children:'Bu i iin stok rezerve edilecek ve sonra retilmek zere bekletilecek.  listesinde "Sonra retilecek" durumunda grnecektir.'})]}),e.jsxs("div",{children:[e.jsxs("h4",{style:{margin:"0 0 12px 0",fontSize:14},children:[" Seilen rnler (",A.length," kalem)"]}),e.jsx("div",{style:{maxHeight:150,overflow:"auto",border:"1px solid var(--color-border)",borderRadius:8},children:e.jsxs("table",{className:"table",style:{fontSize:12,marginBottom:0},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"rn"}),e.jsx("th",{style:{width:"20%"},children:"Kod"}),e.jsx("th",{style:{width:"15%"},children:"Miktar"}),e.jsx("th",{style:{width:"15%"},children:"Durum"})]})}),e.jsx("tbody",{children:A.map(o=>{const h=o.qty>(o.available||0);return e.jsxs("tr",{children:[e.jsx("td",{style:{fontWeight:600},children:o.name}),e.jsx("td",{children:e.jsx("code",{style:{fontSize:10},children:o.productCode})}),e.jsxs("td",{children:[o.qty," ",o.unit]}),e.jsx("td",{children:h?e.jsxs("span",{style:{color:"var(--color-warning)",fontSize:11},children:[" ",o.qty-(o.available||0)," eksik"]}):e.jsx("span",{style:{color:"var(--color-success)",fontSize:11},children:" Yeterli"})})]},o.id)})})]})})]}),e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsxs("label",{className:"form-label",children:[" Tahmini Hazr Olma Tarihi ",e.jsx("span",{style:{color:"var(--color-danger)"},children:"*"})]}),e.jsx(Qe,{value:S,onChange:o=>g(o),min:new Date().toISOString().split("T")[0],style:{fontSize:16}}),e.jsx("div",{className:"text-muted",style:{fontSize:11,marginTop:4},children:"Bu tarih, iin ne zaman retime alnabileceini gsterir"})]}),e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",children:" Not (Opsiyonel)"}),e.jsx("textarea",{className:"form-input",value:x,onChange:o=>M(o.target.value),placeholder:"rn: Mteri talebiyle ertelendi, Malzeme bekliyor...",rows:2,style:{resize:"vertical"}})]})]})}),Qt("production")&&e.jsxs("div",{className:"card",children:[Ge&&e.jsxs("div",{style:{background:"linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%)",borderBottom:"1px solid var(--color-border)",padding:"12px 16px",display:"flex",alignItems:"center",gap:10,color:"#475569"},children:[e.jsx("span",{style:{fontSize:18},children:""}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:600,fontSize:13},children:"Ariv Grnm"}),e.jsx("div",{style:{fontSize:11,opacity:.8},children:"Bu aama tamamland. Sadece grntleme modundasnz."})]})]}),e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"card-title",children:" retim & Tedarik Takip"})}),e.jsxs("div",{className:"card-body",style:{gap:12},children:[e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(4, 1fr)",gap:"0.75rem",marginBottom:"1rem"},children:[e.jsxs("div",{style:{background:"var(--bg-secondary)",padding:"0.75rem",borderRadius:"8px",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"1.25rem",fontWeight:700},children:((hu=w.summary)==null?void 0:hu.totalOrders)||0}),e.jsx("div",{style:{fontSize:"0.7rem",color:"var(--text-muted)"},children:"Toplam Sipari"})]}),e.jsxs("div",{style:{background:"rgba(var(--warning-rgb), 0.1)",padding:"0.75rem",borderRadius:"8px",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"1.25rem",fontWeight:700,color:"var(--warning)"},children:((fu=w.summary)==null?void 0:fu.totalItems)-((gu=w.summary)==null?void 0:gu.receivedItems)||0}),e.jsx("div",{style:{fontSize:"0.7rem",color:"var(--text-muted)"},children:"Bekleyen Adet"})]}),e.jsxs("div",{style:{background:"rgba(var(--danger-rgb), 0.1)",padding:"0.75rem",borderRadius:"8px",textAlign:"center"},children:[e.jsx("div",{style:{fontSize:"1.25rem",fontWeight:700,color:"var(--danger)"},children:((yu=w.summary)==null?void 0:yu.pendingIssues)||0}),e.jsx("div",{style:{fontSize:"0.7rem",color:"var(--text-muted)"},children:"Sorun"})]}),e.jsxs("div",{style:{background:(xu=w.summary)!=null&&xu.readyForAssembly?"rgba(var(--success-rgb), 0.15)":"var(--bg-secondary)",padding:"0.75rem",borderRadius:"8px",textAlign:"center",border:(vu=w.summary)!=null&&vu.readyForAssembly?"2px solid var(--success)":"none"},children:[e.jsx("div",{style:{fontSize:"1.25rem"},children:(ju=w.summary)!=null&&ju.readyForAssembly?"":""}),e.jsx("div",{style:{fontSize:"0.7rem",color:(bu=w.summary)!=null&&bu.readyForAssembly?"var(--success)":"var(--text-muted)"},children:(Nu=w.summary)!=null&&Nu.readyForAssembly?"Montaja Hazr":"Bekleniyor"})]})]}),!Ge&&((Su=t.roles)==null?void 0:Su.length)>0&&e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsx("div",{style:{fontSize:"0.85rem",fontWeight:600,marginBottom:"0.5rem",color:"var(--text-muted)"},children:"  Kollar - Hzl Sipari"}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:t.roles.map(o=>{var _e;const h=re.find(Le=>Le.id===o.id||Le.name===o.name),Y=(o.productionType||(h==null?void 0:h.productionType)||"internal")==="internal",J=o.requiresGlass!==void 0?o.requiresGlass:(h==null?void 0:h.requiresGlass)||!1,te=((_e=w.orders)==null?void 0:_e.filter(Le=>Le.roleId===o.id))||[],ge=te.some(Le=>Le.orderType==="internal"||Le.orderType==="external"),xe=te.some(Le=>Le.orderType==="glass"),ze=ge&&(!J||xe);return e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"0.75rem 1rem",background:ze?"rgba(var(--success-rgb), 0.05)":"var(--bg-secondary)",borderRadius:"8px",borderLeft:`4px solid ${ze?"var(--success)":Y?"var(--primary)":"var(--warning)"}`},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem"},children:[e.jsxs("div",{children:[e.jsxs("div",{style:{fontWeight:600,display:"flex",alignItems:"center",gap:"0.5rem"},children:[o.name,ze&&e.jsx("span",{style:{color:"var(--success)"},children:""})]}),e.jsxs("div",{style:{fontSize:"0.7rem",color:"var(--text-muted)"},children:[Y?"  retim":" D Sipari",J&&e.jsx("span",{children:"   Cam Gerekli"})]})]}),e.jsxs("div",{style:{display:"flex",gap:"0.25rem"},children:[ge&&e.jsx("span",{className:"badge badge-primary",style:{fontSize:"0.6rem"},children:" retim Emri"}),J&&xe&&e.jsx("span",{className:"badge badge-info",style:{fontSize:"0.6rem"},children:" Cam Siparii"})]})]}),e.jsxs("div",{children:[!ze&&e.jsx("button",{className:"btn btn-sm btn-primary",onClick:async()=>{await Zc();const Le=new Date;Le.setDate(Le.getDate()+((h==null?void 0:h.estimatedDays)||5));const ct=new Date;ct.setDate(ct.getDate()+7);let Ve="",rt="";if(!Y&&(h!=null&&h.defaultSupplier)){const He=Ie.find(xt=>xt.id===h.defaultSupplier);He&&(Ve=He.id,rt=He.name)}let Ce="",Ae="";if(J&&(h!=null&&h.defaultGlassSupplier)){const He=Ie.find(xt=>xt.id===h.defaultGlassSupplier);He&&(Ce=He.id,Ae=He.name)}De({roleId:o.id||"",roleName:o.name||"",productionType:Y?"internal":"external",productionDescription:"",productionQty:1,productionUnit:"adet",productionEstDelivery:Le.toISOString().slice(0,10),productionNotes:"",productionSupplierId:Ve,productionSupplierName:rt,requiresGlass:J||!1,includeGlass:J&&!xe,glassItems:[{glassType:"",glassName:"",quantity:1,combination:""}],glassSupplierId:Ce,glassSupplierName:Ae,glassEstDelivery:ct.toISOString().slice(0,10),skipProduction:ge}),oe(!0)},children:ge?" Cam Sipari Ge":" Sipari Olutur"}),ze&&e.jsx("span",{className:"badge badge-success",children:" Sipariler Verildi"})]})]},o.id||o.name)})})]}),B?e.jsx("div",{style:{textAlign:"center",padding:"2rem",color:"var(--text-muted)"},children:"Ykleniyor..."}):((ku=w.orders)==null?void 0:ku.length)===0?e.jsxs("div",{style:{textAlign:"center",padding:"2rem",background:"var(--bg-secondary)",borderRadius:"8px"},children:[e.jsx("div",{style:{fontSize:"2rem",marginBottom:"0.5rem"},children:""}),e.jsx("div",{style:{fontWeight:600,marginBottom:"0.25rem"},children:"Henz sipari yok"}),e.jsx("div",{style:{fontSize:"0.8rem",color:"var(--text-muted)"},children:"Yukardan i kollarna gre sipari oluturabilirsiniz"})]}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.75rem"},children:w.orders.map(o=>{var ge,xe,ze;const h=((ge=o.items)==null?void 0:ge.reduce((_e,Le)=>_e+(Le.quantity||0),0))||0,_=((xe=o.items)==null?void 0:xe.reduce((_e,Le)=>_e+(Le.receivedQty||0),0))||0,Y=((ze=o.issues)==null?void 0:ze.filter(_e=>_e.status==="pending").length)||0,J={internal:"var(--success)",external:"var(--warning)",glass:"var(--info)"},te={internal:"  retim",external:" D Sipari",glass:" Cam"};return e.jsxs("div",{style:{background:"var(--bg-secondary)",borderRadius:"8px",padding:"0.75rem",borderLeft:`4px solid ${J[o.orderType]||"var(--border-color)"}`},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:"0.5rem"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:600},children:o.roleName}),e.jsxs("div",{style:{fontSize:"0.7rem",color:"var(--text-muted)"},children:[te[o.orderType]," ",o.supplierName&&` ${o.supplierName}`]})]}),e.jsxs("div",{style:{display:"flex",gap:"0.25rem"},children:[e.jsx("span",{className:`badge badge-${o.status==="completed"?"success":o.status==="partial"?"info":"primary"}`,children:o.status==="completed"?" Tamamland":o.status==="partial"?" Ksmi Teslim":" Siparite"}),o.isOverdue&&e.jsx("span",{className:"badge badge-danger",children:"GECKT"}),Y>0&&e.jsxs("span",{className:"badge badge-danger",children:[" ",Y]})]})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"0.5rem"},children:[e.jsx("div",{style:{flex:1,height:"6px",background:"var(--bg-tertiary)",borderRadius:"3px",overflow:"hidden"},children:e.jsx("div",{style:{width:`${h>0?_/h*100:0}%`,height:"100%",background:o.status==="completed"?"var(--success)":"var(--primary)",transition:"width 0.3s"}})}),e.jsxs("span",{style:{fontSize:"0.75rem",fontWeight:600,minWidth:"60px"},children:[_," / ",h]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{style:{fontSize:"0.7rem",color:"var(--text-muted)"},children:["Tahmini: ",o.estimatedDelivery?Mi(o.estimatedDelivery):""]}),!Ge&&o.status!=="completed"&&e.jsx("button",{className:"btn btn-xs btn-success",onClick:()=>{T(o),ee({deliveries:o.items.map((_e,Le)=>({lineIndex:Le,receivedQty:0,problemQty:0,problemType:"",problemNote:""})),deliveryDate:new Date().toISOString().slice(0,10),deliveryNote:""}),ce(!0)},children:" Teslim Kaydet"})]})]},o.id)})}),((Cu=w.summary)==null?void 0:Cu.readyForAssembly)&&!Ge&&e.jsxs("div",{style:{marginTop:"1rem",padding:"1rem",background:"linear-gradient(135deg, rgba(var(--success-rgb), 0.1) 0%, rgba(var(--success-rgb), 0.05) 100%)",borderRadius:"8px",border:"1px solid var(--success)",textAlign:"center"},children:[e.jsx("div",{style:{fontWeight:600,marginBottom:"0.5rem",color:"var(--success)"},children:" Tm sipariler tamamland!"}),e.jsx("button",{className:"btn btn-success",disabled:i,onClick:async()=>{try{d(!0),await _0(t.id),await Mb(t.id,{status:"MONTAJA_HAZIR"}),await refreshJob()}catch(o){alert(qa(o))}finally{d(!1)}},children:" Montaja Ge"})]})]})]}),e.jsxs(Be,{isOpen:se,onClose:()=>oe(!1),title:` ${ie.roleName||"Sipari"} - Sipari Olutur`,size:"large",children:[!ie.skipProduction&&e.jsxs("div",{style:{marginBottom:"1.5rem"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.5rem",marginBottom:"1rem",padding:"0.5rem 0.75rem",background:ie.productionType==="internal"?"rgba(var(--success-rgb), 0.1)":"rgba(var(--warning-rgb), 0.1)",borderRadius:"6px",borderLeft:`3px solid ${ie.productionType==="internal"?"var(--success)":"var(--warning)"}`},children:[e.jsx("span",{style:{fontSize:"1.1rem"},children:ie.productionType==="internal"?"":""}),e.jsx("span",{style:{fontWeight:600},children:ie.productionType==="internal"?" retim":"D Sipari"})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"2fr 1fr 1fr",gap:"0.75rem"},children:[e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",style:{fontSize:"0.75rem"},children:"Aklama"}),e.jsx("input",{type:"text",className:"form-input",placeholder:"r: Villa projesi pencereler...",value:ie.productionDescription,onChange:o=>De(h=>({...h,productionDescription:o.target.value}))})]}),e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",style:{fontSize:"0.75rem"},children:"Adet"}),e.jsxs("div",{style:{display:"flex",gap:"0.25rem"},children:[e.jsx("input",{type:"number",className:"form-input",min:1,value:ie.productionQty,onChange:o=>De(h=>({...h,productionQty:parseInt(o.target.value)||1})),style:{flex:1}}),e.jsxs("select",{className:"form-select",value:ie.productionUnit,onChange:o=>De(h=>({...h,productionUnit:o.target.value})),style:{width:"70px"},children:[e.jsx("option",{value:"adet",children:"adet"}),e.jsx("option",{value:"set",children:"set"}),e.jsx("option",{value:"m",children:"m"})]})]})]}),e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",style:{fontSize:"0.75rem"},children:"Tahmini Teslim"}),e.jsx(Qe,{value:ie.productionEstDelivery,onChange:o=>De(h=>({...h,productionEstDelivery:o}))})]})]}),ie.productionType==="external"&&e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.75rem",marginTop:"0.75rem"},children:[e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",style:{fontSize:"0.75rem"},children:"D retim Tedarikisi"}),e.jsxs("select",{className:"form-select",value:ie.productionSupplierId,onChange:o=>{const h=Ie.find(_=>_.id===o.target.value);De(_=>({..._,productionSupplierId:(h==null?void 0:h.id)||"",productionSupplierName:(h==null?void 0:h.name)||""}))},children:[e.jsx("option",{value:"",children:"Tedariki sein..."}),Ie.filter(o=>o.supplyType==="production"&&(o.jobRoleId===ie.roleId||!o.jobRoleId)).map(o=>e.jsx("option",{value:o.id,children:o.name},o.id))]})]}),e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",style:{fontSize:"0.75rem"},children:"Not"}),e.jsx("input",{type:"text",className:"form-input",placeholder:"Opsiyonel notlar...",value:ie.productionNotes,onChange:o=>De(h=>({...h,productionNotes:o.target.value}))})]})]})]}),ie.requiresGlass&&e.jsxs("div",{style:{padding:"1rem",background:ie.includeGlass?"rgba(var(--info-rgb), 0.05)":"var(--bg-secondary)",borderRadius:"8px",border:ie.includeGlass?"1px solid var(--info)":"1px dashed var(--border-color)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:ie.includeGlass?"1rem":0},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.5rem",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:ie.includeGlass,onChange:o=>De(h=>({...h,includeGlass:o.target.checked})),style:{width:"18px",height:"18px"}}),e.jsx("span",{style:{fontSize:"1.1rem"},children:""}),e.jsx("span",{style:{fontWeight:600},children:"Cam Siparii Dahil Et"})]}),!ie.skipProduction&&ie.requiresGlass&&e.jsx("span",{className:"badge badge-info",style:{fontSize:"0.65rem"},children:"Bu i kolu iin cam gerekli"})]}),ie.includeGlass&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{marginBottom:"1rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.5rem"},children:[e.jsx("label",{className:"form-label",style:{margin:0,fontSize:"0.75rem"},children:"Cam Kalemleri"}),e.jsx("button",{type:"button",className:"btn btn-xs btn-info",onClick:()=>De(o=>({...o,glassItems:[...o.glassItems,{glassType:"",glassName:"",quantity:1,combination:""}]})),children:"+ Cam Tipi Ekle"})]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:ie.glassItems.map((o,h)=>e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 80px 30px",gap:"0.5rem",padding:"0.5rem",background:"white",borderRadius:"6px",border:"1px solid var(--border-color)"},children:[e.jsxs("select",{className:"form-select",value:o.glassType,onChange:_=>{const Y=Re.find(te=>te.code===_.target.value),J=[...ie.glassItems];J[h]={...J[h],glassType:_.target.value,glassName:(Y==null?void 0:Y.name)||""},De(te=>({...te,glassItems:J}))},style:{fontSize:"0.8rem"},children:[e.jsxs("option",{value:"",children:["Cam tipi sein... (",Re.length," adet)"]}),Re.map(_=>e.jsx("option",{value:_.code,children:_.name},_.id))]}),e.jsx("input",{type:"text",className:"form-input",placeholder:"Kombinasyon (r: Sinerji, Low-E)",value:o.combination,onChange:_=>{const Y=[...ie.glassItems];Y[h]={...Y[h],combination:_.target.value},De(J=>({...J,glassItems:Y}))},style:{fontSize:"0.8rem"},list:"combinationsList"}),e.jsx("input",{type:"number",className:"form-input",min:1,placeholder:"Adet",value:o.quantity,onChange:_=>{const Y=[...ie.glassItems];Y[h]={...Y[h],quantity:parseInt(_.target.value)||1},De(J=>({...J,glassItems:Y}))},style:{fontSize:"0.8rem",textAlign:"center"}}),e.jsx("button",{type:"button",className:"btn btn-xs btn-ghost",onClick:()=>{ie.glassItems.length>1&&De(_=>({..._,glassItems:_.glassItems.filter((Y,J)=>J!==h)}))},style:{color:"var(--danger)"},disabled:ie.glassItems.length===1,children:""})]},h))}),e.jsx("datalist",{id:"combinationsList",children:R.map((o,h)=>e.jsx("option",{value:o},h))})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"0.75rem"},children:[e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",style:{fontSize:"0.75rem"},children:"Cam Tedarikisi"}),e.jsxs("select",{className:"form-select",value:ie.glassSupplierId,onChange:o=>{const h=Ie.find(_=>_.id===o.target.value);De(_=>({..._,glassSupplierId:(h==null?void 0:h.id)||"",glassSupplierName:(h==null?void 0:h.name)||""}))},children:[e.jsx("option",{value:"",children:"Tedariki sein..."}),Ie.filter(o=>o.supplyType==="glass"&&(o.jobRoleId===ie.roleId||!o.jobRoleId)).map(o=>e.jsx("option",{value:o.id,children:o.name},o.id))]})]}),e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",style:{fontSize:"0.75rem"},children:"Tahmini Cam Teslimi"}),e.jsx(Qe,{value:ie.glassEstDelivery,onChange:o=>De(h=>({...h,glassEstDelivery:o}))})]})]})]})]}),e.jsx("div",{style:{marginTop:"1.5rem",padding:"0.75rem",background:"var(--bg-secondary)",borderRadius:"6px",display:"flex",justifyContent:"space-between",alignItems:"center"},children:e.jsxs("div",{style:{fontSize:"0.85rem",color:"var(--text-muted)"},children:[e.jsx("strong",{children:"Oluturulacak:"})," ",!ie.skipProduction&&e.jsx("span",{className:"badge badge-primary",style:{marginRight:"0.25rem"},children:"1x retim"}),ie.includeGlass&&e.jsxs("span",{className:"badge badge-info",children:["1x Cam Siparii (",ie.glassItems.reduce((o,h)=>o+(h.quantity||0),0)," adet)"]}),ie.skipProduction&&!ie.includeGlass&&e.jsx("span",{style:{color:"var(--danger)"},children:"Hibir ey seilmedi"})]})}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"0.5rem",marginTop:"1rem"},children:[e.jsx("button",{className:"btn btn-ghost",onClick:()=>oe(!1),children:"ptal"}),e.jsx("button",{className:"btn btn-primary",disabled:i||!ie.skipProduction&&!ie.productionDescription||ie.skipProduction&&!ie.includeGlass,onClick:async()=>{try{d(!0);const o=[];ie.skipProduction||o.push(Fo({jobId:t.id,roleId:ie.roleId,roleName:ie.roleName,orderType:ie.productionType,supplierId:ie.productionSupplierId,supplierName:ie.productionSupplierName,items:[{notes:ie.productionDescription,quantity:ie.productionQty,unit:ie.productionUnit}],estimatedDelivery:ie.productionEstDelivery,notes:ie.productionNotes})),ie.includeGlass&&ie.glassItems.length>0&&o.push(Fo({jobId:t.id,roleId:ie.roleId,roleName:ie.roleName,orderType:"glass",supplierId:ie.glassSupplierId,supplierName:ie.glassSupplierName,items:ie.glassItems.map(Y=>({glassType:Y.glassType,glassName:Y.glassName,quantity:Y.quantity,unit:"adet",combination:Y.combination})),estimatedDelivery:ie.glassEstDelivery,notes:""})),await Promise.all(o);const h=await Ri(t.id);j(h||{orders:[],summary:{}}),(t.roles||[]).every(Y=>{const J=Y.id||`role-${Y.name}`,te=((h==null?void 0:h.orders)||[]).filter(Le=>Le.roleId===J||Le.roleName===Y.name),ge=re.find(Le=>Le.id===J||Le.name===Y.name),xe=te.some(Le=>Le.orderType==="internal"||Le.orderType==="external"),ze=te.some(Le=>Le.orderType==="glass"),_e=(ge==null?void 0:ge.requiresGlass)||Y.requiresGlass;return xe&&(!_e||ze)})&&t.status==="URETIME_HAZIR"&&(await Dt(t.id,{status:"URETIMDE"}),An(t.id,{status:"URETIMDE"})),oe(!1)}catch(o){l(qa(o))}finally{d(!1)}},children:i?"Kaydediliyor...":" Siparileri Olutur"})]})]}),e.jsx(Be,{isOpen:O,onClose:()=>ce(!1),title:`Teslim Kaydet - ${(Ee==null?void 0:Ee.roleName)||""}`,size:"large",children:Ee&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{marginBottom:"1rem",padding:"0.75rem",background:"var(--bg-secondary)",borderRadius:"6px"},children:[e.jsxs("div",{children:[e.jsx("strong",{children:" Kolu:"})," ",Ee.roleName]}),Ee.supplierName&&e.jsxs("div",{children:[e.jsx("strong",{children:"Tedariki:"})," ",Ee.supplierName]})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"1rem"},children:[e.jsx(Qe,{value:Me.deliveryDate,onChange:o=>ee(h=>({...h,deliveryDate:o})),style:{width:"200px"}}),e.jsx("button",{type:"button",className:"btn btn-secondary",onClick:()=>{ee(o=>({...o,deliveries:o.deliveries.map((h,_)=>{var Y,J;return{...h,receivedQty:Math.max(0,(((Y=Ee.items[_])==null?void 0:Y.quantity)||0)-(((J=Ee.items[_])==null?void 0:J.receivedQty)||0))}})}))},children:"Tmn Doldur"})]}),e.jsx("div",{style:{maxHeight:"300px",overflowY:"auto"},children:e.jsxs("table",{className:"data-table",style:{fontSize:"0.85rem"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Kalem"}),e.jsx("th",{style:{width:"70px"},children:"Sipari"}),e.jsx("th",{style:{width:"70px"},children:"Alnan"}),e.jsx("th",{style:{width:"70px"},children:"Teslim"}),e.jsx("th",{style:{width:"70px"},children:"Sorunlu"}),e.jsx("th",{style:{width:"100px"},children:"Sorun Tipi"})]})}),e.jsx("tbody",{children:Ee.items.map((o,h)=>{const _=(o.quantity||0)-(o.receivedQty||0),Y=Me.deliveries[h]||{};return e.jsxs("tr",{children:[e.jsxs("td",{children:[o.glassName||o.notes||`Kalem ${h+1}`,o.combination&&e.jsx("div",{style:{fontSize:"0.7rem",color:"var(--text-muted)"},children:o.combination})]}),e.jsxs("td",{children:[o.quantity," ",o.unit]}),e.jsx("td",{style:{color:_===0?"var(--success)":"inherit"},children:o.receivedQty||0}),e.jsx("td",{children:e.jsx("input",{type:"number",className:"form-input",value:Y.receivedQty||"",onChange:J=>{const te=[...Me.deliveries];te[h]={...te[h],receivedQty:parseInt(J.target.value)||0},ee(ge=>({...ge,deliveries:te}))},min:0,max:_,style:{width:"60px",padding:"0.25rem",textAlign:"center"}})}),e.jsx("td",{children:e.jsx("input",{type:"number",className:"form-input",value:Y.problemQty||"",onChange:J=>{const te=[...Me.deliveries];te[h]={...te[h],problemQty:parseInt(J.target.value)||0},ee(ge=>({...ge,deliveries:te}))},min:0,style:{width:"60px",padding:"0.25rem",textAlign:"center"}})}),e.jsx("td",{children:Y.problemQty>0&&e.jsxs("select",{className:"form-select",value:Y.problemType||"",onChange:J=>{const te=[...Me.deliveries];te[h]={...te[h],problemType:J.target.value},ee(ge=>({...ge,deliveries:te}))},style:{padding:"0.25rem",fontSize:"0.75rem"},children:[e.jsx("option",{value:"",children:"Sein..."}),e.jsx("option",{value:"broken",children:" Krk"}),e.jsx("option",{value:"missing",children:" Eksik"}),e.jsx("option",{value:"wrong",children:" Yanl"}),e.jsx("option",{value:"other",children:" Dier"})]})})]},h)})})]})}),e.jsxs("div",{className:"form-group",style:{marginTop:"1rem"},children:[e.jsx("label",{className:"form-label",children:"Teslimat Notu"}),e.jsx("input",{type:"text",className:"form-input",value:Me.deliveryNote,onChange:o=>ee(h=>({...h,deliveryNote:o.target.value})),placeholder:"Opsiyonel not..."})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"0.5rem",marginTop:"1.5rem"},children:[e.jsx("button",{className:"btn btn-ghost",onClick:()=>ce(!1),children:"ptal"}),e.jsx("button",{className:"btn btn-success",disabled:i,onClick:async()=>{if(!Me.deliveries.some(h=>h.receivedQty>0||h.problemQty>0)){alert("En az bir teslim miktar girin");return}try{d(!0),await zy(Ee.id,Me);const h=await Ri(t.id);j(h||{orders:[],summary:{}}),ce(!1)}catch(h){l(qa(h))}finally{d(!1)}},children:i?"Kaydediliyor...":" Teslim Kaydet"})]})]})}),Qt("assembly")&&e.jsxs("div",{className:"card",children:[Ge&&e.jsxs("div",{style:{background:"linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%)",borderBottom:"1px solid var(--color-border)",padding:"12px 16px",display:"flex",alignItems:"center",gap:10,color:"#475569"},children:[e.jsx("span",{style:{fontSize:18},children:""}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:600,fontSize:13},children:"Ariv Grnm"}),e.jsx("div",{style:{fontSize:11,opacity:.8},children:"Bu aama tamamland. Sadece grntleme modundasnz."})]})]}),((wu=je.roles)==null?void 0:wu.length)>0&&e.jsxs("div",{style:{padding:"1rem",background:"var(--bg-secondary)",borderBottom:"1px solid var(--border-color)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem"},children:[e.jsx("h4",{style:{margin:0,fontSize:"0.9rem"},children:" Montaj Grevleri"}),e.jsx("a",{href:"/isler/montaj-takip/planlanan",style:{fontSize:"0.8rem",color:"var(--primary)"},children:"Tmn Gr "})]}),e.jsxs("div",{style:{display:"flex",gap:"1rem",flexWrap:"wrap",marginBottom:"0.75rem"},children:[e.jsxs("div",{style:{padding:"0.5rem 0.75rem",background:"var(--success)",color:"#fff",borderRadius:6,fontSize:"0.8rem"},children:[" ",((Tu=je.summary)==null?void 0:Tu.completedTasks)||0," Tamamland"]}),e.jsxs("div",{style:{padding:"0.5rem 0.75rem",background:"var(--warning)",color:"#fff",borderRadius:6,fontSize:"0.8rem"},children:[" ",((Du=je.summary)==null?void 0:Du.inProgressTasks)||0," Devam Ediyor"]}),e.jsxs("div",{style:{padding:"0.5rem 0.75rem",background:"var(--info)",color:"#fff",borderRadius:6,fontSize:"0.8rem"},children:[" ",((zu=je.summary)==null?void 0:zu.pendingTasks)||0," Bekliyor"]}),((Iu=je.summary)==null?void 0:Iu.pendingIssues)>0&&e.jsxs("div",{style:{padding:"0.5rem 0.75rem",background:"var(--danger)",color:"#fff",borderRadius:6,fontSize:"0.8rem"},children:[" ",(Eu=je.summary)==null?void 0:Eu.pendingIssues," Sorun"]})]}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"0.5rem"},children:(Au=je.roles)==null?void 0:Au.map(o=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"0.75rem",padding:"0.5rem 0.75rem",background:o.isComplete?"rgba(34, 197, 94, 0.1)":"#fff",borderRadius:6,border:`1px solid ${o.isComplete?"var(--success)":"var(--border-color)"}`},children:[e.jsx("span",{children:o.isComplete?"":""}),e.jsx("span",{style:{fontWeight:500,flex:1},children:o.roleName}),e.jsxs("span",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:[o.completedCount,"/",o.totalCount," aama"]}),e.jsx("div",{style:{width:80,height:6,background:"var(--border-color)",borderRadius:3,overflow:"hidden"},children:e.jsx("div",{style:{width:`${o.completedCount/o.totalCount*100}%`,height:"100%",background:o.isComplete?"var(--success)":"var(--primary)",transition:"width 0.3s"}})})]},o.roleId))}),((Ru=je.summary)==null?void 0:Ru.allCompleted)&&e.jsx("div",{style:{marginTop:"0.75rem",padding:"0.75rem",background:"linear-gradient(135deg, rgba(34, 197, 94, 0.1), rgba(34, 197, 94, 0.05))",borderRadius:6,border:"1px solid var(--success)",textAlign:"center",color:"var(--success)",fontWeight:600},children:" Tm montaj grevleri tamamland!"})]}),e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"card-title",children:"Montaj Termin"})}),e.jsxs("div",{className:"card-body grid grid-1",style:{gap:12},children:[e.jsxs("div",{className:"grid grid-3",style:{gap:12},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Montaj Tarihi"}),e.jsx(Qe,{value:((Bu=I.assemblyDate)==null?void 0:Bu.split("T")[0])||I.assemblyDate||"",onChange:o=>{const h=I.assemblyTime||"09:00";me(_=>({..._,assemblyDate:o?`${o}T${h}`:""}))}})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Saat"}),e.jsx("input",{className:"form-input",type:"time",value:(Lu=I.assemblyDate)!=null&&Lu.includes("T")?(Pu=I.assemblyDate.split("T")[1])==null?void 0:Pu.slice(0,5):"09:00",onChange:o=>{var _;const h=((_=I.assemblyDate)==null?void 0:_.split("T")[0])||"";h&&me(Y=>({...Y,assemblyDate:`${h}T${o.target.value}`}))}})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Ekip"}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:4,marginBottom:8},children:I.assemblyTeam.map(o=>{const h=G.find(_=>_.id===o);return h?e.jsxs("span",{style:{background:"#4f46e5",color:"#fff",padding:"4px 10px",borderRadius:16,fontSize:13,display:"flex",alignItems:"center",gap:6},children:[h.ad,e.jsx("button",{type:"button",onClick:()=>me(_=>({..._,assemblyTeam:_.assemblyTeam.filter(Y=>Y!==o)})),style:{background:"transparent",border:"none",color:"#fff",cursor:"pointer",padding:0,fontSize:14,lineHeight:1},children:""})]},o):null})}),e.jsxs("select",{className:"form-input",value:"",onChange:o=>{o.target.value&&!I.assemblyTeam.includes(o.target.value)&&me(h=>({...h,assemblyTeam:[...h.assemblyTeam,o.target.value]}))},children:[e.jsx("option",{value:"",children:"Ekip ekle..."}),G.filter(o=>!I.assemblyTeam.includes(o.id)).map(o=>e.jsx("option",{value:o.id,children:o.ad},o.id))]})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Montaj Notu"}),e.jsx("textarea",{className:"form-textarea",placeholder:"Montaj notu, adres detaylar vb.",value:I.assemblyNote,onChange:o=>me(h=>({...h,assemblyNote:o.target.value}))})]}),e.jsxs("div",{className:"btn-group",style:{gap:8},children:[e.jsx("button",{className:"btn btn-primary",type:"button",disabled:i||!I.assemblyDate,onClick:async()=>{var h;const o=((h=I.assemblyDate)==null?void 0:h.split("T")[0])||I.assemblyDate;await st(async()=>{var Y,J;await xh(t.id,{date:o,note:I.assemblyNote||""});const _=Array.isArray(I.assemblyTeam)?I.assemblyTeam.join(", "):I.assemblyTeam;if(await Ob(t.id,{date:I.assemblyDate,note:I.assemblyNote,team:_}),I.assemblyTeam.length>0){const te=I.assemblyTeam.map(ge=>{var xe;return((xe=G.find(ze=>ze.id===ge))==null?void 0:xe.ad)||ge}).join(", ");try{await xy({baslik:`Montaj: ${(n==null?void 0:n.name)||t.title||t.id}`,aciklama:`: ${t.id}
Mteri: ${(n==null?void 0:n.name)||"-"}
Adres: ${(n==null?void 0:n.address)||"-"}
Not: ${I.assemblyNote||"-"}
Ekip: ${te}`,oncelik:"high",durum:"todo",baslangicTarihi:((Y=I.assemblyDate)==null?void 0:Y.split("T")[0])||"",bitisTarihi:((J=I.assemblyDate)==null?void 0:J.split("T")[0])||"",jobId:t.id,teamIds:I.assemblyTeam})}catch(ge){console.warn("Grev oluturulamad:",ge)}}},{transition:t.status})},children:" Termin Kaydet"}),e.jsx("button",{className:"btn btn-success",type:"button",disabled:i||((Mu=je.roles)==null?void 0:Mu.length)>0&&!((Ou=je.summary)!=null&&Ou.allCompleted),title:((_u=je.roles)==null?void 0:_u.length)>0&&!((Fu=je.summary)!=null&&Fu.allCompleted)?` ${(($u=je.summary)==null?void 0:$u.totalTasks)-((Wu=je.summary)==null?void 0:Wu.completedTasks)} montaj grevi bekliyor`:"Montaj tamamla ve finansa ge",onClick:()=>{var o,h,_,Y;if(((o=je.roles)==null?void 0:o.length)>0&&!((h=je.summary)!=null&&h.allCompleted)){const J=((_=je.summary)==null?void 0:_.totalTasks)-((Y=je.summary)==null?void 0:Y.completedTasks);if(!confirm(` ${J} montaj grevi henz tamamlanmad.

Yine de ii finansa geirmek istiyor musunuz?`))return}st(async()=>{const J=Array.isArray(I.assemblyTeam)?I.assemblyTeam.join(", "):I.assemblyTeam,te=await _b(t.id,{date:I.assemblyDate,note:I.assemblyNote,team:J,completed:!0});return await Rr("assembly.completed","Montaj tamamland",{team:J}),te})},children:" Montaj Bitti  Finansa Ge"})]})]})]}),Qt("finance")&&e.jsxs("div",{className:"card",children:[Ge&&e.jsxs("div",{style:{background:"linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%)",borderBottom:"1px solid var(--color-border)",padding:"12px 16px",display:"flex",alignItems:"center",gap:10,color:"#475569"},children:[e.jsx("span",{style:{fontSize:18},children:""}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:600,fontSize:13},children:"Ariv Grnm"}),e.jsx("div",{style:{fontSize:11,opacity:.8},children:"Bu aama tamamland. Sadece grntleme modundasnz."})]})]}),e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"card-title",children:"Son Mutabakat (Kapan)"})}),e.jsxs("div",{className:"card-body grid grid-1",style:{gap:16},children:[e.jsxs("div",{className:"card subtle-card",children:[e.jsx("div",{className:"card-header",style:{padding:"12px 16px"},children:e.jsx("h4",{className:"card-title",style:{fontSize:14},children:"Finansal zet"})}),e.jsx("div",{className:"card-body",style:{padding:16},children:e.jsxs("div",{className:"grid grid-2",style:{gap:16},children:[e.jsxs("div",{children:[e.jsxs("div",{className:"metric-row",children:[e.jsx("span",{className:"metric-label",children:"Teklif Tutar"}),e.jsxs("span",{className:"metric-value",children:[be($t)," "]})]}),e.jsxs("div",{className:"metric-row",children:[e.jsx("span",{className:"metric-label",children:"n Alnan"}),e.jsxs("span",{className:"metric-value",children:[be(Et((Uu=(Ku=t.approval)==null?void 0:Ku.paymentPlan)==null?void 0:Uu.cash)+Et((Hu=(qu=t.approval)==null?void 0:qu.paymentPlan)==null?void 0:Hu.card)+Et((Vu=(Yu=t.approval)==null?void 0:Yu.paymentPlan)==null?void 0:Vu.cheque))," "]})]}),e.jsxs("div",{className:"metric-row",children:[e.jsx("span",{className:"metric-label",children:"Teslimat Sonras"}),e.jsxs("span",{className:"metric-value",children:[be(Et((Qu=(Gu=t.approval)==null?void 0:Gu.paymentPlan)==null?void 0:Qu.afterDelivery))," "]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"metric-row",children:[e.jsx("span",{className:"metric-label",children:"Beklenen Toplam"}),e.jsxs("span",{className:"metric-value",children:[be(Et((Xu=(Ju=t.approval)==null?void 0:Ju.paymentPlan)==null?void 0:Xu.cash)+Et((em=(Zu=t.approval)==null?void 0:Zu.paymentPlan)==null?void 0:em.card)+Et((sm=(tm=t.approval)==null?void 0:tm.paymentPlan)==null?void 0:sm.cheque)+Et((nm=(rm=t.approval)==null?void 0:rm.paymentPlan)==null?void 0:nm.afterDelivery))," "]})]}),Math.abs($t-(Et((lm=(am=t.approval)==null?void 0:am.paymentPlan)==null?void 0:lm.cash)+Et((om=(im=t.approval)==null?void 0:im.paymentPlan)==null?void 0:om.card)+Et((dm=(cm=t.approval)==null?void 0:cm.paymentPlan)==null?void 0:dm.cheque)+Et((mm=(um=t.approval)==null?void 0:um.paymentPlan)==null?void 0:mm.afterDelivery)))>1&&e.jsx("div",{className:"badge badge-warning",style:{marginTop:8},children:"deme plan teklif tutaryla elemiyor!"})]})]})})]}),e.jsxs("div",{className:"card subtle-card",children:[e.jsx("div",{className:"card-header",style:{padding:"12px 16px"},children:e.jsx("h4",{className:"card-title",style:{fontSize:14},children:" Bitiminde Alnan Tutar"})}),e.jsxs("div",{className:"card-body",style:{padding:16},children:[e.jsxs("div",{className:"grid grid-4",style:{gap:12},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Nakit"}),e.jsx(bt,{placeholder:"0",value:I.financeCash,onChange:o=>me(h=>({...h,financeCash:o}))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Kredi Kart"}),e.jsx(bt,{placeholder:"0",value:I.financeCard,onChange:o=>me(h=>({...h,financeCard:o}))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"ek"}),e.jsx(bt,{placeholder:"0",value:I.financeCheque,onChange:o=>me(h=>({...h,financeCheque:o}))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Toplam Alnan"}),e.jsxs("div",{className:"form-input",style:{background:"#f9fafb",display:"flex",alignItems:"center"},children:[be(Number(I.financeCash||0)+Number(I.financeCard||0)+Number(I.financeCheque||0))," "]})]})]}),(()=>{var te,ge,xe,ze,_e,Le;const o=Et((ge=(te=t.approval)==null?void 0:te.paymentPlan)==null?void 0:ge.cash)+Et((ze=(xe=t.approval)==null?void 0:xe.paymentPlan)==null?void 0:ze.card)+Et((Le=(_e=t.approval)==null?void 0:_e.paymentPlan)==null?void 0:Le.cheque),h=Number(I.financeCash||0)+Number(I.financeCard||0)+Number(I.financeCheque||0),_=Number(I.discountAmount||0),Y=o+h+_,J=$t-Y;return e.jsxs("div",{style:{marginTop:12,padding:12,background:J===0?"#ecfdf5":"#fef2f2",borderRadius:8},children:[e.jsxs("div",{className:"metric-row",children:[e.jsx("span",{className:"metric-label",children:"n Alnan"}),e.jsxs("span",{children:[be(o)," "]})]}),e.jsxs("div",{className:"metric-row",children:[e.jsx("span",{className:"metric-label",children:"imdi Alnan"}),e.jsxs("span",{children:[be(h)," "]})]}),_>0&&e.jsxs("div",{className:"metric-row",children:[e.jsx("span",{className:"metric-label",children:"skonto"}),e.jsxs("span",{children:[be(_)," "]})]}),e.jsx("hr",{style:{margin:"8px 0",borderColor:"rgba(0,0,0,0.1)"}}),e.jsxs("div",{className:"metric-row",children:[e.jsx("span",{className:"metric-label",style:{fontWeight:700},children:"Toplam"}),e.jsxs("span",{style:{fontWeight:700},children:[be(Y)," "]})]}),e.jsxs("div",{className:"metric-row",style:{color:J===0?"#059669":"#dc2626"},children:[e.jsx("span",{className:"metric-label",children:"Bakiye Fark"}),e.jsxs("span",{style:{fontWeight:700},children:[J>0?`+${be(J)}`:be(J)," "]})]}),J!==0&&e.jsx("div",{className:"badge badge-danger",style:{marginTop:8},children:J>0?"Eksik tahsilat!":"Fazla tahsilat!"})]})})()]})]}),e.jsxs("div",{className:"grid grid-2",style:{gap:12},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"skonto Tutar (opsiyonel)"}),e.jsx(bt,{placeholder:"0",value:I.discountAmount,onChange:o=>me(h=>({...h,discountAmount:o}))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"skonto Notu"}),e.jsx("input",{className:"form-input",placeholder:"skonto sebebi",value:I.discountNote,onChange:o=>me(h=>({...h,discountNote:o.target.value}))})]})]}),e.jsx("button",{className:"btn btn-success",type:"button",disabled:i,onClick:()=>st(()=>Fb(t.id,{total:Number(I.financeTotal||$t),payments:{cash:Number(I.financeCash||0),card:Number(I.financeCard||0),cheque:Number(I.financeCheque||0)},discount:Number(I.discountAmount||0)>0?{amount:Number(I.discountAmount||0),note:I.discountNote||""}:null})),children:"i Kapat (Bakiye 0 olmal)"})]})]}),Er&&Qt("service_schedule")&&e.jsxs("div",{className:"card",children:[Ge&&e.jsxs("div",{style:{background:"linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%)",borderBottom:"1px solid var(--color-border)",padding:"12px 16px",display:"flex",alignItems:"center",gap:10,color:"#475569"},children:[e.jsx("span",{style:{fontSize:18},children:""}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:600,fontSize:13},children:"Ariv Grnm"}),e.jsx("div",{style:{fontSize:11,opacity:.8},children:"Bu aama tamamland. Sadece grntleme modundasnz."})]})]}),e.jsxs("div",{className:"card-header",children:[e.jsx("h3",{className:"card-title",children:" Servis Randevusu"}),e.jsx("span",{className:"badge badge-warning",children:"Randevu Belirlenmedi"})]}),e.jsxs("div",{className:"card-body grid grid-1",style:{gap:16},children:[e.jsx("div",{className:"card subtle-card",style:{padding:12},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:600},children:t.customerName}),e.jsx("div",{className:"text-muted",style:{fontSize:12},children:t.title})]}),e.jsxs("div",{style:{textAlign:"right"},children:[e.jsx("div",{className:"text-muted",style:{fontSize:12},children:" Kodu"}),e.jsx("div",{style:{fontWeight:600},children:t.id})]})]})}),e.jsxs("div",{className:"grid grid-3",style:{gap:12},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:" Randevu Tarihi *"}),e.jsx(Qe,{value:I.serviceAppointmentDate||"",onChange:o=>me(h=>({...h,serviceAppointmentDate:o}))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:" Saat *"}),e.jsx("input",{className:"form-input",type:"time",value:I.serviceAppointmentTime||"10:00",onChange:o=>me(h=>({...h,serviceAppointmentTime:o.target.value}))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:" Sabit Servis creti () *"}),e.jsx(bt,{placeholder:"rn: 500",value:I.serviceFixedFee||"",onChange:o=>me(h=>({...h,serviceFixedFee:o}))})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:" Mteri Talebi / Adres / Not"}),e.jsx("textarea",{className:"form-textarea",placeholder:"Mterinin ikayeti, servis adresi, zel notlar...",rows:3,value:I.serviceNote||"",onChange:o=>me(h=>({...h,serviceNote:o.target.value}))})]}),(!I.serviceAppointmentDate||!I.serviceFixedFee)&&e.jsx("div",{style:{padding:12,background:"var(--color-warning-bg)",borderRadius:8,fontSize:13},children:" Randevu tarihi ve servis creti zorunludur."}),e.jsx("button",{className:"btn btn-success",type:"button",style:{padding:"14px 24px",fontSize:16},disabled:i||!I.serviceAppointmentDate||!I.serviceFixedFee,onClick:()=>st(()=>Dt(t.id,{status:"SERVIS_RANDEVULU",service:{...t.service,fixedFee:Number(I.serviceFixedFee||0),note:I.serviceNote,visits:[{id:1,appointmentDate:I.serviceAppointmentDate,appointmentTime:I.serviceAppointmentTime||"10:00",status:"scheduled"}]}}),{transition:"SERVIS_RANDEVULU"}),children:" Randevuyu Kaydet ve Onayla"})]})]}),Er&&Qt("service_start")&&e.jsxs("div",{className:"card",children:[Ge&&e.jsxs("div",{style:{background:"linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%)",borderBottom:"1px solid var(--color-border)",padding:"12px 16px",display:"flex",alignItems:"center",gap:10,color:"#475569"},children:[e.jsx("span",{style:{fontSize:18},children:""}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:600,fontSize:13},children:"Ariv Grnm"}),e.jsx("div",{style:{fontSize:11,opacity:.8},children:"Bu aama tamamland. Sadece grntleme modundasnz."})]})]}),e.jsxs("div",{className:"card-header",children:[e.jsx("h3",{className:"card-title",children:" Servise Bala"}),e.jsx("span",{className:"badge badge-primary",children:"Randevu Alnd"})]}),e.jsxs("div",{className:"card-body grid grid-1",style:{gap:16},children:[e.jsxs("div",{className:"card subtle-card",style:{padding:16},children:[e.jsxs("div",{className:"grid grid-3",style:{gap:16},children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-muted",style:{fontSize:12},children:"MTER"}),e.jsx("div",{style:{fontWeight:600},children:t.customerName})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-muted",style:{fontSize:12},children:"RANDEVU"}),e.jsx("div",{style:{fontWeight:600},children:(()=>{var h,_;const o=(_=(h=t.service)==null?void 0:h.visits)==null?void 0:_.find(Y=>Y.status==="scheduled");return o?`${new Date(o.appointmentDate).toLocaleDateString("tr-TR")} ${o.appointmentTime}`:"-"})()})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-muted",style:{fontSize:12},children:"SABT CRET"}),e.jsxs("div",{style:{fontWeight:600,color:"var(--color-primary)"},children:[be(((pm=t.service)==null?void 0:pm.fixedFee)||0)," "]})]})]}),((hm=t.service)==null?void 0:hm.note)&&e.jsxs("div",{style:{marginTop:12,padding:10,background:"var(--color-warning-bg)",borderRadius:6},children:[e.jsx("strong",{children:"Not:"})," ",t.service.note]})]}),e.jsxs("div",{style:{padding:16,background:"var(--color-bg-secondary)",borderRadius:12},children:[e.jsx("h4",{style:{marginBottom:12},children:" Gidi Bilgilerini Girin"}),e.jsxs("div",{className:"grid grid-2",style:{gap:12},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Gidi Tarihi *"}),e.jsx(Qe,{value:I.serviceVisitDate||new Date().toISOString().split("T")[0],onChange:o=>me(h=>({...h,serviceVisitDate:o}))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Gidi Saati *"}),e.jsx("input",{className:"form-input",type:"time",value:I.serviceVisitTime||new Date().toTimeString().slice(0,5),onChange:o=>me(h=>({...h,serviceVisitTime:o.target.value}))})]})]})]}),e.jsx("button",{className:"btn btn-success",type:"button",style:{padding:"14px 24px",fontSize:16},disabled:i,onClick:()=>{var _;const o=[...((_=t.service)==null?void 0:_.visits)||[]],h=o.findIndex(Y=>Y.status==="scheduled");h>=0&&(o[h]={...o[h],visitedAt:`${I.serviceVisitDate||new Date().toISOString().split("T")[0]}T${I.serviceVisitTime||new Date().toTimeString().slice(0,5)}`,status:"in_progress"}),st(()=>Dt(t.id,{status:"SERVIS_YAPILIYOR",service:{...t.service,visits:o}}),{transition:"SERVIS_YAPILIYOR"})},children:" Servise Bala"})]})]}),Er&&Qt("service_work")&&e.jsxs("div",{className:"card",children:[Ge&&e.jsxs("div",{style:{background:"linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%)",borderBottom:"1px solid var(--color-border)",padding:"12px 16px",display:"flex",alignItems:"center",gap:10,color:"#475569"},children:[e.jsx("span",{style:{fontSize:18},children:""}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:600,fontSize:13},children:"Ariv Grnm"}),e.jsx("div",{style:{fontSize:11,opacity:.8},children:"Bu aama tamamland. Sadece grntleme modundasnz."})]})]}),e.jsxs("div",{className:"card-header",children:[e.jsx("h3",{className:"card-title",children:" Servis almas"}),e.jsx("span",{className:`badge badge-${t.status==="SERVIS_DEVAM_EDIYOR"?"warning":"primary"}`,children:t.status==="SERVIS_DEVAM_EDIYOR"?"Devam Ziyareti":`Ziyaret #${((gm=(fm=t.service)==null?void 0:fm.visits)==null?void 0:gm.length)||1}`})]}),e.jsxs("div",{className:"card-body grid grid-1",style:{gap:16},children:[((xm=(ym=t.service)==null?void 0:ym.visits)==null?void 0:xm.filter(o=>o.status==="completed").length)>0&&e.jsxs("div",{className:"card subtle-card",children:[e.jsx("div",{className:"card-header",style:{padding:"12px 16px"},children:e.jsx("h4",{className:"card-title",style:{fontSize:14},children:" nceki Ziyaretler"})}),e.jsx("div",{className:"card-body",style:{padding:0},children:t.service.visits.filter(o=>o.status==="completed").map((o,h)=>e.jsxs("div",{style:{padding:"12px 16px",borderBottom:"1px solid var(--color-border)",background:h%2===0?"transparent":"var(--color-bg-secondary)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsxs("strong",{children:["#",o.id]})," - ",new Date(o.appointmentDate).toLocaleDateString("tr-TR")," ",o.appointmentTime]}),e.jsx("span",{className:"badge badge-success",children:" Tamamland"})]}),o.visitedAt&&e.jsxs("div",{className:"text-muted",style:{fontSize:12,marginTop:4},children:["Gidi: ",new Date(o.visitedAt).toLocaleString("tr-TR")]}),o.workNote&&e.jsxs("div",{style:{marginTop:8,fontSize:13},children:[e.jsx("strong",{children:"lem:"})," ",o.workNote]}),o.materials&&e.jsxs("div",{style:{marginTop:4,fontSize:13},children:[e.jsx("strong",{children:"Malzeme:"})," ",o.materials]}),o.extraCost>0&&e.jsxs("div",{style:{marginTop:4,fontSize:13,color:"var(--color-primary)"},children:[e.jsx("strong",{children:"Ekstra:"})," ",be(o.extraCost)," "]})]},o.id))})]}),t.status==="SERVIS_DEVAM_EDIYOR"&&e.jsxs("div",{className:"card",style:{border:"2px solid var(--color-warning)",background:"var(--color-warning-bg)"},children:[e.jsx("div",{className:"card-header",style:{padding:"12px 16px"},children:e.jsx("h4",{className:"card-title",style:{fontSize:14},children:" Yeni Randevu Belirle"})}),e.jsxs("div",{className:"card-body",style:{padding:16},children:[e.jsxs("div",{className:"grid grid-3",style:{gap:12},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Randevu Tarihi *"}),e.jsx(Qe,{value:I.serviceNewAppointmentDate||"",onChange:o=>me(h=>({...h,serviceNewAppointmentDate:o}))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Saat *"}),e.jsx("input",{className:"form-input",type:"time",value:I.serviceNewAppointmentTime||"10:00",onChange:o=>me(h=>({...h,serviceNewAppointmentTime:o.target.value}))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Gidi Tarihi"}),e.jsx(Qe,{value:I.serviceVisitDate||"",onChange:o=>me(h=>({...h,serviceVisitDate:o}))})]})]}),e.jsxs("div",{className:"form-group",style:{marginTop:12},children:[e.jsx("label",{className:"form-label",children:"Not"}),e.jsx("input",{className:"form-input",placeholder:"Eksik para, ilave ilem vb...",value:I.serviceNewAppointmentNote||"",onChange:o=>me(h=>({...h,serviceNewAppointmentNote:o.target.value}))})]}),e.jsx("button",{className:"btn btn-primary",type:"button",style:{marginTop:12},disabled:i||!I.serviceNewAppointmentDate,onClick:()=>{var _;const o=[...((_=t.service)==null?void 0:_.visits)||[]],h={id:o.length+1,appointmentDate:I.serviceNewAppointmentDate,appointmentTime:I.serviceNewAppointmentTime||"10:00",note:I.serviceNewAppointmentNote,visitedAt:I.serviceVisitDate?`${I.serviceVisitDate}T${I.serviceVisitTime||"10:00"}`:null,status:I.serviceVisitDate?"in_progress":"scheduled"};o.push(h),st(()=>Dt(t.id,{status:I.serviceVisitDate?"SERVIS_YAPILIYOR":"SERVIS_RANDEVULU",service:{...t.service,visits:o}}),{transition:I.serviceVisitDate?"SERVIS_YAPILIYOR":"SERVIS_RANDEVULU"})},children:I.serviceVisitDate?" Randevuyu Kaydet ve Servise Git":" Randevuyu Kaydet"})]})]}),t.status==="SERVIS_YAPILIYOR"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"card subtle-card",style:{padding:16},children:[e.jsxs("div",{className:"grid grid-3",style:{gap:16},children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-muted",style:{fontSize:12},children:"MTER"}),e.jsx("div",{style:{fontWeight:600},children:t.customerName})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-muted",style:{fontSize:12},children:"SABT CRET"}),e.jsxs("div",{style:{fontWeight:600,color:"var(--color-primary)"},children:[be(((vm=t.service)==null?void 0:vm.fixedFee)||0)," "]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-muted",style:{fontSize:12},children:"TOPLAM ZYARET"}),e.jsx("div",{style:{fontWeight:600},children:((bm=(jm=t.service)==null?void 0:jm.visits)==null?void 0:bm.length)||1})]})]}),((Nm=t.service)==null?void 0:Nm.note)&&e.jsxs("div",{style:{marginTop:12,padding:10,background:"var(--color-warning-bg)",borderRadius:6},children:[e.jsx("strong",{children:"Mteri Talebi:"})," ",t.service.note]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:" Yaplan lem Detay *"}),e.jsx("textarea",{className:"form-textarea",placeholder:"Servis srasnda yaplan ilemleri detayl yazn...",rows:3,value:I.serviceWorkNote||"",onChange:o=>me(h=>({...h,serviceWorkNote:o.target.value}))})]}),e.jsxs("div",{className:"grid grid-2",style:{gap:12},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:" Kullanlan Malzemeler"}),e.jsx("textarea",{className:"form-textarea",placeholder:"Malzeme listesi...",rows:2,value:I.serviceMaterials||"",onChange:o=>me(h=>({...h,serviceMaterials:o.target.value}))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:" Bu Ziyaret Ekstra Malzeme Tutar ()"}),e.jsx(bt,{placeholder:"0",value:I.serviceExtraCost||"",onChange:o=>me(h=>({...h,serviceExtraCost:o}))}),e.jsx("div",{className:"text-muted",style:{fontSize:11,marginTop:4},children:"Sabit crete ek malzeme tutar"})]})]}),e.jsxs("div",{className:"card subtle-card",children:[e.jsxs("div",{className:"card-header",style:{padding:"12px 16px"},children:[e.jsx("h4",{className:"card-title",style:{fontSize:14},children:" Fotoraflar (stee Bal)"}),ut&&e.jsx(ft,{size:"small"})]}),e.jsx("div",{className:"card-body",style:{padding:16},children:e.jsxs("div",{className:"grid grid-2",style:{gap:12},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"ncesi"}),e.jsxs("div",{className:"file-upload-zone",children:[e.jsx("input",{type:"file",id:"service-before-photo",accept:".jpg,.jpeg,.png,.gif,.webp",style:{display:"none"},onChange:async o=>{var _;const h=(_=o.target.files)==null?void 0:_[0];h&&(await bn(h,"servis_oncesi","Servis ncesi"),o.target.value="")}}),e.jsx("label",{htmlFor:"service-before-photo",className:"btn btn-secondary btn-small",style:{cursor:"pointer"},children:" Se"}),at.some(o=>o.type==="servis_oncesi")&&e.jsx("span",{className:"badge badge-success",style:{marginLeft:8},children:""})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Sonras"}),e.jsxs("div",{className:"file-upload-zone",children:[e.jsx("input",{type:"file",id:"service-after-photo",accept:".jpg,.jpeg,.png,.gif,.webp",style:{display:"none"},onChange:async o=>{var _;const h=(_=o.target.files)==null?void 0:_[0];h&&(await bn(h,"servis_sonrasi","Servis Sonras"),o.target.value="")}}),e.jsx("label",{htmlFor:"service-after-photo",className:"btn btn-secondary btn-small",style:{cursor:"pointer"},children:" Se"}),at.some(o=>o.type==="servis_sonrasi")&&e.jsx("span",{className:"badge badge-success",style:{marginLeft:8},children:""})]})]})]})})]}),e.jsxs("div",{style:{display:"flex",gap:12,marginTop:8},children:[e.jsx("button",{className:"btn btn-warning",type:"button",style:{flex:1},disabled:i||!I.serviceWorkNote,onClick:()=>{var _;const o=[...((_=t.service)==null?void 0:_.visits)||[]],h=o.findIndex(Y=>Y.status==="in_progress");h>=0&&(o[h]={...o[h],workNote:I.serviceWorkNote,materials:I.serviceMaterials,extraCost:Number(I.serviceExtraCost||0),status:"completed",completedAt:new Date().toISOString()}),st(()=>Dt(t.id,{status:"SERVIS_DEVAM_EDIYOR",service:{...t.service,visits:o}}),{transition:"SERVIS_DEVAM_EDIYOR"})},children:" Servis Devam Ediyor (Yeni Randevu)"}),e.jsx("button",{className:"btn btn-success",type:"button",style:{flex:1},disabled:i||!I.serviceWorkNote,onClick:()=>{var Y;const o=[...((Y=t.service)==null?void 0:Y.visits)||[]],h=o.findIndex(J=>J.status==="in_progress");h>=0&&(o[h]={...o[h],workNote:I.serviceWorkNote,materials:I.serviceMaterials,extraCost:Number(I.serviceExtraCost||0),status:"completed",completedAt:new Date().toISOString()});const _=o.reduce((J,te)=>J+(te.extraCost||0),0);st(()=>{var J;return Dt(t.id,{status:"SERVIS_ODEME_BEKLIYOR",service:{...t.service,visits:o,totalExtraCost:_,totalCost:(((J=t.service)==null?void 0:J.fixedFee)||0)+_}})},{transition:"SERVIS_ODEME_BEKLIYOR"})},children:" demeye Ge"})]}),!I.serviceWorkNote&&e.jsx("div",{className:"text-muted",style:{fontSize:12},children:' Devam etmek iin "Yaplan lem Detay" alann doldurun.'})]})]})]}),Er&&Qt("service_payment")&&(()=>{var _e,Le,ct,Ve,rt;const o=((_e=t.service)==null?void 0:_e.fixedFee)||0,h=((Le=t.service)==null?void 0:Le.totalExtraCost)||0,_=((ct=t.service)==null?void 0:ct.totalCost)||o+h,Y=Number(I.servicePaymentCash||0),J=Number(I.servicePaymentCard||0),te=Number(I.servicePaymentTransfer||0),ge=Number(I.serviceDiscount||0),xe=Y+J+te+ge,ze=_-xe;return e.jsxs("div",{className:"card",children:[Ge&&e.jsxs("div",{style:{background:"linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%)",borderBottom:"1px solid var(--color-border)",padding:"12px 16px",display:"flex",alignItems:"center",gap:10,color:"#475569"},children:[e.jsx("span",{style:{fontSize:18},children:""}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:600,fontSize:13},children:"Ariv Grnm"}),e.jsx("div",{style:{fontSize:11,opacity:.8},children:"Bu aama tamamland. Sadece grntleme modundasnz."})]})]}),e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"card-title",children:" Servis deme"})}),e.jsxs("div",{className:"card-body grid grid-1",style:{gap:16},children:[((rt=(Ve=t.service)==null?void 0:Ve.visits)==null?void 0:rt.length)>0&&e.jsxs("div",{className:"card subtle-card",children:[e.jsx("div",{className:"card-header",style:{padding:"12px 16px"},children:e.jsxs("h4",{className:"card-title",style:{fontSize:14},children:[" Ziyaret zeti (",t.service.visits.length," ziyaret)"]})}),e.jsx("div",{className:"card-body",style:{padding:0},children:t.service.visits.filter(Ce=>Ce.status==="completed").map(Ce=>e.jsx("div",{style:{padding:"12px 16px",borderBottom:"1px solid var(--color-border)"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsxs("div",{children:[e.jsxs("strong",{children:["#",Ce.id]})," - ",new Date(Ce.appointmentDate).toLocaleDateString("tr-TR"),e.jsx("div",{className:"text-muted",style:{fontSize:12},children:Ce.workNote})]}),Ce.extraCost>0&&e.jsxs("div",{style:{color:"var(--color-primary)",fontWeight:600},children:["+",be(Ce.extraCost)," "]})]})},Ce.id))})]}),e.jsx("div",{className:"card",style:{background:"var(--color-bg-secondary)",border:"2px solid var(--color-border)"},children:e.jsx("div",{style:{padding:20},children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{children:"Sabit Servis creti"}),e.jsxs("span",{style:{fontWeight:600},children:[be(o)," "]})]}),h>0&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{children:"Ekstra Malzeme Toplam"}),e.jsxs("span",{style:{fontWeight:600},children:[be(h)," "]})]}),e.jsx("div",{style:{borderTop:"2px solid var(--color-border)",paddingTop:8,marginTop:8},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{style:{fontSize:18,fontWeight:700},children:"TOPLAM"}),e.jsxs("span",{style:{fontSize:24,fontWeight:700,color:"var(--color-primary)"},children:[be(_)," "]})]})})]})})}),e.jsxs("div",{className:"card subtle-card",children:[e.jsx("div",{className:"card-header",style:{padding:"12px 16px"},children:e.jsx("h4",{className:"card-title",style:{fontSize:14},children:" deme Bilgileri"})}),e.jsxs("div",{className:"card-body",style:{padding:16},children:[e.jsxs("div",{className:"grid grid-3",style:{gap:12},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:" Nakit"}),e.jsx(bt,{placeholder:"0",value:I.servicePaymentCash||"",onChange:Ce=>me(Ae=>({...Ae,servicePaymentCash:Ce}))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:" Kredi Kart"}),e.jsx(bt,{placeholder:"0",value:I.servicePaymentCard||"",onChange:Ce=>me(Ae=>({...Ae,servicePaymentCard:Ce}))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:" Havale/EFT"}),e.jsx(bt,{placeholder:"0",value:I.servicePaymentTransfer||"",onChange:Ce=>me(Ae=>({...Ae,servicePaymentTransfer:Ce}))})]})]}),e.jsx("div",{style:{marginTop:16,padding:12,background:"var(--color-bg-secondary)",borderRadius:8},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{children:"Alnan Toplam:"}),e.jsxs("span",{style:{fontWeight:600,fontSize:18},children:[be(Y+J+te)," "]})]})})]})]}),e.jsxs("div",{className:"card subtle-card",children:[e.jsx("div",{className:"card-header",style:{padding:"12px 16px"},children:e.jsx("h4",{className:"card-title",style:{fontSize:14},children:" skonto (stee Bal)"})}),e.jsxs("div",{className:"card-body",style:{padding:16},children:[ze>0&&ge===0&&e.jsxs("div",{style:{marginBottom:12,padding:10,background:"var(--color-warning-bg)",borderRadius:6,color:"var(--color-warning-dark)"},children:[" Toplam tutara ",be(ze),"  eksik. skonto yaplacaksa aaya girin."]}),e.jsxs("div",{className:"grid grid-2",style:{gap:12},children:[e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{className:"form-label",children:["skonto Tutar ",ze>0&&ge===0?"*":""]}),e.jsx(bt,{placeholder:"0",value:I.serviceDiscount||"",onChange:Ce=>me(Ae=>({...Ae,serviceDiscount:Ce}))})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{className:"form-label",children:["skonto Aklamas ",ge>0?"*":""]}),e.jsx("input",{className:"form-input",placeholder:"rn: Sadk mteri indirimi",value:I.serviceDiscountNote||"",onChange:Ce=>me(Ae=>({...Ae,serviceDiscountNote:Ce.target.value}))})]})]}),ge>0&&!I.serviceDiscountNote&&e.jsx("div",{className:"text-muted",style:{fontSize:12,marginTop:8,color:"var(--color-danger)"},children:" skonto tutar girildiyse aklama zorunludur."})]})]}),e.jsx("div",{style:{padding:16,borderRadius:12,background:ze===0?"var(--color-success-bg)":ze>0?"var(--color-warning-bg)":"var(--color-danger-bg)",border:`2px solid ${ze===0?"var(--color-success)":ze>0?"var(--color-warning)":"var(--color-danger)"}`},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{style:{fontWeight:600},children:"Bakiye:"}),e.jsx("span",{style:{fontWeight:700,fontSize:20,color:ze===0?"var(--color-success)":ze>0?"var(--color-warning-dark)":"var(--color-danger)"},children:ze===0?" 0  (Tamam)":`${be(ze)} `})]})}),e.jsxs("div",{style:{display:"flex",gap:12,marginTop:8},children:[e.jsx("button",{className:"btn btn-warning",type:"button",style:{flex:1},disabled:i,onClick:()=>st(()=>Dt(t.id,{status:"SERVIS_DEVAM_EDIYOR",service:{...t.service,payments:{cash:Y,card:J,transfer:te},discount:ge>0?{amount:ge,note:I.serviceDiscountNote}:null}}),{transition:"SERVIS_DEVAM_EDIYOR"}),children:" Servis Devam Ediyor"}),e.jsx("button",{className:"btn btn-success",type:"button",style:{flex:1},disabled:i||ze!==0||ge>0&&!I.serviceDiscountNote,onClick:()=>st(()=>Dt(t.id,{status:"SERVIS_KAPALI",service:{...t.service,payments:{cash:Y,card:J,transfer:te},discount:ge>0?{amount:ge,note:I.serviceDiscountNote}:null,paymentStatus:"paid",completedAt:new Date().toISOString()}}),{transition:"SERVIS_KAPALI"}),children:" Servisi Kapat"})]}),ze!==0&&e.jsxs("div",{className:"text-muted",style:{fontSize:12,color:"var(--color-danger)"},children:[" Servisi kapatmak iin bakiye 0 olmal. Eksik: ",be(ze)," "]})]})]})})(),Er&&Qt("service_done")&&(()=>{var Y,J,te,ge,xe,ze,_e,Le,ct,Ve,rt,Ce,Ae,He,xt,Wt;const o=((Y=t.service)==null?void 0:Y.payments)||{},h=(o.cash||0)+(o.card||0)+(o.transfer||0),_=((te=(J=t.service)==null?void 0:J.discount)==null?void 0:te.amount)||0;return e.jsxs("div",{className:"card",style:{border:"2px solid var(--color-success)"},children:[Ge&&e.jsxs("div",{style:{background:"linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%)",borderBottom:"1px solid var(--color-border)",padding:"12px 16px",display:"flex",alignItems:"center",gap:10,color:"#475569"},children:[e.jsx("span",{style:{fontSize:18},children:""}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:600,fontSize:13},children:"Ariv Grnm"}),e.jsx("div",{style:{fontSize:11,opacity:.8},children:"Bu aama tamamland. Sadece grntleme modundasnz."})]})]}),e.jsxs("div",{className:"card-header",style:{background:"var(--color-success)",color:"white"},children:[e.jsx("h3",{className:"card-title",style:{color:"white"},children:" Servis Tamamland"}),e.jsx("span",{className:"badge",style:{background:"white",color:"var(--color-success)"},children:((ge=t.service)==null?void 0:ge.paymentStatus)==="paid"?"dendi":"deme Bekliyor"})]}),e.jsxs("div",{className:"card-body",style:{padding:20},children:[e.jsxs("div",{className:"grid grid-4",style:{gap:12,marginBottom:20},children:[e.jsxs("div",{style:{padding:16,background:"var(--color-success-bg)",borderRadius:12,textAlign:"center"},children:[e.jsx("div",{style:{fontSize:11,color:"var(--color-text-light)",marginBottom:4},children:"TOPLAM"}),e.jsxs("div",{style:{fontSize:20,fontWeight:700,color:"var(--color-success)"},children:[be(((xe=t.service)==null?void 0:xe.totalCost)||0)," "]})]}),e.jsxs("div",{style:{padding:16,background:"var(--color-bg-secondary)",borderRadius:12,textAlign:"center"},children:[e.jsx("div",{style:{fontSize:11,color:"var(--color-text-light)",marginBottom:4},children:"ZYARET"}),e.jsx("div",{style:{fontSize:20,fontWeight:600},children:((_e=(ze=t.service)==null?void 0:ze.visits)==null?void 0:_e.length)||1})]}),e.jsxs("div",{style:{padding:16,background:"var(--color-bg-secondary)",borderRadius:12,textAlign:"center"},children:[e.jsx("div",{style:{fontSize:11,color:"var(--color-text-light)",marginBottom:4},children:"ALINAN"}),e.jsxs("div",{style:{fontSize:20,fontWeight:600},children:[be(h)," "]})]}),e.jsxs("div",{style:{padding:16,background:"var(--color-bg-secondary)",borderRadius:12,textAlign:"center"},children:[e.jsx("div",{style:{fontSize:11,color:"var(--color-text-light)",marginBottom:4},children:"TARH"}),e.jsx("div",{style:{fontSize:12,fontWeight:600},children:(Le=t.service)!=null&&Le.completedAt?new Date(t.service.completedAt).toLocaleDateString("tr-TR"):"-"})]})]}),e.jsxs("div",{className:"card subtle-card",style:{marginBottom:16},children:[e.jsx("div",{className:"card-header",style:{padding:"10px 16px"},children:e.jsx("h4",{className:"card-title",style:{fontSize:13},children:" Mteri Bilgisi"})}),e.jsxs("div",{className:"card-body",style:{padding:16},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:600,fontSize:16},children:t.customerName}),e.jsx("div",{className:"text-muted",children:t.title})]}),e.jsxs("div",{style:{textAlign:"right"},children:[e.jsx("div",{className:"text-muted",style:{fontSize:11},children:" Kodu"}),e.jsx("div",{style:{fontWeight:600},children:t.id})]})]}),((ct=t.service)==null?void 0:ct.note)&&e.jsxs("div",{style:{marginTop:12,padding:10,background:"var(--color-bg-secondary)",borderRadius:6,fontSize:13},children:[e.jsx("strong",{children:"Mteri Talebi:"})," ",t.service.note]})]})]}),((rt=(Ve=t.service)==null?void 0:Ve.visits)==null?void 0:rt.length)>0&&e.jsxs("div",{className:"card subtle-card",style:{marginBottom:16},children:[e.jsx("div",{className:"card-header",style:{padding:"10px 16px"},children:e.jsx("h4",{className:"card-title",style:{fontSize:13},children:" Ziyaret Gemii"})}),e.jsx("div",{className:"card-body",style:{padding:0},children:t.service.visits.map((Ke,Ns)=>e.jsxs("div",{style:{padding:"12px 16px",borderBottom:Ns<t.service.visits.length-1?"1px solid var(--color-border)":"none",background:Ns%2===0?"transparent":"var(--color-bg-secondary)"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:4},children:[e.jsxs("strong",{children:["#",Ke.id]}),e.jsx("span",{className:"badge badge-success",style:{fontSize:10},children:""})]}),e.jsxs("div",{style:{fontSize:12,color:"var(--color-text-light)"},children:[" Randevu: ",new Date(Ke.appointmentDate).toLocaleDateString("tr-TR")," ",Ke.appointmentTime]}),Ke.visitedAt&&e.jsxs("div",{style:{fontSize:12,color:"var(--color-text-light)"},children:[" Gidi: ",new Date(Ke.visitedAt).toLocaleString("tr-TR")]})]}),Ke.extraCost>0&&e.jsxs("div",{style:{textAlign:"right"},children:[e.jsx("div",{style:{fontSize:11,color:"var(--color-text-light)"},children:"Ekstra"}),e.jsxs("div",{style:{fontWeight:600,color:"var(--color-primary)"},children:["+",be(Ke.extraCost)," "]})]})]}),Ke.workNote&&e.jsxs("div",{style:{marginTop:8,fontSize:13,padding:8,background:"var(--color-bg-secondary)",borderRadius:4},children:[" ",Ke.workNote]}),Ke.materials&&e.jsxs("div",{style:{marginTop:4,fontSize:12,color:"var(--color-text-light)"},children:[" ",Ke.materials]})]},Ke.id))})]}),e.jsxs("div",{className:"card subtle-card",style:{marginBottom:16},children:[e.jsx("div",{className:"card-header",style:{padding:"10px 16px"},children:e.jsx("h4",{className:"card-title",style:{fontSize:13},children:" deme Detaylar"})}),e.jsx("div",{className:"card-body",style:{padding:16},children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{children:"Sabit Servis creti"}),e.jsxs("span",{children:[be(((Ce=t.service)==null?void 0:Ce.fixedFee)||0)," "]})]}),(((Ae=t.service)==null?void 0:Ae.totalExtraCost)||0)>0&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between"},children:[e.jsx("span",{children:"Ekstra Malzeme"}),e.jsxs("span",{children:[be(t.service.totalExtraCost)," "]})]}),e.jsxs("div",{style:{borderTop:"1px solid var(--color-border)",paddingTop:8,display:"flex",justifyContent:"space-between",fontWeight:600},children:[e.jsx("span",{children:"Toplam"}),e.jsxs("span",{children:[be(((He=t.service)==null?void 0:He.totalCost)||0)," "]})]}),e.jsxs("div",{style:{borderTop:"1px dashed var(--color-border)",paddingTop:8,marginTop:8},children:[o.cash>0&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:13},children:[e.jsx("span",{children:" Nakit"}),e.jsxs("span",{children:[be(o.cash)," "]})]}),o.card>0&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:13},children:[e.jsx("span",{children:" Kart"}),e.jsxs("span",{children:[be(o.card)," "]})]}),o.transfer>0&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:13},children:[e.jsx("span",{children:" Havale"}),e.jsxs("span",{children:[be(o.transfer)," "]})]}),_>0&&e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",fontSize:13,color:"var(--color-warning-dark)"},children:[e.jsxs("span",{children:[" skonto (",((Wt=(xt=t.service)==null?void 0:xt.discount)==null?void 0:Wt.note)||"",")"]}),e.jsxs("span",{children:["-",be(_)," "]})]})]})]})})]}),at.filter(Ke=>Ke.type==="servis_oncesi"||Ke.type==="servis_sonrasi").length>0&&e.jsxs("div",{style:{marginBottom:16},children:[e.jsx("div",{style:{fontSize:13,fontWeight:600,marginBottom:8},children:" Fotoraflar"}),e.jsx("div",{style:{display:"flex",gap:8,flexWrap:"wrap"},children:at.filter(Ke=>Ke.type==="servis_oncesi"||Ke.type==="servis_sonrasi").map(Ke=>e.jsxs("a",{href:ys(Ke.id),target:"_blank",rel:"noopener noreferrer",style:{padding:"8px 16px",background:"var(--color-primary-bg)",borderRadius:8,fontSize:12,textDecoration:"none",color:"var(--color-primary)"},children:[" ",Ke.type==="servis_oncesi"?"ncesi":"Sonras"]},Ke.id))})]})]})]})})(),(ri==="KAPALI"||ri==="SERVIS_KAPALI")&&e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:16},children:[e.jsxs("div",{style:{background:"linear-gradient(135deg, #059669 0%, #047857 100%)",borderRadius:12,padding:"20px 24px",color:"white",display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:16},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontSize:14,opacity:.9,marginBottom:4},children:ri==="SERVIS_KAPALI"?"SERVS TAMAMLANDI":" BAARIYLA TAMAMLANDI"}),e.jsxs("div",{style:{fontSize:24,fontWeight:700,display:"flex",alignItems:"center",gap:8},children:[" ",t.title]}),e.jsxs("div",{style:{marginTop:8,fontSize:13,opacity:.9},children:[" Kapatma: ",(Sm=t.finance)!=null&&Sm.closedAt?new Date(t.finance.closedAt).toLocaleDateString("tr-TR",{day:"numeric",month:"long",year:"numeric"}):"-"]})]}),e.jsxs("div",{style:{background:"rgba(255,255,255,0.2)",padding:"16px 24px",borderRadius:8,textAlign:"center"},children:[e.jsx("div",{style:{fontSize:12,opacity:.9},children:"TOPLAM TAHSLAT"}),e.jsxs("div",{style:{fontSize:28,fontWeight:700},children:[be(((km=t.finance)==null?void 0:km.total)||$t)," "]})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(3, 1fr)",gap:16},children:[e.jsx("div",{className:"card",style:{margin:0},children:e.jsxs("div",{className:"card-body",style:{padding:16},children:[e.jsx("div",{style:{fontWeight:600,marginBottom:12,color:"#64748b",fontSize:11},children:" MTER"}),e.jsx("div",{style:{fontWeight:700,fontSize:16,marginBottom:4},children:t.customerName}),e.jsx("div",{style:{fontSize:12,color:"#64748b"},children:t.address||"-"})]})}),e.jsx("div",{className:"card",style:{margin:0},children:e.jsxs("div",{className:"card-body",style:{padding:16},children:[e.jsx("div",{style:{fontWeight:600,marginBottom:12,color:"#64748b",fontSize:11},children:"  KOLLARI"}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:6},children:((Cm=t.roles)==null?void 0:Cm.map((o,h)=>e.jsx("span",{className:"badge badge-primary",style:{fontSize:11},children:o.name||o},h)))||e.jsx("span",{className:"text-muted",children:"-"})})]})}),e.jsx("div",{className:"card",style:{margin:0},children:e.jsxs("div",{className:"card-body",style:{padding:16},children:[e.jsx("div",{style:{fontWeight:600,marginBottom:12,color:"#64748b",fontSize:11},children:" TARH ZET"}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4,fontSize:12},children:[e.jsxs("div",{children:[e.jsx("span",{style:{color:"#64748b"},children:"Balang:"})," ",t.createdAt?new Date(t.createdAt).toLocaleDateString("tr-TR"):"-"]}),e.jsxs("div",{children:[e.jsx("span",{style:{color:"#64748b"},children:"Montaj:"})," ",(Tm=(wm=t.assembly)==null?void 0:wm.schedule)!=null&&Tm.date?new Date(t.assembly.schedule.date).toLocaleDateString("tr-TR"):"-"]}),e.jsxs("div",{children:[e.jsx("span",{style:{color:"#64748b"},children:"Kapan:"})," ",(Dm=t.finance)!=null&&Dm.closedAt?new Date(t.finance.closedAt).toLocaleDateString("tr-TR"):"-"]})]})]})})]}),e.jsxs("div",{className:"card",style:{margin:0,border:"2px solid #22c55e"},children:[e.jsx("div",{className:"card-header",style:{background:"#f0fdf4",borderBottom:"1px solid #bbf7d0"},children:e.jsx("h4",{className:"card-title",style:{fontSize:14,color:"#166534"},children:" Finansal zet"})}),e.jsx("div",{className:"card-body",style:{padding:16},children:e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:16},children:[e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:600,marginBottom:12,color:"#64748b",fontSize:11,borderBottom:"1px solid #e2e8f0",paddingBottom:8},children:" N DEMELER"}),e.jsxs("div",{className:"metric-row",style:{padding:"4px 0",fontSize:13},children:[e.jsx("span",{children:"Nakit"}),e.jsxs("span",{children:[be(((Im=(zm=t.finance)==null?void 0:zm.prePayments)==null?void 0:Im.cash)||0)," "]})]}),e.jsxs("div",{className:"metric-row",style:{padding:"4px 0",fontSize:13},children:[e.jsx("span",{children:"Kart"}),e.jsxs("span",{children:[be(((Am=(Em=t.finance)==null?void 0:Em.prePayments)==null?void 0:Am.card)||0)," "]})]}),e.jsxs("div",{className:"metric-row",style:{padding:"4px 0",fontSize:13},children:[e.jsx("span",{children:"ek"}),e.jsxs("span",{children:[be(((Bm=(Rm=t.finance)==null?void 0:Rm.prePayments)==null?void 0:Bm.cheque)||0)," "]})]}),((Pm=(Lm=t.finance)==null?void 0:Lm.prePayments)==null?void 0:Pm.afterDelivery)>0&&e.jsxs("div",{className:"metric-row",style:{padding:"4px 0",fontSize:13},children:[e.jsx("span",{children:"Teslim Sonras"}),e.jsxs("span",{children:[be(((Om=(Mm=t.finance)==null?void 0:Mm.prePayments)==null?void 0:Om.afterDelivery)||0)," "]})]})]}),e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:600,marginBottom:12,color:"#64748b",fontSize:11,borderBottom:"1px solid #e2e8f0",paddingBottom:8},children:" SON DEMELER"}),e.jsxs("div",{className:"metric-row",style:{padding:"4px 0",fontSize:13},children:[e.jsx("span",{children:"Nakit"}),e.jsxs("span",{children:[be(((Fm=(_m=t.finance)==null?void 0:_m.finalPayments)==null?void 0:Fm.cash)||0)," "]})]}),e.jsxs("div",{className:"metric-row",style:{padding:"4px 0",fontSize:13},children:[e.jsx("span",{children:"Kart"}),e.jsxs("span",{children:[be(((Wm=($m=t.finance)==null?void 0:$m.finalPayments)==null?void 0:Wm.card)||0)," "]})]}),e.jsxs("div",{className:"metric-row",style:{padding:"4px 0",fontSize:13},children:[e.jsx("span",{children:"ek"}),e.jsxs("span",{children:[be(((Um=(Km=t.finance)==null?void 0:Km.finalPayments)==null?void 0:Um.cheque)||0)," "]})]})]}),e.jsxs("div",{style:{background:"#f0fdf4",padding:16,borderRadius:8},children:[e.jsx("div",{style:{fontWeight:600,marginBottom:12,color:"#166534",fontSize:11,borderBottom:"1px solid #bbf7d0",paddingBottom:8},children:" SONU"}),e.jsxs("div",{className:"metric-row",style:{padding:"4px 0",fontSize:13},children:[e.jsx("span",{children:"Teklif Tutar"}),e.jsxs("span",{style:{fontWeight:600},children:[be(((qm=t.finance)==null?void 0:qm.total)||$t)," "]})]}),((Ym=(Hm=t.finance)==null?void 0:Hm.discount)==null?void 0:Ym.amount)>0&&e.jsxs("div",{className:"metric-row",style:{padding:"4px 0",fontSize:13,color:"#b45309"},children:[e.jsx("span",{children:"skonto"}),e.jsxs("span",{children:["-",be(t.finance.discount.amount)," "]})]}),e.jsx("hr",{style:{margin:"8px 0",borderColor:"#bbf7d0"}}),e.jsxs("div",{className:"metric-row",style:{padding:"4px 0"},children:[e.jsx("span",{style:{fontWeight:700,color:"#166534"},children:"NET TAHSLAT"}),e.jsxs("span",{style:{fontWeight:700,fontSize:16,color:"#166534"},children:[be((((Vm=t.finance)==null?void 0:Vm.total)||$t)-(((Qm=(Gm=t.finance)==null?void 0:Gm.discount)==null?void 0:Qm.amount)||0))," "]})]}),((Xm=(Jm=t.finance)==null?void 0:Jm.discount)==null?void 0:Xm.note)&&e.jsxs("div",{style:{fontSize:11,color:"#64748b",marginTop:8},children:[" skonto Notu: ",t.finance.discount.note]})]})]})})]}),e.jsxs("div",{style:{background:"#f1f5f9",borderRadius:8,padding:"12px 16px",display:"flex",alignItems:"center",gap:12,fontSize:13,color:"#64748b"},children:[e.jsx("span",{style:{fontSize:18},children:""}),e.jsx("span",{children:"Bu i kapatlmtr. Deiiklik yapmak iin yetkili onay gereklidir."})]})]}),fe.length>0?e.jsxs("div",{className:"card subtle-card",children:[e.jsxs("div",{className:"card-header",style:{justifyContent:"space-between"},children:[e.jsx("h3",{className:"card-title",children:" Gnl"}),e.jsx("button",{className:"btn btn-secondary btn-small",type:"button",onClick:()=>We(o=>!o),children:ve?"Gizle":"Gster"})]}),ve?e.jsx("div",{className:"timeline",children:fe.map(o=>e.jsxs("div",{className:"timeline-item",children:[e.jsx("div",{className:"timeline-point"}),e.jsxs("div",{children:[e.jsxs("div",{className:"timeline-title",children:[new Date(o.createdAt).toLocaleString("tr-TR"),"  ",o.action]}),e.jsx("div",{className:"timeline-subtitle",children:o.detail})]})]},o.id))}):null,P?e.jsx("div",{className:"error-text",children:P}):null]}):null,i&&e.jsx("div",{className:"loader-overlay",children:e.jsx(ft,{text:"lem yaplyor..."})})]})},yN=()=>{const[t,s]=c.useState([]),[r,n]=c.useState(!0),[a,l]=c.useState("");return c.useEffect(()=>{(async()=>{try{n(!0),l("");const d=await Ny();s(d)}catch(d){l(d.message||"Montaj/sevkiyat verisi alnamad")}finally{n(!1)}})()},[]),e.jsxs("div",{children:[e.jsx(Fe,{title:"Montaj / Sevkiyat",subtitle:"lere ayrlm rnlerin sevkiyat plan"}),r?e.jsx("div",{className:"card subtle-card",children:"Sevkiyat plan ykleniyor..."}):a?e.jsxs("div",{className:"card error-card",children:[e.jsx("div",{className:"error-title",children:"Sevkiyat verisi alnamad"}),e.jsx("div",{className:"error-message",children:a})]}):e.jsx(et,{columns:[{label:" Kodu",accessor:"job"},{label:"Kalem",accessor:"item"},{label:"Miktar",accessor:"qty"},{label:"Termin",accessor:"dueDate"},{label:"Durum",accessor:"status"}],rows:t})]})},xN=()=>{const[t,s]=c.useState([]),[r,n]=c.useState(!0),[a,l]=c.useState("");return c.useEffect(()=>{(async()=>{try{n(!0),l("");const d=await jy();s(d)}catch(d){l(d.message||"Takvim verisi alnamad")}finally{n(!1)}})()},[]),e.jsxs("div",{children:[e.jsx(Fe,{title:"Keif / l Takvimi",subtitle:"lere ait keif, montaj ve teslim planlar"}),r?e.jsx("div",{className:"card subtle-card",children:"Takvim ykleniyor..."}):a?e.jsxs("div",{className:"card error-card",children:[e.jsx("div",{className:"error-title",children:"Takvim alnamad"}),e.jsx("div",{className:"error-message",children:a})]}):e.jsx(et,{columns:[{label:"Balk",accessor:"title"},{label:"Tarih",accessor:"date"},{label:"Tr",accessor:"type"},{label:"Sorumlu",accessor:"owner"},{label:"Lokasyon",accessor:"location"}],rows:t})]})},Ha={pending:"#f59e0b",in_progress:"#3b82f6",completed:"#10b981",cancelled:"#6b7280"},_i={pending:"Bekliyor",in_progress:"retimde",completed:"Tamamland",cancelled:"ptal"},vN=()=>{const[t,s]=c.useState([]),[r,n]=c.useState([]),[a,l]=c.useState([]),[i,d]=c.useState(!0),[u,f]=c.useState(""),[N,C]=c.useState(new Date),[b,L]=c.useState("monthly"),[k,E]=c.useState(null),[y,p]=c.useState(null),[m,v]=c.useState(!1);c.useEffect(()=>{z()},[]);const z=async()=>{try{d(!0),f("");const[j,B,K]=await Promise.all([Dy().catch(()=>[]),zr().catch(()=>[]),jn(!0).catch(()=>[])]),se=j.filter(oe=>oe.orderType==="internal"&&oe.status!=="cancelled").map(oe=>{var we,Ee;const O=B.find(T=>T.id===oe.jobId),ce=K.find(T=>T.id===oe.roleId),je=((we=ce==null?void 0:ce.name)==null?void 0:we.substring(0,3).toUpperCase())||"";return{...oe,customerName:((Ee=O==null?void 0:O.customer)==null?void 0:Ee.name)||"",jobTitle:(O==null?void 0:O.title)||oe.jobTitle||"",roleName:(ce==null?void 0:ce.name)||oe.roleName||"",roleShort:je}});s(se),n(B),l(K)}catch(j){f(j.message||"Veriler alnamad")}finally{d(!1)}},W=j=>{var K;const B=r.find(se=>se.id===j);return((K=B==null?void 0:B.estimatedAssembly)==null?void 0:K.date)||null},F=c.useMemo(()=>{const j=N.getFullYear(),B=N.getMonth(),K=new Date(j,B,1),se=new Date(j,B+1,0);let oe=K.getDay();oe=oe===0?6:oe-1;const O=[];for(let je=oe-1;je>=0;je--){const we=new Date(j,B,-je);O.push({date:we,isCurrentMonth:!1})}for(let je=1;je<=se.getDate();je++)O.push({date:new Date(j,B,je),isCurrentMonth:!0});const ce=42-O.length;for(let je=1;je<=ce;je++)O.push({date:new Date(j,B+1,je),isCurrentMonth:!1});return O},[N]),q=c.useMemo(()=>{const j=new Date(N),B=j.getDay(),K=B===0?-6:1-B,se=new Date(j);se.setDate(j.getDate()+K);const oe=[];for(let O=0;O<7;O++){const ce=new Date(se);ce.setDate(se.getDate()+O),oe.push({date:ce,isCurrentMonth:!0})}return oe},[N]),X=b==="monthly"?F:q,Q=j=>{const B=j.toISOString().split("T")[0];return t.filter(K=>K.plannedDate===B)},A=c.useMemo(()=>t.filter(j=>!j.plannedDate&&j.status!=="completed"),[t]),ue=(j,B)=>{E(B),j.dataTransfer.effectAllowed="move"},Z=j=>{j.preventDefault(),j.dataTransfer.dropEffect="move"},ae=(j,B)=>{if(j.preventDefault(),!k)return;const K=W(k.jobId);if(K){const O=new Date(K);if(B>O){alert(" retim tarihi montaj tarihinden sonra olamaz!"),E(null);return}}const se=B.toISOString().split("T")[0],oe=k.id;s(O=>O.map(ce=>ce.id===oe?{...ce,plannedDate:se}:ce)),E(null),kh(oe,{plannedDate:se}).catch(O=>{console.error("Plan kaydedilemedi:",O),z(),alert("Plan kaydedilemedi: "+(O.message||"Bilinmeyen hata"))})},$=j=>{if(j.preventDefault(),!k||!k.plannedDate)return;const B=k.id;s(K=>K.map(se=>se.id===B?{...se,plannedDate:null}:se)),E(null),kh(B,{plannedDate:null}).catch(K=>{console.error("Plan kaldrlamad:",K),z(),alert("Plan kaldrlamad: "+(K.message||"Bilinmeyen hata"))})},ne=()=>{E(null)},U=j=>{const B=new Date(N);b==="monthly"?B.setMonth(B.getMonth()+j):B.setDate(B.getDate()+j*7),C(B)},pe=()=>{C(new Date)},V=j=>{p(j),v(!0)},D=new Date;D.setHours(0,0,0,0);const S=["Ocak","ubat","Mart","Nisan","Mays","Haziran","Temmuz","Austos","Eyll","Ekim","Kasm","Aralk"],g=["Pzt","Sal","ar","Per","Cum","Cmt","Paz"],x=["Pazartesi","Sal","aramba","Perembe","Cuma","Cumartesi","Pazar"],M=j=>j?new Date(j).toLocaleDateString("tr-TR"):"-",w=()=>{if(q.length===0)return"";const j=q[0].date,B=q[6].date;return`${j.getDate()} ${S[j.getMonth()]} - ${B.getDate()} ${S[B.getMonth()]} ${B.getFullYear()}`};return i?e.jsx(ft,{text:"retim plan ykleniyor..."}):u?e.jsxs("div",{children:[e.jsx(Fe,{title:"retim Plan",subtitle:"Takvim bazl retim planlamas"}),e.jsxs("div",{className:"card error-card",children:[e.jsx("div",{className:"error-title",children:"Hata"}),e.jsx("div",{className:"error-message",children:u})]})]}):e.jsxs("div",{children:[e.jsx(Fe,{title:"retim Plan",subtitle:" retim emirlerini takvime srkle-brak ile planlayn"}),e.jsxs("div",{style:{display:"flex",gap:24},children:[e.jsx("div",{style:{width:320,flexShrink:0},children:e.jsxs("div",{className:"card",style:{padding:20,border:k!=null&&k.plannedDate?"2px dashed var(--color-primary)":void 0,transition:"border 0.2s",height:b==="weekly"?"auto":"calc(100vh - 220px)",display:"flex",flexDirection:"column"},onDragOver:Z,onDrop:$,children:[e.jsxs("h4",{style:{marginBottom:12,display:"flex",alignItems:"center",gap:8},children:[" Planlanmam Emirler",e.jsx("span",{className:"badge badge-warning",style:{fontSize:12},children:A.length})]}),e.jsx("div",{style:{fontSize:12,color:"var(--color-text-muted)",marginBottom:16},children:"Takvime srkleyin veya takvimden buraya geri brakn"}),e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:10,flex:1,overflowY:"auto"},children:A.length===0?e.jsx("div",{className:"text-muted",style:{textAlign:"center",padding:40,background:"var(--color-bg-secondary)",borderRadius:12,border:"2px dashed var(--color-border)"},children:k!=null&&k.plannedDate?e.jsx("span",{style:{color:"var(--color-primary)",fontSize:14},children:" Buraya brakn"}):e.jsx(e.Fragment,{children:" Tm emirler planland"})}):A.map(j=>{var K;const B=W(j.jobId);return e.jsxs("div",{draggable:!0,onDragStart:se=>ue(se,j),onDragEnd:ne,onClick:()=>V(j),style:{padding:"14px 16px",background:"var(--color-bg-secondary)",borderRadius:10,cursor:"grab",borderLeft:`5px solid ${Ha[j.status]||"#ccc"}`,transition:"transform 0.1s, box-shadow 0.1s"},onMouseEnter:se=>{se.currentTarget.style.transform="scale(1.02)",se.currentTarget.style.boxShadow="0 4px 12px rgba(0,0,0,0.15)"},onMouseLeave:se=>{se.currentTarget.style.transform="scale(1)",se.currentTarget.style.boxShadow="none"},title:"Detay iin tklayn, takvime srkleyip brakn",children:[e.jsxs("div",{style:{fontWeight:700,fontSize:15,color:"var(--color-primary)",marginBottom:6},children:[" ",j.customerName||"Mteri Yok"]}),e.jsx("div",{style:{display:"inline-block",background:"var(--color-primary)",color:"#fff",padding:"3px 10px",borderRadius:12,fontSize:12,fontWeight:600,marginBottom:6},children:j.roleName||" Kolu"}),e.jsx("div",{style:{fontSize:12,color:"var(--color-text-muted)",marginTop:4},children:j.id}),e.jsxs("div",{style:{display:"flex",gap:6,marginTop:8,flexWrap:"wrap"},children:[e.jsx("span",{className:`badge badge-${j.status==="pending"?"warning":"primary"}`,style:{fontSize:10},children:_i[j.status]||j.status}),((K=j.items)==null?void 0:K.length)>0&&e.jsxs("span",{className:"badge badge-secondary",style:{fontSize:10},children:[j.items.length," kalem"]})]}),B&&e.jsxs("div",{style:{fontSize:11,color:"var(--color-info)",marginTop:6},children:[" Montaj: ",M(B)]})]},j.id)})})]})}),e.jsxs("div",{style:{flex:1,minWidth:0},children:[e.jsxs("div",{className:"card",style:{padding:20},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:20},children:[e.jsxs("button",{className:"btn btn-secondary",onClick:()=>U(-1),title:b==="monthly"?"nceki Ay":"nceki Hafta",children:[" ",b==="monthly"?"nceki Ay":"nceki Hafta"]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:16},children:[e.jsx("h2",{style:{margin:0,fontSize:22},children:b==="monthly"?`${S[N.getMonth()]} ${N.getFullYear()}`:w()}),e.jsx("button",{className:"btn btn-sm btn-outline",onClick:pe,style:{fontSize:12,padding:"6px 14px"},children:"Bugn"}),e.jsxs("div",{style:{display:"flex",background:"var(--color-bg-secondary)",borderRadius:8,padding:3},children:[e.jsx("button",{onClick:()=>L("monthly"),style:{padding:"8px 16px",border:"none",borderRadius:6,cursor:"pointer",fontSize:13,fontWeight:600,background:b==="monthly"?"var(--color-primary)":"transparent",color:b==="monthly"?"#fff":"var(--color-text-secondary)",transition:"all 0.2s"},children:" Aylk"}),e.jsx("button",{onClick:()=>L("weekly"),style:{padding:"8px 16px",border:"none",borderRadius:6,cursor:"pointer",fontSize:13,fontWeight:600,background:b==="weekly"?"var(--color-primary)":"transparent",color:b==="weekly"?"#fff":"var(--color-text-secondary)",transition:"all 0.2s"},children:" Haftalk"})]})]}),e.jsxs("button",{className:"btn btn-secondary",onClick:()=>U(1),title:b==="monthly"?"Sonraki Ay":"Sonraki Hafta",children:[b==="monthly"?"Sonraki Ay":"Sonraki Hafta"," "]})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:8,marginBottom:8},children:(b==="weekly"?x:g).map((j,B)=>e.jsx("div",{style:{textAlign:"center",fontWeight:700,fontSize:b==="weekly"?14:13,padding:b==="weekly"?12:10,color:"var(--color-text-secondary)",background:"var(--color-bg-secondary)",borderRadius:8},children:j},j))}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:8},children:X.map((j,B)=>{const{date:K,isCurrentMonth:se}=j,oe=K.toDateString()===D.toDateString(),O=Q(K),ce=K<D,je=b==="weekly"?300:140,we=b==="weekly"?8:3;return e.jsxs("div",{onDragOver:Z,onDrop:Ee=>ae(Ee,K),style:{minHeight:je,padding:b==="weekly"?12:10,background:oe?"rgba(59, 130, 246, 0.1)":ce&&se?"rgba(0,0,0,0.02)":"var(--color-bg-secondary)",borderRadius:10,border:oe?"2px solid var(--color-primary)":"1px solid var(--color-border)",opacity:se?1:.4,transition:"background 0.2s, transform 0.1s"},onDragEnter:Ee=>{Ee.currentTarget.style.background="rgba(59, 130, 246, 0.15)"},onDragLeave:Ee=>{Ee.currentTarget.style.background=oe?"rgba(59, 130, 246, 0.1)":ce&&se?"rgba(0,0,0,0.02)":"var(--color-bg-secondary)"},children:[e.jsxs("div",{style:{fontWeight:oe?700:600,fontSize:b==="weekly"?18:14,marginBottom:8,color:oe?"var(--color-primary)":"inherit",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{children:K.getDate()}),O.length>0&&e.jsx("span",{style:{background:"var(--color-primary)",color:"#fff",borderRadius:"50%",width:22,height:22,display:"flex",alignItems:"center",justifyContent:"center",fontSize:11,fontWeight:700},children:O.length})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:4},children:[O.slice(0,we).map(Ee=>e.jsxs("div",{draggable:!0,onDragStart:T=>ue(T,Ee),onDragEnd:ne,onClick:T=>{T.stopPropagation(),V(Ee)},style:{padding:b==="weekly"?"8px 10px":"5px 8px",background:Ha[Ee.status]||"#ccc",color:"white",borderRadius:6,fontSize:b==="weekly"?12:11,fontWeight:600,cursor:"grab",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",transition:"transform 0.1s"},onMouseEnter:T=>{T.currentTarget.style.transform="scale(1.03)"},onMouseLeave:T=>{T.currentTarget.style.transform="scale(1)"},title:`${Ee.customerName||"Mteri Yok"} - ${Ee.roleName||" Kolu"}
Detay iin tklayn`,children:[e.jsx("span",{children:Ee.customerName||"Mteri"}),Ee.roleShort&&e.jsx("span",{style:{marginLeft:6,background:"rgba(255,255,255,0.3)",padding:"1px 5px",borderRadius:4,fontSize:b==="weekly"?10:9},children:Ee.roleShort})]},Ee.id)),O.length>we&&e.jsxs("div",{style:{fontSize:11,color:"var(--color-primary)",textAlign:"center",padding:4,background:"rgba(59, 130, 246, 0.1)",borderRadius:4,cursor:"pointer",fontWeight:600},onClick:()=>{V(O[we])},children:["+",O.length-we," daha"]})]})]},B)})})]}),e.jsxs("div",{style:{display:"flex",gap:20,marginTop:16,justifyContent:"center",flexWrap:"wrap",alignItems:"center"},children:[Object.entries(Ha).map(([j,B])=>e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("div",{style:{width:14,height:14,borderRadius:4,background:B}}),e.jsx("span",{style:{fontSize:12,fontWeight:500},children:_i[j]})]},j)),e.jsx("div",{style:{fontSize:12,color:"var(--color-text-muted)",marginLeft:24},children:" Tklayarak detay grn, srkleyerek tayn"})]})]})]}),e.jsx(Be,{isOpen:m,onClose:()=>v(!1),title:"Emir Detay",size:"md",children:y&&e.jsxs("div",{style:{padding:8},children:[e.jsx("div",{style:{background:"linear-gradient(135deg, var(--color-primary) 0%, #6366f1 100%)",padding:20,borderRadius:12,marginBottom:20,color:"#fff"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start"},children:[e.jsxs("div",{children:[e.jsxs("div",{style:{fontWeight:700,fontSize:22,marginBottom:6},children:[" ",y.customerName||"Mteri Bilgisi Yok"]}),e.jsx("div",{style:{display:"inline-block",background:"rgba(255,255,255,0.2)",padding:"4px 12px",borderRadius:16,fontSize:13,fontWeight:600,marginBottom:8},children:y.roleName||" Kolu"}),e.jsxs("div",{style:{fontSize:12,opacity:.9,marginTop:4},children:[" No: ",y.jobId]})]}),e.jsx("span",{style:{background:Ha[y.status]||"#ccc",padding:"6px 14px",borderRadius:20,fontSize:12,fontWeight:600},children:_i[y.status]||y.status})]})}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:20,marginBottom:20},children:[e.jsxs("div",{style:{background:"var(--color-bg-secondary)",padding:16,borderRadius:10},children:[e.jsx("div",{className:"text-muted",style:{fontSize:11,marginBottom:6},children:"Emir No"}),e.jsx("div",{style:{fontWeight:700,fontSize:14},children:y.id})]}),e.jsxs("div",{style:{background:"var(--color-bg-secondary)",padding:16,borderRadius:10},children:[e.jsx("div",{className:"text-muted",style:{fontSize:11,marginBottom:6},children:"Oluturulma"}),e.jsx("div",{style:{fontWeight:600},children:M(y.createdAt)})]}),e.jsxs("div",{style:{background:"var(--color-bg-secondary)",padding:16,borderRadius:10},children:[e.jsx("div",{className:"text-muted",style:{fontSize:11,marginBottom:6},children:"Planlanan Tarih"}),e.jsx("div",{style:{fontWeight:700,fontSize:14,color:y.plannedDate?"var(--color-primary)":"var(--color-text-muted)"},children:y.plannedDate?M(y.plannedDate):"Planlanmad"})]}),e.jsxs("div",{style:{background:"var(--color-bg-secondary)",padding:16,borderRadius:10},children:[e.jsx("div",{className:"text-muted",style:{fontSize:11,marginBottom:6},children:"Montaj Tarihi"}),e.jsx("div",{style:{fontWeight:600,color:"var(--color-info)"},children:M(W(y.jobId))})]})]}),y.items&&y.items.length>0&&e.jsxs("div",{style:{marginBottom:20},children:[e.jsx("div",{style:{fontWeight:700,marginBottom:12,fontSize:15},children:" retim Kalemleri"}),e.jsxs("table",{className:"data-table",style:{fontSize:13},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"rn"}),e.jsx("th",{style:{textAlign:"right"},children:"Miktar"}),e.jsx("th",{style:{textAlign:"right"},children:"Birim"})]})}),e.jsx("tbody",{children:y.items.map((j,B)=>e.jsxs("tr",{children:[e.jsx("td",{style:{fontWeight:500},children:j.name||j.productId||"-"}),e.jsx("td",{style:{textAlign:"right",fontWeight:600},children:j.quantity}),e.jsx("td",{style:{textAlign:"right"},children:j.unit||"adet"})]},B))})]})]}),y.notes&&e.jsxs("div",{style:{marginBottom:20},children:[e.jsx("div",{style:{fontWeight:700,marginBottom:8,fontSize:15},children:" Notlar"}),e.jsx("div",{style:{background:"var(--color-bg-secondary)",padding:16,borderRadius:10,fontSize:14,lineHeight:1.6},children:y.notes})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:10,paddingTop:16,borderTop:"1px solid var(--color-border)"},children:[e.jsx("button",{className:"btn btn-secondary",onClick:()=>v(!1),style:{padding:"10px 20px"},children:"Kapat"}),e.jsx("button",{className:"btn btn-primary",style:{padding:"10px 20px"},onClick:()=>{window.location.href=`/isler/list?job=${y.jobId}&stage=4`},children:"e Git "})]})]})})]})},jN=()=>e.jsxs("div",{children:[e.jsx(Fe,{title:"Sayfa bulunamad",subtitle:"Aradnz sayfa kaldrlm olabilir"}),e.jsx("div",{className:"card subtle-card",children:e.jsxs("div",{className:"empty-state",children:[e.jsx("div",{className:"empty-state-icon",children:""}),e.jsx("div",{className:"empty-state-title",children:"404"}),e.jsx("div",{className:"empty-state-description",children:"Yanl bir balantya tkladysanz menden doru modl seebilirsiniz."}),e.jsx(gs,{className:"btn btn-primary",to:"/dashboard",children:"Kontrol Paneline Dn"})]})})]}),bN=()=>{const[t,s]=c.useState([]),[r,n]=c.useState(!0),[a,l]=c.useState("");return c.useEffect(()=>{(async()=>{try{n(!0),l("");const d=await jy();s(d)}catch(d){l(d.message||"Planlama verisi alnamad")}finally{n(!1)}})()},[]),e.jsxs("div",{children:[e.jsx(Fe,{title:"Planlama / Takvim",subtitle:"Keif, montaj ve teslim planlarnz takip edin"}),r?e.jsx("div",{className:"card subtle-card",children:"Planlama ykleniyor..."}):a?e.jsxs("div",{className:"card error-card",children:[e.jsx("div",{className:"error-title",children:"Planlama alnamad"}),e.jsx("div",{className:"error-message",children:a})]}):e.jsx(et,{columns:[{label:"Balk",accessor:"title"},{label:"Tarih",accessor:"date"},{label:"Tr",accessor:"type"},{label:"Sorumlu",accessor:"owner"},{label:"Lokasyon",accessor:"location"}],rows:t})]})},NN=()=>{const[t,s]=c.useState([]),[r,n]=c.useState(!0),[a,l]=c.useState("");return c.useEffect(()=>{(async()=>{try{n(!0),l("");const d=await f0();s(d)}catch(d){l(d.message||"Raporlar alnamad")}finally{n(!1)}})()},[]),e.jsxs("div",{children:[e.jsx(Fe,{title:"Raporlar",subtitle:"Hazr ve devam eden raporlar"}),r?e.jsx("div",{className:"card subtle-card",children:"Raporlar ykleniyor..."}):a?e.jsxs("div",{className:"card error-card",children:[e.jsx("div",{className:"error-title",children:"Raporlar alnamad"}),e.jsx("div",{className:"error-message",children:a})]}):e.jsx(et,{columns:[{label:"Rapor",accessor:"title"},{label:"Periyot",accessor:"period"},{label:"Durum",accessor:"status"},{label:"Sahip",accessor:"owner"}],rows:t})]})},SN=()=>{const[t,s]=c.useState([]),[r,n]=c.useState([]),[a,l]=c.useState(!0),[i,d]=c.useState("");c.useEffect(()=>{(async()=>{try{l(!0),d("");const[N,C]=await Promise.all([p0(),ky()]);s(N),n(C)}catch(N){d(N.message||"Satnalma verisi alnamad")}finally{l(!1)}})()},[]);const u=c.useMemo(()=>{const f=t.filter(b=>b.status.toLowerCase().includes("onay")).length,N=t.filter(b=>b.status.toLowerCase().includes("yolda")).length,C=r.length;return[{id:"po1",label:"Toplam PO",value:t.length,icon:"",tone:"primary"},{id:"po2",label:"Onay Bekleyen",value:f,icon:"",tone:"warning"},{id:"po3",label:"Yolda",value:N,icon:"",tone:"secondary"},{id:"po4",label:"Tedariki",value:C,icon:"",tone:"success"}]},[t,r]);return e.jsxs("div",{children:[e.jsx(Fe,{title:"Satnalma",subtitle:"PO, tedariki ve talepler iin zet"}),a?e.jsx("div",{className:"card subtle-card",children:"Satnalma verisi ykleniyor..."}):i?e.jsxs("div",{className:"card error-card",children:[e.jsx("div",{className:"error-title",children:"Veri alnamad"}),e.jsx("div",{className:"error-message",children:i})]}):e.jsx("div",{className:"stats-grid",children:u.map(f=>e.jsx(Ks,{icon:f.icon,label:f.label,value:f.value,tone:f.tone},f.id))})]})},Cs=({value:t,onChange:s,min:r=0,max:n,step:a=1,placeholder:l="",className:i="form-input",allowEmpty:d=!1,...u})=>{const[f,N]=c.useState(()=>t===0||t==="0"||t===""||t===null||t===void 0?"":String(t));c.useEffect(()=>{N(t===0||t==="0"||t===""||t===null||t===void 0?"":String(t))},[t]);const C=k=>{const E=k.target.value;if(E!==""&&!/^-?\d*\.?\d*$/.test(E))return;if(N(E),E===""||E==="-"){d&&s("");return}const y=a%1===0?parseInt(E,10):parseFloat(E);if(!isNaN(y)){let p=y;r!==void 0&&y<r&&(p=r),n!==void 0&&y>n&&(p=n),s(p)}},b=()=>{if(f===""||f==="-")d||(N(r>0?String(r):""),s(r));else{const k=a%1===0?parseInt(f,10):parseFloat(f);if(!isNaN(k)){let E=k;r!==void 0&&k<r&&(E=r),n!==void 0&&k>n&&(E=n),N(String(E)),s(E)}}},L=k=>{k.target.select()};return e.jsx("input",{type:"text",inputMode:"numeric",pattern:"[0-9]*",className:i,value:f,onChange:C,onBlur:b,onFocus:L,placeholder:l||(r>0?String(r):"0"),...u})},_r=t=>new Intl.NumberFormat("tr-TR").format(t||0),Ms=t=>new Intl.NumberFormat("tr-TR",{style:"currency",currency:"TRY",maximumFractionDigits:0}).format(t||0),Fr={draft:{label:"Taslak",tone:"secondary",icon:""},sent:{label:"Gnderildi",tone:"primary",icon:""},partial:{label:"Ksmi Teslim",tone:"warning",icon:""},delivered:{label:"Tamamland",tone:"success",icon:""}},Bh={supplierId:"",supplierName:"",notes:"",expectedDate:"",items:[]},Fi={productCode:"",colorCode:"",productName:"",quantity:1,unit:"boy",unitCost:0},kN={items:[],note:"",receivedBy:"",waybillFile:null},CN=()=>{var De,Me,ee,fe,qe;const[t,s]=c.useState([]),[r,n]=c.useState([]),[a,l]=c.useState([]),[i,d]=c.useState(!0),[u,f]=c.useState(""),[N,C]=c.useState(""),[b,L]=c.useState("all"),[k,E]=c.useState("all"),[y,p]=c.useState(!1),[m,v]=c.useState(Bh),[z,W]=c.useState(Fi),[F,q]=c.useState(!1),[X,Q]=c.useState(!1),[A,ue]=c.useState(null),[Z,ae]=c.useState(!1),[$,ne]=c.useState(!1),[U,pe]=c.useState(kN),[V,D]=c.useState(""),[S,g]=c.useState([]),[x,M]=c.useState(!1),[w,j]=c.useState([]),[B,K]=c.useState(null);c.useEffect(()=>{se()},[]);const se=async()=>{try{d(!0),f("");const[P,de,ve]=await Promise.all([qc(),cr(),Hc().catch(()=>[])]);s(P),n(de),l(ve)}catch(P){f(P.message||"Veriler alnamad")}finally{d(!1)}};c.useEffect(()=>{if(!V||V.length<2){g([]);return}const P=setTimeout(async()=>{try{const de=await Ty(V,"");g(de.slice(0,10))}catch(de){console.error("Product search error:",de)}},300);return()=>clearTimeout(P)},[V]);const oe=c.useMemo(()=>{let P=[...t];if(N){const de=N.toLowerCase();P=P.filter(ve=>ve.id.toLowerCase().includes(de)||(ve.supplierName||"").toLowerCase().includes(de))}return b!=="all"&&(P=P.filter(de=>de.status===b)),k!=="all"&&(P=P.filter(de=>de.supplierId===k)),P.sort((de,ve)=>new Date(ve.createdAt)-new Date(de.createdAt))},[t,N,b,k]),O=c.useMemo(()=>{const P=t.length,de=t.filter(tt=>tt.status==="draft").length,ve=t.filter(tt=>["sent","partial"].includes(tt.status)).length,We=t.reduce((tt,H)=>tt+(H.totalAmount||0),0);return{total:P,draft:de,pending:ve,totalAmount:We}},[t]),ce=()=>{v(Bh),W(Fi),D(""),g([]),p(!0)},je=()=>{j([]),M(!0)},we=P=>{W({productCode:P.productCode,colorCode:P.colorCode,productName:`${P.name} ${P.colorName||""}`.trim(),quantity:1,unit:P.unit||"boy",unitCost:P.unitCost||0}),D(""),g([])},Ee=()=>{!z.productCode||z.quantity<=0||(v(P=>P.items.find(ve=>ve.productCode===z.productCode&&ve.colorCode===z.colorCode)?{...P,items:P.items.map(ve=>ve.productCode===z.productCode&&ve.colorCode===z.colorCode?{...ve,quantity:ve.quantity+z.quantity}:ve)}:{...P,items:[...P.items,{...z}]}),W(Fi))},T=(P,de)=>{v(ve=>({...ve,items:ve.items.filter(We=>!(We.productCode===P&&We.colorCode===de))}))},re=P=>{var H;const de=r.find(G=>G.id===P.supplierId)||{},ve=window.open("","_blank");if(!ve){alert("Pop-up engellendi. Ltfen pop-up izni verin.");return}const We=(P.items||[]).map((G,Se)=>`
      <tr>
        <td style="padding: 8px; border-bottom: 1px solid #ddd;">${Se+1}</td>
        <td style="padding: 8px; border-bottom: 1px solid #ddd;">${G.productName||G.productCode}</td>
        <td style="padding: 8px; border-bottom: 1px solid #ddd;">${G.productCode}</td>
        <td style="padding: 8px; border-bottom: 1px solid #ddd;">${G.colorCode||"-"}</td>
        <td style="padding: 8px; border-bottom: 1px solid #ddd; text-align: center;">${G.quantity} ${G.unit||"adet"}</td>
        <td style="padding: 8px; border-bottom: 1px solid #ddd; text-align: right;">${Ms(G.unitCost||0)}</td>
        <td style="padding: 8px; border-bottom: 1px solid #ddd; text-align: right;">${Ms((G.quantity||0)*(G.unitCost||0))}</td>
      </tr>
    `).join(""),tt=`
      <!DOCTYPE html>
      <html lang="tr">
      <head>
        <meta charset="UTF-8">
        <title>Tedarik Siparii - ${P.id}</title>
        <style>
          body { font-family: Arial, sans-serif; padding: 20px; color: #333; }
          .header { display: flex; justify-content: space-between; margin-bottom: 30px; border-bottom: 2px solid #333; padding-bottom: 20px; }
          .company { font-size: 20px; font-weight: bold; }
          .order-info { text-align: right; }
          .order-number { font-size: 18px; font-weight: bold; color: #0066cc; }
          .section { margin-bottom: 20px; }
          .section-title { font-weight: bold; margin-bottom: 10px; font-size: 14px; color: #666; border-bottom: 1px solid #ddd; padding-bottom: 5px; }
          table { width: 100%; border-collapse: collapse; margin-top: 10px; }
          th { background: #f5f5f5; padding: 10px 8px; text-align: left; font-weight: 600; border-bottom: 2px solid #ddd; }
          .total-row { font-weight: bold; background: #f9f9f9; }
          .footer { margin-top: 40px; padding-top: 20px; border-top: 1px solid #ddd; text-align: center; font-size: 12px; color: #666; }
          @media print {
            body { padding: 0; }
            .no-print { display: none; }
          }
        </style>
      </head>
      <body>
        <div class="header">
          <div class="company">TEDARK SPAR</div>
          <div class="order-info">
            <div class="order-number">${P.id}</div>
            <div>Tarih: ${new Date(P.createdAt).toLocaleDateString("tr-TR")}</div>
            <div>Durum: ${((H=Fr[P.status])==null?void 0:H.label)||P.status}</div>
          </div>
        </div>

        <div class="section">
          <div class="section-title"> TEDARK BLGLER</div>
          <div><strong>${de.name||"Belirtilmemi"}</strong></div>
          ${de.phone?`<div>Tel: ${de.phone}</div>`:""}
          ${de.email?`<div>E-posta: ${de.email}</div>`:""}
          ${de.address?`<div>Adres: ${de.address}</div>`:""}
        </div>

        <div class="section">
          <div class="section-title"> SPAR KALEMLER</div>
          <table>
            <thead>
              <tr>
                <th style="width: 40px">#</th>
                <th>rn Ad</th>
                <th>rn Kodu</th>
                <th>Renk</th>
                <th style="text-align: center;">Miktar</th>
                <th style="text-align: right;">Birim Fiyat</th>
                <th style="text-align: right;">Toplam</th>
              </tr>
            </thead>
            <tbody>
              ${We}
              <tr class="total-row">
                <td colspan="6" style="padding: 10px 8px; text-align: right;">GENEL TOPLAM:</td>
                <td style="padding: 10px 8px; text-align: right;">${Ms(P.totalAmount||0)}</td>
              </tr>
            </tbody>
          </table>
        </div>

        ${P.notes?`
          <div class="section">
            <div class="section-title"> NOTLAR</div>
            <div>${P.notes}</div>
          </div>
        `:""}

        <div class="footer">
          Bu belge ${new Date().toLocaleString("tr-TR")} tarihinde oluturulmutur.
        </div>

        <script>
          window.onload = function() { window.print(); }
        <\/script>
      </body>
      </html>
    `;ve.document.write(tt),ve.document.close()},ke=async P=>{if(P.preventDefault(),!(!m.supplierId||m.items.length===0))try{q(!0);const de=r.find(tt=>tt.id===m.supplierId),ve={supplierId:m.supplierId,supplierName:(de==null?void 0:de.name)||m.supplierName,items:m.items,notes:m.notes,expectedDate:m.expectedDate,relatedJobs:[]},We=await _o(ve);s(tt=>[We,...tt]),p(!1)}catch(de){f(de.message||"Sipari oluturulamad")}finally{q(!1)}},Ie=async()=>{if(w.length===0)return;const P={};w.forEach(de=>{const ve=de.supplierId;P[ve]||(P[ve]={supplierId:de.supplierId,supplierName:de.supplierName,items:[]}),P[ve].items.push({productCode:de.productCode,colorCode:de.colorCode,productName:`${de.name} ${de.colorName||""}`.trim(),quantity:de.suggestedQty,unit:de.unit,unitCost:0})});try{q(!0);const de=[];for(const ve of Object.values(P)){const We=await _o({supplierId:ve.supplierId,supplierName:ve.supplierName,items:ve.items,notes:"Kritik stok siparii",expectedDate:"",relatedJobs:[]});de.push(We)}s(ve=>[...de,...ve]),M(!1),await se()}catch(de){f(de.message||"Sipari oluturulamad")}finally{q(!1)}},Ne=async P=>{ue(P),Q(!0)},Re=async P=>{try{q(!0);const de=await v0(P);s(ve=>ve.map(We=>We.id===P?de:We)),(A==null?void 0:A.id)===P&&ue(de)}catch(de){f(de.message||"Sipari gnderilemedi")}finally{q(!1)}},Oe=()=>{A&&(pe({items:A.items.map(P=>({productCode:P.productCode,colorCode:P.colorCode,productName:P.productName,ordered:P.quantity,received:P.receivedQty||0,remaining:P.quantity-(P.receivedQty||0),quantity:0})),note:"",receivedBy:""}),ne(!0))},R=async P=>{if(P.preventDefault(),!A)return;const de=U.items.filter(ve=>ve.quantity>0).map(ve=>({productCode:ve.productCode,colorCode:ve.colorCode,quantity:ve.quantity}));if(de.length!==0)try{q(!0);const ve=await j0(A.id,{items:de,note:U.note,receivedBy:U.receivedBy});if(U.waybillFile)try{await ba(U.waybillFile,A.jobId||`PO-${A.id}`,"irsaliye",`Teslimat rsaliyesi - ${A.id} - ${new Date().toLocaleDateString("tr-TR")}`)}catch(We){console.warn("rsaliye yklenemedi:",We)}s(We=>We.map(tt=>tt.id===A.id?ve:tt)),ue(ve),ne(!1),await se()}catch(ve){f(ve.message||"Teslimat kaydedilemedi")}finally{q(!1)}},le=async()=>{if(B)try{q(!0),await b0(B.id),s(P=>P.filter(de=>de.id!==B.id)),K(null)}catch(P){f(P.message||"Silinemedi")}finally{q(!1)}},ie=()=>{const P=["Sipari No","Tedariki","Durum","Toplam Tutar","Beklenen Tarih","Oluturulma"],de=oe.map(G=>{var Se,I;return[G.id,G.supplierName,((Se=Fr[G.status])==null?void 0:Se.label)||G.status,G.totalAmount||0,G.expectedDate||"-",((I=G.createdAt)==null?void 0:I.slice(0,10))||"-"]}),ve=[P.join(","),...de.map(G=>G.map(Se=>`"${Se}"`).join(","))].join(`
`),We=new Blob([ve],{type:"text/csv;charset=utf-8;"}),tt=URL.createObjectURL(We),H=document.createElement("a");H.href=tt,H.download=`siparisler-${new Date().toISOString().slice(0,10)}.csv`,H.click(),URL.revokeObjectURL(tt)};return e.jsxs("div",{children:[e.jsx(Fe,{title:"Satnalma Siparileri",subtitle:"Sipari oluturma, takip ve teslimat ynetimi",actions:e.jsxs(e.Fragment,{children:[a.length>0&&e.jsxs("button",{className:"btn btn-warning",type:"button",onClick:je,children:[" Eksik rnler (",a.length,")"]}),e.jsx("button",{className:"btn btn-secondary",type:"button",onClick:ie,children:" CSV"}),e.jsx("button",{className:"btn btn-primary",type:"button",onClick:ce,children:" Yeni Sipari"})]})}),e.jsxs("div",{className:"stats-grid",style:{marginBottom:16},children:[e.jsx("div",{className:"card",style:{padding:16},children:e.jsxs("div",{className:"metric-row",children:[e.jsx("div",{className:"metric-icon",children:""}),e.jsxs("div",{children:[e.jsx("div",{className:"metric-label",children:"Toplam"}),e.jsx("div",{className:"metric-value",children:O.total})]})]})}),e.jsx("div",{className:"card",style:{padding:16},children:e.jsxs("div",{className:"metric-row",children:[e.jsx("div",{className:"metric-icon",children:""}),e.jsxs("div",{children:[e.jsx("div",{className:"metric-label",children:"Taslak"}),e.jsx("div",{className:"metric-value",children:O.draft})]})]})}),e.jsx("div",{className:"card",style:{padding:16},children:e.jsxs("div",{className:"metric-row",children:[e.jsx("div",{className:"metric-icon",children:""}),e.jsxs("div",{children:[e.jsx("div",{className:"metric-label",children:"Bekleyen"}),e.jsx("div",{className:"metric-value",children:O.pending})]})]})}),e.jsx("div",{className:"card",style:{padding:16},children:e.jsxs("div",{className:"metric-row",children:[e.jsx("div",{className:"metric-icon",children:""}),e.jsxs("div",{children:[e.jsx("div",{className:"metric-label",children:"Toplam Tutar"}),e.jsx("div",{className:"metric-value",children:Ms(O.totalAmount)})]})]})})]}),e.jsxs("div",{className:"filter-bar",style:{marginBottom:16},children:[e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{className:"filter-label",children:"Ara"}),e.jsx("input",{className:"filter-input",type:"search",placeholder:"Sipari no, tedariki...",value:N,onChange:P=>C(P.target.value)})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{className:"filter-label",children:"Durum"}),e.jsxs("select",{className:"filter-input",value:b,onChange:P=>L(P.target.value),children:[e.jsx("option",{value:"all",children:"Tm"}),e.jsx("option",{value:"draft",children:"Taslak"}),e.jsx("option",{value:"sent",children:"Gnderildi"}),e.jsx("option",{value:"partial",children:"Ksmi Teslim"}),e.jsx("option",{value:"delivered",children:"Tamamland"})]})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{className:"filter-label",children:"Tedariki"}),e.jsxs("select",{className:"filter-input",value:k,onChange:P=>E(P.target.value),children:[e.jsx("option",{value:"all",children:"Tm"}),r.map(P=>e.jsx("option",{value:P.id,children:P.name},P.id))]})]})]}),i?e.jsx(ft,{text:"Sipariler ykleniyor..."}):u?e.jsxs("div",{className:"card error-card",children:[e.jsx("div",{className:"error-title",children:"Hata"}),e.jsx("div",{className:"error-message",children:u})]}):e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header",children:[e.jsx("h3",{className:"card-title",children:"Sipari Listesi"}),e.jsxs("span",{className:"badge badge-secondary",children:[oe.length," kayt"]})]}),e.jsx(et,{columns:[{label:"Sipari No",accessor:"id",render:P=>e.jsx("strong",{children:P})},{label:"Tedariki",accessor:"supplierName"},{label:"Kalem",accessor:"items",render:P=>`${(P==null?void 0:P.length)||0} kalem`},{label:"Tutar",accessor:"totalAmount",render:P=>Ms(P)},{label:"Durum",accessor:"status",render:P=>{const de=Fr[P]||{label:P,tone:"secondary"};return e.jsxs("span",{className:`badge badge-${de.tone}`,children:[de.icon," ",de.label]})}},{label:"Beklenen",accessor:"expectedDate",render:P=>P||"-"},{label:"Aksiyon",accessor:"actions",render:(P,de)=>e.jsxs("div",{style:{display:"flex",gap:8},children:[e.jsx("button",{className:"btn btn-primary btn-small",type:"button",onClick:()=>Ne(de),title:"Detaylar Grntle",children:""}),de.status==="draft"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-success btn-small",type:"button",onClick:()=>Re(de.id),title:"Siparii Gnder",children:""}),e.jsx("button",{className:"btn btn-danger btn-small",type:"button",onClick:()=>K(de),title:"Siparii Sil",children:""})]})]})}],rows:oe})]}),e.jsx(Be,{open:y,title:"Yeni Sipari Olutur",size:"xlarge",onClose:()=>p(!1),actions:e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-secondary",type:"button",onClick:()=>p(!1),children:"ptal"}),e.jsx("button",{className:"btn btn-primary",type:"submit",form:"order-form",disabled:F||!m.supplierId||m.items.length===0,children:F?"Kaydediliyor...":"Sipari Olutur"})]}),children:e.jsxs("form",{id:"order-form",onSubmit:ke,children:[e.jsxs("div",{className:"grid grid-2",style:{gap:16,marginBottom:16},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Tedariki *"}),e.jsxs("select",{className:"form-select",value:m.supplierId,onChange:P=>{const de=r.find(ve=>ve.id===P.target.value);v(ve=>({...ve,supplierId:P.target.value,supplierName:(de==null?void 0:de.name)||""}))},required:!0,children:[e.jsx("option",{value:"",children:"Sein"}),r.map(P=>e.jsxs("option",{value:P.id,children:[P.name," (",P.type==="dealer"?"Bayi":"retici",")"]},P.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Beklenen Tarih"}),e.jsx(Qe,{value:m.expectedDate,onChange:P=>v(de=>({...de,expectedDate:P}))})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"1 / -1"},children:[e.jsx("label",{className:"form-label",children:"Not"}),e.jsx("input",{className:"form-input",value:m.notes,onChange:P=>v(de=>({...de,notes:P.target.value})),placeholder:"Sipari notu..."})]})]}),e.jsxs("div",{className:"card subtle-card",style:{padding:16,marginBottom:16},children:[e.jsx("h4",{style:{margin:"0 0 12px 0",fontSize:14},children:" rn Ekle"}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"rn Ara"}),e.jsx("input",{className:"form-input",placeholder:"rn kodu veya ad...",value:V,onChange:P=>D(P.target.value)}),S.length>0&&e.jsx("div",{style:{marginTop:8,border:"1px solid var(--color-border)",borderRadius:6,maxHeight:150,overflow:"auto"},children:S.map(P=>e.jsxs("div",{style:{padding:"8px 12px",cursor:"pointer",borderBottom:"1px solid var(--color-border)"},onClick:()=>we(P),onKeyDown:de=>de.key==="Enter"&&we(P),tabIndex:0,role:"button",children:[e.jsx("strong",{children:P.productCode}),"-",P.colorCode,"  ",P.name," ",P.colorName||""]},P.id))})]}),e.jsxs("div",{className:"grid grid-4",style:{gap:12},children:[e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",style:{fontSize:11},children:"rn Kodu"}),e.jsx("input",{className:"form-input",value:z.productCode,onChange:P=>W(de=>({...de,productCode:P.target.value}))})]}),e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",style:{fontSize:11},children:"Renk Kodu"}),e.jsx("input",{className:"form-input",value:z.colorCode,onChange:P=>W(de=>({...de,colorCode:P.target.value}))})]}),e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",style:{fontSize:11},children:"Miktar"}),e.jsx(Cs,{className:"form-input",min:1,value:z.quantity,onChange:P=>W(de=>({...de,quantity:P}))})]}),e.jsx("div",{className:"form-group",style:{margin:0,display:"flex",alignItems:"flex-end"},children:e.jsx("button",{type:"button",className:"btn btn-primary",style:{width:"100%"},onClick:Ee,disabled:!z.productCode,children:"+ Ekle"})})]})]}),e.jsxs("div",{className:"card subtle-card",style:{padding:16},children:[e.jsxs("h4",{style:{margin:"0 0 12px 0",fontSize:14},children:[" Sipari Kalemleri (",m.items.length,")"]}),m.items.length===0?e.jsx("div",{className:"text-muted",children:"Henz kalem eklenmedi"}):e.jsx("div",{className:"table-container",style:{maxHeight:200},children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"rn"}),e.jsx("th",{children:"Miktar"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:m.items.map(P=>e.jsxs("tr",{children:[e.jsxs("td",{children:[e.jsx("strong",{children:P.productCode}),"-",P.colorCode,e.jsx("div",{className:"text-muted",children:P.productName})]}),e.jsxs("td",{children:[P.quantity," ",P.unit]}),e.jsx("td",{children:e.jsx("button",{type:"button",className:"btn btn-danger btn-small btn-icon",onClick:()=>T(P.productCode,P.colorCode),title:"Kalemi Kaldr",children:""})})]},`${P.productCode}-${P.colorCode}`))})]})})]})]})}),e.jsx(Be,{open:X,title:`Sipari Detay - ${(A==null?void 0:A.id)||""}`,size:"xlarge",onClose:()=>{Q(!1),ue(null)},actions:e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-secondary",type:"button",onClick:()=>re(A),title:"Siparii PDF olarak yazdr",children:" PDF Yazdr"}),["sent","partial"].includes(A==null?void 0:A.status)&&e.jsx("button",{className:"btn btn-success",type:"button",onClick:Oe,children:" Teslimat Kaydet"}),(A==null?void 0:A.status)==="draft"&&e.jsx("button",{className:"btn btn-primary",type:"button",onClick:()=>Re(A.id),children:" Siparii Gnder"})]}),children:A&&e.jsxs("div",{children:[e.jsx("div",{className:"card subtle-card",style:{marginBottom:16},children:e.jsxs("div",{className:"grid grid-4",style:{gap:16},children:[e.jsxs("div",{children:[e.jsx("div",{className:"metric-label",children:"Tedariki"}),e.jsx("div",{style:{fontWeight:600},children:A.supplierName})]}),e.jsxs("div",{children:[e.jsx("div",{className:"metric-label",children:"Durum"}),e.jsxs("span",{className:`badge badge-${((De=Fr[A.status])==null?void 0:De.tone)||"secondary"}`,children:[(Me=Fr[A.status])==null?void 0:Me.icon," ",((ee=Fr[A.status])==null?void 0:ee.label)||A.status]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"metric-label",children:"Beklenen Tarih"}),e.jsx("div",{style:{fontWeight:600},children:A.expectedDate||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"metric-label",children:"Toplam"}),e.jsx("div",{style:{fontWeight:600,fontSize:18,color:"var(--color-primary)"},children:Ms(A.totalAmount)})]})]})}),e.jsxs("div",{className:"card",style:{marginBottom:16},children:[e.jsx("div",{className:"card-header",children:e.jsx("h4",{className:"card-title",children:"Sipari Kalemleri"})}),e.jsx("div",{className:"table-container",children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"rn"}),e.jsx("th",{children:"Miktar"}),e.jsx("th",{children:"Teslim Alnan"}),e.jsx("th",{children:"Kalan"}),e.jsx("th",{children:"Durum"}),e.jsx("th",{children:"Birim Fiyat"}),e.jsx("th",{children:"Tutar"})]})}),e.jsx("tbody",{children:(fe=A.items)==null?void 0:fe.map((P,de)=>{const ve=P.quantity-(P.receivedQty||0),We=ve===0?{label:"Tamam",tone:"success",icon:""}:ve===P.quantity?{label:"Bekliyor",tone:"secondary",icon:""}:{label:"Eksik",tone:"warning",icon:""};return e.jsxs("tr",{style:{background:ve>0&&ve<P.quantity?"rgba(245, 158, 11, 0.05)":void 0},children:[e.jsxs("td",{children:[e.jsx("strong",{children:P.productCode}),"-",P.colorCode,e.jsx("div",{className:"text-muted",children:P.productName})]}),e.jsxs("td",{children:[P.quantity," ",P.unit]}),e.jsx("td",{style:{color:"var(--color-success)",fontWeight:(P.receivedQty||0)>0?600:400},children:P.receivedQty||0}),e.jsx("td",{style:{color:ve>0?"var(--color-warning)":"var(--color-success)",fontWeight:ve>0?700:400},children:ve>0?`-${ve}`:""}),e.jsx("td",{children:e.jsxs("span",{className:`badge badge-${We.tone}`,style:{fontSize:10},children:[We.icon," ",We.label]})}),e.jsx("td",{children:Ms(P.unitCost||0)}),e.jsx("td",{style:{fontWeight:600},children:Ms(P.totalCost||0)})]},`${P.productCode}-${de}`)})})]})})]}),((qe=A.deliveries)==null?void 0:qe.length)>0&&e.jsxs("div",{className:"card",children:[e.jsx("div",{className:"card-header",children:e.jsx("h4",{className:"card-title",children:"Teslimat Gemii"})}),e.jsx("div",{className:"timeline",children:A.deliveries.map(P=>{var de;return e.jsxs("div",{className:"timeline-item",children:[e.jsx("div",{className:"timeline-point"}),e.jsxs("div",{children:[e.jsx("div",{className:"timeline-title",children:P.date}),e.jsx("div",{className:"timeline-subtitle",children:(de=P.items)==null?void 0:de.map(ve=>`${ve.productCode}: ${ve.quantity}`).join(", ")}),e.jsxs("div",{className:"text-muted",children:[P.receivedBy&&`Teslim alan: ${P.receivedBy}`," ",P.note&&` ${P.note}`]})]})]},P.id)})})]})]})}),e.jsx(Be,{open:$,title:" Teslimat Kaydet",size:"xlarge",onClose:()=>ne(!1),actions:e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-secondary",type:"button",onClick:()=>ne(!1),children:"ptal"}),e.jsx("button",{className:"btn btn-warning",type:"button",onClick:()=>{pe(P=>({...P,items:P.items.map(de=>({...de,quantity:de.remaining}))}))},children:"Tmn Doldur"}),e.jsx("button",{className:"btn btn-success",type:"submit",form:"delivery-form",disabled:F||!U.items.some(P=>P.quantity>0),children:F?"Kaydediliyor...":` ${U.items.filter(P=>P.quantity>0).length} Kalem Kaydet`})]}),children:e.jsxs("form",{id:"delivery-form",onSubmit:R,children:[e.jsx("div",{className:"card subtle-card",style:{padding:12,marginBottom:16},children:e.jsxs("div",{className:"grid grid-4",style:{gap:16},children:[e.jsxs("div",{children:[e.jsx("div",{className:"metric-label",style:{fontSize:11},children:"Sipari No"}),e.jsx("strong",{children:A==null?void 0:A.id})]}),e.jsxs("div",{children:[e.jsx("div",{className:"metric-label",style:{fontSize:11},children:"Tedariki"}),e.jsx("strong",{children:A==null?void 0:A.supplierName})]}),e.jsxs("div",{children:[e.jsx("div",{className:"metric-label",style:{fontSize:11},children:"Toplam Kalem"}),e.jsx("strong",{children:U.items.length})]}),e.jsxs("div",{children:[e.jsx("div",{className:"metric-label",style:{fontSize:11},children:"Bu Teslimatta"}),e.jsxs("strong",{style:{color:"var(--color-success)"},children:[U.items.filter(P=>P.quantity>0).length," kalem"]})]})]})}),e.jsxs("div",{className:"text-muted",style:{marginBottom:12,fontSize:13},children:[" Her kalem iin teslim alnan miktar girin. ",e.jsx("strong",{children:"Tab"})," ile sonraki kaleme geebilirsiniz."]}),e.jsx("div",{className:"table-container",style:{marginBottom:16,maxHeight:350,overflow:"auto"},children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{style:{width:"35%"},children:"rn"}),e.jsx("th",{style:{width:"15%"},children:"Sipari"}),e.jsx("th",{style:{width:"15%"},children:"nceki Alm"}),e.jsx("th",{style:{width:"15%"},children:"Kalan"}),e.jsx("th",{style:{width:"20%"},children:"Bu Teslimat"})]})}),e.jsx("tbody",{children:U.items.map((P,de)=>e.jsxs("tr",{style:{background:P.quantity>0?"var(--color-success-bg)":P.remaining===0?"var(--color-bg-secondary)":"transparent"},children:[e.jsxs("td",{children:[e.jsx("strong",{children:P.productCode}),"-",P.colorCode,e.jsx("div",{className:"text-muted",style:{fontSize:12},children:P.productName})]}),e.jsx("td",{children:_r(P.ordered)}),e.jsx("td",{style:{color:P.received>0?"var(--color-success)":"var(--text-muted)"},children:_r(P.received)}),e.jsx("td",{children:P.remaining>0?e.jsx("span",{style:{color:"var(--color-warning)",fontWeight:600},children:_r(P.remaining)}):e.jsx("span",{className:"badge badge-success",children:"Tamam"})}),e.jsx("td",{children:P.remaining>0?e.jsx(Cs,{className:"form-input",min:0,max:P.remaining,value:P.quantity,onChange:ve=>{pe(We=>({...We,items:We.items.map((tt,H)=>H===de?{...tt,quantity:ve}:tt)}))},style:{width:90},allowEmpty:!0}):e.jsx("span",{className:"text-muted",children:"-"})})]},`${P.productCode}-${de}`))})]})}),e.jsxs("div",{className:"grid grid-2",style:{gap:16},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Teslim Alan *"}),e.jsx("input",{className:"form-input",value:U.receivedBy,onChange:P=>pe(de=>({...de,receivedBy:P.target.value})),placeholder:"Teslim alan kiinin ad...",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Not (opsiyonel)"}),e.jsx("input",{className:"form-input",value:U.note,onChange:P=>pe(de=>({...de,note:P.target.value})),placeholder:"Teslimat notu, irsaliye no vb..."})]})]}),e.jsxs("div",{className:"form-group",style:{marginTop:16},children:[e.jsx("label",{className:"form-label",children:" rsaliye / Belge Ykle (opsiyonel)"}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[e.jsxs("label",{style:{display:"inline-flex",alignItems:"center",gap:6,padding:"8px 14px",background:"var(--color-bg-secondary)",border:"2px dashed var(--color-border)",borderRadius:8,cursor:"pointer",fontSize:13,color:"var(--color-text-secondary)",transition:"all 0.2s"},children:[e.jsx("span",{children:""}),e.jsx("span",{children:"Dosya Se"}),e.jsx("input",{type:"file",accept:".pdf,.png,.jpg,.jpeg",style:{display:"none"},onChange:P=>{var ve;const de=(ve=P.target.files)==null?void 0:ve[0];de&&pe(We=>({...We,waybillFile:de})),P.target.value=""}})]}),U.waybillFile&&e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsxs("span",{style:{fontSize:13},children:[" ",U.waybillFile.name]}),e.jsx("button",{type:"button",style:{background:"none",border:"none",color:"var(--color-danger)",cursor:"pointer",padding:"2px 6px",fontSize:12},onClick:()=>pe(P=>({...P,waybillFile:null})),title:"Dosyay Kaldr",children:""})]})]}),e.jsx("div",{className:"text-muted",style:{fontSize:11,marginTop:4},children:"Tedarikiden gelen irsaliye veya teslim belgesi (PDF, PNG, JPG)"})]})]})}),e.jsxs(Be,{open:x,title:" Eksik rnler - Toplu Sipari",size:"xlarge",onClose:()=>M(!1),actions:e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-secondary",type:"button",onClick:()=>M(!1),children:"Kapat"}),e.jsx("button",{className:"btn btn-primary",type:"button",disabled:F||w.length===0,onClick:Ie,children:F?"Oluturuluyor...":` ${w.length} rn in Sipari Olutur`})]}),children:[e.jsx("div",{className:"text-muted",style:{marginBottom:16},children:"Aadaki rnler kritik stok seviyesinin altnda. Sipari vermek istediklerinizi sein:"}),e.jsx("div",{className:"table-container",style:{maxHeight:400},children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:e.jsx("input",{type:"checkbox",checked:w.length===a.length&&a.length>0,onChange:P=>j(P.target.checked?[...a]:[])})}),e.jsx("th",{children:"rn"}),e.jsx("th",{children:"Tedariki"}),e.jsx("th",{children:"Mevcut"}),e.jsx("th",{children:"Kritik"}),e.jsx("th",{children:"nerilen"})]})}),e.jsx("tbody",{children:a.map(P=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("input",{type:"checkbox",checked:w.some(de=>de.itemId===P.itemId),onChange:de=>{de.target.checked?j(ve=>[...ve,P]):j(ve=>ve.filter(We=>We.itemId!==P.itemId))}})}),e.jsxs("td",{children:[e.jsx("strong",{children:P.productCode}),"-",P.colorCode,e.jsx("div",{className:"text-muted",children:P.name})]}),e.jsx("td",{children:P.supplierName}),e.jsx("td",{style:{color:"var(--color-danger)"},children:_r(P.available)}),e.jsx("td",{children:_r(P.critical)}),e.jsx("td",{style:{fontWeight:600},children:_r(P.suggestedQty)})]},P.itemId))})]})})]}),e.jsx(Be,{open:!!B,title:"Silme Onay",size:"small",onClose:()=>K(null),actions:e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-secondary",type:"button",onClick:()=>K(null),children:"Vazge"}),e.jsx("button",{className:"btn btn-danger",type:"button",onClick:le,disabled:F,children:"Sil"})]}),children:e.jsxs("p",{children:[e.jsx("strong",{children:B==null?void 0:B.id})," sipariini silmek istediinize emin misiniz?"]})})]})},ur=t=>new Intl.NumberFormat("tr-TR").format(t||0),Lh={name:"",type:"manufacturer",category:"",jobRoleId:"",supplyType:"stock",leadTimeDays:7,notes:"",contact:{phone:"",email:"",address:"",contactPerson:""}},Ph={productCode:"",colorCode:"",productName:"",quantity:1,unit:"boy",type:"received",date:new Date().toISOString().slice(0,10),note:""},wN=()=>{var Ie,Ne,Re,Oe,R,le,ie,De,Me;const[t,s]=c.useState([]),[r,n]=c.useState(!0),[a,l]=c.useState(""),[i,d]=c.useState(""),[u,f]=c.useState("all"),[N,C]=c.useState([]),[b,L]=c.useState(!1),[k,E]=c.useState(null),[y,p]=c.useState(Lh),[m,v]=c.useState(!1),[z,W]=c.useState(!1),[F,q]=c.useState(null),[X,Q]=c.useState(null),[A,ue]=c.useState([]),[Z,ae]=c.useState(!1),[$,ne]=c.useState(!1),[U,pe]=c.useState(Ph),[V,D]=c.useState(""),[S,g]=c.useState([]),[x,M]=c.useState(!1),[w,j]=c.useState(null);c.useEffect(()=>{K(),B()},[]);const B=async()=>{try{const ee=await jn(!0);C(ee||[])}catch(ee){console.warn("Job roles yklenemedi:",ee)}},K=async()=>{try{n(!0),l("");const ee=await cr();s(ee)}catch(ee){l(ee.message||"Tedarikiler alnamad")}finally{n(!1)}},se=c.useMemo(()=>{let ee=[...t];if(i){const fe=i.toLowerCase();ee=ee.filter(qe=>{var P;return qe.name.toLowerCase().includes(fe)||(qe.category||"").toLowerCase().includes(fe)||(((P=qe.contact)==null?void 0:P.contactPerson)||"").toLowerCase().includes(fe)})}return u!=="all"&&(ee=ee.filter(fe=>fe.type===u)),ee},[t,i,u]),oe=()=>{E(null),p(Lh),L(!0)},O=ee=>{var fe,qe,P,de;E(ee),p({name:ee.name||"",type:ee.type||"manufacturer",category:ee.category||"",jobRoleId:ee.jobRoleId||"",supplyType:ee.supplyType||"stock",leadTimeDays:ee.leadTimeDays||7,notes:ee.notes||"",contact:{phone:((fe=ee.contact)==null?void 0:fe.phone)||"",email:((qe=ee.contact)==null?void 0:qe.email)||"",address:((P=ee.contact)==null?void 0:P.address)||"",contactPerson:((de=ee.contact)==null?void 0:de.contactPerson)||""}}),L(!0)},ce=async ee=>{ee.preventDefault();try{if(v(!0),k){const fe=await S0(k.id,y);s(qe=>qe.map(P=>P.id===k.id?fe:P))}else{const fe=await N0(y);s(qe=>[fe,...qe])}L(!1)}catch(fe){l(fe.message||"Kayt yaplamad")}finally{v(!1)}},je=async()=>{if(w)try{v(!0),await k0(w.id),s(ee=>ee.filter(fe=>fe.id!==w.id)),j(null)}catch(ee){l(ee.message||"Silinemedi")}finally{v(!1)}},we=async ee=>{q(ee),W(!0),ae(!0);try{const[fe,qe]=await Promise.all([Sh(ee.id),C0(ee.id)]);Q(fe),ue(qe)}catch(fe){console.error("Balance load error:",fe)}finally{ae(!1)}},Ee=()=>{pe({...Ph,date:new Date().toISOString().slice(0,10)}),D(""),g([]),ne(!0)};c.useEffect(()=>{if(!V||V.length<2){g([]);return}const ee=setTimeout(async()=>{M(!0);try{const fe=await Ty(V,"");g(fe.slice(0,10))}catch(fe){console.error("Product search error:",fe)}finally{M(!1)}},300);return()=>clearTimeout(ee)},[V]);const T=ee=>{pe(fe=>({...fe,productCode:ee.productCode,colorCode:ee.colorCode,productName:`${ee.name} ${ee.colorName||""}`.trim(),unit:ee.unit||"boy"})),D(""),g([])},re=async ee=>{if(ee.preventDefault(),!!F)try{v(!0);const fe=await w0(F.id,U);ue(P=>[fe,...P]);const qe=await Sh(F.id);Q(qe),ne(!1)}catch(fe){l(fe.message||"Hareket kaydedilemedi")}finally{v(!1)}},ke=c.useMemo(()=>{const ee=t.filter(qe=>qe.type==="manufacturer").length,fe=t.filter(qe=>qe.type==="dealer").length;return{total:t.length,manufacturers:ee,dealers:fe}},[t]);return e.jsxs("div",{children:[e.jsx(Fe,{title:"Tedarikiler & Bayiler",subtitle:"Tedariki ynetimi ve rn bazl hesap takibi",actions:e.jsx("button",{className:"btn btn-primary",type:"button",onClick:oe,children:" Yeni Tedariki"})}),e.jsxs("div",{className:"stats-grid",style:{marginBottom:16},children:[e.jsx("div",{className:"card",style:{padding:16},children:e.jsxs("div",{className:"metric-row",children:[e.jsx("div",{className:"metric-icon",children:""}),e.jsxs("div",{children:[e.jsx("div",{className:"metric-label",children:"Toplam"}),e.jsx("div",{className:"metric-value",children:ke.total})]})]})}),e.jsx("div",{className:"card",style:{padding:16},children:e.jsxs("div",{className:"metric-row",children:[e.jsx("div",{className:"metric-icon",children:""}),e.jsxs("div",{children:[e.jsx("div",{className:"metric-label",children:"retici/Fabrika"}),e.jsx("div",{className:"metric-value",children:ke.manufacturers})]})]})}),e.jsx("div",{className:"card",style:{padding:16},children:e.jsxs("div",{className:"metric-row",children:[e.jsx("div",{className:"metric-icon",children:""}),e.jsxs("div",{children:[e.jsx("div",{className:"metric-label",children:"Bayi"}),e.jsx("div",{className:"metric-value",children:ke.dealers})]})]})})]}),e.jsxs("div",{className:"filter-bar",style:{marginBottom:16},children:[e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{className:"filter-label",children:"Ara"}),e.jsx("input",{className:"filter-input",type:"search",placeholder:"Tedariki ad, kategori...",value:i,onChange:ee=>d(ee.target.value)})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{className:"filter-label",children:"Tr"}),e.jsxs("select",{className:"filter-input",value:u,onChange:ee=>f(ee.target.value),children:[e.jsx("option",{value:"all",children:"Tm"}),e.jsx("option",{value:"manufacturer",children:"retici/Fabrika"}),e.jsx("option",{value:"dealer",children:"Bayi"})]})]})]}),r?e.jsx(ft,{text:"Tedarikiler ykleniyor..."}):a?e.jsxs("div",{className:"card error-card",children:[e.jsx("div",{className:"error-title",children:"Hata"}),e.jsx("div",{className:"error-message",children:a})]}):e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header",children:[e.jsx("h3",{className:"card-title",children:"Tedariki Listesi"}),e.jsxs("span",{className:"badge badge-secondary",children:[se.length," kayt"]})]}),e.jsx(et,{columns:[{label:"Tedariki",accessor:"name",render:(ee,fe)=>e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:600},children:fe.name}),e.jsx("div",{className:"text-muted",children:fe.category||"Genel"})]})},{label:"Tr",accessor:"type",render:ee=>e.jsx("span",{className:`badge badge-${ee==="dealer"?"warning":"primary"}`,children:ee==="dealer"?" Bayi":" retici"})},{label:"Tedarik Tr",accessor:"supplyType",render:(ee,fe)=>{var P;const qe=(P=N.find(de=>de.id===fe.jobRoleId))==null?void 0:P.name;return e.jsxs("div",{children:[e.jsx("span",{className:`badge badge-${ee==="glass"?"info":ee==="production"?"success":"secondary"}`,children:ee==="glass"?" Cam":ee==="production"?" D retim":" Stok"}),qe&&e.jsx("div",{className:"text-muted",style:{fontSize:11,marginTop:2},children:qe})]})}},{label:"letiim",accessor:"contact",render:(ee,fe)=>{var qe,P;return e.jsxs("div",{style:{fontSize:13},children:[e.jsx("div",{children:((qe=fe.contact)==null?void 0:qe.contactPerson)||"-"}),e.jsx("div",{className:"text-muted",children:((P=fe.contact)==null?void 0:P.phone)||"-"})]})}},{label:"Temin Sresi",accessor:"leadTimeDays",render:ee=>`${ee||7} gn`},{label:"Aksiyon",accessor:"actions",render:(ee,fe)=>e.jsxs("div",{style:{display:"flex",gap:8},children:[e.jsx("button",{className:"btn btn-primary btn-small",type:"button",onClick:()=>we(fe),children:" Hesap"}),e.jsx("button",{className:"btn btn-secondary btn-icon",type:"button",onClick:()=>O(fe),title:"Dzenle",children:""}),e.jsx("button",{className:"btn btn-danger btn-icon",type:"button",onClick:()=>j(fe),title:"Sil",children:""})]})}],rows:se})]}),e.jsx(Be,{open:b,title:k?"Tedariki Dzenle":"Yeni Tedariki",size:"large",onClose:()=>L(!1),actions:e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-secondary",type:"button",onClick:()=>L(!1),children:"ptal"}),e.jsx("button",{className:"btn btn-primary",type:"submit",form:"supplier-form",disabled:m,children:m?"Kaydediliyor...":"Kaydet"})]}),children:e.jsxs("form",{id:"supplier-form",onSubmit:ce,className:"grid grid-2",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Tedariki Ad *"}),e.jsx("input",{className:"form-input",value:y.name,onChange:ee=>p(fe=>({...fe,name:ee.target.value})),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Tr *"}),e.jsxs("select",{className:"form-select",value:y.type,onChange:ee=>p(fe=>({...fe,type:ee.target.value})),children:[e.jsx("option",{value:"manufacturer",children:" retici/Fabrika"}),e.jsx("option",{value:"dealer",children:" Bayi"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Kategori"}),e.jsx("input",{className:"form-input",value:y.category,onChange:ee=>p(fe=>({...fe,category:ee.target.value})),placeholder:"PVC Profil, Aksesuar, Cam..."})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Tedarik Tr *"}),e.jsxs("select",{className:"form-select",value:y.supplyType,onChange:ee=>p(fe=>({...fe,supplyType:ee.target.value,jobRoleId:ee.target.value==="stock"?"":fe.jobRoleId})),children:[e.jsx("option",{value:"stock",children:" Stok Tedarikisi"}),e.jsx("option",{value:"glass",children:" Cam Tedarikisi (retim)"}),e.jsx("option",{value:"production",children:" D retim Tedarikisi"})]})]}),(y.supplyType==="glass"||y.supplyType==="production")&&e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:" Kolu *"}),e.jsxs("select",{className:"form-select",value:y.jobRoleId,onChange:ee=>p(fe=>({...fe,jobRoleId:ee.target.value})),children:[e.jsx("option",{value:"",children:"Tm (Genel)"}),N.map(ee=>e.jsx("option",{value:ee.id,children:ee.name},ee.id))]}),e.jsx("small",{className:"text-muted",style:{fontSize:"0.75rem",marginTop:4},children:"Bu tedariki hangi i kolu iin sipari verilecek? Bo brakrsanz tm i kollarnda grnr."})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Temin Sresi (gn)"}),e.jsx("input",{className:"form-input",type:"number",min:"1",value:y.leadTimeDays,onChange:ee=>p(fe=>({...fe,leadTimeDays:Number(ee.target.value)}))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Yetkili Kii"}),e.jsx("input",{className:"form-input",value:y.contact.contactPerson,onChange:ee=>p(fe=>({...fe,contact:{...fe.contact,contactPerson:ee.target.value}}))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Telefon"}),e.jsx("input",{className:"form-input",value:y.contact.phone,onChange:ee=>p(fe=>({...fe,contact:{...fe.contact,phone:ee.target.value}}))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"E-posta"}),e.jsx("input",{className:"form-input",type:"email",value:y.contact.email,onChange:ee=>p(fe=>({...fe,contact:{...fe.contact,email:ee.target.value}}))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Adres"}),e.jsx("input",{className:"form-input",value:y.contact.address,onChange:ee=>p(fe=>({...fe,contact:{...fe.contact,address:ee.target.value}}))})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"1 / -1"},children:[e.jsx("label",{className:"form-label",children:"Notlar"}),e.jsx("textarea",{className:"form-textarea",value:y.notes,onChange:ee=>p(fe=>({...fe,notes:ee.target.value})),placeholder:"Ek bilgiler..."})]})]})}),e.jsx(Be,{open:z,title:` ${(F==null?void 0:F.name)||"Tedariki"} - rn Hesab`,size:"xxlarge",onClose:()=>{W(!1),q(null),Q(null),ue([])},children:Z?e.jsx(ft,{text:"Hesap bilgileri ykleniyor..."}):e.jsxs("div",{children:[e.jsx("div",{className:"card subtle-card",style:{marginBottom:16},children:e.jsxs("div",{className:"grid grid-4",style:{gap:16},children:[e.jsxs("div",{children:[e.jsx("div",{className:"metric-label",children:"Tr"}),e.jsx("div",{style:{fontWeight:600},children:(F==null?void 0:F.type)==="dealer"?" Bayi":" retici"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"metric-label",children:"Kategori"}),e.jsx("div",{style:{fontWeight:600},children:(F==null?void 0:F.category)||"-"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"metric-label",children:"Temin Sresi"}),e.jsxs("div",{style:{fontWeight:600},children:[(F==null?void 0:F.leadTimeDays)||7," gn"]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"metric-label",children:"letiim"}),e.jsx("div",{style:{fontWeight:600},children:((Ie=F==null?void 0:F.contact)==null?void 0:Ie.phone)||"-"})]})]})}),X&&e.jsxs("div",{className:"card",style:{marginBottom:16},children:[e.jsxs("div",{className:"card-header",children:[e.jsx("h4",{className:"card-title",children:" rn Bazl Bakiye"}),e.jsx("button",{className:"btn btn-primary btn-small",type:"button",onClick:Ee,children:" Hareket Ekle"})]}),e.jsxs("div",{className:"grid grid-3",style:{gap:12,marginBottom:16,padding:"0 16px"},children:[e.jsxs("div",{style:{padding:12,background:"var(--color-success-bg)",borderRadius:8,textAlign:"center"},children:[e.jsx("div",{className:"metric-label",children:"Aldk (Toplam)"}),e.jsx("div",{style:{fontSize:20,fontWeight:700,color:"var(--color-success)"},children:ur(((Ne=X.summary)==null?void 0:Ne.totalReceived)||0)})]}),e.jsxs("div",{style:{padding:12,background:"var(--color-warning-bg)",borderRadius:8,textAlign:"center"},children:[e.jsx("div",{className:"metric-label",children:"Verdik (Toplam)"}),e.jsx("div",{style:{fontSize:20,fontWeight:700,color:"var(--color-warning)"},children:ur(((Re=X.summary)==null?void 0:Re.totalGiven)||0)})]}),e.jsxs("div",{style:{padding:12,background:(((Oe=X.summary)==null?void 0:Oe.netBalance)||0)>=0?"var(--color-info-bg)":"var(--color-danger-bg)",borderRadius:8,textAlign:"center"},children:[e.jsx("div",{className:"metric-label",children:"Net Bakiye"}),e.jsxs("div",{style:{fontSize:20,fontWeight:700,color:(((R=X.summary)==null?void 0:R.netBalance)||0)>=0?"var(--color-info)":"var(--color-danger)"},children:[(((le=X.summary)==null?void 0:le.netBalance)||0)>=0?"+":"",ur(((ie=X.summary)==null?void 0:ie.netBalance)||0)]}),e.jsx("div",{className:"text-muted",style:{fontSize:11},children:(((De=X.summary)==null?void 0:De.netBalance)||0)>=0?"Biz fazla aldk":"Biz fazla verdik"})]})]}),((Me=X.items)==null?void 0:Me.length)>0?e.jsx("div",{className:"table-container",style:{maxHeight:300},children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"rn Kodu"}),e.jsx("th",{children:"Renk Kodu"}),e.jsx("th",{children:"rn Ad"}),e.jsx("th",{children:"Birim"}),e.jsx("th",{style:{textAlign:"right"},children:"Aldk"}),e.jsx("th",{style:{textAlign:"right"},children:"Verdik"}),e.jsx("th",{style:{textAlign:"right"},children:"Bakiye"})]})}),e.jsx("tbody",{children:X.items.map((ee,fe)=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("strong",{children:ee.productCode})}),e.jsx("td",{children:ee.colorCode}),e.jsx("td",{children:ee.productName}),e.jsx("td",{children:ee.unit}),e.jsxs("td",{style:{textAlign:"right",color:"var(--color-success)"},children:["+",ur(ee.received)]}),e.jsxs("td",{style:{textAlign:"right",color:"var(--color-warning)"},children:["-",ur(ee.given)]}),e.jsxs("td",{style:{textAlign:"right",fontWeight:700,color:ee.balance>=0?"var(--color-info)":"var(--color-danger)"},children:[ee.balance>=0?"+":"",ur(ee.balance)]})]},`${ee.productCode}-${ee.colorCode}-${fe}`))})]})}):e.jsxs("div",{className:"empty-state",style:{padding:20},children:[e.jsx("div",{className:"empty-state-icon",children:""}),e.jsx("div",{className:"empty-state-title",children:"Henz hareket yok"}),e.jsx("div",{className:"empty-state-description",children:"Bu tedariki ile rn alverii kayd bulunmuyor."})]})]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header",children:[e.jsx("h4",{className:"card-title",children:" Son Hareketler"}),e.jsxs("span",{className:"badge badge-secondary",children:[A.length," kayt"]})]}),A.length>0?e.jsx("div",{className:"table-container",style:{maxHeight:250},children:e.jsxs("table",{className:"table",children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Tarih"}),e.jsx("th",{children:"rn"}),e.jsx("th",{children:"Miktar"}),e.jsx("th",{children:"lem"}),e.jsx("th",{children:"Not"})]})}),e.jsx("tbody",{children:A.slice(0,20).map(ee=>e.jsxs("tr",{children:[e.jsx("td",{children:ee.date}),e.jsxs("td",{children:[e.jsx("strong",{children:ee.productCode}),"-",ee.colorCode,e.jsx("div",{className:"text-muted",style:{fontSize:12},children:ee.productName})]}),e.jsxs("td",{children:[ur(ee.quantity)," ",ee.unit]}),e.jsx("td",{children:e.jsx("span",{className:`badge badge-${ee.type==="received"?"success":"warning"}`,children:ee.type==="received"?" Aldk":" Verdik"})}),e.jsx("td",{className:"text-muted",children:ee.note||"-"})]},ee.id))})]})}):e.jsx("div",{className:"text-muted",style:{padding:16},children:"Henz hareket kayd yok."})]})]})}),e.jsx(Be,{open:$,title:" rn Hareketi Ekle",size:"large",onClose:()=>ne(!1),actions:e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-secondary",type:"button",onClick:()=>ne(!1),children:"ptal"}),e.jsx("button",{className:"btn btn-primary",type:"submit",form:"transaction-form",disabled:m||!U.productCode,children:m?"Kaydediliyor...":"Kaydet"})]}),children:e.jsxs("form",{id:"transaction-form",onSubmit:re,children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"rn Ara (kod veya ad)"}),e.jsx("input",{className:"form-input",placeholder:"rn kodu veya ad yazn...",value:V,onChange:ee=>D(ee.target.value)}),x&&e.jsx("div",{className:"text-muted",style:{marginTop:4},children:"Aranyor..."}),S.length>0&&e.jsx("div",{style:{marginTop:8,border:"1px solid var(--color-border)",borderRadius:6,maxHeight:200,overflow:"auto"},children:S.map(ee=>e.jsxs("div",{style:{padding:"8px 12px",cursor:"pointer",borderBottom:"1px solid var(--color-border)"},onClick:()=>T(ee),onKeyDown:fe=>fe.key==="Enter"&&T(ee),tabIndex:0,role:"button",children:[e.jsx("strong",{children:ee.productCode}),"-",ee.colorCode,"  ",ee.name," ",ee.colorName||"",e.jsxs("span",{className:"text-muted",style:{marginLeft:8},children:["(",ee.unit,")"]})]},ee.id))})]}),U.productCode&&e.jsxs("div",{style:{padding:12,background:"var(--color-primary-bg)",borderRadius:8,marginBottom:16},children:[e.jsxs("div",{style:{fontWeight:600},children:[U.productCode,"-",U.colorCode]}),e.jsx("div",{children:U.productName})]}),e.jsxs("div",{className:"grid grid-2",style:{gap:16},children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"rn Kodu *"}),e.jsx("input",{className:"form-input",value:U.productCode,onChange:ee=>pe(fe=>({...fe,productCode:ee.target.value})),placeholder:"18300",required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Renk Kodu *"}),e.jsx("input",{className:"form-input",value:U.colorCode,onChange:ee=>pe(fe=>({...fe,colorCode:ee.target.value})),placeholder:"3",required:!0})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"1 / -1"},children:[e.jsx("label",{className:"form-label",children:"rn Ad"}),e.jsx("input",{className:"form-input",value:U.productName,onChange:ee=>pe(fe=>({...fe,productName:ee.target.value})),placeholder:"Carisma Kasa Beyaz"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Miktar *"}),e.jsx("input",{className:"form-input",type:"number",min:"0.01",step:"0.01",value:U.quantity,onChange:ee=>pe(fe=>({...fe,quantity:Number(ee.target.value)})),required:!0})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Birim"}),e.jsxs("select",{className:"form-select",value:U.unit,onChange:ee=>pe(fe=>({...fe,unit:ee.target.value})),children:[e.jsx("option",{value:"boy",children:"Boy"}),e.jsx("option",{value:"adet",children:"Adet"}),e.jsx("option",{value:"m2",children:"m"}),e.jsx("option",{value:"kg",children:"Kg"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"lem Tr *"}),e.jsxs("select",{className:"form-select",value:U.type,onChange:ee=>pe(fe=>({...fe,type:ee.target.value})),children:[e.jsx("option",{value:"received",children:" Aldk (Biz onlardan aldk)"}),e.jsx("option",{value:"given",children:" Verdik (Biz onlara verdik)"})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Tarih"}),e.jsx(Qe,{value:U.date,onChange:ee=>pe(fe=>({...fe,date:ee}))})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"1 / -1"},children:[e.jsx("label",{className:"form-label",children:"Not"}),e.jsx("input",{className:"form-input",value:U.note,onChange:ee=>pe(fe=>({...fe,note:ee.target.value})),placeholder:"Acil ihtiya iin, dn verildi vb."})]})]})]})}),e.jsx(Be,{open:!!w,title:"Silme Onay",size:"small",onClose:()=>j(null),actions:e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-secondary",type:"button",onClick:()=>j(null),children:"Vazge"}),e.jsx("button",{className:"btn btn-danger",type:"button",onClick:je,disabled:m,children:"Sil"})]}),children:e.jsxs("p",{children:[e.jsx("strong",{children:w==null?void 0:w.name})," tedarikisini silmek istediinize emin misiniz?"]})})]})},$r=t=>new Intl.NumberFormat("tr-TR").format(t||0),TN=()=>{const[t,s]=c.useState([]),[r,n]=c.useState([]),[a,l]=c.useState(!0),[i,d]=c.useState(""),[u,f]=c.useState(""),[N,C]=c.useState("all"),[b,L]=c.useState([]),[k,E]=c.useState(!1),[y,p]=c.useState(!1);c.useEffect(()=>{m()},[]);const m=async()=>{try{l(!0),d("");const[Q,A]=await Promise.all([Hc(),cr()]);s(Q),n(A)}catch(Q){d(Q.message||"Veriler alnamad")}finally{l(!1)}},v=c.useMemo(()=>{let Q=[...t];if(u){const A=u.toLowerCase();Q=Q.filter(ue=>ue.productCode.toLowerCase().includes(A)||ue.name.toLowerCase().includes(A)||(ue.colorName||"").toLowerCase().includes(A))}return N!=="all"&&(Q=Q.filter(A=>A.supplierId===N)),Q},[t,u,N]),z=c.useMemo(()=>{const Q=t.length,A=t.reduce((Z,ae)=>Z+(ae.suggestedQty||0),0),ue=new Set(t.map(Z=>Z.supplierId)).size;return{total:Q,totalShortage:A,suppliersNeeded:ue}},[t]),W=Q=>{L(A=>A.find(Z=>Z.itemId===Q.itemId)?A.filter(Z=>Z.itemId!==Q.itemId):[...A,Q])},F=()=>{b.length===v.length?L([]):L([...v])},q=async()=>{if(b.length===0)return;const Q={};b.forEach(A=>{const ue=A.supplierId;Q[ue]||(Q[ue]={supplierId:A.supplierId,supplierName:A.supplierName,items:[]}),Q[ue].items.push({productCode:A.productCode,colorCode:A.colorCode,productName:`${A.name} ${A.colorName||""}`.trim(),quantity:A.suggestedQty,unit:A.unit,unitCost:0})});try{E(!0);for(const A of Object.values(Q))await _o({supplierId:A.supplierId,supplierName:A.supplierName,items:A.items,notes:"Kritik stok siparii",expectedDate:"",relatedJobs:[]});L([]),p(!1),await m()}catch(A){d(A.message||"Sipari oluturulamad")}finally{E(!1)}},X=c.useMemo(()=>{const Q={};return b.forEach(A=>{Q[A.supplierId]||(Q[A.supplierId]={supplierName:A.supplierName,items:[]}),Q[A.supplierId].items.push(A)}),Object.entries(Q)},[b]);return e.jsxs("div",{children:[e.jsx(Fe,{title:"Eksik rnler",subtitle:"Kritik stok seviyesinin altndaki rnler - Sipari verilmesi gerekenler",actions:b.length>0&&e.jsxs("button",{className:"btn btn-primary",type:"button",onClick:()=>p(!0),children:[" ",b.length," rn in Sipari Olutur"]})}),e.jsxs("div",{className:"stats-grid",style:{marginBottom:16},children:[e.jsx("div",{className:"card",style:{padding:16},children:e.jsxs("div",{className:"metric-row",children:[e.jsx("div",{className:"metric-icon",children:""}),e.jsxs("div",{children:[e.jsx("div",{className:"metric-label",children:"Eksik rn"}),e.jsx("div",{className:"metric-value",children:z.total})]})]})}),e.jsx("div",{className:"card",style:{padding:16},children:e.jsxs("div",{className:"metric-row",children:[e.jsx("div",{className:"metric-icon",children:""}),e.jsxs("div",{children:[e.jsx("div",{className:"metric-label",children:"Toplam Eksik"}),e.jsx("div",{className:"metric-value",children:$r(z.totalShortage)})]})]})}),e.jsx("div",{className:"card",style:{padding:16},children:e.jsxs("div",{className:"metric-row",children:[e.jsx("div",{className:"metric-icon",children:""}),e.jsxs("div",{children:[e.jsx("div",{className:"metric-label",children:"Tedariki"}),e.jsx("div",{className:"metric-value",children:z.suppliersNeeded})]})]})})]}),e.jsxs("div",{className:"filter-bar",style:{marginBottom:16},children:[e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{className:"filter-label",children:"Ara"}),e.jsx("input",{className:"filter-input",type:"search",placeholder:"rn kodu, ad...",value:u,onChange:Q=>f(Q.target.value)})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{className:"filter-label",children:"Tedariki"}),e.jsxs("select",{className:"filter-input",value:N,onChange:Q=>C(Q.target.value),children:[e.jsx("option",{value:"all",children:"Tm"}),r.map(Q=>e.jsx("option",{value:Q.id,children:Q.name},Q.id))]})]})]}),a?e.jsx(ft,{text:"Eksik rnler ykleniyor..."}):i?e.jsxs("div",{className:"card error-card",children:[e.jsx("div",{className:"error-title",children:"Hata"}),e.jsx("div",{className:"error-message",children:i})]}):t.length===0?e.jsxs("div",{className:"card",style:{padding:40,textAlign:"center"},children:[e.jsx("div",{style:{fontSize:48,marginBottom:16},children:""}),e.jsx("h3",{children:"Tm Stoklar Yeterli"}),e.jsx("p",{className:"text-muted",children:"Kritik seviyenin altnda rn bulunmuyor."})]}):e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header",children:[e.jsx("h3",{className:"card-title",children:"Eksik rn Listesi"}),e.jsxs("span",{className:"badge badge-warning",children:[v.length," rn"]})]}),e.jsx(et,{columns:[{label:e.jsx("input",{type:"checkbox",checked:b.length===v.length&&v.length>0,onChange:F}),accessor:"select",render:(Q,A)=>e.jsx("input",{type:"checkbox",checked:b.some(ue=>ue.itemId===A.itemId),onChange:()=>W(A)})},{label:"rn",accessor:"name",render:(Q,A)=>e.jsxs("div",{children:[e.jsx("strong",{children:A.productCode}),"-",A.colorCode,e.jsxs("div",{className:"text-muted",children:[A.name," ",A.colorName||""]})]})},{label:"Tedariki",accessor:"supplierName"},{label:"Mevcut",accessor:"available",render:Q=>e.jsx("span",{style:{color:"var(--color-danger)",fontWeight:600},children:$r(Q)})},{label:"Kritik",accessor:"critical",render:Q=>$r(Q)},{label:"Bekleyen Sipari",accessor:"pendingInOrders",render:Q=>Q>0?e.jsxs("span",{className:"badge badge-info",children:[$r(Q)," sipari edildi"]}):"-"},{label:"nerilen",accessor:"suggestedQty",render:(Q,A)=>e.jsxs("strong",{style:{color:"var(--color-primary)"},children:[$r(Q)," ",A.unit]})}],rows:v})]}),e.jsxs(Be,{open:y,title:" Sipari Olutur",size:"large",onClose:()=>p(!1),actions:e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-secondary",type:"button",onClick:()=>p(!1),children:"ptal"}),e.jsx("button",{className:"btn btn-primary",type:"button",disabled:k,onClick:q,children:k?"Oluturuluyor...":`${X.length} Sipari Olutur`})]}),children:[e.jsx("div",{className:"text-muted",style:{marginBottom:16},children:"Seilen rnler tedarikiye gre gruplandrlarak sipari oluturulacak:"}),X.map(([Q,A])=>e.jsxs("div",{className:"card subtle-card",style:{marginBottom:12,padding:12},children:[e.jsxs("div",{style:{fontWeight:600,marginBottom:8},children:[" ",A.supplierName]}),e.jsx("div",{style:{fontSize:13},children:A.items.map(ue=>e.jsxs("div",{className:"metric-row",style:{padding:"4px 0"},children:[e.jsxs("span",{children:[ue.productCode,"-",ue.colorCode," ",ue.name]}),e.jsxs("strong",{children:[$r(ue.suggestedQty)," ",ue.unit]})]},ue.itemId))})]},Q))]})]})},Ya=t=>new Intl.NumberFormat("tr-TR").format(t||0),DN=()=>{const[t,s]=c.useState([]),[r,n]=c.useState([]),[a,l]=c.useState(!0),[i,d]=c.useState(""),[u,f]=c.useState(""),[N,C]=c.useState("all");c.useEffect(()=>{b()},[]);const b=async()=>{try{l(!0),d("");const[p,m]=await Promise.all([qc(),cr()]);s(p),n(m)}catch(p){d(p.message||"Veriler alnamad")}finally{l(!1)}},L=c.useMemo(()=>{const p=[];return t.filter(m=>["sent","partial"].includes(m.status)).forEach(m=>{var v;(v=m.items)==null||v.forEach(z=>{const W=z.quantity-(z.receivedQty||0);W>0&&p.push({id:`${m.id}-${z.productCode}-${z.colorCode}`,orderId:m.id,supplierId:m.supplierId,supplierName:m.supplierName,expectedDate:m.expectedDate,productCode:z.productCode,colorCode:z.colorCode,productName:z.productName,ordered:z.quantity,received:z.receivedQty||0,remaining:W,unit:z.unit,status:m.status})})}),p},[t]),k=c.useMemo(()=>{let p=[...L];if(u){const m=u.toLowerCase();p=p.filter(v=>v.orderId.toLowerCase().includes(m)||v.productCode.toLowerCase().includes(m)||v.productName.toLowerCase().includes(m))}return N!=="all"&&(p=p.filter(m=>m.supplierId===N)),p.sort((m,v)=>m.expectedDate?v.expectedDate?new Date(m.expectedDate)-new Date(v.expectedDate):-1:1)},[L,u,N]),E=c.useMemo(()=>{const p=L.length,m=L.reduce((W,F)=>W+F.remaining,0),v=L.filter(W=>W.expectedDate?new Date(W.expectedDate)<new Date:!1).length,z=new Set(L.map(W=>W.orderId)).size;return{totalItems:p,totalRemaining:m,overdueCount:v,uniqueOrders:z}},[L]),y=p=>{if(!p)return null;const m=new Date(p),v=new Date;return v.setHours(0,0,0,0),m.setHours(0,0,0,0),Math.floor((v-m)/(1e3*60*60*24))};return e.jsxs("div",{children:[e.jsx(Fe,{title:"Bekleyen Teslimatlar",subtitle:"Gnderilmi siparilerdeki teslim alnmam rnler"}),e.jsxs("div",{className:"stats-grid",style:{marginBottom:16},children:[e.jsx("div",{className:"card",style:{padding:16},children:e.jsxs("div",{className:"metric-row",children:[e.jsx("div",{className:"metric-icon",children:""}),e.jsxs("div",{children:[e.jsx("div",{className:"metric-label",children:"Bekleyen Kalem"}),e.jsx("div",{className:"metric-value",children:E.totalItems})]})]})}),e.jsx("div",{className:"card",style:{padding:16},children:e.jsxs("div",{className:"metric-row",children:[e.jsx("div",{className:"metric-icon",children:""}),e.jsxs("div",{children:[e.jsx("div",{className:"metric-label",children:"Ak Sipari"}),e.jsx("div",{className:"metric-value",children:E.uniqueOrders})]})]})}),e.jsx("div",{className:"card",style:{padding:16},children:e.jsxs("div",{className:"metric-row",children:[e.jsx("div",{className:"metric-icon",children:""}),e.jsxs("div",{children:[e.jsx("div",{className:"metric-label",children:"Toplam Bekleyen"}),e.jsx("div",{className:"metric-value",children:Ya(E.totalRemaining)})]})]})}),e.jsx("div",{className:"card",style:{padding:16,background:E.overdueCount>0?"var(--color-danger-bg)":void 0},children:e.jsxs("div",{className:"metric-row",children:[e.jsx("div",{className:"metric-icon",children:""}),e.jsxs("div",{children:[e.jsx("div",{className:"metric-label",children:"Gecikmi"}),e.jsx("div",{className:"metric-value",style:{color:E.overdueCount>0?"var(--color-danger)":void 0},children:E.overdueCount})]})]})})]}),e.jsxs("div",{className:"filter-bar",style:{marginBottom:16},children:[e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{className:"filter-label",children:"Ara"}),e.jsx("input",{className:"filter-input",type:"search",placeholder:"Sipari no, rn...",value:u,onChange:p=>f(p.target.value)})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{className:"filter-label",children:"Tedariki"}),e.jsxs("select",{className:"filter-input",value:N,onChange:p=>C(p.target.value),children:[e.jsx("option",{value:"all",children:"Tm"}),r.map(p=>e.jsx("option",{value:p.id,children:p.name},p.id))]})]})]}),a?e.jsx(ft,{text:"Bekleyen teslimatlar ykleniyor..."}):i?e.jsxs("div",{className:"card error-card",children:[e.jsx("div",{className:"error-title",children:"Hata"}),e.jsx("div",{className:"error-message",children:i})]}):L.length===0?e.jsxs("div",{className:"card",style:{padding:40,textAlign:"center"},children:[e.jsx("div",{style:{fontSize:48,marginBottom:16},children:""}),e.jsx("h3",{children:"Tm Teslimatlar Tamamland"}),e.jsx("p",{className:"text-muted",children:"Bekleyen rn bulunmuyor."})]}):e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header",children:[e.jsx("h3",{className:"card-title",children:"Bekleyen rnler"}),e.jsxs("span",{className:"badge badge-warning",children:[k.length," kalem"]})]}),e.jsx(et,{columns:[{label:"Sipari",accessor:"orderId",render:p=>e.jsx("strong",{children:p})},{label:"Tedariki",accessor:"supplierName"},{label:"rn",accessor:"productName",render:(p,m)=>e.jsxs("div",{children:[e.jsx("strong",{children:m.productCode}),"-",m.colorCode,e.jsx("div",{className:"text-muted",children:m.productName})]})},{label:"Sipari",accessor:"ordered",render:(p,m)=>`${Ya(p)} ${m.unit}`},{label:"Teslim Alnan",accessor:"received",render:p=>e.jsx("span",{style:{color:"var(--color-success)"},children:Ya(p)})},{label:"Kalan",accessor:"remaining",render:(p,m)=>e.jsxs("strong",{style:{color:"var(--color-warning)"},children:[Ya(p)," ",m.unit]})},{label:"Beklenen Tarih",accessor:"expectedDate",render:p=>{if(!p)return"-";const m=y(p),v=m>0,z=m===0;return e.jsxs("div",{children:[e.jsx("span",{className:`badge badge-${v?"danger":z?"warning":"secondary"}`,children:p}),v&&e.jsxs("div",{style:{fontSize:11,color:"var(--color-danger)",fontWeight:600,marginTop:2},children:[" ",m," gn geti!"]}),m<0&&e.jsxs("div",{style:{fontSize:10,color:"var(--color-text-muted)",marginTop:2},children:[Math.abs(m)," gn kald"]}),z&&e.jsx("div",{style:{fontSize:11,color:"var(--color-warning)",fontWeight:600,marginTop:2},children:" Bugn!"})]})}},{label:"Durum",accessor:"status",render:p=>e.jsx("span",{className:`badge badge-${p==="partial"?"warning":"primary"}`,children:p==="partial"?"Ksmi":"Bekliyor"})}],rows:k})]})]})},zN=()=>{const[t,s]=c.useState([]),[r,n]=c.useState([]),[a,l]=c.useState(!0),[i,d]=c.useState("");c.useEffect(()=>{(async()=>{try{l(!0),d("");const[N,C]=await Promise.all([ja(),by()]);s(N),n(C)}catch(N){d(N.message||"Stok verisi alnamad")}finally{l(!1)}})()},[]);const u=c.useMemo(()=>{var L;const f=t.length,N=t.reduce((k,E)=>k+(E.onHand||0),0),C=t.filter(k=>k.onHand-k.reserved<=k.critical).length,b=((L=r[0])==null?void 0:L.date)||"-";return[{id:"stk1",label:"Kalem Says",value:f,icon:"",tone:"primary"},{id:"stk2",label:"Mevcut Stok",value:N,icon:"",tone:"success"},{id:"stk3",label:"Kritik Kalem",value:C,icon:"",tone:"danger"},{id:"stk4",label:"Son Hareket",value:b,icon:"",tone:"secondary"}]},[t,r]);return e.jsxs("div",{children:[e.jsx(Fe,{title:"Stok",subtitle:"Stok seviyeleri ve hareketlerinin zet grnm"}),a?e.jsx("div",{className:"card subtle-card",children:"Stok verisi ykleniyor..."}):i?e.jsxs("div",{className:"card error-card",children:[e.jsx("div",{className:"error-title",children:"Stok verisi alnamad"}),e.jsx("div",{className:"error-message",children:i})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"stats-grid",children:u.map(f=>e.jsx(Ks,{icon:f.icon,label:f.label,value:f.value,tone:f.tone},f.id))}),e.jsxs("div",{className:"card",style:{marginTop:24},children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{className:"card-title",children:"ne kan Hareketler"})}),e.jsx("div",{className:"card-body",children:r.slice(0,4).map(f=>e.jsxs("div",{className:"metric-row",style:{marginBottom:8},children:[e.jsxs("span",{className:"metric-label",children:[f.date,"  ",f.item]}),e.jsxs("span",{className:`badge badge-${f.change>=0?"success":"danger"}`,children:[f.change>=0?"+":"",f.change]})]},f.id))})]})]})]})},mr=t=>new Intl.NumberFormat("tr-TR").format(t||0),IN={stockIn:{label:"Stok Girii",icon:"",color:"success"},stockOut:{label:"Stok k",icon:"",color:"danger"},reserve:{label:"Rezervasyon",icon:"",color:"warning"},release:{label:"Rezerv ptal",icon:"",color:"info"},consume:{label:"retime Alnd",icon:"",color:"primary"}},Mh=[{value:"sayim",label:"Saym Dzeltme"},{value:"siparis",label:"Sipari Teslimi"},{value:"bayi",label:"Bayi'den Alm"},{value:"iade",label:"ade"},{value:"diger",label:"Dier"}],Oh=[{value:"fire",label:"Fire / Kayp"},{value:"sayim",label:"Saym Dzeltme"},{value:"bayi",label:"Bayi'ye Verildi"},{value:"hurda",label:"Hurda"},{value:"diger",label:"Dier"}],hs={itemId:"",productCode:"",colorCode:"",name:"",qty:1,unit:"boy"},EN=()=>{const[t,s]=c.useState([]),[r,n]=c.useState([]),[a,l]=c.useState(!0),[i,d]=c.useState(""),[u,f]=c.useState(""),[N,C]=c.useState("all"),[b,L]=c.useState(""),[k,E]=c.useState(""),[y,p]=c.useState(""),[m,v]=c.useState(!1),[z,W]=c.useState([{...hs}]),[F,q]=c.useState("sayim"),[X,Q]=c.useState(""),[A,ue]=c.useState(""),[Z,ae]=c.useState(!1),[$,ne]=c.useState([{...hs}]),[U,pe]=c.useState("fire"),[V,D]=c.useState(""),[S,g]=c.useState(""),[x,M]=c.useState(!1);c.useRef([]),c.useEffect(()=>{w()},[]);const w=async()=>{try{l(!0),d("");const[R,le]=await Promise.all([by(),ja()]);s(R),n(le)}catch(R){d(R.message||"Veriler alnamad")}finally{l(!1)}},j=c.useMemo(()=>r.map(R=>({id:R.id,productCode:R.productCode,colorCode:R.colorCode,name:R.name,colorName:R.colorName,unit:R.unit,available:Math.max(0,(R.onHand||0)-(R.reserved||0)),onHand:R.onHand||0,displayText:`${R.productCode}-${R.colorCode} ${R.name} ${R.colorName||""}`})),[r]),B=c.useMemo(()=>{let R=[...t];if(u){const le=u.toLowerCase();R=R.filter(ie=>(ie.item||"").toLowerCase().includes(le)||(ie.productCode||"").toLowerCase().includes(le)||(ie.reason||"").toLowerCase().includes(le))}return N!=="all"&&(R=R.filter(le=>le.type===N)),b&&(R=R.filter(le=>le.date===b)),R.sort((le,ie)=>new Date(ie.date)-new Date(le.date))},[t,u,N,b]),K=c.useMemo(()=>{const R=new Date().toISOString().slice(0,10),le=t.filter(Me=>Me.date===R),ie=le.filter(Me=>Me.type==="stockIn").reduce((Me,ee)=>Me+Math.abs(ee.change||0),0),De=le.filter(Me=>Me.type==="stockOut"||Me.type==="consume").reduce((Me,ee)=>Me+Math.abs(ee.change||0),0);return{total:t.length,todayCount:le.length,todayIn:ie,todayOut:De}},[t]),se=(R,le)=>{le&&W(ie=>ie.map((De,Me)=>Me===R?{...De,itemId:le.id,productCode:le.productCode,colorCode:le.colorCode,name:le.name,unit:le.unit||"boy"}:De))},oe=(R,le)=>{le&&ne(ie=>ie.map((De,Me)=>Me===R?{...De,itemId:le.id,productCode:le.productCode,colorCode:le.colorCode,name:le.name,unit:le.unit||"boy",maxQty:le.available}:De))},O=()=>{W(R=>[...R,{...hs}]),setTimeout(()=>{var le;const R=document.querySelectorAll("#entry-form .autocomplete-container input");R.length>0&&((le=R[R.length-1])==null||le.focus())},100)},ce=()=>{ne(R=>[...R,{...hs}]),setTimeout(()=>{var le;const R=document.querySelectorAll("#exit-form .autocomplete-container input");R.length>0&&((le=R[R.length-1])==null||le.focus())},100)},je=R=>{W(le=>le.filter((ie,De)=>De!==R))},we=R=>{ne(le=>le.filter((ie,De)=>De!==R))},Ee=(R,le)=>{W(ie=>ie.map((De,Me)=>Me===R?{...De,qty:Number(le)||0}:De))},T=(R,le)=>{ne(ie=>ie.map((De,Me)=>Me===R?{...De,qty:Number(le)||0}:De))},re=async R=>{var ie;R.preventDefault();const le=z.filter(De=>De.itemId&&De.qty>0);if(le.length===0){d("En az bir rn ekleyin");return}try{M(!0),d("");const De=((ie=Mh.find(Me=>Me.value===F))==null?void 0:ie.label)||F;for(const Me of le)await jh({itemId:Me.itemId,qty:Me.qty,type:"stockIn",reason:`${De}${X?` - ${X}`:""}`,operator:A||"Sistem",reference:null});await w(),W([{...hs}]),q("sayim"),Q(""),ue(""),v(!1)}catch(De){d(De.message||"Stok girii yaplamad")}finally{M(!1)}},ke=async R=>{var ie;R.preventDefault();const le=$.filter(De=>De.itemId&&De.qty>0);if(le.length===0){d("En az bir rn ekleyin");return}try{M(!0),d("");const De=((ie=Oh.find(Me=>Me.value===U))==null?void 0:ie.label)||U;for(const Me of le)await jh({itemId:Me.itemId,qty:Me.qty,type:"stockOut",reason:`${De}${V?` - ${V}`:""}`,operator:S||"Sistem",reference:null});await w(),ne([{...hs}]),pe("fire"),D(""),g(""),ae(!1)}catch(De){d(De.message||"Stok k yaplamad")}finally{M(!1)}},Ie=(R,le)=>{R.key==="Enter"&&z[le].itemId&&z[le].qty>0&&(R.preventDefault(),O())},Ne=(R,le)=>{R.key==="Enter"&&$[le].itemId&&$[le].qty>0&&(R.preventDefault(),ce())},Re=()=>{W([{...hs}]),q("sayim"),Q(""),ue(""),E(""),d(""),v(!0)},Oe=()=>{ne([{...hs}]),pe("fire"),D(""),g(""),p(""),d(""),ae(!0)};return e.jsxs("div",{children:[e.jsx(Fe,{title:"Stok Hareketleri",subtitle:"Stok giri, k ve hareket kaytlar",actions:e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-success",type:"button",onClick:Re,children:" Stok Girii"}),e.jsx("button",{className:"btn btn-danger",type:"button",onClick:Oe,children:" Stok k"})]})}),e.jsxs("div",{className:"stats-grid",style:{marginBottom:16},children:[e.jsx("div",{className:"card",style:{padding:16},children:e.jsxs("div",{className:"metric-row",children:[e.jsx("div",{className:"metric-icon",children:""}),e.jsxs("div",{children:[e.jsx("div",{className:"metric-label",children:"Toplam Hareket"}),e.jsx("div",{className:"metric-value",children:mr(K.total)})]})]})}),e.jsx("div",{className:"card",style:{padding:16},children:e.jsxs("div",{className:"metric-row",children:[e.jsx("div",{className:"metric-icon",children:""}),e.jsxs("div",{children:[e.jsx("div",{className:"metric-label",children:"Bugn"}),e.jsx("div",{className:"metric-value",children:mr(K.todayCount)})]})]})}),e.jsx("div",{className:"card",style:{padding:16},children:e.jsxs("div",{className:"metric-row",children:[e.jsx("div",{className:"metric-icon",children:""}),e.jsxs("div",{children:[e.jsx("div",{className:"metric-label",children:"Bugn Giri"}),e.jsxs("div",{className:"metric-value",style:{color:"var(--color-success)"},children:["+",mr(K.todayIn)]})]})]})}),e.jsx("div",{className:"card",style:{padding:16},children:e.jsxs("div",{className:"metric-row",children:[e.jsx("div",{className:"metric-icon",children:""}),e.jsxs("div",{children:[e.jsx("div",{className:"metric-label",children:"Bugn k"}),e.jsxs("div",{className:"metric-value",style:{color:"var(--color-danger)"},children:["-",mr(K.todayOut)]})]})]})})]}),e.jsxs("div",{className:"filter-bar",style:{marginBottom:16},children:[e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{className:"filter-label",children:"Ara"}),e.jsx("input",{className:"filter-input",type:"search",placeholder:"rn, neden...",value:u,onChange:R=>f(R.target.value)})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{className:"filter-label",children:"Hareket Tipi"}),e.jsxs("select",{className:"filter-input",value:N,onChange:R=>C(R.target.value),children:[e.jsx("option",{value:"all",children:"Tm"}),e.jsx("option",{value:"stockIn",children:"Giri"}),e.jsx("option",{value:"stockOut",children:"k"}),e.jsx("option",{value:"reserve",children:"Rezervasyon"}),e.jsx("option",{value:"consume",children:"retim"})]})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{className:"filter-label",children:"Tarih"}),e.jsx(Qe,{className:"filter-input",value:b,onChange:R=>L(R)})]})]}),i&&e.jsxs("div",{className:"card error-card",style:{marginBottom:16},children:[e.jsx("div",{className:"error-title",children:"Hata"}),e.jsx("div",{className:"error-message",children:i})]}),a?e.jsx(ft,{text:"Hareketler ykleniyor..."}):e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-header",children:[e.jsx("h3",{className:"card-title",children:"Hareket Gemii"}),e.jsxs("span",{className:"badge badge-secondary",children:[B.length," kayt"]})]}),e.jsx(et,{columns:[{label:"Tarih",accessor:"date"},{label:"rn",accessor:"item",render:(R,le)=>e.jsxs("div",{children:[e.jsx("strong",{children:le.productCode||"-"}),"-",le.colorCode||"-",e.jsx("div",{className:"text-muted",style:{fontSize:12},children:le.item})]})},{label:"Tip",accessor:"type",render:R=>{const le=IN[R]||{label:R,color:"secondary"};return e.jsxs("span",{className:`badge badge-${le.color}`,children:[le.icon," ",le.label]})}},{label:"Miktar",accessor:"change",render:R=>e.jsxs("strong",{style:{color:R>=0?"var(--color-success)":"var(--color-danger)"},children:[R>=0?"+":"",mr(R)]})},{label:"Neden",accessor:"reason"},{label:"Operatr",accessor:"operator"},{label:"Referans",accessor:"reference",render:R=>R||"-"}],rows:B})]}),e.jsx(Be,{open:m,title:" Stok Girii",size:"xxlarge",onClose:()=>v(!1),actions:e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{flex:1,textAlign:"left",fontSize:13,color:"var(--text-muted)"},children:z.filter(R=>R.itemId&&R.qty>0).length>0&&` ${z.filter(R=>R.itemId&&R.qty>0).length} rn seildi`}),e.jsx("button",{className:"btn btn-secondary",type:"button",onClick:()=>v(!1),children:"ptal"}),e.jsx("button",{className:"btn btn-success",type:"submit",form:"entry-form",disabled:x||!z.some(R=>R.itemId&&R.qty>0),children:x?"Kaydediliyor...":" Stok Girii Yap"})]}),children:e.jsxs("form",{id:"entry-form",onSubmit:re,children:[e.jsx("div",{style:{background:"linear-gradient(135deg, #dcfce7 0%, #bbf7d0 100%)",padding:16,borderRadius:12,marginBottom:16},children:e.jsxs("div",{className:"grid grid-3",style:{gap:16},children:[e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",style:{fontWeight:600},children:" Giri Tr"}),e.jsx("select",{className:"form-select",value:F,onChange:R=>q(R.target.value),style:{background:"white"},children:Mh.map(R=>e.jsx("option",{value:R.value,children:R.label},R.value))})]}),e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",style:{fontWeight:600},children:" lemi Yapan"}),e.jsx("input",{className:"form-input",value:A,onChange:R=>ue(R.target.value),placeholder:"sim...",style:{background:"white"}})]}),e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",style:{fontWeight:600},children:" Not"}),e.jsx("input",{className:"form-input",value:X,onChange:R=>Q(R.target.value),placeholder:"Aklama...",style:{background:"white"}})]})]})}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16,minHeight:400},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[e.jsxs("div",{style:{background:"var(--color-bg-secondary)",padding:12,borderRadius:"12px 12px 0 0",borderBottom:"2px solid var(--color-primary)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:8},children:[e.jsx("span",{style:{fontSize:18},children:""}),e.jsx("span",{style:{fontWeight:600},children:"rn Ara"})]}),e.jsx("input",{id:"entry-search-input",className:"form-input",type:"search",placeholder:"rn kodu veya ad yazn...",value:k,onChange:R=>E(R.target.value),autoFocus:!0,style:{fontSize:15}})]}),e.jsx("div",{style:{flex:1,border:"1px solid var(--color-border)",borderTop:0,borderRadius:"0 0 12px 12px",overflow:"hidden",display:"flex",flexDirection:"column"},children:e.jsxs("div",{style:{flex:1,overflow:"auto",maxHeight:340},children:[j.filter(R=>{if(!k.trim())return!0;const le=k.toLowerCase();return(R.productCode||"").toLowerCase().includes(le)||(R.colorCode||"").toLowerCase().includes(le)||(R.name||"").toLowerCase().includes(le)||(R.colorName||"").toLowerCase().includes(le)}).slice(0,50).map(R=>{const le=z.some(ie=>ie.itemId===R.id);return e.jsx("div",{onClick:()=>{if(!le){const ie=z.findIndex(De=>!De.itemId);ie>=0?se(ie,R):W(De=>[...De,{...hs,itemId:R.id,productCode:R.productCode,colorCode:R.colorCode,name:R.name,unit:R.unit||"boy"}])}},style:{padding:"10px 14px",borderBottom:"1px solid var(--color-border)",cursor:le?"not-allowed":"pointer",background:le?"var(--color-bg-secondary)":"white",opacity:le?.5:1,transition:"background 0.15s"},onMouseEnter:ie=>!le&&(ie.currentTarget.style.background="#f0fdf4"),onMouseLeave:ie=>!le&&(ie.currentTarget.style.background="white"),children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsxs("div",{style:{fontWeight:600,fontSize:14},children:[e.jsx("span",{style:{color:"var(--color-primary)"},children:R.productCode}),e.jsxs("span",{style:{color:"var(--color-text-secondary)"},children:["-",R.colorCode]})]}),e.jsxs("div",{style:{fontSize:13,color:"var(--color-text-secondary)"},children:[R.name," ",R.colorName&&`(${R.colorName})`]})]}),e.jsxs("div",{style:{textAlign:"right"},children:[e.jsxs("div",{style:{fontSize:13,fontWeight:600},children:[R.onHand," ",R.unit]}),le&&e.jsx("span",{className:"badge badge-success",style:{fontSize:10},children:" Seildi"})]})]})},R.id)}),j.filter(R=>{if(!k.trim())return!0;const le=k.toLowerCase();return(R.productCode||"").toLowerCase().includes(le)||(R.colorCode||"").toLowerCase().includes(le)||(R.name||"").toLowerCase().includes(le)}).length===0&&e.jsxs("div",{style:{padding:30,textAlign:"center",color:"var(--color-text-secondary)"},children:[e.jsx("div",{style:{fontSize:32,marginBottom:8},children:""}),e.jsx("div",{children:"rn bulunamad"})]})]})})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[e.jsxs("div",{style:{background:"linear-gradient(135deg, #dbeafe 0%, #bfdbfe 100%)",padding:12,borderRadius:"12px 12px 0 0",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{style:{fontSize:18},children:""}),e.jsx("span",{style:{fontWeight:600},children:"Seilen rnler"})]}),e.jsxs("span",{className:"badge badge-primary",children:[z.filter(R=>R.itemId).length," rn"]})]}),e.jsxs("div",{style:{flex:1,border:"1px solid var(--color-border)",borderTop:0,borderRadius:"0 0 12px 12px",overflow:"hidden",display:"flex",flexDirection:"column"},children:[e.jsx("div",{style:{flex:1,overflow:"auto",maxHeight:340},children:z.filter(R=>R.itemId).length===0?e.jsxs("div",{style:{padding:40,textAlign:"center",color:"var(--color-text-secondary)"},children:[e.jsx("div",{style:{fontSize:48,marginBottom:12},children:""}),e.jsx("div",{style:{fontWeight:600,marginBottom:4},children:"Henz rn seilmedi"}),e.jsx("div",{style:{fontSize:13},children:"Soldan rn seerek balayn"})]}):z.map((R,le)=>R.itemId&&e.jsxs("div",{style:{padding:"12px 14px",borderBottom:"1px solid var(--color-border)",background:"white"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:8},children:[e.jsxs("div",{children:[e.jsxs("div",{style:{fontWeight:600,fontSize:14},children:[e.jsx("span",{style:{color:"var(--color-primary)"},children:R.productCode}),e.jsxs("span",{style:{color:"var(--color-text-secondary)"},children:["-",R.colorCode]})]}),e.jsx("div",{style:{fontSize:13,color:"var(--color-text-secondary)"},children:R.name})]}),e.jsx("button",{type:"button",className:"btn btn-danger btn-small btn-icon",onClick:()=>je(le),style:{padding:"4px 8px"},title:"Kalemi Kaldr",children:""})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("label",{style:{fontSize:12,fontWeight:600,color:"var(--color-text-secondary)"},children:"Miktar:"}),e.jsx(Cs,{className:"form-input",min:1,value:R.qty,onChange:ie=>Ee(le,ie),onKeyDown:ie=>Ie(ie,le),style:{width:80,padding:"6px 10px"}}),e.jsx("span",{style:{fontSize:12,color:"var(--color-text-secondary)"},children:R.unit})]})]},le))}),z.filter(R=>R.itemId&&R.qty>0).length>0&&e.jsxs("div",{style:{padding:12,background:"var(--color-bg-secondary)",borderTop:"1px solid var(--color-border)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{style:{fontWeight:600},children:"Toplam Giri:"}),e.jsxs("span",{style:{fontSize:18,fontWeight:700,color:"var(--color-success)"},children:["+",mr(z.filter(R=>R.itemId).reduce((R,le)=>R+(le.qty||0),0))]})]})]})]})]})]})}),e.jsx(Be,{open:Z,title:" Stok k",size:"xxlarge",onClose:()=>ae(!1),actions:e.jsxs(e.Fragment,{children:[e.jsx("div",{style:{flex:1,textAlign:"left",fontSize:13,color:"var(--text-muted)"},children:$.filter(R=>R.itemId&&R.qty>0).length>0&&` ${$.filter(R=>R.itemId&&R.qty>0).length} rn kartlacak`}),e.jsx("button",{className:"btn btn-secondary",type:"button",onClick:()=>ae(!1),children:"ptal"}),e.jsx("button",{className:"btn btn-danger",type:"submit",form:"exit-form",disabled:x||!$.some(R=>R.itemId&&R.qty>0),children:x?"Kaydediliyor...":" Stok k Yap"})]}),children:e.jsxs("form",{id:"exit-form",onSubmit:ke,children:[e.jsx("div",{style:{background:"linear-gradient(135deg, #fee2e2 0%, #fecaca 100%)",padding:16,borderRadius:12,marginBottom:16},children:e.jsxs("div",{className:"grid grid-3",style:{gap:16},children:[e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",style:{fontWeight:600},children:" k Tr"}),e.jsx("select",{className:"form-select",value:U,onChange:R=>pe(R.target.value),style:{background:"white"},children:Oh.map(R=>e.jsx("option",{value:R.value,children:R.label},R.value))})]}),e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",style:{fontWeight:600},children:" lemi Yapan"}),e.jsx("input",{className:"form-input",value:S,onChange:R=>g(R.target.value),placeholder:"sim...",style:{background:"white"}})]}),e.jsxs("div",{className:"form-group",style:{margin:0},children:[e.jsx("label",{className:"form-label",style:{fontWeight:600},children:" Not"}),e.jsx("input",{className:"form-input",value:V,onChange:R=>D(R.target.value),placeholder:"Aklama...",style:{background:"white"}})]})]})}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16,minHeight:400},children:[e.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[e.jsxs("div",{style:{background:"var(--color-bg-secondary)",padding:12,borderRadius:"12px 12px 0 0",borderBottom:"2px solid var(--color-danger)"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8,marginBottom:8},children:[e.jsx("span",{style:{fontSize:18},children:""}),e.jsx("span",{style:{fontWeight:600},children:"rn Ara"}),e.jsx("span",{className:"text-muted",style:{fontSize:11,marginLeft:"auto"},children:" Sadece stokta olanlar"})]}),e.jsx("input",{id:"exit-search-input",className:"form-input",type:"search",placeholder:"rn kodu veya ad yazn...",value:y,onChange:R=>p(R.target.value),autoFocus:!0,style:{fontSize:15}})]}),e.jsx("div",{style:{flex:1,border:"1px solid var(--color-border)",borderTop:0,borderRadius:"0 0 12px 12px",overflow:"hidden",display:"flex",flexDirection:"column"},children:e.jsxs("div",{style:{flex:1,overflow:"auto",maxHeight:340},children:[j.filter(R=>R.available>0).filter(R=>{if(!y.trim())return!0;const le=y.toLowerCase();return(R.productCode||"").toLowerCase().includes(le)||(R.colorCode||"").toLowerCase().includes(le)||(R.name||"").toLowerCase().includes(le)||(R.colorName||"").toLowerCase().includes(le)}).slice(0,50).map(R=>{const le=$.some(ie=>ie.itemId===R.id);return e.jsx("div",{onClick:()=>{if(!le){const ie=$.findIndex(De=>!De.itemId);ie>=0?oe(ie,R):ne(De=>[...De,{...hs,itemId:R.id,productCode:R.productCode,colorCode:R.colorCode,name:R.name,unit:R.unit||"boy",maxQty:R.available}])}},style:{padding:"10px 14px",borderBottom:"1px solid var(--color-border)",cursor:le?"not-allowed":"pointer",background:le?"var(--color-bg-secondary)":"white",opacity:le?.5:1,transition:"background 0.15s"},onMouseEnter:ie=>!le&&(ie.currentTarget.style.background="#fef2f2"),onMouseLeave:ie=>!le&&(ie.currentTarget.style.background="white"),children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsxs("div",{style:{fontWeight:600,fontSize:14},children:[e.jsx("span",{style:{color:"var(--color-primary)"},children:R.productCode}),e.jsxs("span",{style:{color:"var(--color-text-secondary)"},children:["-",R.colorCode]})]}),e.jsxs("div",{style:{fontSize:13,color:"var(--color-text-secondary)"},children:[R.name," ",R.colorName&&`(${R.colorName})`]})]}),e.jsxs("div",{style:{textAlign:"right"},children:[e.jsxs("div",{style:{fontSize:13,fontWeight:600,color:"var(--color-success)"},children:[R.available," ",R.unit]}),le&&e.jsx("span",{className:"badge badge-danger",style:{fontSize:10},children:" Seildi"})]})]})},R.id)}),j.filter(R=>R.available>0).filter(R=>{if(!y.trim())return!0;const le=y.toLowerCase();return(R.productCode||"").toLowerCase().includes(le)||(R.colorCode||"").toLowerCase().includes(le)||(R.name||"").toLowerCase().includes(le)}).length===0&&e.jsxs("div",{style:{padding:30,textAlign:"center",color:"var(--color-text-secondary)"},children:[e.jsx("div",{style:{fontSize:32,marginBottom:8},children:""}),e.jsx("div",{children:"Stokta rn bulunamad"})]})]})})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column"},children:[e.jsxs("div",{style:{background:"linear-gradient(135deg, #fef3c7 0%, #fde68a 100%)",padding:12,borderRadius:"12px 12px 0 0",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("span",{style:{fontSize:18},children:""}),e.jsx("span",{style:{fontWeight:600},children:"k Yaplacaklar"})]}),e.jsxs("span",{className:"badge badge-warning",children:[$.filter(R=>R.itemId).length," rn"]})]}),e.jsxs("div",{style:{flex:1,border:"1px solid var(--color-border)",borderTop:0,borderRadius:"0 0 12px 12px",overflow:"hidden",display:"flex",flexDirection:"column"},children:[e.jsx("div",{style:{flex:1,overflow:"auto",maxHeight:340},children:$.filter(R=>R.itemId).length===0?e.jsxs("div",{style:{padding:40,textAlign:"center",color:"var(--color-text-secondary)"},children:[e.jsx("div",{style:{fontSize:48,marginBottom:12},children:""}),e.jsx("div",{style:{fontWeight:600,marginBottom:4},children:"Henz rn seilmedi"}),e.jsx("div",{style:{fontSize:13},children:"Soldan k yaplacak rnleri sein"})]}):$.map((R,le)=>R.itemId&&e.jsxs("div",{style:{padding:"12px 14px",borderBottom:"1px solid var(--color-border)",background:R.qty>(R.maxQty||0)?"#fef2f2":"white"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:8},children:[e.jsxs("div",{children:[e.jsxs("div",{style:{fontWeight:600,fontSize:14},children:[e.jsx("span",{style:{color:"var(--color-primary)"},children:R.productCode}),e.jsxs("span",{style:{color:"var(--color-text-secondary)"},children:["-",R.colorCode]})]}),e.jsx("div",{style:{fontSize:13,color:"var(--color-text-secondary)"},children:R.name})]}),e.jsx("button",{type:"button",className:"btn btn-danger btn-small btn-icon",onClick:()=>we(le),style:{padding:"4px 8px"},title:"Kalemi Kaldr",children:""})]}),e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx("label",{style:{fontSize:12,fontWeight:600,color:"var(--color-text-secondary)"},children:"Miktar:"}),e.jsx(Cs,{className:"form-input",min:1,max:R.maxQty||999999,value:R.qty,onChange:ie=>T(le,ie),onKeyDown:ie=>Ne(ie,le),style:{width:80,padding:"6px 10px",borderColor:R.qty>(R.maxQty||0)?"var(--color-danger)":void 0}}),e.jsxs("span",{style:{fontSize:12,color:"var(--color-text-secondary)"},children:["/ ",R.maxQty||0," ",R.unit]}),R.qty>(R.maxQty||0)&&e.jsx("span",{style:{fontSize:11,color:"var(--color-danger)"},children:" Stok yetersiz!"})]})]},le))}),$.filter(R=>R.itemId&&R.qty>0).length>0&&e.jsxs("div",{style:{padding:12,background:"var(--color-bg-secondary)",borderTop:"1px solid var(--color-border)",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx("span",{style:{fontWeight:600},children:"Toplam k:"}),e.jsxs("span",{style:{fontSize:18,fontWeight:700,color:"var(--color-danger)"},children:["-",mr($.filter(R=>R.itemId).reduce((R,le)=>R+(le.qty||0),0))]})]})]})]})]})]})})]})},AN=()=>{const[t,s]=c.useState([]),[r,n]=c.useState(!0),[a,l]=c.useState("");c.useEffect(()=>{(async()=>{try{n(!0),l("");const u=await ja();s(u)}catch(u){l(u.message||"Kritik stoklar alnamad")}finally{n(!1)}})()},[]);const i=c.useMemo(()=>t.filter(d=>d.onHand-d.reserved<=d.critical),[t]);return e.jsxs("div",{children:[e.jsx(Fe,{title:"Kritik Stok",subtitle:"Kritik seviyenin altndaki kalemler"}),r?e.jsx("div",{className:"card subtle-card",children:"Kritik stoklar ykleniyor..."}):a?e.jsxs("div",{className:"card error-card",children:[e.jsx("div",{className:"error-title",children:"Kritik stoklar alnamad"}),e.jsx("div",{className:"error-message",children:a})]}):e.jsx(et,{columns:[{label:"Kalem",accessor:"name"},{label:"SKU",accessor:"sku"},{label:"Mevcut",accessor:"onHand"},{label:"Rezerve",accessor:"reserved"},{label:"Kritik Limit",accessor:"critical"},{label:"Tedariki",accessor:"supplier"}],rows:i})]})},_h={productCode:"",colorCode:"",name:"",colorName:"",unit:"boy",supplierId:"",supplierName:"",critical:0,unitCost:0,notes:""},Rn=t=>{const s=Math.max(0,(t.onHand||0)-(t.reserved||0)),r=t.critical||0;return s<=0?{label:"Tkendi",tone:"danger"}:s<=r?{label:"Kritik",tone:"danger"}:s<=r*1.5?{label:"Dk",tone:"warning"}:{label:"Salkl",tone:"success"}},Os=t=>new Intl.NumberFormat("tr-TR").format(t||0),RN=t=>new Intl.NumberFormat("tr-TR",{style:"currency",currency:"TRY",maximumFractionDigits:0}).format(t||0),BN=()=>{const[t,s]=c.useState([]),[r,n]=c.useState([]),[a,l]=c.useState([]),[i,d]=c.useState(""),[u,f]=c.useState(""),[N,C]=c.useState(""),[b,L]=c.useState("all"),[k,E]=c.useState("all"),[y,p]=c.useState(!1),[m,v]=c.useState("name"),[z,W]=c.useState("asc"),[F,q]=c.useState(!0),[X,Q]=c.useState(""),[A,ue]=c.useState(!1),[Z,ae]=c.useState(null),[$,ne]=c.useState(_h),[U,pe]=c.useState({}),[V,D]=c.useState(!1),[S,g]=c.useState(null);c.useEffect(()=>{x()},[]);const x=async()=>{try{q(!0),Q("");const[T,re,ke]=await Promise.all([ja(),Sy().catch(()=>[]),cr().catch(()=>[])]);s(T),n(re),l(ke)}catch(T){Q(T.message||"Stok listesi alnamad")}finally{q(!1)}},M=c.useMemo(()=>a.map(T=>({id:T.id,name:T.name,displayName:`${T.name} (${T.type==="dealer"?"Bayi":"retici"})`})),[a]),w=c.useMemo(()=>{const T=new Map;return r.forEach(re=>{T.set(re.code||re.id,{code:re.code||re.id,name:re.name})}),t.forEach(re=>{re.colorCode&&!T.has(re.colorCode)&&T.set(re.colorCode,{code:re.colorCode,name:re.colorName||re.colorCode})}),Array.from(T.values())},[r,t]),j=c.useMemo(()=>{const T=i.trim().toLowerCase(),re=u.trim().toLowerCase(),ke=N.trim().toLowerCase();let Ie=[...t];return T&&(Ie=Ie.filter(Ne=>(Ne.name||"").toLowerCase().includes(T)||(Ne.supplierName||"").toLowerCase().includes(T))),re&&(Ie=Ie.filter(Ne=>(Ne.productCode||"").toLowerCase().includes(re))),ke&&(Ie=Ie.filter(Ne=>(Ne.colorCode||"").toLowerCase().includes(ke))),b!=="all"&&(Ie=Ie.filter(Ne=>Ne.supplierId===b)),k!=="all"&&(Ie=Ie.filter(Ne=>Rn(Ne).label===k)),y&&(Ie=Ie.filter(Ne=>Rn(Ne).tone!=="success")),Ie.sort((Ne,Re)=>{const Oe=m==="available"?(Ne.onHand||0)-(Ne.reserved||0):Ne[m],R=m==="available"?(Re.onHand||0)-(Re.reserved||0):Re[m];return typeof Oe=="string"?z==="asc"?(Oe||"").localeCompare(R||""):(R||"").localeCompare(Oe||""):z==="asc"?(Oe||0)-(R||0):(R||0)-(Oe||0)}),Ie.map(Ne=>({...Ne,available:Math.max(0,(Ne.onHand||0)-(Ne.reserved||0)),stockValue:(Ne.unitCost||0)*(Ne.onHand||0)}))},[t,i,u,N,b,k,m,z,y]),B=c.useMemo(()=>{const T=t.length,re=t.reduce((Re,Oe)=>Re+(Oe.onHand||0),0),ke=t.reduce((Re,Oe)=>Re+Math.max(0,(Oe.onHand||0)-(Oe.reserved||0)),0),Ie=t.filter(Re=>Rn(Re).tone!=="success").length,Ne=t.reduce((Re,Oe)=>Re+(Oe.unitCost||0)*(Oe.onHand||0),0);return[{id:"sum1",label:"rn eidi",value:Os(T),icon:""},{id:"sum2",label:"Mevcut Stok",value:Os(re),icon:""},{id:"sum3",label:"Kullanlabilir",value:Os(ke),icon:""},{id:"sum4",label:"Dikkat Gereken",value:Os(Ie),icon:""},{id:"sum5",label:"Tahmini Deer",value:RN(Ne),icon:""}]},[t]),K=()=>{ae(null),ne(_h),pe({}),ue(!0)},se=T=>{ae(T),ne({productCode:T.productCode||"",colorCode:T.colorCode||"",name:T.name||"",colorName:T.colorName||"",unit:T.unit||"boy",supplierId:T.supplierId||"",supplierName:T.supplierName||"",critical:T.critical||0,unitCost:T.unitCost||0,notes:T.notes||""}),pe({}),ue(!0)},oe=()=>{const T={};return $.productCode.trim()||(T.productCode="rn kodu gerekli"),$.colorCode.trim()||(T.colorCode="Renk kodu gerekli"),$.name.trim()||(T.name="rn ad gerekli"),$.unit.trim()||(T.unit="Birim gerekli"),!$.supplierId&&!$.supplierName.trim()&&(T.supplierName="Tedariki gerekli"),Number($.critical)<0&&(T.critical="0 veya zeri olmal"),Number($.unitCost)<0&&(T.unitCost="0 veya zeri olmal"),pe(T),Object.keys(T).length===0},O=async T=>{if(T.preventDefault(),!oe())return;const re={productCode:$.productCode.trim(),colorCode:$.colorCode.trim(),name:$.name.trim(),colorName:$.colorName.trim()||$.colorCode.trim(),unit:$.unit,supplierId:$.supplierId||`SUP-TEMP-${Date.now()}`,supplierName:$.supplierName.trim(),critical:Number($.critical)||0,unitCost:Number($.unitCost)||0,notes:$.notes||""};try{if(D(!0),Q(""),Z){const ke=await i0(Z.id,re);s(Ie=>Ie.map(Ne=>Ne.id===Z.id?ke:Ne))}else{const ke=await l0(re);s(Ie=>[ke,...Ie])}ue(!1),ae(null)}catch(ke){const Ie=ke.message||"Kayt yaplamad";Ie.includes("validation error")||Ie.includes("field required")?Q("Eksik veya hatal alan var. Ltfen tm zorunlu alanlar doldurun."):Q(Ie)}finally{D(!1)}},ce=async()=>{if(S)try{D(!0),await o0(S.id),s(T=>T.filter(re=>re.id!==S.id)),g(null)}catch(T){Q(T.message||"Silinemedi")}finally{D(!1)}},je=()=>{const T=["rn Kodu","Renk Kodu","rn Ad","Tedariki","Mevcut","Rezerve","Kullanlabilir","Kritik","Birim","Birim Maliyet","Durum"],re=t.map(Oe=>{const R=Rn(Oe).label,le=Math.max(0,(Oe.onHand||0)-(Oe.reserved||0));return[Oe.productCode,Oe.colorCode,Oe.name,Oe.supplierName,Oe.onHand,Oe.reserved,le,Oe.critical,Oe.unit,Oe.unitCost,R].map(ie=>`"${String(ie??"").replace(/"/g,'""')}"`).join(",")}),ke=[T.join(","),...re].join(`
`),Ie=new Blob([ke],{type:"text/csv;charset=utf-8;"}),Ne=URL.createObjectURL(Ie),Re=document.createElement("a");Re.href=Ne,Re.download="stok-listesi.csv",Re.click(),URL.revokeObjectURL(Ne)},we=T=>{T&&ne(re=>({...re,colorCode:T.code||T,colorName:T.name||T}))},Ee=T=>{T&&ne(re=>({...re,supplierId:T.id||"",supplierName:T.name||T}))};return e.jsxs("div",{children:[e.jsx(Fe,{title:"Stok Listesi",subtitle:"rn tanmlama ve stok durumu takibi",actions:e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-secondary",type:"button",onClick:je,children:" CSV Da Aktar"}),e.jsx("button",{className:"btn btn-primary",type:"button",onClick:K,children:" Yeni rn"})]})}),e.jsx("div",{className:"stats-grid",style:{marginBottom:16},children:B.map(T=>e.jsx("div",{className:"card",style:{padding:16},children:e.jsxs("div",{className:"metric-row",style:{alignItems:"center"},children:[e.jsx("div",{className:"metric-icon","aria-hidden":"true",children:T.icon}),e.jsxs("div",{style:{flex:1},children:[e.jsx("div",{className:"metric-label",children:T.label}),e.jsx("div",{className:"metric-value",children:T.value})]})]})},T.id))}),e.jsxs("div",{className:"filter-bar",children:[e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{className:"filter-label",children:"rn Ara"}),e.jsx("input",{className:"filter-input",type:"search",placeholder:"rn ad, tedariki...",value:i,onChange:T=>d(T.target.value)})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{className:"filter-label",children:"rn Kodu"}),e.jsx("input",{className:"filter-input",type:"search",placeholder:"Kod ara...",value:u,onChange:T=>f(T.target.value)})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{className:"filter-label",children:"Renk Kodu"}),e.jsx("input",{className:"filter-input",type:"search",placeholder:"Renk ara...",value:N,onChange:T=>C(T.target.value)})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{className:"filter-label",children:"Tedariki"}),e.jsxs("select",{className:"filter-input",value:b,onChange:T=>L(T.target.value),children:[e.jsx("option",{value:"all",children:"Tm"}),a.map(T=>e.jsx("option",{value:T.id,children:T.name},T.id))]})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{className:"filter-label",children:"Durum"}),e.jsxs("select",{className:"filter-input",value:k,onChange:T=>E(T.target.value),children:[e.jsx("option",{value:"all",children:"Tm"}),e.jsx("option",{value:"Kritik",children:"Kritik"}),e.jsx("option",{value:"Dk",children:"Dk"}),e.jsx("option",{value:"Salkl",children:"Salkl"}),e.jsx("option",{value:"Tkendi",children:"Tkendi"})]})]}),e.jsxs("div",{className:"filter-group",children:[e.jsx("label",{className:"filter-label",children:"Srala"}),e.jsxs("select",{className:"filter-input",value:`${m}-${z}`,onChange:T=>{const[re,ke]=T.target.value.split("-");v(re),W(ke)},children:[e.jsx("option",{value:"name-asc",children:"rn Ad (AZ)"}),e.jsx("option",{value:"name-desc",children:"rn Ad (ZA)"}),e.jsx("option",{value:"productCode-asc",children:"rn Kodu (AZ)"}),e.jsx("option",{value:"available-desc",children:"Stok (yksek  dk)"}),e.jsx("option",{value:"available-asc",children:"Stok (dk  yksek)"})]})]}),e.jsx("div",{className:"filter-group",style:{alignSelf:"flex-end"},children:e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8,cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:y,onChange:T=>p(T.target.checked)}),e.jsx("span",{className:"text-muted",children:"Sadece dikkat gereken"})]})})]}),X&&e.jsxs("div",{className:"card error-card",style:{marginTop:16,marginBottom:16},children:[e.jsx("div",{className:"error-title",children:"Hata"}),e.jsx("div",{className:"error-message",children:X})]}),F?e.jsx(ft,{text:"Stok listesi ykleniyor..."}):e.jsxs("div",{className:"card",style:{marginTop:16},children:[e.jsxs("div",{className:"card-header",children:[e.jsx("h3",{className:"card-title",children:"rnler"}),e.jsxs("span",{className:"badge badge-secondary",children:[j.length," kayt"]})]}),e.jsx(et,{columns:[{label:"rn",accessor:"name",render:(T,re)=>e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:600},children:re.name}),e.jsxs("div",{className:"text-muted",style:{fontSize:12},children:["Kod: ",re.productCode,"  Renk: ",re.colorCode]})]})},{label:"Tedariki",accessor:"supplierName",render:T=>T||"-"},{label:"Stok Durumu",accessor:"onHand",render:(T,re)=>e.jsxs("div",{children:[e.jsx("strong",{children:Os(re.onHand||0)})," ",re.unit,e.jsxs("div",{className:"text-muted",style:{fontSize:11},children:["Rezerve: ",Os(re.reserved||0),"  Kullanlabilir: ",e.jsx("strong",{children:Os(re.available)})]})]})},{label:"Kritik",accessor:"critical",render:T=>Os(T||0)},{label:"Durum",accessor:"status",render:(T,re)=>{const ke=Rn(re);return e.jsx("span",{className:`badge badge-${ke.tone}`,children:ke.label})}},{label:"Aksiyon",accessor:"actions",render:(T,re)=>e.jsxs("div",{style:{display:"flex",gap:8},children:[e.jsx("button",{className:"btn btn-secondary btn-icon",type:"button",onClick:()=>se(re),title:"Dzenle",children:""}),e.jsx("button",{className:"btn btn-danger btn-icon",type:"button",onClick:()=>g(re),title:"Sil",children:""})]})}],rows:j})]}),e.jsx(Be,{open:A,title:Z?"rn Dzenle":"Yeni rn Tanmla",size:"large",onClose:()=>ue(!1),actions:e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-secondary",type:"button",onClick:()=>ue(!1),children:"ptal"}),e.jsx("button",{className:"btn btn-primary",type:"submit",form:"stock-form",disabled:V,children:V?"Kaydediliyor...":"Kaydet"})]}),children:e.jsx("form",{id:"stock-form",onSubmit:O,children:e.jsxs("div",{className:"grid grid-2",style:{gap:16},children:[e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{className:"form-label",children:["rn Kodu ",e.jsx("span",{style:{color:"var(--color-danger)"},children:"*"})]}),e.jsx("input",{className:`form-input ${U.productCode?"input-error":""}`,value:$.productCode,onChange:T=>ne(re=>({...re,productCode:T.target.value})),placeholder:"rn: 18300",autoFocus:!0}),U.productCode&&e.jsx("div",{className:"form-error",children:U.productCode})]}),e.jsx(br,{label:"Renk Kodu",required:!0,value:$.colorCode,onChange:T=>ne(re=>({...re,colorCode:T})),onSelect:we,options:w,displayKey:"name",valueKey:"code",placeholder:"Renk kodu yazn...",renderOption:T=>e.jsxs("div",{className:"autocomplete-option-content",children:[e.jsx("span",{className:"autocomplete-option-value",children:T.code}),e.jsx("span",{className:"autocomplete-option-label",children:T.name})]}),error:U.colorCode}),e.jsxs("div",{className:"form-group",style:{gridColumn:"1 / -1"},children:[e.jsxs("label",{className:"form-label",children:["rn Ad ",e.jsx("span",{style:{color:"var(--color-danger)"},children:"*"})]}),e.jsx("input",{className:`form-input ${U.name?"input-error":""}`,value:$.name,onChange:T=>ne(re=>({...re,name:T.target.value})),placeholder:"rn: Carisma Kasa"}),U.name&&e.jsx("div",{className:"form-error",children:U.name})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{className:"form-label",children:["Birim ",e.jsx("span",{style:{color:"var(--color-danger)"},children:"*"})]}),e.jsxs("select",{className:"form-select",value:$.unit,onChange:T=>ne(re=>({...re,unit:T.target.value})),children:[e.jsx("option",{value:"boy",children:"Boy (metre)"}),e.jsx("option",{value:"adet",children:"Adet"}),e.jsx("option",{value:"m2",children:"m (metrekare)"}),e.jsx("option",{value:"kg",children:"Kg"}),e.jsx("option",{value:"paket",children:"Paket"})]})]}),e.jsx(br,{label:"Tedariki",required:!0,value:$.supplierName,onChange:T=>ne(re=>({...re,supplierName:T,supplierId:""})),onSelect:Ee,options:M,displayKey:"name",valueKey:"id",placeholder:"Tedariki ad yazn...",allowCreate:!0,createLabel:"Yeni tedariki ekle",onCreate:T=>{ne(re=>({...re,supplierName:T,supplierId:""}))},renderOption:T=>e.jsx("div",{className:"autocomplete-option-content",children:e.jsx("span",{className:"autocomplete-option-label",children:T.displayName||T.name})}),error:U.supplierName}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Kritik Stok Seviyesi"}),e.jsx("input",{className:`form-input ${U.critical?"input-error":""}`,type:"number",min:"0",value:$.critical,onChange:T=>ne(re=>({...re,critical:T.target.value})),placeholder:"0"}),e.jsx("div",{className:"text-muted",style:{fontSize:11,marginTop:4},children:"Bu seviyenin altna dnce uyar verilir"}),U.critical&&e.jsx("div",{className:"form-error",children:U.critical})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Birim Maliyet ()"}),e.jsx("input",{className:`form-input ${U.unitCost?"input-error":""}`,type:"number",min:"0",step:"0.01",value:$.unitCost,onChange:T=>ne(re=>({...re,unitCost:T.target.value})),placeholder:"0"}),U.unitCost&&e.jsx("div",{className:"form-error",children:U.unitCost})]}),e.jsxs("div",{className:"form-group",style:{gridColumn:"1 / -1"},children:[e.jsx("label",{className:"form-label",children:"Not (Opsiyonel)"}),e.jsx("textarea",{className:"form-textarea",value:$.notes,onChange:T=>ne(re=>({...re,notes:T.target.value})),placeholder:"Ek bilgiler...",rows:2})]})]})})}),e.jsxs(Be,{open:!!S,title:"Silme Onay",size:"small",onClose:()=>g(null),actions:e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-secondary",type:"button",onClick:()=>g(null),children:"Vazge"}),e.jsx("button",{className:"btn btn-danger",type:"button",onClick:ce,disabled:V,children:"Sil"})]}),children:[e.jsxs("p",{children:[e.jsx("strong",{children:S==null?void 0:S.name})," (",S==null?void 0:S.productCode,"-",S==null?void 0:S.colorCode,") rnn silmek istediinize emin misiniz?"]}),e.jsx("p",{className:"text-muted",style:{marginTop:8},children:"Bu ilem geri alnamaz."})]})]})},LN=()=>{const[t,s]=c.useState([]),[r,n]=c.useState(!0),[a,l]=c.useState("");return c.useEffect(()=>{(async()=>{try{n(!0),l("");const d=await Ny();s(d)}catch(d){l(d.message||"Rezervasyonlar alnamad")}finally{n(!1)}})()},[]),e.jsxs("div",{children:[e.jsx(Fe,{title:"Rezervasyonlar",subtitle:"lere ayrlm stok kalemleri"}),r?e.jsx("div",{className:"card subtle-card",children:"Rezervasyonlar ykleniyor..."}):a?e.jsxs("div",{className:"card error-card",children:[e.jsx("div",{className:"error-title",children:"Rezervasyonlar alnamad"}),e.jsx("div",{className:"error-message",children:a})]}):e.jsx(et,{columns:[{label:" Kodu",accessor:"job"},{label:"Kalem",accessor:"item"},{label:"Miktar",accessor:"qty"},{label:"Termin",accessor:"dueDate"},{label:"Durum",accessor:"status"}],rows:t})]})},PN=()=>{const[t,s]=c.useState([]),[r,n]=c.useState(!0),[a,l]=c.useState(""),[i,d]=c.useState(!1),[u,f]=c.useState({name:"",code:""}),[N,C]=c.useState({}),[b,L]=c.useState(!1),[k,E]=c.useState(null);c.useEffect(()=>{(async()=>{try{n(!0);const W=await Sy();s(W)}catch(W){l(W.message||"Renkler yklenemedi")}finally{n(!1)}})()},[]);const y=c.useMemo(()=>[{accessor:"name",label:"Renk Ad"},{accessor:"code",label:"Renk Kodu"},{accessor:"actions",label:"lem",render:(z,W)=>e.jsx("button",{className:"btn btn-danger btn-small",type:"button",onClick:F=>{F.stopPropagation(),E(W)},children:"Sil"})}],[]),p=()=>{const z={};return u.name.trim()||(z.name="Renk ad gerekli"),u.code.trim()||(z.code="Renk kodu gerekli"),C(z),Object.keys(z).length===0},m=async z=>{if(z.preventDefault(),!!p())try{L(!0);const W=await u0({name:u.name.trim(),code:u.code.trim().toUpperCase()});s(F=>[W,...F]),d(!1),f({name:"",code:""})}catch(W){C({submit:W.message||"Renk eklenemedi"})}finally{L(!1)}},v=async()=>{if(k)try{L(!0),await m0(k.id),s(z=>z.filter(W=>W.id!==k.id)),E(null)}catch(z){l(z.message||"Silinemedi")}finally{L(!1)}};return e.jsxs("div",{className:"container",children:[e.jsx(Fe,{title:"Renk Ynetimi",subtitle:"Stok kalemlerinde kullanlacak renkleri tanmlayn",actions:e.jsx("button",{className:"btn btn-primary",type:"button",onClick:()=>{f({name:"",code:""}),C({}),d(!0)},children:"+ Yeni Renk"})}),a&&e.jsxs("div",{className:"card error-card",children:[e.jsx("div",{className:"error-title",children:"Hata"}),e.jsx("div",{className:"error-message",children:a})]}),e.jsx("div",{className:"card",children:e.jsx("div",{className:"card-body",children:r?e.jsx(ft,{text:"Renkler ykleniyor..."}):e.jsx(et,{columns:y,rows:t})})}),e.jsx(Be,{open:i,title:"Yeni Renk Ekle",onClose:()=>d(!1),size:"small",actions:e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-secondary",type:"button",onClick:()=>d(!1),children:"ptal"}),e.jsx("button",{className:"btn btn-primary",type:"submit",form:"color-form",disabled:b,children:b?"Kaydediliyor...":"Kaydet"})]}),children:e.jsxs("form",{id:"color-form",onSubmit:m,children:[N.submit&&e.jsx("div",{className:"error-text",style:{marginBottom:12},children:N.submit}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",htmlFor:"color-name",children:"Renk Ad"}),e.jsx("input",{id:"color-name",className:`form-input ${N.name?"input-error":""}`,type:"text",placeholder:"rn: Beyaz, Antrasit, Krem",value:u.name,onChange:z=>f(W=>({...W,name:z.target.value}))}),N.name&&e.jsx("span",{className:"error-text",children:N.name})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",htmlFor:"color-code",children:"Renk Kodu"}),e.jsx("input",{id:"color-code",className:`form-input ${N.code?"input-error":""}`,type:"text",placeholder:"rn: BYZ, ANT, KRM",value:u.code,onChange:z=>f(W=>({...W,code:z.target.value.toUpperCase()}))}),N.code&&e.jsx("span",{className:"error-text",children:N.code})]})]})}),e.jsx(Be,{open:!!k,title:"Silme Onay",onClose:()=>E(null),size:"small",actions:e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-secondary",type:"button",onClick:()=>E(null),children:"ptal"}),e.jsx("button",{className:"btn btn-danger",type:"button",onClick:v,disabled:b,children:"Sil"})]}),children:e.jsxs("p",{children:[e.jsx("strong",{children:k==null?void 0:k.name})," (",k==null?void 0:k.code,") rengini silmek istediinize emin misiniz?"]})})]})},Fh={internal:{label:" retim",color:"var(--success)",icon:""},external:{label:"D Sipari",color:"var(--warning)",icon:""},glass:{label:"Cam Siparii",color:"var(--info)",icon:""}},$h={pending:{label:"Bekliyor",color:"var(--warning)"},partial:{label:"Ksmi Teslim",color:"var(--info)"},completed:{label:"Tamamland",color:"var(--success)"}},Va={broken:{label:"Krk/Hasarl",icon:""},missing:{label:"Eksik",icon:""},wrong:{label:"Yanl rn",icon:""},other:{label:"Dier",icon:""}},Wh=[{value:"replaced",label:"Deiim yapld"},{value:"refunded",label:"ade alnd"},{value:"credited",label:"Alacak yazld"},{value:"cancelled",label:"ptal edildi"}],Bn=({orderType:t=null,showIssues:s=!1})=>{var ve,We,tt;const r=Ls(),[n,a]=c.useState(!0),[l,i]=c.useState([]),[d,u]=c.useState({}),[f,N]=c.useState([]),[C,b]=c.useState([]),[L,k]=c.useState([]),[E,y]=c.useState([]),[p,m]=c.useState([]),[v,z]=c.useState([]),[W,F]=c.useState(""),[q,X]=c.useState(""),[Q,A]=c.useState(""),[ue,Z]=c.useState(!1),[ae,$]=c.useState(!1),[ne,U]=c.useState(!1),[pe,V]=c.useState(!1),[D,S]=c.useState(null),[g,x]=c.useState(null),[M,w]=c.useState(!1),[j,B]=c.useState({jobId:"",roleId:"",roleName:"",orderType:"internal",supplierId:"",supplierName:"",items:[{glassType:"",glassName:"",quantity:1,unit:"adet",combination:"",notes:""}],estimatedDelivery:"",notes:""}),[K,se]=c.useState({deliveries:[],deliveryDate:new Date().toISOString().slice(0,10),deliveryNote:""}),[oe,O]=c.useState({resolution:"replaced",resolvedQty:0,note:"",newIssueQty:0,newIssueType:"",newIssueNote:""});c.useEffect(()=>{ce()},[t,s]);const ce=async()=>{a(!0);const H={};t&&(H.orderType=t),ue&&(H.overdue=!0);let G=[],Se={},I={},me=[],ut=[],ms=[],at=[],Ir=[];try{G=await Dy(H)}catch(Ct){console.warn("Orders error:",Ct)}try{Se=await z0()}catch(Ct){console.warn("Summary error:",Ct)}try{I=await Iy()}catch(Ct){console.warn("Alerts error:",Ct)}try{me=await zr()}catch(Ct){console.warn("Jobs error:",Ct)}try{ut=await jn(!0)}catch(Ct){console.warn("Roles error:",Ct)}try{ms=await cr()}catch(Ct){console.warn("Suppliers error:",Ct)}try{at=await Yc()}catch(Ct){console.warn("Glass error:",Ct)}try{Ir=await Ey()}catch(Ct){console.warn("Combinations error:",Ct)}i(G||[]),u(Se||{}),N(I||{}),b(me||[]),k(ut||[]),y(ms||[]),m(at||[]),z(Ir||[]),a(!1)},je=c.useMemo(()=>{let H=[...l];if(W&&(H=H.filter(G=>G.status===W)),q&&(H=H.filter(G=>G.supplierId===q)),Q){const G=Q.toLowerCase();H=H.filter(Se=>{var I,me,ut,ms;return((I=Se.jobTitle)==null?void 0:I.toLowerCase().includes(G))||((me=Se.customerName)==null?void 0:me.toLowerCase().includes(G))||((ut=Se.roleName)==null?void 0:ut.toLowerCase().includes(G))||((ms=Se.supplierName)==null?void 0:ms.toLowerCase().includes(G))})}return ue&&(H=H.filter(G=>G.isOverdue)),s&&(H=H.filter(G=>{var Se;return(Se=G.issues)==null?void 0:Se.some(I=>I.status==="pending")})),H},[l,W,q,Q,ue,s]),we=c.useMemo(()=>s?"Sorun Takip":t==="internal"?" retim Emirleri":t==="external"?"D retim Emirleri":t==="glass"?"Cam Emirleri":"Tm retim Emirleri",[t,s]),Ee=c.useMemo(()=>{const H=l.filter(me=>me.status==="pending").length,G=l.filter(me=>me.status==="partial").length,Se=l.filter(me=>me.status==="completed").length,I=l.filter(me=>me.isOverdue).length;return{pending:H,partial:G,completed:Se,overdue:I}},[l]),T=c.useMemo(()=>!f||!Array.isArray(f)?[]:t?f.filter(H=>{const G=l.find(Se=>Se.id===H.orderId);return(G==null?void 0:G.orderType)===t}):f,[f,l,t]),re=H=>{if(!H)return"";try{return new Date(H).toLocaleDateString("tr-TR")}catch{return H}},ke=H=>{H&&B(G=>({...G,jobId:H.id}))},Ie=H=>{const G=L.find(ut=>ut.id===H);if(!G)return;let Se=G.productionType||"internal",I="",me="";if(G.productionType==="external"&&G.defaultSupplier){const ut=E.find(ms=>ms.id===G.defaultSupplier);ut&&(I=ut.id,me=ut.name)}B(ut=>({...ut,roleId:G.id,roleName:G.name,orderType:Se,supplierId:I,supplierName:me,estimatedDelivery:ut.estimatedDelivery||Ne(G.estimatedDays)}))},Ne=H=>{const G=new Date;return G.setDate(G.getDate()+(H||5)),G.toISOString().slice(0,10)},Re=()=>{B(H=>({...H,items:[...H.items,{glassType:"",glassName:"",quantity:1,unit:"adet",combination:"",notes:""}]}))},Oe=(H,G,Se)=>{B(I=>{const me=[...I.items];return me[H]={...me[H],[G]:Se},{...I,items:me}})},R=H=>{B(G=>({...G,items:G.items.filter((Se,I)=>I!==H)}))},le=async()=>{if(!j.jobId||!j.roleId){alert(" ve i kolu seimi gerekli");return}if(j.items.length===0||j.items.every(H=>!H.quantity)){alert("En az bir kalem eklemelisiniz");return}try{w(!0),await Fo(j),await ce(),$(!1)}catch(H){alert(H.message)}finally{w(!1)}},ie=H=>{S(H),se({deliveries:H.items.map((G,Se)=>({lineIndex:Se,receivedQty:0,problemQty:0,problemType:"",problemNote:""})),deliveryDate:new Date().toISOString().slice(0,10),deliveryNote:""}),U(!0)},De=(H,G,Se)=>{se(I=>{const me=[...I.deliveries];return me[H]={...me[H],[G]:Se},{...I,deliveries:me}})},Me=()=>{D&&se(H=>({...H,deliveries:H.deliveries.map((G,Se)=>{var I,me;return{...G,receivedQty:Math.max(0,(((I=D.items[Se])==null?void 0:I.quantity)||0)-(((me=D.items[Se])==null?void 0:me.receivedQty)||0))}})}))},ee=async()=>{if(!D)return;if(!K.deliveries.some(G=>G.receivedQty>0||G.problemQty>0)){alert("En az bir teslim miktar girin");return}try{w(!0),await zy(D.id,K),await ce(),U(!1)}catch(G){alert(G.message)}finally{w(!1)}},fe=(H,G)=>{S(H),x(G),O({resolution:"replaced",resolvedQty:G.quantity||0,note:"",newIssueQty:0,newIssueType:"",newIssueNote:""}),V(!0)},qe=async()=>{if(!(!D||!g))try{w(!0),await D0(D.id,g.id,{issueId:g.id,...oe}),await ce(),V(!1)}catch(H){alert(H.message)}finally{w(!1)}},P=async H=>{if(confirm("Bu siparii silmek istediinize emin misiniz?"))try{w(!0),await T0(H),await ce()}catch(G){alert(G.message)}finally{w(!1)}},de=[{header:"Sipari",accessor:"id",render:(H,G)=>e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:600,fontSize:"0.8rem"},children:G.id}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:re(G.createdAt)})]})},{header:"",accessor:"jobTitle",render:(H,G)=>e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:600},children:G.jobTitle}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:G.customerName})]})},{header:"Tr /  Kolu",accessor:"orderType",render:(H,G)=>{const Se=Fh[G.orderType]||{};return e.jsxs("div",{children:[e.jsxs("span",{className:"badge",style:{background:Se.color,color:"#fff",marginBottom:"0.25rem"},children:[Se.icon," ",Se.label]}),e.jsx("div",{style:{fontSize:"0.75rem"},children:G.roleName})]})}},{header:"Tedariki",accessor:"supplierName",render:H=>H||e.jsx("span",{style:{color:"var(--text-muted)"},children:""})},{header:"Kalemler",accessor:"items",render:H=>{const G=(H==null?void 0:H.reduce((I,me)=>I+(me.quantity||0),0))||0,Se=(H==null?void 0:H.reduce((I,me)=>I+(me.receivedQty||0),0))||0;return e.jsxs("div",{children:[e.jsxs("div",{style:{fontWeight:600},children:[Se," / ",G," adet"]}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:[(H==null?void 0:H.length)||0," kalem"]})]})}},{header:"Tahmini Teslim",accessor:"estimatedDelivery",render:(H,G)=>e.jsxs("div",{children:[e.jsx("div",{style:{color:G.isOverdue?"var(--danger)":"inherit"},children:re(H)}),G.isOverdue&&e.jsx("span",{className:"badge badge-danger",style:{fontSize:"0.65rem"},children:"GECKT"})]})},{header:"Durum",accessor:"status",render:(H,G)=>{var me;const Se=$h[H]||{},I=((me=G.issues)==null?void 0:me.filter(ut=>ut.status==="pending").length)||0;return e.jsxs("div",{children:[e.jsx("span",{className:"badge",style:{background:Se.color,color:"#fff"},children:Se.label}),I>0&&e.jsx("div",{style:{marginTop:"0.25rem"},children:e.jsxs("span",{className:"badge badge-danger",style:{fontSize:"0.65rem"},children:[" ",I," sorun"]})})]})}},{header:"lem",accessor:"actions",render:(H,G)=>{var Se;return e.jsxs("div",{style:{display:"flex",gap:"0.25rem",flexWrap:"wrap"},children:[G.status!=="completed"&&e.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>ie(G),title:"Teslim Kaydet",children:""}),((Se=G.issues)==null?void 0:Se.some(I=>I.status==="pending"))&&e.jsx("button",{className:"btn btn-sm btn-warning",onClick:()=>{const I=G.issues.find(me=>me.status==="pending");I&&fe(G,I)},title:"Sorun z",children:""}),G.status==="pending"&&e.jsx("button",{className:"btn btn-sm btn-ghost",onClick:()=>P(G.id),title:"Sil",style:{color:"var(--danger)"},children:""}),e.jsx("button",{className:"btn btn-sm btn-ghost",onClick:()=>r(`/isler/list?job=${G.jobId}&stage=4`),title:"e Git",children:""})]})}}];return n?e.jsxs("div",{children:[e.jsx(Fe,{title:we,subtitle:"retim ve tedarik siparileri"}),e.jsx("div",{className:"card subtle-card",children:"Ykleniyor..."})]}):e.jsxs("div",{children:[e.jsx(Fe,{title:we,subtitle:`${je.length} sipari listeleniyor`}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(180px, 1fr))",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsx("div",{className:"card",style:{margin:0,background:"linear-gradient(135deg, var(--warning) 0%, #f59e0b 100%)",color:"#fff"},children:e.jsxs("div",{className:"card-body",style:{padding:"1rem"},children:[e.jsx("div",{style:{fontSize:"0.75rem",opacity:.9},children:"Bekleyen"}),e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:700},children:Ee.pending})]})}),e.jsx("div",{className:"card",style:{margin:0,background:"linear-gradient(135deg, var(--info) 0%, #0ea5e9 100%)",color:"#fff"},children:e.jsxs("div",{className:"card-body",style:{padding:"1rem"},children:[e.jsx("div",{style:{fontSize:"0.75rem",opacity:.9},children:"Ksmi Teslim"}),e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:700},children:Ee.partial})]})}),e.jsx("div",{className:"card",style:{margin:0,background:"linear-gradient(135deg, var(--danger) 0%, #ef4444 100%)",color:"#fff"},children:e.jsxs("div",{className:"card-body",style:{padding:"1rem"},children:[e.jsx("div",{style:{fontSize:"0.75rem",opacity:.9},children:" Geciken"}),e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:700},children:Ee.overdue})]})}),e.jsx("div",{className:"card",style:{margin:0,background:"linear-gradient(135deg, var(--success) 0%, #22c55e 100%)",color:"#fff"},children:e.jsxs("div",{className:"card-body",style:{padding:"1rem"},children:[e.jsx("div",{style:{fontSize:"0.75rem",opacity:.9},children:"Tamamlanan"}),e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:700},children:Ee.completed})]})})]}),T.length>0&&e.jsxs("div",{className:"card",style:{marginBottom:"1.5rem",borderLeft:"4px solid var(--danger)"},children:[e.jsx("div",{className:"card-header",children:e.jsxs("h3",{className:"card-title",children:[" Uyarlar (",T.length,")"]})}),e.jsx("div",{className:"card-body",style:{maxHeight:"200px",overflowY:"auto"},children:T.slice(0,5).map((H,G)=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"0.5rem 0",borderBottom:G<4?"1px solid var(--border-color)":"none"},children:[e.jsxs("div",{children:[e.jsx("span",{className:"badge",style:{marginRight:"0.5rem",background:H.severity==="high"?"var(--danger)":"var(--warning)",color:"#fff"},children:H.type==="overdue"?"GECKT":H.type==="due_today"?"BUGN":"SORUN"}),e.jsx("span",{children:H.message})]}),e.jsx("button",{className:"btn btn-sm btn-ghost",onClick:()=>r(`/isler/list?job=${H.jobId}&stage=4`),children:""})]},G))})]}),e.jsx("div",{className:"card",style:{marginBottom:"1rem"},children:e.jsx("div",{className:"card-body",style:{padding:"0.75rem"},children:e.jsxs("div",{style:{display:"flex",gap:"0.75rem",flexWrap:"wrap",alignItems:"center"},children:[e.jsx("input",{type:"text",className:"form-control",placeholder:" , mteri, tedariki ara...",value:Q,onChange:H=>A(H.target.value),style:{flex:1,minWidth:"200px"}}),e.jsxs("select",{className:"form-control",value:W,onChange:H=>F(H.target.value),style:{width:"150px"},children:[e.jsx("option",{value:"",children:"Tm Durumlar"}),Object.entries($h).map(([H,G])=>e.jsx("option",{value:H,children:G.label},H))]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"0.25rem",cursor:"pointer"},children:[e.jsx("input",{type:"checkbox",checked:ue,onChange:H=>Z(H.target.checked)}),"Sadece Gecikenler"]})]})})}),e.jsx("div",{className:"card",children:e.jsx(et,{columns:de,data:je,emptyMessage:"Sipari bulunamad"})}),e.jsxs(Be,{isOpen:ae,onClose:()=>$(!1),title:"Yeni retim/Tedarik Siparii",size:"large",children:[e.jsxs("div",{className:"form-grid",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:" Se *"}),e.jsx(br,{value:j.jobId,onChange:H=>B(G=>({...G,jobId:H})),options:C.filter(H=>["URETIME_HAZIR","URETIMDE","ANLASMA_TAMAMLANDI"].includes(H.status)),displayKey:"title",valueKey:"id",placeholder:" ara...",onSelect:ke})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:" Kolu *"}),e.jsxs("select",{className:"form-control",value:j.roleId,onChange:H=>Ie(H.target.value),children:[e.jsx("option",{value:"",children:"Sein..."}),L.map(H=>e.jsx("option",{value:H.id,children:H.name},H.id))]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Sipari Tr"}),e.jsx("select",{className:"form-control",value:j.orderType,onChange:H=>B(G=>({...G,orderType:H.target.value})),children:Object.entries(Fh).map(([H,G])=>e.jsxs("option",{value:H,children:[G.icon," ",G.label]},H))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Tahmini Teslim"}),e.jsx(Qe,{value:j.estimatedDelivery,onChange:H=>B(G=>({...G,estimatedDelivery:H}))})]}),(j.orderType==="external"||j.orderType==="glass")&&e.jsxs("div",{className:"form-group",style:{gridColumn:"1 / -1"},children:[e.jsx("label",{className:"form-label",children:"Tedariki"}),e.jsx(br,{value:j.supplierName,onChange:H=>B(G=>({...G,supplierName:H})),options:E,displayKey:"name",valueKey:"id",placeholder:"Tedariki ara...",onSelect:H=>B(G=>({...G,supplierId:(H==null?void 0:H.id)||"",supplierName:(H==null?void 0:H.name)||""}))})]})]}),e.jsxs("div",{style:{marginTop:"1.5rem"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"0.75rem"},children:[e.jsx("label",{className:"form-label",style:{margin:0},children:"Kalemler"}),e.jsx("button",{className:"btn btn-sm btn-secondary",onClick:Re,children:"+ Kalem Ekle"})]}),e.jsx("div",{style:{maxHeight:"300px",overflowY:"auto"},children:j.items.map((H,G)=>e.jsxs("div",{style:{display:"grid",gridTemplateColumns:j.orderType==="glass"?"1fr 1fr 80px 80px 40px":"1fr 80px 80px 40px",gap:"0.5rem",padding:"0.5rem",background:"var(--bg-secondary)",borderRadius:"6px",marginBottom:"0.5rem"},children:[j.orderType==="glass"?e.jsxs(e.Fragment,{children:[e.jsxs("select",{className:"form-control",value:H.glassType,onChange:Se=>{const I=p.find(me=>me.code===Se.target.value);Oe(G,"glassType",Se.target.value),Oe(G,"glassName",(I==null?void 0:I.name)||"")},children:[e.jsx("option",{value:"",children:"Cam tipi..."}),p.map(Se=>e.jsx("option",{value:Se.code,children:Se.name},Se.id))]}),e.jsx(br,{value:H.combination,onChange:Se=>Oe(G,"combination",Se),options:v,displayKey:"name",valueKey:"name",placeholder:"Kombinasyon...",onSelect:Se=>Oe(G,"combination",(Se==null?void 0:Se.name)||"")})]}):e.jsx("input",{type:"text",className:"form-control",value:H.notes,onChange:Se=>Oe(G,"notes",Se.target.value),placeholder:"Aklama..."}),e.jsx(Cs,{className:"form-control",value:H.quantity,onChange:Se=>Oe(G,"quantity",Se),min:1,placeholder:"Adet"}),e.jsxs("select",{className:"form-control",value:H.unit,onChange:Se=>Oe(G,"unit",Se.target.value),children:[e.jsx("option",{value:"adet",children:"adet"}),e.jsx("option",{value:"m",children:"m"}),e.jsx("option",{value:"set",children:"set"})]}),e.jsx("button",{className:"btn btn-sm btn-ghost",onClick:()=>R(G),style:{color:"var(--danger)"},disabled:j.items.length===1,children:""})]},G))})]}),e.jsxs("div",{className:"form-group",style:{marginTop:"1rem"},children:[e.jsx("label",{className:"form-label",children:"Not"}),e.jsx("textarea",{className:"form-control",value:j.notes,onChange:H=>B(G=>({...G,notes:H.target.value})),rows:2,placeholder:"Ek notlar..."})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"0.5rem",marginTop:"1.5rem"},children:[e.jsx("button",{className:"btn btn-ghost",onClick:()=>$(!1),children:"ptal"}),e.jsx("button",{className:"btn btn-primary",onClick:le,disabled:M,children:M?"Kaydediliyor...":"Sipari Olutur"})]})]}),e.jsx(Be,{isOpen:ne,onClose:()=>U(!1),title:`Teslim Kaydet - ${D==null?void 0:D.id}`,size:"large",children:D&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{marginBottom:"1rem",padding:"0.75rem",background:"var(--bg-secondary)",borderRadius:"6px"},children:[e.jsxs("div",{children:[e.jsx("strong",{children:":"})," ",D.jobTitle]}),e.jsxs("div",{children:[e.jsx("strong",{children:" Kolu:"})," ",D.roleName]}),D.supplierName&&e.jsxs("div",{children:[e.jsx("strong",{children:"Tedariki:"})," ",D.supplierName]})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",marginBottom:"1rem"},children:[e.jsx(Qe,{value:K.deliveryDate,onChange:H=>se(G=>({...G,deliveryDate:H})),style:{width:"200px"}}),e.jsx("button",{className:"btn btn-secondary",onClick:Me,children:"Tmn Doldur"})]}),e.jsx("div",{style:{maxHeight:"350px",overflowY:"auto"},children:e.jsxs("table",{className:"data-table",style:{fontSize:"0.85rem"},children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"Kalem"}),e.jsx("th",{style:{width:"80px"},children:"Sipari"}),e.jsx("th",{style:{width:"80px"},children:"Alnan"}),e.jsx("th",{style:{width:"80px"},children:"Teslim"}),e.jsx("th",{style:{width:"80px"},children:"Sorunlu"}),e.jsx("th",{style:{width:"120px"},children:"Sorun Tipi"})]})}),e.jsx("tbody",{children:D.items.map((H,G)=>{const Se=(H.quantity||0)-(H.receivedQty||0),I=K.deliveries[G]||{};return e.jsxs("tr",{children:[e.jsxs("td",{children:[H.glassName||H.notes||`Kalem ${G+1}`,H.combination&&e.jsx("div",{style:{fontSize:"0.7rem",color:"var(--text-muted)"},children:H.combination})]}),e.jsxs("td",{children:[H.quantity," ",H.unit]}),e.jsx("td",{children:e.jsx("span",{style:{color:Se===0?"var(--success)":"inherit"},children:H.receivedQty||0})}),e.jsx("td",{children:e.jsx(Cs,{className:"form-control",value:I.receivedQty||0,onChange:me=>De(G,"receivedQty",me),min:0,max:Se,style:{width:"70px",padding:"0.25rem"},allowEmpty:!0})}),e.jsx("td",{children:e.jsx(Cs,{className:"form-control",value:I.problemQty||0,onChange:me=>De(G,"problemQty",me),min:0,style:{width:"70px",padding:"0.25rem"},allowEmpty:!0})}),e.jsx("td",{children:I.problemQty>0&&e.jsxs("select",{className:"form-control",value:I.problemType||"",onChange:me=>De(G,"problemType",me.target.value),style:{padding:"0.25rem",fontSize:"0.75rem"},children:[e.jsx("option",{value:"",children:"Sein..."}),Object.entries(Va).map(([me,ut])=>e.jsxs("option",{value:me,children:[ut.icon," ",ut.label]},me))]})})]},G)})})]})}),e.jsxs("div",{className:"form-group",style:{marginTop:"1rem"},children:[e.jsx("label",{className:"form-label",children:"Teslimat Notu"}),e.jsx("input",{type:"text",className:"form-control",value:K.deliveryNote,onChange:H=>se(G=>({...G,deliveryNote:H.target.value})),placeholder:"Opsiyonel not..."})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"0.5rem",marginTop:"1.5rem"},children:[e.jsx("button",{className:"btn btn-ghost",onClick:()=>U(!1),children:"ptal"}),e.jsx("button",{className:"btn btn-success",onClick:ee,disabled:M,children:M?"Kaydediliyor...":" Teslim Kaydet"})]})]})}),e.jsx(Be,{isOpen:pe,onClose:()=>V(!1),title:"Sorun zm",size:"medium",children:D&&g&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{marginBottom:"1rem",padding:"0.75rem",background:"var(--bg-secondary)",borderRadius:"6px"},children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Sipari:"})," ",D.id]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Sorun:"})," ",(ve=Va[g.type])==null?void 0:ve.icon," ",(We=Va[g.type])==null?void 0:We.label]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Miktar:"})," ",g.quantity," adet"]}),g.note&&e.jsxs("div",{children:[e.jsx("strong",{children:"Not:"})," ",g.note]}),((tt=g.history)==null?void 0:tt.length)>0&&e.jsxs("div",{style:{marginTop:"0.5rem",paddingTop:"0.5rem",borderTop:"1px solid var(--border-color)"},children:[e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)",marginBottom:"0.25rem"},children:"Gemi:"}),g.history.map((H,G)=>{var Se;return e.jsxs("div",{style:{fontSize:"0.75rem"},children:[re(H.date)," - ",(Se=Wh.find(I=>I.value===H.resolution))==null?void 0:Se.label," (",H.resolvedQty," adet)"]},G)})]})]}),e.jsxs("div",{className:"form-grid",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"zm Tr"}),e.jsx("select",{className:"form-control",value:oe.resolution,onChange:H=>O(G=>({...G,resolution:H.target.value})),children:Wh.map(H=>e.jsx("option",{value:H.value,children:H.label},H.value))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"zlen Miktar"}),e.jsx(Cs,{className:"form-control",value:oe.resolvedQty,onChange:H=>O(G=>({...G,resolvedQty:H})),min:0,max:g.quantity})]})]}),oe.resolution==="replaced"&&e.jsxs("div",{style:{marginTop:"1rem",padding:"0.75rem",background:"rgba(var(--warning-rgb), 0.1)",borderRadius:"6px"},children:[e.jsx("div",{style:{fontWeight:600,marginBottom:"0.5rem"},children:" Deiim de sorunlu mu?"}),e.jsxs("div",{className:"form-grid",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Yeni Sorunlu Miktar"}),e.jsx(Cs,{className:"form-control",value:oe.newIssueQty,onChange:H=>O(G=>({...G,newIssueQty:H})),min:0})]}),oe.newIssueQty>0&&e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Sorun Tipi"}),e.jsxs("select",{className:"form-control",value:oe.newIssueType,onChange:H=>O(G=>({...G,newIssueType:H.target.value})),children:[e.jsx("option",{value:"",children:"Sein..."}),Object.entries(Va).map(([H,G])=>e.jsxs("option",{value:H,children:[G.icon," ",G.label]},H))]})]})]}),oe.newIssueQty>0&&e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Yeni Sorun Notu"}),e.jsx("input",{type:"text",className:"form-control",value:oe.newIssueNote,onChange:H=>O(G=>({...G,newIssueNote:H.target.value})),placeholder:"Aklama..."})]})]}),e.jsxs("div",{className:"form-group",style:{marginTop:"1rem"},children:[e.jsx("label",{className:"form-label",children:"zm Notu"}),e.jsx("textarea",{className:"form-control",value:oe.note,onChange:H=>O(G=>({...G,note:H.target.value})),rows:2,placeholder:"Aklama..."})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"0.5rem",marginTop:"1.5rem"},children:[e.jsx("button",{className:"btn btn-ghost",onClick:()=>V(!1),children:"ptal"}),e.jsx("button",{className:"btn btn-success",onClick:qe,disabled:M,children:M?"Kaydediliyor...":" Sorunu z"})]})]})})]})},Kh={pending:{label:"Planlanmad",color:"var(--text-muted)",icon:""},planned:{label:"Planland",color:"var(--info)",icon:""},in_progress:{label:"Devam Ediyor",color:"var(--warning)",icon:""},completed:{label:"Tamamland",color:"var(--success)",icon:""},blocked:{label:"Beklemede",color:"var(--danger)",icon:""}},MN=()=>{const t=Ls(),[s,r]=c.useState(!0),[n,a]=c.useState([]),[l,i]=c.useState({}),[d,u]=c.useState([]),[f,N]=c.useState([]),[C,b]=c.useState(""),[L,k]=c.useState(""),[E,y]=c.useState(""),[p,m]=c.useState("week"),[v,z]=c.useState(!1),[W,F]=c.useState(null),[q,X]=c.useState({plannedDate:"",teamId:"",teamName:"",assignedPersonnel:[]}),[Q,A]=c.useState(null),[ue,Z]=c.useState(!1);c.useEffect(()=>{ae()},[p]);const ae=async()=>{r(!0);try{const g={},x=new Date;if(p==="week"){const K=new Date(x);K.setDate(x.getDate()+7),g.dateTo=K.toISOString().slice(0,10)}else if(p==="month"){const K=new Date(x);K.setMonth(x.getMonth()+1),g.dateTo=K.toISOString().slice(0,10)}const[M,w,j,B]=await Promise.all([Vc(g),U0(),vn(),Ql()]);a(M||[]),i(w||{}),u(j||[]),N(B||[])}catch(g){console.error("Load error:",g)}finally{r(!1)}},$=c.useMemo(()=>{let g=[...n];if(C&&(g=g.filter(x=>x.status===C)),L&&(g=g.filter(x=>x.teamId===L)),E){const x=E.toLowerCase();g=g.filter(M=>{var w,j,B,K;return((w=M.customerName)==null?void 0:w.toLowerCase().includes(x))||((j=M.roleName)==null?void 0:j.toLowerCase().includes(x))||((B=M.stageName)==null?void 0:B.toLowerCase().includes(x))||((K=M.location)==null?void 0:K.toLowerCase().includes(x))})}return g.sort((x,M)=>!x.plannedDate&&M.plannedDate?-1:x.plannedDate&&!M.plannedDate?1:x.plannedDate&&M.plannedDate?x.plannedDate.localeCompare(M.plannedDate):0),g},[n,C,L,E]),ne=g=>{if(!g)return"";try{return new Date(g).toLocaleDateString("tr-TR",{day:"numeric",month:"short",weekday:"short"})}catch{return g}},U=g=>{F(g),X({plannedDate:g.plannedDate||g.estimatedDate||"",teamId:g.teamId||"",teamName:g.teamName||"",assignedPersonnel:g.assignedPersonnel||[]}),A(null),z(!0)},pe=async g=>{const x=d.find(M=>M.id===g);if(X(M=>({...M,teamId:g,teamName:(x==null?void 0:x.ad)||"",assignedPersonnel:[]})),g&&q.plannedDate)try{const M=await Ch(g,q.plannedDate);A(M.warning)}catch{A(null)}},V=async g=>{if(X(x=>({...x,plannedDate:g})),q.teamId&&g)try{const x=await Ch(q.teamId,g);A(x.warning)}catch{A(null)}},D=async()=>{if(W)try{Z(!0),await Ay(W.id,{plannedDate:q.plannedDate,teamId:q.teamId,teamName:q.teamName,assignedPersonnel:q.assignedPersonnel,status:q.plannedDate?"planned":"pending"}),await ae(),z(!1)}catch(g){alert(g.message)}finally{Z(!1)}},S=[{header:"Mteri / Konum",accessor:"customerName",render:(g,x)=>e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:600},children:x.customerName}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:[" ",x.location||"Konum belirtilmedi"]})]})},{header:" Kolu / Aama",accessor:"roleName",render:(g,x)=>e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:500},children:x.roleName}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:x.stageName})]})},{header:"Mteri Termini",accessor:"estimatedDate",render:(g,x)=>e.jsxs("div",{children:[e.jsx("div",{style:{color:x.isOverdue?"var(--danger)":"inherit"},children:ne(g)}),x.isOverdue&&e.jsxs("span",{className:"badge badge-danger",style:{fontSize:"0.65rem"},children:[" ",Math.abs(x.daysUntilEstimated)," gn geti"]})]})},{header:"Planlanan Tarih",accessor:"plannedDate",render:g=>e.jsx("div",{style:{color:g?"inherit":"var(--text-muted)"},children:g?ne(g):"Planlanmad"})},{header:"Ekip",accessor:"teamName",render:g=>g||e.jsx("span",{style:{color:"var(--text-muted)"},children:""})},{header:"Durum",accessor:"status",render:g=>{const x=Kh[g]||{};return e.jsxs("span",{className:"badge",style:{background:x.color,color:"#fff"},children:[x.icon," ",x.label]})}},{header:"lem",accessor:"actions",render:(g,x)=>e.jsxs("div",{style:{display:"flex",gap:"0.25rem"},children:[e.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>U(x),title:"Planla",children:""}),e.jsx("button",{className:"btn btn-sm btn-ghost",onClick:()=>t(`/isler/list?job=${x.jobId}&stage=5`),title:"e Git",children:""})]})}];return s?e.jsxs("div",{children:[e.jsx(Fe,{title:"Planlanan Montajlar",subtitle:"Ykleniyor..."}),e.jsx("div",{className:"card subtle-card",children:"Ykleniyor..."})]}):e.jsxs("div",{children:[e.jsx(Fe,{title:"Planlanan Montajlar",subtitle:`${$.length} montaj grevi`}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsx("div",{className:"card",style:{margin:0,background:"var(--text-muted)",color:"#fff"},children:e.jsxs("div",{className:"card-body",style:{padding:"1rem"},children:[e.jsx("div",{style:{fontSize:"0.75rem",opacity:.9},children:"Planlanmad"}),e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:700},children:l.pending||0})]})}),e.jsx("div",{className:"card",style:{margin:0,background:"var(--info)",color:"#fff"},children:e.jsxs("div",{className:"card-body",style:{padding:"1rem"},children:[e.jsx("div",{style:{fontSize:"0.75rem",opacity:.9},children:"Planland"}),e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:700},children:l.planned||0})]})}),e.jsx("div",{className:"card",style:{margin:0,background:"var(--warning)",color:"#fff"},children:e.jsxs("div",{className:"card-body",style:{padding:"1rem"},children:[e.jsx("div",{style:{fontSize:"0.75rem",opacity:.9},children:"Devam Ediyor"}),e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:700},children:l.inProgress||0})]})}),e.jsx("div",{className:"card",style:{margin:0,background:"var(--danger)",color:"#fff"},children:e.jsxs("div",{className:"card-body",style:{padding:"1rem"},children:[e.jsx("div",{style:{fontSize:"0.75rem",opacity:.9},children:" Termin Geen"}),e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:700},children:l.overdue||0})]})})]}),e.jsx("div",{className:"card",style:{marginBottom:"1rem"},children:e.jsx("div",{className:"card-body",style:{padding:"0.75rem"},children:e.jsxs("div",{style:{display:"flex",gap:"0.75rem",flexWrap:"wrap",alignItems:"center"},children:[e.jsx("input",{type:"text",className:"form-control",placeholder:" Mteri, konum, i kolu ara...",value:E,onChange:g=>y(g.target.value),style:{flex:1,minWidth:"200px"}}),e.jsxs("select",{className:"form-control",value:C,onChange:g=>b(g.target.value),style:{width:"150px"},children:[e.jsx("option",{value:"",children:"Tm Durumlar"}),Object.entries(Kh).map(([g,x])=>e.jsxs("option",{value:g,children:[x.icon," ",x.label]},g))]}),e.jsxs("select",{className:"form-control",value:L,onChange:g=>k(g.target.value),style:{width:"150px"},children:[e.jsx("option",{value:"",children:"Tm Ekipler"}),d.map(g=>e.jsx("option",{value:g.id,children:g.ad},g.id))]}),e.jsxs("select",{className:"form-control",value:p,onChange:g=>m(g.target.value),style:{width:"120px"},children:[e.jsx("option",{value:"week",children:"Bu Hafta"}),e.jsx("option",{value:"month",children:"Bu Ay"}),e.jsx("option",{value:"all",children:"Tm"})]})]})})}),e.jsx("div",{className:"card",children:e.jsx(et,{columns:S,data:$,emptyMessage:"Montaj grevi bulunamad"})}),e.jsx(Be,{isOpen:v,onClose:()=>z(!1),title:"Montaj Planla",size:"medium",children:W&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{marginBottom:"1rem",padding:"0.75rem",background:"var(--bg-secondary)",borderRadius:6},children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Mteri:"})," ",W.customerName]}),e.jsxs("div",{children:[e.jsx("strong",{children:" Kolu:"})," ",W.roleName]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Aama:"})," ",W.stageName]}),W.estimatedDate&&e.jsxs("div",{style:{marginTop:"0.5rem",color:W.isOverdue?"var(--danger)":"var(--info)"},children:[e.jsx("strong",{children:"Mteri Termini:"})," ",ne(W.estimatedDate),W.isOverdue&&"  GET!"]})]}),e.jsxs("div",{className:"form-grid",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Planlanan Tarih *"}),e.jsx(Qe,{value:q.plannedDate,onChange:V})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Ekip *"}),e.jsxs("select",{className:"form-control",value:q.teamId,onChange:g=>pe(g.target.value),children:[e.jsx("option",{value:"",children:"Ekip sein..."}),d.map(g=>e.jsx("option",{value:g.id,children:g.ad},g.id))]})]})]}),Q&&e.jsx("div",{style:{padding:"0.75rem",background:"rgba(245, 158, 11, 0.1)",border:"1px solid var(--warning)",borderRadius:6,marginBottom:"1rem",color:"var(--warning)"},children:Q}),q.teamId&&e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Personel (Opsiyonel)"}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem"},children:f.filter(g=>g.ekipId===q.teamId||!g.ekipId).map(g=>{const x=q.assignedPersonnel.includes(g.id);return e.jsxs("button",{type:"button",className:`btn btn-sm ${x?"btn-primary":"btn-ghost"}`,onClick:()=>{X(M=>({...M,assignedPersonnel:x?M.assignedPersonnel.filter(w=>w!==g.id):[...M.assignedPersonnel,g.id]}))},children:[x?" ":"",g.ad]},g.id)})})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"0.5rem",marginTop:"1.5rem"},children:[e.jsx("button",{className:"btn btn-ghost",onClick:()=>z(!1),children:"ptal"}),e.jsx("button",{className:"btn btn-primary",onClick:D,disabled:ue||!q.plannedDate||!q.teamId,children:ue?"Kaydediliyor...":" Planla"})]})]})})]})},ON={pending:{label:"Bekliyor",color:"var(--text-muted)",icon:""},planned:{label:"Planland",color:"var(--info)",icon:""},in_progress:{label:"Devam Ediyor",color:"var(--warning)",icon:""},completed:{label:"Tamamland",color:"var(--success)",icon:""},blocked:{label:"Beklemede",color:"var(--danger)",icon:""}},_N=[{value:"broken",label:"Krk/Hasarl"},{value:"missing",label:"Eksik Malzeme"},{value:"wrong",label:"Yanl rn"},{value:"damage",label:"Hasar (Tama/Montaj)"},{value:"other",label:"Dier"}],FN=[{value:"production",label:"retim Hatas (Tedariki)"},{value:"team",label:"Ekip Hatas"},{value:"accident",label:"Kaza"}],$N=()=>{const t=Ls(),[s,r]=c.useState(!0),[n,a]=c.useState([]),[l,i]=c.useState([]),[d,u]=c.useState(""),[f,N]=c.useState(!1),[C,b]=c.useState(!1),[L,k]=c.useState(null),[E,y]=c.useState(null),[p,m]=c.useState({issueType:"broken",item:"",quantity:1,faultSource:"team",responsiblePersonId:"",photoUrl:"",note:"",createReplacement:!0}),[v,z]=c.useState({photosBefore:[],photosAfter:[],customerSignature:"",note:""}),[W,F]=c.useState(!1);c.useEffect(()=>{q()},[d]);const q=async()=>{r(!0);try{const[D,S]=await Promise.all([M0(d||null),vn()]);a(D||[]),i(S||[])}catch(D){console.error("Load error:",D)}finally{r(!1)}},X=async D=>{try{F(!0),await F0(D.id),await q()}catch(S){alert(S.message)}finally{F(!1)}},Q=async D=>{try{F(!0),await $0(D.id,{photosBefore:v.photosBefore,photosAfter:v.photosAfter,customerSignature:v.customerSignature,note:v.note}),await q(),b(!1)}catch(S){alert(S.message)}finally{F(!1)}},A=async D=>{if(confirm("Tm grevleri tek seferde tamamlamak istediinize emin misiniz?"))try{F(!0),await W0(D.jobId,{photosBefore:v.photosBefore,photosAfter:v.photosAfter,customerSignature:v.customerSignature,note:v.note}),await q(),b(!1)}catch(S){alert(S.message)}finally{F(!1)}},ue=D=>{k(D),m({issueType:"broken",item:"",quantity:1,faultSource:"team",responsiblePersonId:"",photoUrl:"",note:"",createReplacement:!0}),N(!0)},Z=(D,S=null)=>{k(D),y(S),z({photosBefore:[],photosAfter:[],customerSignature:"",note:""}),b(!0)},ae=async()=>{if(!L||!p.item){alert("Sorunlu rn/malzeme ad gerekli");return}try{F(!0),await K0(L.id,p),await q(),N(!1)}catch(D){alert(D.message)}finally{F(!1)}},$=async(D,S)=>{try{F(!0),await Ry(D.id,S),await q()}catch(g){alert(g.message)}finally{F(!1)}},[ne,U]=c.useState(!1),pe=async(D,S)=>{var M;const g=(M=D.target.files)==null?void 0:M[0];if(!g)return;const x=(L==null?void 0:L.jobId)||(E==null?void 0:E.jobId);if(!x){console.error("No jobId for upload"),D.target.value="";return}try{U(!0);let w="montaj",j="Montaj fotoraf";S==="before"?(w="montaj_oncesi",j="Montaj ncesi fotoraf"):S==="after"?(w="montaj_sonrasi",j="Montaj sonras fotoraf"):S==="signature"?(w="musteri_imza",j="Mteri imzas"):S==="issue"&&(w="montaj_sorun",j="Montaj sorunu fotoraf");const B=await ba(g,x,w,j),K=(B==null?void 0:B.url)||(B==null?void 0:B.path)||URL.createObjectURL(g);S==="before"?z(se=>({...se,photosBefore:[...se.photosBefore,K]})):S==="after"?z(se=>({...se,photosAfter:[...se.photosAfter,K]})):S==="signature"?z(se=>({...se,customerSignature:K})):S==="issue"&&m(se=>({...se,photoUrl:K}))}catch(w){console.error("Upload error:",w),alert("Dosya yklenirken hata olutu: "+(w.message||w))}finally{U(!1)}D.target.value=""};if(s)return e.jsxs("div",{children:[e.jsx(Fe,{title:"Bugnk Montajlar",subtitle:"Ykleniyor..."}),e.jsx("div",{className:"card subtle-card",children:"Ykleniyor..."})]});const V=new Date().toLocaleDateString("tr-TR",{weekday:"long",year:"numeric",month:"long",day:"numeric"});return e.jsxs("div",{children:[e.jsx(Fe,{title:"Bugnk Montajlar",subtitle:V}),e.jsx("div",{className:"card",style:{marginBottom:"1rem"},children:e.jsx("div",{className:"card-body",style:{padding:"0.75rem"},children:e.jsxs("div",{style:{display:"flex",gap:"0.75rem",alignItems:"center"},children:[e.jsx("span",{style:{fontWeight:500},children:"Ekip:"}),e.jsxs("select",{className:"form-control",value:d,onChange:D=>u(D.target.value),style:{width:"200px"},children:[e.jsx("option",{value:"",children:"Tm Ekipler"}),l.map(D=>e.jsx("option",{value:D.id,children:D.ad},D.id))]}),e.jsx("button",{className:"btn btn-secondary",onClick:q,children:" Yenile"})]})})}),n.length===0?e.jsxs("div",{className:"card",style:{textAlign:"center",padding:"3rem"},children:[e.jsx("div",{style:{fontSize:"3rem",marginBottom:"1rem"},children:""}),e.jsx("div",{style:{fontSize:"1.25rem",fontWeight:600,marginBottom:"0.5rem"},children:"Bugn iin planlanm montaj yok"}),e.jsx("div",{style:{color:"var(--text-muted)"},children:"Planlanan Montajlar sayfasndan yeni montaj planlayabilirsiniz."})]}):e.jsx("div",{style:{display:"flex",flexDirection:"column",gap:"1rem"},children:n.map(D=>{const S=D.tasks.every(M=>M.status==="completed"),g=D.tasks.some(M=>M.status==="blocked"),x=D.tasks.some(M=>M.status==="in_progress");return e.jsxs("div",{className:"card",style:{margin:0},children:[e.jsx("div",{className:"card-header",style:{background:S?"var(--success)":g?"var(--danger)":x?"var(--warning)":"var(--primary)",color:"#fff"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("div",{children:[e.jsxs("div",{style:{fontSize:"1.1rem",fontWeight:600},children:[" ",D.customerName]}),e.jsxs("div",{style:{fontSize:"0.85rem",opacity:.9},children:[" ",D.location||"Konum belirtilmedi"]})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[!S&&!g&&e.jsx("button",{className:"btn btn-sm",style:{background:"rgba(255,255,255,0.2)",color:"#fff"},onClick:()=>Z(null,D),children:" Tek Seferde Tamamla"}),e.jsx("button",{className:"btn btn-sm",style:{background:"rgba(255,255,255,0.2)",color:"#fff"},onClick:()=>t(`/isler/list?job=${D.jobId}&stage=5`),children:" e Git"})]})]})}),e.jsx("div",{className:"card-body",style:{padding:"1rem"},children:D.tasks.map((M,w)=>{var oe;const j=ON[M.status]||{},B=w===0,K=w===D.tasks.length-1,se=((oe=M.issues)==null?void 0:oe.filter(O=>O.status==="pending"))||[];return e.jsxs("div",{style:{display:"flex",alignItems:"flex-start",gap:"1rem",padding:"1rem",background:M.status==="completed"?"rgba(34, 197, 94, 0.1)":M.status==="blocked"?"rgba(239, 68, 68, 0.1)":M.status==="in_progress"?"rgba(245, 158, 11, 0.1)":"var(--bg-secondary)",borderRadius:8,marginBottom:w<D.tasks.length-1?"0.5rem":0},children:[e.jsx("div",{style:{width:32,height:32,borderRadius:"50%",background:j.color,color:"#fff",display:"flex",alignItems:"center",justifyContent:"center",fontWeight:600,fontSize:"0.85rem",flexShrink:0},children:M.status==="completed"?"":M.stageOrder}),e.jsxs("div",{style:{flex:1},children:[e.jsxs("div",{style:{fontWeight:600,marginBottom:"0.25rem"},children:[M.roleName," - ",M.stageName]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem",alignItems:"center",marginBottom:"0.5rem"},children:[e.jsxs("span",{className:"badge",style:{background:j.color,color:"#fff"},children:[j.icon," ",j.label]}),M.teamName&&e.jsxs("span",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:[" ",M.teamName]})]}),se.length>0&&e.jsx("div",{style:{padding:"0.5rem",background:"rgba(239, 68, 68, 0.1)",borderRadius:4,marginBottom:"0.5rem"},children:se.map(O=>e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs("span",{style:{fontSize:"0.85rem",color:"var(--danger)"},children:[" ",O.item," (",O.quantity," adet) - ",O.note]}),O.replacementOrderId&&e.jsx("button",{className:"btn btn-sm btn-success",onClick:()=>$(M,O.id),disabled:W,children:" zld"})]},O.id))}),B&&M.status!=="completed"&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--info)",marginBottom:"0.25rem"},children:" Montaj ncesi fotoraf zorunlu"}),K&&M.status!=="completed"&&e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--info)"},children:" Montaj sonras fotoraf ve  mteri imzas zorunlu"})]}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:[M.status==="planned"&&e.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>X(M),disabled:W,children:" Balat"}),M.status==="in_progress"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"btn btn-sm btn-success",onClick:()=>Z(M),disabled:W||se.length>0,title:se.length>0?"nce sorunlar zn":"",children:" Tamamla"}),e.jsx("button",{className:"btn btn-sm btn-warning",onClick:()=>ue(M),disabled:W,children:" Sorun"})]}),M.status==="blocked"&&se.length===0&&e.jsx("button",{className:"btn btn-sm btn-primary",onClick:()=>X(M),disabled:W,children:" Devam Et"})]})]},M.id)})})]},D.jobId)})}),e.jsx(Be,{isOpen:f,onClose:()=>N(!1),title:" Montaj Sorunu Bildir",size:"medium",children:L&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{marginBottom:"1rem",padding:"0.75rem",background:"var(--bg-secondary)",borderRadius:6},children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Mteri:"})," ",L.customerName]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Grev:"})," ",L.roleName," - ",L.stageName]})]}),e.jsxs("div",{className:"form-grid",children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Sorun Tr *"}),e.jsx("select",{className:"form-control",value:p.issueType,onChange:D=>m({...p,issueType:D.target.value}),children:_N.map(D=>e.jsx("option",{value:D.value,children:D.label},D.value))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Adet *"}),e.jsx("input",{type:"number",className:"form-control",value:p.quantity,onChange:D=>m({...p,quantity:parseInt(D.target.value)||1}),min:1})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Sorunlu rn/Malzeme *"}),e.jsx("input",{type:"text",className:"form-control",value:p.item,onChange:D=>m({...p,item:D.target.value}),placeholder:"rn: Cam 80x120"})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Hata Kayna *"}),e.jsx("select",{className:"form-control",value:p.faultSource,onChange:D=>m({...p,faultSource:D.target.value}),children:FN.map(D=>e.jsx("option",{value:D.value,children:D.label},D.value))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:" Fotoraf (Zorunlu)"}),e.jsx("input",{type:"file",accept:"image/*",onChange:D=>pe(D,"issue"),className:"form-control"}),p.photoUrl&&e.jsx("img",{src:p.photoUrl,alt:"Sorun fotoraf",style:{maxWidth:200,marginTop:"0.5rem",borderRadius:4}})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Aklama"}),e.jsx("textarea",{className:"form-control",value:p.note,onChange:D=>m({...p,note:D.target.value}),rows:2,placeholder:"Ne oldu? Nasl oldu?"})]}),e.jsx("div",{className:"form-group",children:e.jsxs("label",{className:"form-label",style:{display:"flex",alignItems:"center",gap:"0.5rem"},children:[e.jsx("input",{type:"checkbox",checked:p.createReplacement,onChange:D=>m({...p,createReplacement:D.target.checked})}),"Yedek sipari olutur (retim Takip'e der)"]})}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"0.5rem",marginTop:"1.5rem"},children:[e.jsx("button",{className:"btn btn-ghost",onClick:()=>N(!1),children:"ptal"}),e.jsx("button",{className:"btn btn-danger",onClick:ae,disabled:W||!p.item||!p.photoUrl,children:W?"Kaydediliyor...":" Sorunu Bildir"})]})]})}),e.jsxs(Be,{isOpen:C,onClose:()=>b(!1),title:E?" Tm Grevleri Tamamla":" Grevi Tamamla",size:"medium",children:[e.jsxs("div",{style:{marginBottom:"1rem"},children:[L&&e.jsx("div",{style:{padding:"0.75rem",background:"var(--bg-secondary)",borderRadius:6},children:e.jsxs("div",{children:[e.jsx("strong",{children:"Grev:"})," ",L.roleName," - ",L.stageName]})}),E&&e.jsxs("div",{style:{padding:"0.75rem",background:"var(--bg-secondary)",borderRadius:6},children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Mteri:"})," ",E.customerName]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Tamamlanacak Grev:"})," ",E.tasks.length," adet"]})]})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:" Montaj ncesi Fotoraf (Zorunlu)"}),e.jsx("input",{type:"file",accept:"image/*",onChange:D=>pe(D,"before"),className:"form-control"}),v.photosBefore.length>0&&e.jsx("div",{style:{display:"flex",gap:"0.5rem",marginTop:"0.5rem",flexWrap:"wrap"},children:v.photosBefore.map((D,S)=>e.jsx("img",{src:D,alt:"ncesi",style:{width:80,height:80,objectFit:"cover",borderRadius:4}},S))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:" Montaj Sonras Fotoraf (Zorunlu)"}),e.jsx("input",{type:"file",accept:"image/*",onChange:D=>pe(D,"after"),className:"form-control"}),v.photosAfter.length>0&&e.jsx("div",{style:{display:"flex",gap:"0.5rem",marginTop:"0.5rem",flexWrap:"wrap"},children:v.photosAfter.map((D,S)=>e.jsx("img",{src:D,alt:"Sonras",style:{width:80,height:80,objectFit:"cover",borderRadius:4}},S))})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:" Mteri mzas (Zorunlu)"}),e.jsx("input",{type:"file",accept:"image/*",onChange:D=>pe(D,"signature"),className:"form-control"}),v.customerSignature&&e.jsx("img",{src:v.customerSignature,alt:"mza",style:{maxWidth:200,marginTop:"0.5rem",borderRadius:4}})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{className:"form-label",children:"Not (Opsiyonel)"}),e.jsx("textarea",{className:"form-control",value:v.note,onChange:D=>z({...v,note:D.target.value}),rows:2,placeholder:"Ek notlar..."})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"0.5rem",marginTop:"1.5rem"},children:[e.jsx("button",{className:"btn btn-ghost",onClick:()=>b(!1),children:"ptal"}),e.jsx("button",{className:"btn btn-success",onClick:()=>E?A(E):Q(L),disabled:W||v.photosBefore.length===0||v.photosAfter.length===0||!v.customerSignature,children:W?"Kaydediliyor...":" Tamamla"})]})]})]})},Uh={pending:"var(--text-muted)",planned:"var(--info)",in_progress:"var(--warning)",completed:"var(--success)",blocked:"var(--danger)"},WN=()=>{const t=Ls(),[s,r]=c.useState(!0),[n,a]=c.useState([]),[l,i]=c.useState([]),[d,u]=c.useState("month"),[f,N]=c.useState(new Date),[C,b]=c.useState(""),[L,k]=c.useState(null),[E,y]=c.useState(!1),[p,m]=c.useState(null);c.useEffect(()=>{v()},[]);const v=async()=>{r(!0);try{const[U,pe]=await Promise.all([Vc({}),vn()]);a(U||[]),i(pe||[])}catch(U){console.error("Load error:",U)}finally{r(!1)}},z=c.useMemo(()=>{const U=f.getFullYear(),pe=f.getMonth();if(d==="month"){const V=new Date(U,pe,1),D=new Date(U,pe+1,0),S=V.getDay()===0?6:V.getDay()-1,g=[];for(let M=S-1;M>=0;M--){const w=new Date(U,pe,-M);g.push({date:w,isCurrentMonth:!1})}for(let M=1;M<=D.getDate();M++)g.push({date:new Date(U,pe,M),isCurrentMonth:!0});const x=42-g.length;for(let M=1;M<=x;M++)g.push({date:new Date(U,pe+1,M),isCurrentMonth:!1});return g}else{const V=new Date(f),D=V.getDay()===0?6:V.getDay()-1;V.setDate(V.getDate()-D);const S=[];for(let g=0;g<7;g++){const x=new Date(V);x.setDate(V.getDate()+g),S.push({date:x,isCurrentMonth:!0})}return S}},[f,d]),W=c.useMemo(()=>{const U={};for(const pe of n){if(!pe.plannedDate||C&&pe.teamId!==C)continue;const V=pe.plannedDate.slice(0,10);U[V]||(U[V]=[]),U[V].push(pe)}return U},[n,C]),F=U=>U.toISOString().slice(0,10),q=(U,pe)=>{k(pe),U.dataTransfer.effectAllowed="move"},X=U=>{U.preventDefault(),U.dataTransfer.dropEffect="move"},Q=async(U,pe)=>{if(U.preventDefault(),!L)return;const V=F(pe);if(L.estimatedDate){const D=new Date(L.estimatedDate);if(pe>D&&!confirm("Bu tarih mteri termininden sonra. Devam etmek istiyor musunuz?")){k(null);return}}try{await Ay(L.id,{plannedDate:V,status:"planned"}),await v()}catch(D){alert(D.message)}k(null)},A=U=>{m(U),y(!0)},ue=()=>{const U=new Date(f);d==="month"?U.setMonth(U.getMonth()-1):U.setDate(U.getDate()-7),N(U)},Z=()=>{const U=new Date(f);d==="month"?U.setMonth(U.getMonth()+1):U.setDate(U.getDate()+7),N(U)},ae=()=>{N(new Date)};if(s)return e.jsxs("div",{children:[e.jsx(Fe,{title:"Montaj Takvimi",subtitle:"Ykleniyor..."}),e.jsx("div",{className:"card subtle-card",children:"Ykleniyor..."})]});const $=new Date().toISOString().slice(0,10),ne=["Pzt","Sal","ar","Per","Cum","Cmt","Paz"];return e.jsxs("div",{children:[e.jsx(Fe,{title:"Montaj Takvimi",subtitle:f.toLocaleDateString("tr-TR",{month:"long",year:"numeric"})}),e.jsx("div",{className:"card",style:{marginBottom:"1rem"},children:e.jsx("div",{className:"card-body",style:{padding:"0.75rem"},children:e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",flexWrap:"wrap",gap:"0.75rem"},children:[e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx("button",{className:"btn btn-ghost",onClick:ue,children:" nceki"}),e.jsx("button",{className:"btn btn-secondary",onClick:ae,children:"Bugn"}),e.jsx("button",{className:"btn btn-ghost",onClick:Z,children:"Sonraki "})]}),e.jsxs("div",{style:{display:"flex",gap:"0.5rem"},children:[e.jsx("button",{className:`btn ${d==="month"?"btn-primary":"btn-ghost"}`,onClick:()=>u("month"),children:"Aylk"}),e.jsx("button",{className:`btn ${d==="week"?"btn-primary":"btn-ghost"}`,onClick:()=>u("week"),children:"Haftalk"})]}),e.jsxs("select",{className:"form-control",value:C,onChange:U=>b(U.target.value),style:{width:"150px"},children:[e.jsx("option",{value:"",children:"Tm Ekipler"}),l.map(U=>e.jsx("option",{value:U.id,children:U.ad},U.id))]})]})})}),e.jsx("div",{className:"card",children:e.jsxs("div",{className:"card-body",style:{padding:"0.5rem"},children:[e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:"2px",marginBottom:"2px"},children:ne.map(U=>e.jsx("div",{style:{padding:"0.5rem",textAlign:"center",fontWeight:600,background:"var(--bg-secondary)",borderRadius:4},children:U},U))}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(7, 1fr)",gap:"2px"},children:z.map((U,pe)=>{const V=F(U.date),D=W[V]||[],S=V===$,g=[5,6].includes(pe%7);return e.jsxs("div",{style:{minHeight:d==="week"?"300px":"120px",padding:"0.25rem",background:S?"rgba(59, 130, 246, 0.1)":U.isCurrentMonth?g?"rgba(0,0,0,0.02)":"transparent":"var(--bg-secondary)",border:S?"2px solid var(--primary)":"1px solid var(--border-color)",borderRadius:4,opacity:U.isCurrentMonth?1:.5,overflow:"hidden"},onDragOver:X,onDrop:x=>Q(x,U.date),children:[e.jsx("div",{style:{fontSize:"0.75rem",fontWeight:S?700:500,color:S?"var(--primary)":"inherit",marginBottom:"0.25rem"},children:U.date.getDate()}),e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"2px"},children:[D.slice(0,d==="week"?20:3).map(x=>{var M,w;return e.jsxs("div",{draggable:x.status!=="completed",onDragStart:j=>q(j,x),onClick:()=>A(x),style:{padding:"2px 4px",background:Uh[x.status]||"var(--primary)",color:"#fff",borderRadius:3,fontSize:"0.65rem",cursor:"pointer",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},title:`${x.customerName} - ${x.roleName}`,children:[(M=x.customerName)==null?void 0:M.split(" ")[0],"  ",(w=x.roleName)==null?void 0:w.slice(0,6)]},x.id)}),D.length>(d==="week"?20:3)&&e.jsxs("div",{style:{fontSize:"0.65rem",color:"var(--text-muted)",textAlign:"center"},children:["+",D.length-(d==="week"?20:3)," daha"]})]})]},V)})})]})}),e.jsxs("div",{className:"card",style:{marginTop:"1rem"},children:[e.jsx("div",{className:"card-header",children:e.jsx("h3",{style:{margin:0},children:" Planlanmam Grevler"})}),e.jsx("div",{className:"card-body",style:{padding:"0.75rem"},children:e.jsxs("div",{style:{display:"flex",flexWrap:"wrap",gap:"0.5rem"},children:[n.filter(U=>!U.plannedDate&&U.status!=="completed").filter(U=>!C||U.teamId===C).slice(0,20).map(U=>e.jsxs("div",{draggable:!0,onDragStart:pe=>q(pe,U),onClick:()=>A(U),style:{padding:"0.5rem 0.75rem",background:U.isOverdue?"rgba(239, 68, 68, 0.1)":"var(--bg-secondary)",border:U.isOverdue?"1px solid var(--danger)":"1px solid var(--border-color)",borderRadius:6,fontSize:"0.85rem",cursor:"grab"},title:"Srkleyip takvime brakn",children:[e.jsx("div",{style:{fontWeight:500},children:U.customerName}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:[U.roleName," - ",U.stageName]}),U.estimatedDate&&e.jsxs("div",{style:{fontSize:"0.7rem",color:U.isOverdue?"var(--danger)":"var(--info)",marginTop:"0.25rem"},children:[" Termin: ",new Date(U.estimatedDate).toLocaleDateString("tr-TR"),U.isOverdue&&" "]})]},U.id)),n.filter(U=>!U.plannedDate&&U.status!=="completed").length===0&&e.jsx("div",{style:{color:"var(--text-muted)",padding:"1rem"},children:"Tm grevler planland "})]})})]}),e.jsx(Be,{isOpen:E,onClose:()=>y(!1),title:"Montaj Grevi Detay",size:"medium",children:p&&e.jsxs("div",{children:[e.jsxs("div",{style:{display:"grid",gap:"0.5rem"},children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Mteri:"})," ",p.customerName]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Konum:"})," ",p.location||""]}),e.jsxs("div",{children:[e.jsx("strong",{children:" Kolu:"})," ",p.roleName]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Aama:"})," ",p.stageName]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Ekip:"})," ",p.teamName||"Atanmad"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Planlanan Tarih:"})," ",p.plannedDate?new Date(p.plannedDate).toLocaleDateString("tr-TR"):"Planlanmad"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Mteri Termini:"})," ",p.estimatedDate?new Date(p.estimatedDate).toLocaleDateString("tr-TR"):""]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Durum:"})," ",e.jsx("span",{className:"badge",style:{background:Uh[p.status],color:"#fff"},children:p.status})]})]}),e.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:"0.5rem",marginTop:"1.5rem"},children:[e.jsx("button",{className:"btn btn-ghost",onClick:()=>y(!1),children:"Kapat"}),e.jsx("button",{className:"btn btn-primary",onClick:()=>{y(!1),t(`/isler/list?job=${p.jobId}&stage=5`)},children:" e Git"})]})]})})]})},qh={broken:{label:"Krk/Hasarl",icon:""},missing:{label:"Eksik Malzeme",icon:""},wrong:{label:"Yanl rn",icon:""},damage:{label:"Hasar",icon:""},other:{label:"Dier",icon:""}},KN={production:{label:"retim Hatas",color:"var(--warning)"},team:{label:"Ekip Hatas",color:"var(--danger)"},accident:{label:"Kaza",color:"var(--info)"}},UN=()=>{const t=Ls(),[s,r]=c.useState(!0),[n,a]=c.useState([]),[l,i]=c.useState(""),[d,u]=c.useState(""),[f,N]=c.useState(!1);c.useEffect(()=>{C()},[]);const C=async()=>{r(!0);try{const y=await Vc({});a(y||[])}catch(y){console.error("Load error:",y)}finally{r(!1)}},b=c.useMemo(()=>{const y=[];for(const m of n)for(const v of m.issues||[])v.status==="pending"&&y.push({...v,taskId:m.id,customerName:m.customerName,location:m.location,roleName:m.roleName,stageName:m.stageName,teamName:m.teamName,jobId:m.jobId});let p=[...y];if(l){const m=l.toLowerCase();p=p.filter(v=>{var z,W,F;return((z=v.customerName)==null?void 0:z.toLowerCase().includes(m))||((W=v.item)==null?void 0:W.toLowerCase().includes(m))||((F=v.note)==null?void 0:F.toLowerCase().includes(m))})}return d&&(p=p.filter(m=>m.type===d)),p.sort((m,v)=>(v.createdAt||"").localeCompare(m.createdAt||"")),p},[n,l,d]),L=async y=>{if(confirm("Bu sorunu zld olarak iaretlemek istediinize emin misiniz?"))try{N(!0),await Ry(y.taskId,y.id),await C()}catch(p){alert(p.message)}finally{N(!1)}},k=y=>{if(!y)return"";try{return new Date(y).toLocaleDateString("tr-TR",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"})}catch{return y}},E=[{header:"Mteri / Konum",accessor:"customerName",render:(y,p)=>e.jsxs("div",{children:[e.jsx("div",{style:{fontWeight:600},children:p.customerName}),e.jsxs("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:[" ",p.location||""]})]})},{header:"Grev",accessor:"roleName",render:(y,p)=>e.jsxs("div",{children:[e.jsx("div",{children:p.roleName}),e.jsx("div",{style:{fontSize:"0.75rem",color:"var(--text-muted)"},children:p.stageName})]})},{header:"Sorun",accessor:"item",render:(y,p)=>{const m=qh[p.type]||{};return e.jsxs("div",{children:[e.jsxs("div",{style:{fontWeight:600},children:[m.icon," ",p.item," (",p.quantity," adet)"]}),e.jsx("span",{className:"badge",style:{fontSize:"0.65rem"},children:m.label})]})}},{header:"Hata Kayna",accessor:"faultSource",render:y=>{const p=KN[y]||{};return e.jsx("span",{className:"badge",style:{background:p.color,color:"#fff"},children:p.label})}},{header:"Yedek Sipari",accessor:"replacementOrderId",render:y=>y?e.jsxs("button",{className:"btn btn-sm btn-ghost",onClick:()=>t(`/isler/uretim-takip/siparisler?search=${y}`),style:{color:"var(--primary)"},children:[" ",y]}):e.jsx("span",{style:{color:"var(--text-muted)"},children:""})},{header:"Tarih",accessor:"createdAt",render:y=>k(y)},{header:"lem",accessor:"actions",render:(y,p)=>e.jsxs("div",{style:{display:"flex",gap:"0.25rem"},children:[e.jsx("button",{className:"btn btn-sm btn-success",onClick:()=>L(p),disabled:f,title:"zld Olarak aretle",children:""}),e.jsx("button",{className:"btn btn-sm btn-ghost",onClick:()=>t(`/isler/list?job=${p.jobId}&stage=5`),title:"e Git",children:""})]})}];return s?e.jsxs("div",{children:[e.jsx(Fe,{title:"Bekleyen Montaj Sorunlar",subtitle:"Ykleniyor..."}),e.jsx("div",{className:"card subtle-card",children:"Ykleniyor..."})]}):e.jsxs("div",{children:[e.jsx(Fe,{title:"Bekleyen Montaj Sorunlar",subtitle:`${b.length} bekleyen sorun`}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(150px, 1fr))",gap:"1rem",marginBottom:"1.5rem"},children:[e.jsx("div",{className:"card",style:{margin:0,background:"var(--danger)",color:"#fff"},children:e.jsxs("div",{className:"card-body",style:{padding:"1rem"},children:[e.jsx("div",{style:{fontSize:"0.75rem",opacity:.9},children:"Toplam Bekleyen"}),e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:700},children:b.length})]})}),e.jsx("div",{className:"card",style:{margin:0,background:"var(--warning)",color:"#fff"},children:e.jsxs("div",{className:"card-body",style:{padding:"1rem"},children:[e.jsx("div",{style:{fontSize:"0.75rem",opacity:.9},children:"retim Hatas"}),e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:700},children:b.filter(y=>y.faultSource==="production").length})]})}),e.jsx("div",{className:"card",style:{margin:0,background:"var(--info)",color:"#fff"},children:e.jsxs("div",{className:"card-body",style:{padding:"1rem"},children:[e.jsx("div",{style:{fontSize:"0.75rem",opacity:.9},children:"Ekip Hatas"}),e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:700},children:b.filter(y=>y.faultSource==="team").length})]})}),e.jsx("div",{className:"card",style:{margin:0,background:"var(--primary)",color:"#fff"},children:e.jsxs("div",{className:"card-body",style:{padding:"1rem"},children:[e.jsx("div",{style:{fontSize:"0.75rem",opacity:.9},children:"Yedek Sipari"}),e.jsx("div",{style:{fontSize:"1.5rem",fontWeight:700},children:b.filter(y=>y.replacementOrderId).length})]})})]}),e.jsx("div",{className:"card",style:{marginBottom:"1rem"},children:e.jsx("div",{className:"card-body",style:{padding:"0.75rem"},children:e.jsxs("div",{style:{display:"flex",gap:"0.75rem",flexWrap:"wrap",alignItems:"center"},children:[e.jsx("input",{type:"text",className:"form-control",placeholder:" Mteri, rn ara...",value:l,onChange:y=>i(y.target.value),style:{flex:1,minWidth:"200px"}}),e.jsxs("select",{className:"form-control",value:d,onChange:y=>u(y.target.value),style:{width:"150px"},children:[e.jsx("option",{value:"",children:"Tm Trler"}),Object.entries(qh).map(([y,p])=>e.jsxs("option",{value:y,children:[p.icon," ",p.label]},y))]})]})})}),e.jsx("div",{className:"card",children:e.jsx(et,{columns:E,data:b,emptyMessage:"Bekleyen montaj sorunu yok "})})]})},qN=()=>e.jsx(vb,{children:e.jsx(ub,{children:e.jsxs(Pe,{path:"/",element:e.jsx(zb,{}),children:[e.jsx(Pe,{index:!0,element:e.jsx(Or,{to:"/dashboard",replace:!0})}),e.jsx(Pe,{path:"dashboard",element:e.jsx(Z0,{})}),e.jsxs(Pe,{path:"isler",children:[e.jsx(Pe,{index:!0,element:e.jsx(Or,{to:"list",replace:!0})}),e.jsx(Pe,{path:"list",element:e.jsx(fN,{})}),e.jsx(Pe,{path:"yeni",element:e.jsx(uN,{})}),e.jsx(Pe,{path:"takvim",element:e.jsx(xN,{})}),e.jsx(Pe,{path:"uretim-plani",element:e.jsx(vN,{})}),e.jsx(Pe,{path:"montaj-sevkiyat",element:e.jsx(yN,{})}),e.jsxs(Pe,{path:"uretim-takip",children:[e.jsx(Pe,{index:!0,element:e.jsx(Or,{to:"siparisler",replace:!0})}),e.jsx(Pe,{path:"siparisler",element:e.jsx(Bn,{})}),e.jsx(Pe,{path:"ic-uretim",element:e.jsx(Bn,{orderType:"internal"})}),e.jsx(Pe,{path:"dis-siparis",element:e.jsx(Bn,{orderType:"external"})}),e.jsx(Pe,{path:"cam",element:e.jsx(Bn,{orderType:"glass"})}),e.jsx(Pe,{path:"sorunlar",element:e.jsx(Bn,{showIssues:!0})})]}),e.jsxs(Pe,{path:"montaj-takip",children:[e.jsx(Pe,{index:!0,element:e.jsx(Or,{to:"planlanan",replace:!0})}),e.jsx(Pe,{path:"planlanan",element:e.jsx(MN,{})}),e.jsx(Pe,{path:"bugun",element:e.jsx($N,{})}),e.jsx(Pe,{path:"takvim",element:e.jsx(WN,{})}),e.jsx(Pe,{path:"sorunlar",element:e.jsx(UN,{})})]})]}),e.jsxs(Pe,{path:"gorevler",children:[e.jsx(Pe,{index:!0,element:e.jsx(Or,{to:"list",replace:!0})}),e.jsx(Pe,{path:"list",element:e.jsx(lN,{})}),e.jsx(Pe,{path:"personel",element:e.jsx(iN,{})}),e.jsx(Pe,{path:"ekipler",element:e.jsx(oN,{})}),e.jsx(Pe,{path:"roller",element:e.jsx(dN,{})})]}),e.jsx(Pe,{path:"musteriler",element:e.jsx(Q0,{})}),e.jsx(Pe,{path:"planlama",element:e.jsx(bN,{})}),e.jsxs(Pe,{path:"stok",children:[e.jsx(Pe,{index:!0,element:e.jsx(zN,{})}),e.jsx(Pe,{path:"liste",element:e.jsx(BN,{})}),e.jsx(Pe,{path:"hareketler",element:e.jsx(EN,{})}),e.jsx(Pe,{path:"kritik",element:e.jsx(AN,{})}),e.jsx(Pe,{path:"rezervasyonlar",element:e.jsx(LN,{})}),e.jsx(Pe,{path:"renkler",element:e.jsx(PN,{})})]}),e.jsx(Pe,{path:"uretim/*",element:e.jsx(Or,{to:"/isler/uretim-takip",replace:!0})}),e.jsxs(Pe,{path:"satinalma",children:[e.jsx(Pe,{index:!0,element:e.jsx(SN,{})}),e.jsx(Pe,{path:"siparisler",element:e.jsx(CN,{})}),e.jsx(Pe,{path:"eksik",element:e.jsx(TN,{})}),e.jsx(Pe,{path:"bekleyen",element:e.jsx(DN,{})}),e.jsx(Pe,{path:"tedarikciler",element:e.jsx(wN,{})})]}),e.jsx(Pe,{path:"evrak/irsaliye-fatura",element:e.jsx(tN,{})}),e.jsx(Pe,{path:"finans/odemeler-kasa",element:e.jsx(rN,{})}),e.jsx(Pe,{path:"arsiv",element:e.jsx(H0,{})}),e.jsx(Pe,{path:"raporlar",element:e.jsx(NN,{})}),e.jsx(Pe,{path:"ayarlar",element:e.jsx(V0,{})}),e.jsx(Pe,{path:"*",element:e.jsx(jN,{})})]})})});$i.createRoot(document.getElementById("root")).render(e.jsx(sf.StrictMode,{children:e.jsx(qN,{})}));
